(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.2' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    583129,      11307]
NotebookOptionsPosition[    577538,      11225]
NotebookOutlinePosition[    577917,      11241]
CellTagsIndexPosition[    577874,      11238]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[TextData[{
 StyleBox["Library of functions written to accompany the algorithms described \
in ",
  FontSize->36,
  FontColor->RGBColor[0, 0, 1]],
 StyleBox["Modern Robotics: Mechanics, Planning, and Control",
  FontSize->36,
  FontSlant->"Italic",
  FontColor->RGBColor[0, 0, 1]],
 StyleBox[".",
  FontSize->36,
  FontColor->RGBColor[0, 0, 1]]
}], "Title",
 CellChangeTimes->{{3.658271341588306*^9, 3.6582713456457853`*^9}, {
   3.675528750549493*^9, 3.675528779907896*^9}, {3.675529226872184*^9, 
   3.67552922870382*^9}, {3.675529362176085*^9, 3.675529365448338*^9}, 
   3.675529396890761*^9, {3.676205646014924*^9, 3.6762056476708612`*^9}, {
   3.6935033748198347`*^9, 3.6935033793448424`*^9}, {3.6935034321395426`*^9, 
   3.693503451701378*^9}, {3.6935037319956045`*^9, 
   3.693503736833613*^9}},ExpressionUUID->"3096a67c-add9-43da-83af-\
32b7a7a080ef"],

Cell[TextData[{
 StyleBox["Author: Huan Weng, Mikhail Todes\nFunctions also available in: \
Python, MATLAB\n\n",
  FontSize->18,
  FontColor->RGBColor[0, 0, 1]],
 StyleBox["Notes:\n",
  FontSize->18,
  FontWeight->"Bold",
  FontColor->RGBColor[0, 0, 1]],
 StyleBox["Before using any of the functions in this library, each chapter\
\[CloseCurlyQuote]s cell needs to be evaluated. This can be done as a whole \
by highlighting everything (Ctrl + A) and then evaluating (Shift + Enter). \n\
\nDouble click on the tabs at the side of each chapter to expand and view the \
code.\n\nAt the start of each function is a description of what it does as \
well as an example showing how to use it.\nQuick tip: If you see a small T \
after braces, it means the transpose of that vector. This can be done the \
same way as accessing Greek letters in Mathematica. Press the Esc key, type \
\[OpenCurlyDoubleQuote]tr\[CloseCurlyDoubleQuote], and then press the Esc key \
again.",
  FontSize->18,
  FontColor->RGBColor[0, 0, 1]],
 StyleBox[" ",
  FontSize->18,
  FontWeight->"Bold",
  FontColor->RGBColor[0, 0, 1]]
}], "Title",
 CellChangeTimes->{{3.658271341588306*^9, 3.6582713456457853`*^9}, {
   3.675528750549493*^9, 3.675528779907896*^9}, {3.675529226872184*^9, 
   3.67552922870382*^9}, {3.675529362176085*^9, 3.675529365448338*^9}, 
   3.675529396890761*^9, {3.676205646014924*^9, 3.676205711454337*^9}, {
   3.676205798666971*^9, 3.676205801603088*^9}, {3.6786303129136467`*^9, 
   3.678630314739846*^9}, 3.682543797297825*^9, {3.6832314306368*^9, 
   3.683231490482093*^9}, {3.683231539283634*^9, 3.683231632134388*^9}, {
   3.683232465039819*^9, 3.6832324695390797`*^9}, {3.683232533035797*^9, 
   3.683232573144146*^9}, {3.693503187861879*^9, 3.6935031908664856`*^9}, {
   3.693503224815956*^9, 3.693503229366966*^9}, {3.6935032898728704`*^9, 
   3.6935032928096757`*^9}, {3.693503339469767*^9, 
   3.6935033477241817`*^9}},ExpressionUUID->"b6567309-8434-4708-a2bb-\
37b3f2220626"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.6755319110417843`*^9, 3.675531927048277*^9}, {
   3.675531958735077*^9, 3.675532032779791*^9}, {3.6755321540719852`*^9, 
   3.675532155394449*^9}, 3.67559226134205*^9, {3.675596340559066*^9, 
   3.675596342576479*^9}, {3.678095916353695*^9, 3.678095936057015*^9}, {
   3.689123258998646*^9, 3.6891232618786497`*^9}, {3.689123343863774*^9, 
   3.68912340346986*^9}, {3.6899070280953193`*^9, 3.689907162011979*^9}, {
   3.6899072391353903`*^9, 3.6899072597645698`*^9}, {3.6899073047291417`*^9, 
   3.689907368236774*^9}, 3.6899076067024136`*^9, {3.689908335780114*^9, 
   3.6899083377722282`*^9}, 3.6899083909262686`*^9, 3.6899086294909134`*^9, {
   3.689908788995037*^9, 3.689908816402604*^9}, {3.690385644196001*^9, 
   3.690385648357239*^9}, {3.690853037932588*^9, 3.690853051641118*^9}, {
   3.6908533565816717`*^9, 
   3.6908533662967834`*^9}},ExpressionUUID->"051fe601-9dc3-4e99-996b-\
456fe895c2ee"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["BASIC HELPER FUNCTIONS",
 FontSize->24,
 FontWeight->"Bold",
 FontColor->RGBColor[0, 0, 1]]], "Title",
 CellChangeTimes->{{3.6755319110417843`*^9, 3.675531927048277*^9}, {
   3.675531958735077*^9, 3.67553201284205*^9}, {3.6756152664138308`*^9, 
   3.675615299230091*^9}, {3.6761156821135902`*^9, 3.676115684953891*^9}, 
   3.6908532331593294`*^9},ExpressionUUID->"67b2b117-d9a7-4270-b942-\
f78127e03058"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"NearZero", "[", "s_", "]"}], ":", "\[IndentingNewLine]", "  ", 
     RowBox[{"Takes", " ", "a", " ", 
      RowBox[{"scalar", ".", "\[IndentingNewLine]", "Checks"}], " ", "if", 
      " ", "the", " ", "scalar", " ", "is", " ", "small", " ", "enough", " ", 
      "to", " ", "be", " ", 
      RowBox[{"neglected", "."}]}]}], "\[IndentingNewLine]", ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "Example", ":", "\[IndentingNewLine]", "Input", ":", " ", "judge"}], " ",
      "=", " ", 
     RowBox[{
      RowBox[{"NearZero", "[", 
       RowBox[{"-", 
        SuperscriptBox["10", 
         RowBox[{"-", "7"}]]}], "]"}], "\[IndentingNewLine]", 
      RowBox[{"Output", ":", " ", "True"}]}]}]}], "\[IndentingNewLine]", 
   "*)"}], "\[IndentingNewLine]", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"NearZero", "[", "s_", "]"}], ":=", 
    RowBox[{
     RowBox[{"Abs", "[", "s", "]"}], "<", 
     SuperscriptBox["10", 
      RowBox[{"-", "6"}]]}]}], "\[IndentingNewLine]", "\n"}]}]], "Input",
 CellChangeTimes->{{3.6755319110417843`*^9, 3.675531927048277*^9}, {
   3.675531958735077*^9, 3.675532032779791*^9}, {3.6755321540719852`*^9, 
   3.675532155394449*^9}, 3.67559226134205*^9, {3.675596340559066*^9, 
   3.675596342576479*^9}, {3.678095916353695*^9, 3.678095936057015*^9}, {
   3.689123258998646*^9, 3.6891232618786497`*^9}, {3.689123343863774*^9, 
   3.68912340346986*^9}, {3.6899075896464376`*^9, 3.689907596066805*^9}, {
   3.689907651688987*^9, 3.689907656250248*^9}, {3.689908341024414*^9, 
   3.6899083422934866`*^9}, {3.6899083849099245`*^9, 3.689908387394067*^9}, {
   3.689908830571415*^9, 3.6899088323495164`*^9}, 3.6908533275993333`*^9, 
   3.690854954790098*^9, {3.6924691057816725`*^9, 3.6924691282329273`*^9}, {
   3.6924695971960073`*^9, 3.6924695974456077`*^9}, {3.69309949985518*^9, 
   3.6930995081881924`*^9}, 3.6931533609456143`*^9, {3.6932376898099833`*^9, 
   3.6932377248320446`*^9}, 3.693237810912996*^9, 3.6935352191572638`*^9, 
   3.6935353437081375`*^9, {3.7390669406448765`*^9, 3.7390669751281943`*^9}, 
   3.7390670765600395`*^9, {3.7391118831207404`*^9, 3.7391118836414433`*^9}, {
   3.739111913690474*^9, 3.7391119278205028`*^9}, 3.7391122955954013`*^9, {
   3.7391123313036284`*^9, 3.739112355775103*^9}, {3.7391132887367125`*^9, 
   3.739113290105914*^9}, {3.739113335387994*^9, 3.7391133414081125`*^9}, {
   3.7391133829367013`*^9, 3.7391133835712132`*^9}, 3.739113454365202*^9, {
   3.7391134905920267`*^9, 3.7391135369549313`*^9}, {3.7391135870514154`*^9, 
   3.739113631579914*^9}, {3.7391136761999083`*^9, 3.7391137578315706`*^9}, {
   3.7391138105158825`*^9, 3.73911393012703*^9}, {3.739113960303635*^9, 
   3.739114006487262*^9}, {3.7391141310907097`*^9, 3.739114285843878*^9}, {
   3.739114344057414*^9, 3.739114390715605*^9}, {3.73911444398519*^9, 
   3.7391144917104807`*^9}, {3.739114551615704*^9, 3.7391145602236476`*^9}, {
   3.739115013147765*^9, 3.7391151873754435`*^9}, 3.73911531566462*^9, {
   3.7391154731340127`*^9, 3.739115545682316*^9}, {3.7391155895767775`*^9, 
   3.7391156703697853`*^9}, {3.739115838530749*^9, 
   3.739115863763939*^9}},ExpressionUUID->"384776d6-859b-4642-a67d-\
e130b5288bb1"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["CHAPTER  3: RIGID-BODY MOTION",
 FontSize->24,
 FontWeight->"Bold",
 FontColor->RGBColor[0, 0, 1]]], "Title",
 CellChangeTimes->{{3.6755319110417843`*^9, 3.675531927048277*^9}, {
  3.675531958735077*^9, 3.67553201284205*^9}, {3.6756152664138308`*^9, 
  3.675615299230091*^9}, {3.6761156821135902`*^9, 
  3.676115684953891*^9}},ExpressionUUID->"634fe91f-27b4-4e3f-a2ab-\
11a4d248e7fd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"RotInv", "[", "R_", "]"}], ":", "\[IndentingNewLine]", "  ", 
     RowBox[{"Takes", " ", "a", " ", "3", "x3", " ", "rotation", " ", 
      RowBox[{"matrix", ".", "\[IndentingNewLine]", "Returns"}], " ", "the", 
      " ", "inverse", " ", 
      RowBox[{
       RowBox[{"(", "transpose", ")"}], "."}]}]}], "\[IndentingNewLine]", ";",
     "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "Example", ":", "\[IndentingNewLine]", "Input", ":", " ", "invR"}], " ", 
     "=", " ", 
     RowBox[{
      RowBox[{"RotInv", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "}"}], "]"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Output", ":", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0"}], "}"}]}], "}"}]}]}]}]}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", "\n", 
  RowBox[{
   RowBox[{
    RowBox[{"RotInv", "[", "R_", "]"}], ":=", 
    RowBox[{"R", "\[Transpose]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.6755319110417843`*^9, 3.675531927048277*^9}, {
   3.675531958735077*^9, 3.675532032779791*^9}, {3.6755321540719852`*^9, 
   3.675532155394449*^9}, 3.67559226134205*^9, {3.675596340559066*^9, 
   3.675596342576479*^9}, {3.678095916353695*^9, 3.678095936057015*^9}, {
   3.689123258998646*^9, 3.6891232618786497`*^9}, {3.689123343863774*^9, 
   3.68912340346986*^9}, {3.6899075896464376`*^9, 3.689907596066805*^9}, {
   3.689907651688987*^9, 3.689907656250248*^9}, {3.689908341024414*^9, 
   3.6899083422934866`*^9}, {3.6899083849099245`*^9, 3.689908387394067*^9}, {
   3.689908830571415*^9, 3.6899088323495164`*^9}, {3.6924695941854005`*^9, 
   3.692469595786604*^9}, {3.69315336961923*^9, 
   3.6931533840804553`*^9}},ExpressionUUID->"f6c93c67-d27e-41b6-bdde-\
6f032fb810cd"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"VecToso3", "[", "omg_", "]"}], ":", "\[IndentingNewLine]", 
     "   ", 
     RowBox[{
      RowBox[{"Takes", " ", "a", " ", "3"}], "-", 
      RowBox[{"vector", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"angular", " ", "velocity"}], ")"}], ".", 
        "\[IndentingNewLine]", "Returns"}], " ", "the", " ", "skew", " ", 
       "symmetric", " ", "matrix", " ", "in", " ", 
       RowBox[{"so3", "."}]}]}]}], "\[IndentingNewLine]", ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "Example", ":", "\[IndentingNewLine]", "Input", ":", " ", "so3mat"}], 
     " ", "=", " ", 
     RowBox[{
      RowBox[{"VecToso3", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "1", "}"}], ",", 
         RowBox[{"{", "2", "}"}], ",", 
         RowBox[{"{", "3", "}"}]}], "}"}], "]"}], "\[IndentingNewLine]", 
      RowBox[{"Output", ":", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"-", "3"}], ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"3", ",", "0", ",", 
           RowBox[{"-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "2"}], ",", "1", ",", "0"}], "}"}]}], "}"}]}]}]}]}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"VecToso3", "[", "omg_", "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"-", 
         RowBox[{"omg", "[", 
          RowBox[{"[", 
           RowBox[{"3", ",", "1"}], "]"}], "]"}]}], ",", 
        RowBox[{"omg", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"omg", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "1"}], "]"}], "]"}], ",", "0", ",", 
        RowBox[{"-", 
         RowBox[{"omg", "[", 
          RowBox[{"[", 
           RowBox[{"1", ",", "1"}], "]"}], "]"}]}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"omg", "[", 
          RowBox[{"[", 
           RowBox[{"2", ",", "1"}], "]"}], "]"}]}], ",", 
        RowBox[{"omg", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", "0"}], "}"}]}], "}"}]}],
    "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.6755319110417843`*^9, 3.675531927048277*^9}, {
   3.675531958735077*^9, 3.675532032779791*^9}, {3.6755321540719852`*^9, 
   3.675532176089467*^9}, {3.6755325631830273`*^9, 3.6755326462949533`*^9}, {
   3.6755327460483017`*^9, 3.675532746848569*^9}, {3.675533015887747*^9, 
   3.6755331043631153`*^9}, {3.675533262027841*^9, 3.6755332644293537`*^9}, 
   3.675592257047958*^9, 3.675594217872285*^9, {3.67559635411017*^9, 
   3.6755963639568*^9}, {3.678095931635499*^9, 3.678095941539589*^9}, {
   3.6899090930844297`*^9, 3.6899091025809727`*^9}, {3.690311308636998*^9, 
   3.690311353117509*^9}, {3.6924695914339933`*^9, 3.6924695919799943`*^9}, {
   3.693153395140875*^9, 
   3.6931533983700805`*^9}},ExpressionUUID->"a30bf937-6481-47ee-bb9e-\
be8b63cba8e1"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"so3ToVec", "[", "so3mat_", "]"}], ":", "\[IndentingNewLine]", 
     "   ", 
     RowBox[{
      RowBox[{"Takes", " ", "a", " ", "3", "x3", " ", "skew"}], "-", 
      RowBox[{"symmetric", " ", "matrix", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"an", " ", "element", " ", "of", " ", "so", 
          RowBox[{"(", "3", ")"}]}], ")"}], ".", "\[IndentingNewLine]", 
        "Returns"}], " ", "the", " ", "corresponding", " ", "vector", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"angular", " ", "velocity"}], ")"}], "."}]}]}]}], 
    "\[IndentingNewLine]", ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "Example", ":", "\[IndentingNewLine]", "Input", ":", " ", "omg"}], " ", 
     "=", " ", 
     RowBox[{
      RowBox[{"so3ToVec", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"-", "3"}], ",", "2"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"3", ",", "0", ",", 
           RowBox[{"-", "1"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "2"}], ",", "1", ",", "0"}], "}"}]}], "}"}], "]"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Output", ":", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "1", "}"}], ",", 
         RowBox[{"{", "2", "}"}], ",", 
         RowBox[{"{", "3", "}"}]}], "}"}]}]}]}]}], "\[IndentingNewLine]", 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"so3ToVec", "[", "so3mat_", "]"}], ":=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"so3mat", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "2"}], "]"}], "]"}], ",", 
        RowBox[{"so3mat", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "3"}], "]"}], "]"}], ",", 
        RowBox[{"so3mat", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}]}], "}"}], "}"}], 
     "\[Transpose]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.675533307004715*^9, 3.67553330945144*^9}, 
   3.675592067518145*^9, {3.675592113013286*^9, 3.675592115100141*^9}, {
   3.675592155090198*^9, 3.675592250827938*^9}, {3.67559229043678*^9, 
   3.6755922914617233`*^9}, 3.675594212914967*^9, {3.67559639441064*^9, 
   3.675596396661991*^9}, {3.67809595187551*^9, 3.678095953534129*^9}, 
   3.6903174557842903`*^9, {3.6924692013473115`*^9, 3.69246920470912*^9}, {
   3.692469587930587*^9, 3.692469588462988*^9}, {3.6931534028160877`*^9, 
   3.693153405171692*^9}},ExpressionUUID->"c7a81d49-344f-4e62-a20b-\
5d1c78342f7c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"AxisAng3", "[", "expc3_", "]"}], ":", "\[IndentingNewLine]", 
     "   ", 
     RowBox[{
      RowBox[{"Takes", " ", "A", " ", "3"}], "-", 
      RowBox[{
      "vector", " ", "of", " ", "exponential", " ", "coordinates", " ", "for",
        " ", 
       RowBox[{"rotation", ".", " ", "\[IndentingNewLine]", "Returns"}], " ", 
       "unit", " ", "rotation", " ", "axis", " ", "omghat", " ", "and", " ", 
       "the", " ", "corresponding", " ", "rotation", " ", "angle", " ", 
       RowBox[{"theta", ".", "\[IndentingNewLine]", "The"}], " ", "first", 
       " ", "element", " ", "of", " ", "the", " ", "output", " ", "is", " ", 
       "the", " ", "unit", " ", "rotation", " ", "axis", " ", "column", " ", 
       "vector", " ", 
       RowBox[{"(", "omghat", ")"}], " ", "and", " ", "the", " ", "second", 
       " ", "element", " ", "is", " ", 
       RowBox[{"theta", "."}]}]}]}], "\[IndentingNewLine]", ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Example", ":", "\[IndentingNewLine]", "Input", ":", " ", 
      RowBox[{"{", 
       RowBox[{"omghat", ",", "theta"}], "}"}]}], " ", "=", " ", 
     RowBox[{
      RowBox[{"AxisAng3", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "3"}], "}"}], "}"}], "\[Transpose]"}], 
       "]"}], "//", 
      RowBox[{"N", "\[IndentingNewLine]", 
       RowBox[{"Output", ":", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "0.2672612419124244", "}"}], ",", 
            RowBox[{"{", "0.5345224838248488", "}"}], ",", 
            RowBox[{"{", "0.8017837257372732", "}"}]}], "}"}], ",", 
          "3.7416573867739413"}], "}"}]}]}]}]}]}], "\[IndentingNewLine]", 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"AxisAng3", "[", "expc3_", "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"expc3", "/", 
       RowBox[{"Norm", "[", "expc3", "]"}]}], ",", 
      RowBox[{"Norm", "[", "expc3", "]"}]}], "}"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.675533307004715*^9, 3.67553330945144*^9}, 
   3.675592067518145*^9, {3.675592113013286*^9, 3.675592115100141*^9}, {
   3.675592155090198*^9, 3.675592250827938*^9}, {3.67559229043678*^9, 
   3.6755922914617233`*^9}, 3.6755923257071743`*^9, {3.675592392796273*^9, 
   3.6755924786666107`*^9}, {3.675592636879244*^9, 3.675592662642579*^9}, {
   3.675592692874652*^9, 3.675592696674159*^9}, 3.675594207807824*^9, 
   3.675596301390246*^9, 3.678095963162088*^9, 3.690855047324808*^9, {
   3.692469216534156*^9, 3.692469257502246*^9}, {3.692469585962983*^9, 
   3.692469586399784*^9}, {3.693153412924906*^9, 
   3.6931534155613103`*^9}},ExpressionUUID->"a1df8796-c264-4486-93a4-\
7068200bf83e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MatrixExp3", "[", "so3mat", "]"}], ":", "\[IndentingNewLine]", 
      "  ", 
      RowBox[{"Takes", " ", "a", " ", "so", 
       RowBox[{"(", "3", ")"}], " ", "representation", " ", "of", " ", 
       "exponential", " ", 
       RowBox[{"coordinates", ".", "\[IndentingNewLine]", "Returns"}], " ", 
       "R", " ", "in", " ", "SO", 
       RowBox[{"(", "3", ")"}], " ", "that", " ", "is", " ", "achieved", " ", 
       "by", " ", "rotating", " ", "about", " ", "omghat", " ", "by", " ", 
       "theta", " ", "from", " ", "an", " ", "initial", " ", "orientation", 
       " ", "R"}]}], "=", 
     RowBox[{"I", "."}]}], "\[IndentingNewLine]", ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Example", ":", "\[IndentingNewLine]", "Input", ":", " ", "R"}], 
     " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"MatrixExp3", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", 
            RowBox[{"-", "3"}], ",", "2"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"3", ",", "0", ",", 
            RowBox[{"-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"-", "2"}], ",", "1", ",", "0"}], "}"}]}], "}"}], "]"}], "//",
        "N"}], "//", 
      RowBox[{"MatrixForm", "\[IndentingNewLine]", 
       RowBox[{"Output", ":", " ", 
        TagBox[
         RowBox[{"(", "\[NoBreak]", GridBox[{
            {
             RowBox[{"-", "0.6949205576413118"}], "0.7135209905277876", 
             "0.08929285886191213"},
            {
             RowBox[{"-", "0.1920069727919994"}], 
             RowBox[{"-", "0.3037850443394705"}], "0.9331923538236468"},
            {"0.6929781677417701", "0.6313496993837178", "0.34810747783026474"}
           },
           
           GridBoxAlignment->{
            "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
           GridBoxSpacings->{"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.7]}, 
               Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
         Function[BoxForm`e$, 
          MatrixForm[BoxForm`e$]]]}]}]}]}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MatrixExp3", "[", "so3mat_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"omgtheta", ",", "omghat", ",", "theta", ",", "omgmat"}], 
       "}"}], ",", 
      RowBox[{
       RowBox[{"omgtheta", "=", 
        RowBox[{"so3ToVec", "[", "so3mat", "]"}]}], ";", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"NearZero", "[", 
          RowBox[{"Norm", "[", "omgtheta", "]"}], "]"}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"IdentityMatrix", "[", "3", "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"omghat", ",", " ", "theta"}], "}"}], " ", "=", " ", 
           RowBox[{"AxisAng3", "[", "omgtheta", "]"}]}], ";", 
          RowBox[{"omgmat", "=", 
           RowBox[{"so3mat", "/", "theta"}]}], ";", 
          RowBox[{"Return", "[", 
           RowBox[{
            RowBox[{"IdentityMatrix", "[", "3", "]"}], "+", 
            RowBox[{
             RowBox[{"Sin", "[", "theta", "]"}], "*", "omgmat"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               RowBox[{"Cos", "[", "theta", "]"}]}], ")"}], "*", 
             RowBox[{"omgmat", ".", "omgmat"}]}]}], "]"}]}]}], "]"}]}]}], 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.675533307004715*^9, 3.67553330945144*^9}, 
   3.675592067518145*^9, {3.675592113013286*^9, 3.675592115100141*^9}, {
   3.675592155090198*^9, 3.675592250827938*^9}, {3.67559229043678*^9, 
   3.6755922914617233`*^9}, 3.6755923257071743`*^9, {3.675592392796273*^9, 
   3.6755924786666107`*^9}, {3.675592636879244*^9, 3.675592662642579*^9}, {
   3.675592750871451*^9, 3.675592760234817*^9}, {3.675592843016467*^9, 
   3.6755928498639193`*^9}, {3.675593005317328*^9, 3.675593006955986*^9}, {
   3.675593085055738*^9, 3.675593106872654*^9}, {3.6755931552286654`*^9, 
   3.675593202588101*^9}, {3.675593410152174*^9, 3.675593425469223*^9}, {
   3.675593463962451*^9, 3.675593465912236*^9}, 3.675594202040379*^9, {
   3.675596420655054*^9, 3.675596421318139*^9}, {3.675601785945984*^9, 
   3.67560180540821*^9}, 3.678095974651895*^9, {3.690316962755663*^9, 
   3.6903169900622253`*^9}, {3.6903172083078814`*^9, 
   3.6903172210359006`*^9}, {3.6903172543599486`*^9, 3.690317258029954*^9}, 
   3.6903174800323267`*^9, 3.69031752418739*^9, {3.6903175690344543`*^9, 
   3.690317574912464*^9}, {3.6903176062325087`*^9, 3.6903176407495584`*^9}, {
   3.6903176838896227`*^9, 3.6903178122478094`*^9}, {3.6903180723051853`*^9, 
   3.690318133493273*^9}, 3.690318291203499*^9, {3.6903224954192677`*^9, 
   3.690322523167308*^9}, 3.6903234267162743`*^9, {3.6904637546239395`*^9, 
   3.690463885817773*^9}, {3.6904644441695704`*^9, 3.690464456852393*^9}, 
   3.690464502773274*^9, 3.690855052820299*^9, {3.6924692693512707`*^9, 
   3.692469274767481*^9}, {3.6924693061159534`*^9, 3.6924693872389235`*^9}, {
   3.6924694605604925`*^9, 3.692469471100115*^9}, {3.6924695772459645`*^9, 
   3.692469581071972*^9}, 3.693099528992228*^9, {3.693153426200529*^9, 
   3.693153431613739*^9}, {3.6931906954047346`*^9, 3.6931906968555374`*^9}, {
   3.6932378420506506`*^9, 
   3.6932378557786746`*^9}},ExpressionUUID->"9e5fc67d-eedb-4d6c-92ce-\
f7e1bae8e4b6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"MatrixLog3", "[", "R_", "]"}], ":", "\[IndentingNewLine]", "  ", 
     RowBox[{"Takes", " ", "R", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"rotation", " ", "matrix"}], ")"}], ".", 
       "\[IndentingNewLine]", "Returns"}], " ", "the", " ", "corresponding", 
      " ", "so", 
      RowBox[{"(", "3", ")"}], " ", "representation", " ", "of", " ", 
      "exponential", " ", 
      RowBox[{"coordinates", "."}]}]}], "  ", "\[IndentingNewLine]", ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "Example", ":", "\[IndentingNewLine]", "Input", ":", " ", "so3mat"}], 
     " ", "=", " ", 
     RowBox[{
      RowBox[{"MatrixLog3", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "}"}], "]"}], "//", 
      RowBox[{"N", "\[IndentingNewLine]", 
       RowBox[{"Output", ":", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "1.2091995761561452", "}"}], ",", 
          RowBox[{"{", "1.2091995761561452", "}"}], ",", 
          RowBox[{"{", "1.2091995761561452", "}"}]}], "}"}]}]}]}]}]}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MatrixLog3", "[", "R_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"acosinput", ",", "theta", ",", "omgmat"}], "}"}], ",", 
      RowBox[{"Which", "[", 
       RowBox[{
        RowBox[{"NearZero", "[", 
         RowBox[{"Norm", "[", 
          RowBox[{"R", "-", 
           RowBox[{"IdentityMatrix", "[", "3", "]"}]}], "]"}], "]"}], ",", 
        RowBox[{"Return", "[", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"3", ",", "3"}], "}"}]}], "]"}], "]"}], ",", 
        RowBox[{"NearZero", "[", 
         RowBox[{
          RowBox[{"Tr", "[", "R", "]"}], "+", "1"}], "]"}], ",", 
        RowBox[{"Which", "[", 
         RowBox[{
          RowBox[{"Not", "[", 
           RowBox[{"NearZero", "[", 
            RowBox[{
             RowBox[{"R", "[", 
              RowBox[{"[", 
               RowBox[{"3", ",", "3"}], "]"}], "]"}], "+", "1"}], "]"}], 
           "]"}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"VecToso3", "[", 
            RowBox[{
             RowBox[{"1", "/", 
              RowBox[{"Sqrt", "[", 
               RowBox[{"2", 
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"R", "[", 
                   RowBox[{"[", 
                    RowBox[{"3", ",", "3"}], "]"}], "]"}]}], ")"}]}], "]"}]}],
              "*", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"R", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "3"}], "]"}], "]"}], ",", 
                 RowBox[{"R", "[", 
                  RowBox[{"[", 
                   RowBox[{"2", ",", "3"}], "]"}], "]"}], ",", 
                 RowBox[{"1", "+", 
                  RowBox[{"R", "[", 
                   RowBox[{"[", 
                    RowBox[{"3", ",", "3"}], "]"}], "]"}]}]}], "}"}], "}"}], 
              "\[Transpose]"}], "*", "Pi"}], "]"}], "]"}], ",", 
          RowBox[{"Not", "[", 
           RowBox[{"NearZero", "[", 
            RowBox[{
             RowBox[{"R", "[", 
              RowBox[{"[", 
               RowBox[{"2", ",", "2"}], "]"}], "]"}], "+", "1"}], "]"}], 
           "]"}], ",", 
          RowBox[{"Return", "[", 
           RowBox[{"VecToso3", "[", 
            RowBox[{
             RowBox[{"1", "/", 
              RowBox[{"Sqrt", "[", 
               RowBox[{"2", 
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"R", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ")"}]}], "]"}]}],
              "*", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"R", "[", 
                  RowBox[{"[", 
                   RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", 
                 RowBox[{"1", "+", 
                  RowBox[{"R", "[", 
                   RowBox[{"[", 
                    RowBox[{"2", ",", "2"}], "]"}], "]"}]}], ",", 
                 RowBox[{"R", "[", 
                  RowBox[{"[", 
                   RowBox[{"3", ",", "2"}], "]"}], "]"}]}], "}"}], "}"}], 
              "\[Transpose]"}], "*", "Pi"}], "]"}], "]"}], ",", "True", ",", 
          RowBox[{"Return", "[", 
           RowBox[{"VecToso3", "[", 
            RowBox[{
             RowBox[{"1", "/", 
              RowBox[{"Sqrt", "[", 
               RowBox[{"2", 
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{"R", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ")"}]}], "]"}]}],
              "*", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"1", "+", 
                  RowBox[{"R", "[", 
                   RowBox[{"[", 
                    RowBox[{"1", ",", "1"}], "]"}], "]"}]}], ",", 
                 RowBox[{"R", "[", 
                  RowBox[{"[", 
                   RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
                 RowBox[{"R", "[", 
                  RowBox[{"[", 
                   RowBox[{"3", ",", "1"}], "]"}], "]"}]}], "}"}], "}"}], 
              "\[Transpose]"}], "*", "Pi"}], "]"}], "]"}]}], "]"}], ",", 
        "True", ",", 
        RowBox[{
         RowBox[{"acosinput", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Tr", "[", "R", "]"}], "-", "1"}], ")"}], "/", "2"}]}], 
         ";", 
         RowBox[{"Which", "[", 
          RowBox[{
           RowBox[{"acosinput", ">", "1"}], ",", 
           RowBox[{"acosinput", "=", "1"}], ",", 
           RowBox[{"acosinput", "<", 
            RowBox[{"-", "1"}]}], ",", 
           RowBox[{"acosinput", "=", 
            RowBox[{"-", "1"}]}]}], "]"}], ";", 
         RowBox[{"theta", "=", 
          RowBox[{"ArcCos", "[", "acosinput", "]"}]}], ";", 
         RowBox[{"omgmat", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"R", "-", 
             RowBox[{"R", "\[Transpose]"}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", "*", 
             RowBox[{"Sin", "[", "theta", "]"}]}], ")"}]}]}], ";", 
         RowBox[{"Return", "[", 
          RowBox[{"theta", "*", "omgmat"}], "]"}]}]}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.675533307004715*^9, 3.67553330945144*^9}, 
   3.675592067518145*^9, {3.675592113013286*^9, 3.675592115100141*^9}, {
   3.675592155090198*^9, 3.675592250827938*^9}, {3.67559229043678*^9, 
   3.6755922914617233`*^9}, 3.6755923257071743`*^9, {3.675592392796273*^9, 
   3.6755924786666107`*^9}, {3.675592636879244*^9, 3.675592662642579*^9}, {
   3.675592750871451*^9, 3.675592760234817*^9}, {3.675592843016467*^9, 
   3.6755928498639193`*^9}, {3.675593005317328*^9, 3.675593006955986*^9}, {
   3.675593085055738*^9, 3.675593106872654*^9}, {3.6755931552286654`*^9, 
   3.675593202588101*^9}, {3.675593410152174*^9, 3.675593425469223*^9}, {
   3.675593463962451*^9, 3.675593465912236*^9}, {3.675594236154458*^9, 
   3.6755942477744513`*^9}, {3.675594364598016*^9, 3.675594367233914*^9}, {
   3.675594505282823*^9, 3.675594524684219*^9}, {3.675594705253235*^9, 
   3.67559470565687*^9}, {3.675594770197138*^9, 3.6755948067599487`*^9}, {
   3.67559486980615*^9, 3.6755949272469254`*^9}, {3.675594959952829*^9, 
   3.675594966081294*^9}, {3.675595073310274*^9, 3.675595099122567*^9}, {
   3.675595166588663*^9, 3.675595198087933*^9}, {3.675596440163121*^9, 
   3.6755964490162983`*^9}, {3.678095978175391*^9, 3.6780960120591097`*^9}, {
   3.678096058570084*^9, 3.6780960634875927`*^9}, {3.6891019372217746`*^9, 
   3.6891019477417893`*^9}, {3.6891019827579947`*^9, 
   3.6891019945970225`*^9}, {3.689102332695384*^9, 3.689102355379416*^9}, {
   3.6891027087439213`*^9, 3.6891027302559524`*^9}, {3.689102760787996*^9, 
   3.689102778300021*^9}, {3.6891028165060754`*^9, 3.6891028176160765`*^9}, {
   3.6891237737294703`*^9, 3.6891237973465033`*^9}, {3.6893784218629103`*^9, 
   3.689378540730709*^9}, {3.6903271275408573`*^9, 3.690327157925967*^9}, {
   3.690327234969596*^9, 3.6903273112797165`*^9}, {3.6903274962807355`*^9, 
   3.6903275154157643`*^9}, {3.690327571555847*^9, 3.6903276193499165`*^9}, {
   3.690327703624699*^9, 3.6903277763308063`*^9}, {3.6903278574919267`*^9, 
   3.6903278942929816`*^9}, {3.690327925553028*^9, 3.690328017523163*^9}, {
   3.6903280623929653`*^9, 3.6903280918630085`*^9}, {3.69032817462913*^9, 
   3.690328176119132*^9}, {3.69032859247474*^9, 3.6903285980217485`*^9}, {
   3.6903826145646625`*^9, 3.6903826159218645`*^9}, {3.6903827301920657`*^9, 
   3.690382788520568*^9}, {3.6903830758070974`*^9, 3.6903832624287715`*^9}, {
   3.690383355359087*^9, 3.6903834242210255`*^9}, {3.690383556687602*^9, 
   3.6903837399190826`*^9}, {3.6903839021183596`*^9, 3.690383908328715*^9}, 
   3.690384008237429*^9, {3.6903841024418173`*^9, 3.6903842061487494`*^9}, {
   3.6903843524911194`*^9, 3.6903844570981026`*^9}, {3.690384517418553*^9, 
   3.690384559520961*^9}, {3.6903846244256735`*^9, 3.690384682787011*^9}, {
   3.69038482823133*^9, 3.6903848739139433`*^9}, {3.6903849852783127`*^9, 
   3.6903851187249455`*^9}, {3.690385186941847*^9, 3.690385236173663*^9}, 
   3.690385377774762*^9, 3.6903856761338277`*^9, {3.6903857777206383`*^9, 
   3.6903858065702877`*^9}, {3.690385836747014*^9, 3.690385916871597*^9}, {
   3.6903876830276155`*^9, 3.6903878015853963`*^9}, {3.692469395272942*^9, 
   3.6924693997741513`*^9}, {3.6924694371828403`*^9, 
   3.6924694808031335`*^9}, {3.6924695752349577`*^9, 
   3.6924695754533577`*^9}, {3.693099531904233*^9, 3.69309953504824*^9}, {
   3.6931534401157537`*^9, 3.69315344379736*^9}, {3.693237872143103*^9, 
   3.6932378825795217`*^9}},ExpressionUUID->"305f1770-a098-48b5-a75d-\
b4d53949ef1a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"RpToTrans", "[", 
      RowBox[{"R_", ",", "p_"}], "]"}], ":", "\[IndentingNewLine]", "  ", 
     RowBox[{
     "Takes", " ", "rotation", " ", "matrix", " ", "R", " ", "and", " ", 
      "position", " ", 
      RowBox[{"p", ".", "\[IndentingNewLine]", "Returns"}], " ", 
      "corresponding", " ", "homogeneous", " ", "transformation", " ", 
      "matrix", " ", "T", " ", "in", " ", "SE", 
      RowBox[{
       RowBox[{"(", "3", ")"}], "."}]}]}], "\[IndentingNewLine]", ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Example", ":", "\[IndentingNewLine]", "Input", ":", " ", "T"}], 
     " ", "=", " ", 
     RowBox[{
      RowBox[{"RpToTrans", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", 
            RowBox[{"-", "1"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "}"}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"{", 
           RowBox[{"1", ",", "2", ",", "5"}], "}"}], "}"}], 
         "\[Transpose]"}]}], "]"}], "//", 
      RowBox[{"MatrixForm", "\[IndentingNewLine]", 
       RowBox[{"Output", ":", " ", 
        TagBox[
         RowBox[{"(", "\[NoBreak]", GridBox[{
            {"1", "0", "0", "1"},
            {"0", "0", 
             RowBox[{"-", "1"}], "2"},
            {"0", "1", "0", "5"},
            {"0", "0", "0", "1"}
           },
           
           GridBoxAlignment->{
            "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
           GridBoxSpacings->{"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.7]}, 
               Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
         Function[BoxForm`e$, 
          MatrixForm[BoxForm`e$]]]}]}]}]}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"RpToTrans", "[", 
     RowBox[{"R_", ",", "p_"}], "]"}], ":=", 
    RowBox[{"ArrayFlatten", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"R", ",", "p"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "}"}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.654107438701495*^9, 3.6541075770931664`*^9}, {
   3.6541076103152647`*^9, 3.654107726674172*^9}, {3.654107800327899*^9, 
   3.654107805926005*^9}, {3.654107842157054*^9, 3.654107956534466*^9}, {
   3.6541080276373253`*^9, 3.654108039845397*^9}, {3.654108208328875*^9, 
   3.654108267778264*^9}, {3.654108316603101*^9, 3.65410832858707*^9}, {
   3.654122072990996*^9, 3.654122200142358*^9}, {3.654122232524707*^9, 
   3.6541222637488813`*^9}, {3.654122372486209*^9, 3.65412253592478*^9}, {
   3.654122571686759*^9, 3.654122685636675*^9}, {3.654122740902017*^9, 
   3.6541228215630703`*^9}, {3.654122865671712*^9, 3.654122935620612*^9}, {
   3.654123032181581*^9, 3.6541230914473333`*^9}, {3.654123152783122*^9, 
   3.6541232043612537`*^9}, {3.654123304611115*^9, 3.654123341073502*^9}, {
   3.654123502235703*^9, 3.654123578362132*^9}, {3.654123664279245*^9, 
   3.654123683195951*^9}, {3.6541237878998413`*^9, 3.6541238249788847`*^9}, {
   3.654123940392714*^9, 3.654123947510108*^9}, {3.654124026309593*^9, 
   3.654124026885428*^9}, 3.6541241152729683`*^9, 3.654124170343902*^9, {
   3.6541246995439568`*^9, 3.654124712871656*^9}, {3.6541251843297157`*^9, 
   3.654125231518578*^9}, {3.6541254856851683`*^9, 3.65412548908077*^9}, {
   3.654125547742125*^9, 3.654125551165526*^9}, {3.654125930807577*^9, 
   3.654126007244483*^9}, {3.654126127665163*^9, 3.654126191634789*^9}, {
   3.654126236482831*^9, 3.654126250153975*^9}, {3.6541262848658533`*^9, 
   3.654126288991514*^9}, {3.654126323055903*^9, 3.654126399729628*^9}, {
   3.654126435349374*^9, 3.654126447266036*^9}, {3.654126530077552*^9, 
   3.6541265937421*^9}, {3.654126679867402*^9, 3.6541267650289497`*^9}, {
   3.6541267969631968`*^9, 3.654126798410089*^9}, {3.654126829860013*^9, 
   3.654126881359337*^9}, {3.6541269393824577`*^9, 3.654126959132009*^9}, {
   3.654127079773924*^9, 3.654127194954756*^9}, {3.654127229244482*^9, 
   3.654127253953713*^9}, {3.6541278694900227`*^9, 3.654127878663176*^9}, {
   3.654127969775614*^9, 3.6541279938293123`*^9}, {3.654128051763153*^9, 
   3.654128134016169*^9}, {3.654128326830834*^9, 3.654128326972948*^9}, {
   3.654182305132535*^9, 3.654182317491791*^9}, {3.65418238746202*^9, 
   3.654182511491269*^9}, {3.654182551115921*^9, 3.654182559209998*^9}, {
   3.6541826265390177`*^9, 3.654182732425318*^9}, {3.654182795218339*^9, 
   3.654182802306821*^9}, {3.654182858360195*^9, 3.654182976637673*^9}, {
   3.65418309291822*^9, 3.6541831115452337`*^9}, {3.654183280620055*^9, 
   3.654183381285778*^9}, {3.6541834216733217`*^9, 3.65418343026462*^9}, {
   3.65418347398075*^9, 3.654183479016459*^9}, {3.654183517743698*^9, 
   3.654183590244978*^9}, {3.654183629340012*^9, 3.654183659551435*^9}, {
   3.654183828746057*^9, 3.654183869187777*^9}, {3.654183918271063*^9, 
   3.6541839184304667`*^9}, {3.654206461375032*^9, 3.6542064948942213`*^9}, {
   3.6542065261576433`*^9, 3.654206710642645*^9}, {3.65420685898112*^9, 
   3.654206859498214*^9}, {3.654206912388175*^9, 3.6542069199221067`*^9}, {
   3.654206956850091*^9, 3.654206957769821*^9}, {3.6542070885864773`*^9, 
   3.6542070905801163`*^9}, {3.6542071861274023`*^9, 3.654207197287834*^9}, {
   3.654207355631957*^9, 3.65420737546005*^9}, {3.654207422116619*^9, 
   3.6542074295958633`*^9}, {3.654207513008601*^9, 3.654207622631179*^9}, {
   3.6542077902321663`*^9, 3.6542079082040863`*^9}, {3.654208112675095*^9, 
   3.6542082406765347`*^9}, {3.654208390436673*^9, 3.654208437282127*^9}, {
   3.654208729398788*^9, 3.6542088242969923`*^9}, {3.654208875181876*^9, 
   3.6542089105814543`*^9}, {3.654209036563011*^9, 3.654209042056604*^9}, {
   3.654209131808134*^9, 3.654209211748107*^9}, {3.654277910558556*^9, 
   3.654277962902483*^9}, {3.6542785554956903`*^9, 3.654278555764879*^9}, {
   3.6542801407928543`*^9, 3.654280145647377*^9}, {3.654280336511973*^9, 
   3.654280388661951*^9}, {3.654735519742467*^9, 3.654735526212496*^9}, {
   3.654736711632904*^9, 3.654736744359725*^9}, {3.654736840726715*^9, 
   3.6547369027091503`*^9}, {3.6547369619155817`*^9, 3.65473711893006*^9}, 
   3.654737215212165*^9, {3.6547372623430433`*^9, 3.654737301717353*^9}, {
   3.654737434898181*^9, 3.654737445769989*^9}, {3.654737593349925*^9, 
   3.654737893647337*^9}, {3.654737938282483*^9, 3.654737939560112*^9}, {
   3.654737995469615*^9, 3.65473804382544*^9}, {3.65473814244207*^9, 
   3.65473826286047*^9}, {3.654738473301898*^9, 3.654738519313912*^9}, {
   3.654738551955141*^9, 3.654738559351729*^9}, {3.654738599129403*^9, 
   3.654738599566987*^9}, {3.654738653005966*^9, 3.654738704434928*^9}, {
   3.654738885183668*^9, 3.654738922018218*^9}, {3.654739011880048*^9, 
   3.65473910917871*^9}, {3.654739159170903*^9, 3.654739162120161*^9}, {
   3.6547393230277576`*^9, 3.6547393764227123`*^9}, {3.654739415181912*^9, 
   3.65473942023728*^9}, {3.654739453135948*^9, 3.654739679965816*^9}, {
   3.654739718627033*^9, 3.6547397334487553`*^9}, {3.654739765385715*^9, 
   3.654739851694334*^9}, {3.654739889466123*^9, 3.654740005071364*^9}, {
   3.6547400491757*^9, 3.654740154008595*^9}, 3.654740216700787*^9, {
   3.654740314399178*^9, 3.6547403286014967`*^9}, 3.6547403850818996`*^9, {
   3.654740521314966*^9, 3.654740541208376*^9}, {3.65474063388687*^9, 
   3.654740654515286*^9}, {3.654740701345427*^9, 3.654740810460566*^9}, {
   3.654740848239312*^9, 3.654741082783293*^9}, {3.654741274225429*^9, 
   3.65474127713437*^9}, 3.654741426789631*^9, {3.6547414571147537`*^9, 
   3.654741569824174*^9}, {3.654741604551594*^9, 3.65474161887015*^9}, {
   3.6547416933496304`*^9, 3.654741709459137*^9}, {3.654741935230948*^9, 
   3.654741945307493*^9}, {3.6547830386167917`*^9, 3.654783105454197*^9}, {
   3.6547832406606083`*^9, 3.6547832525310373`*^9}, {3.654783794511154*^9, 
   3.654783837663447*^9}, {3.65478390359721*^9, 3.654783909803577*^9}, {
   3.654783989474423*^9, 3.654784403124803*^9}, {3.654784520313846*^9, 
   3.654784622329711*^9}, {3.6547847231449842`*^9, 3.654784727983326*^9}, {
   3.654785122876478*^9, 3.654785187751635*^9}, {3.654785255283667*^9, 
   3.654785472044736*^9}, {3.654785554330287*^9, 3.6547855634367*^9}, {
   3.6547858133842907`*^9, 3.654785842420493*^9}, {3.654785988696732*^9, 
   3.654785999313698*^9}, {3.654786083383224*^9, 3.654786083827299*^9}, {
   3.654799998454865*^9, 3.654800009014682*^9}, 3.654800058896707*^9, {
   3.6548001027328*^9, 3.654800173381201*^9}, {3.654800206111162*^9, 
   3.654800346038969*^9}, {3.654800415767541*^9, 3.654800685527397*^9}, {
   3.654800717895743*^9, 3.6548007259529123`*^9}, {3.6548007560240192`*^9, 
   3.654800892868227*^9}, {3.654800961067473*^9, 3.6548010443125353`*^9}, {
   3.654801144205307*^9, 3.6548013970409203`*^9}, {3.654801447723054*^9, 
   3.6548014700938597`*^9}, {3.654801562889327*^9, 3.6548017505389137`*^9}, {
   3.6548017965315866`*^9, 3.654801838591158*^9}, {3.654801925163512*^9, 
   3.654801957336872*^9}, {3.654802037838778*^9, 3.654802097667626*^9}, {
   3.6548021338675137`*^9, 3.654802151746142*^9}, {3.6548021938035927`*^9, 
   3.65480226557542*^9}, {3.6548023434469347`*^9, 3.6548024564595747`*^9}, {
   3.654802493167995*^9, 3.654802498462143*^9}, {3.654802632969117*^9, 
   3.654802636326886*^9}, {3.6548026864101667`*^9, 3.6548027624957323`*^9}, {
   3.654802812209731*^9, 3.6548030159498*^9}, {3.6548066359524317`*^9, 
   3.654806720935005*^9}, {3.654806751992766*^9, 3.6548067587144833`*^9}, {
   3.654806821497799*^9, 3.654806889382121*^9}, {3.654807006283039*^9, 
   3.654807210369132*^9}, {3.654807340425975*^9, 3.6548074184588003`*^9}, {
   3.6548074913193197`*^9, 3.654807699931301*^9}, 3.6548078200861998`*^9, {
   3.654807890939335*^9, 3.65480791502777*^9}, {3.654807960842239*^9, 
   3.6548080712336483`*^9}, {3.654808128338978*^9, 3.6548081799548407`*^9}, {
   3.6548101758929577`*^9, 3.654810330104765*^9}, {3.654810401423953*^9, 
   3.654810408457419*^9}, {3.6548104718702717`*^9, 3.6548106690676603`*^9}, {
   3.6548107121438303`*^9, 3.6548108463298893`*^9}, {3.654810878513033*^9, 
   3.6548109250220337`*^9}, {3.654810973064028*^9, 3.6548109963255377`*^9}, {
   3.654811065383171*^9, 3.65481111435124*^9}, {3.6548111568410273`*^9, 
   3.654811165569319*^9}, {3.654811202562601*^9, 3.654811649746052*^9}, {
   3.657067656153129*^9, 3.657067660941557*^9}, {3.6570766750689*^9, 
   3.657076677028944*^9}, {3.658274451899232*^9, 3.6582744912918463`*^9}, {
   3.6583703518545094`*^9, 3.65837035300604*^9}, {3.675595275623045*^9, 
   3.6755952858059273`*^9}, {3.675595499994834*^9, 3.675595501887823*^9}, {
   3.675595686331749*^9, 3.6755956966706448`*^9}, {3.6755964730817327`*^9, 
   3.6755964735643463`*^9}, 3.6780960195594473`*^9, {3.67809610144601*^9, 
   3.678096106509063*^9}, {3.6903930166606817`*^9, 3.6903930437642317`*^9}, 
   3.6908550580671806`*^9, {3.6924695059439898`*^9, 3.692469512604602*^9}, {
   3.6924695713499475`*^9, 3.692469571601548*^9}, {3.6931534485241685`*^9, 
   3.693153450645772*^9}, {3.7391164142734165`*^9, 3.739116496929733*^9}, {
   3.7391166453454423`*^9, 
   3.739116663929633*^9}},ExpressionUUID->"4ddea111-4d1b-4fab-bb2e-\
2bf18b5511c8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"TransToRp", "[", "T_", "]"}], ":", "\[IndentingNewLine]", "  ", 
     RowBox[{
     "Takes", " ", "transformation", " ", "matrix", " ", "T", " ", "in", " ", 
      "SE", 
      RowBox[{
       RowBox[{"(", "3", ")"}], ".", "\[IndentingNewLine]", "Returns"}], " ", 
      "R"}], ":", " ", 
     RowBox[{"the", " ", "corresponding", " ", "rotation", " ", "matrix"}]}], 
    ",", "\[IndentingNewLine]", "           ", 
    RowBox[{
     RowBox[{"p", ":", " ", 
      RowBox[{"the", " ", "corresponding", " ", "position", " ", 
       RowBox[{"vector", ".", " ", "\[IndentingNewLine]", "The"}], " ", 
       "first", " ", "element", " ", "of", " ", "the", " ", "output", " ", 
       "is", " ", "the", " ", "rotation", " ", "matrix", " ", "and", " ", 
       "the", " ", "second", " ", "is", " ", "the", " ", "position", " ", 
       RowBox[{"vector", "."}]}]}], "\[IndentingNewLine]", ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Example", ":", "\[IndentingNewLine]", "Input", ":", " ", 
       RowBox[{"{", 
        RowBox[{"R", ",", "p"}], "}"}]}], " ", "=", " ", 
      RowBox[{
       RowBox[{"TransToRp", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", 
            RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", "0", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}], "]"}],
        "\[IndentingNewLine]", 
       RowBox[{"Output", ":", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"1", ",", "0", ",", "0"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", 
              RowBox[{"-", "1"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "1", ",", "0"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "3", "}"}]}], "}"}]}], "}"}]}]}]}]}]}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"TransToRp", "[", "T_", "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"T", "[", 
       RowBox[{"[", 
        RowBox[{
         RowBox[{"1", ";;", "3"}], ",", 
         RowBox[{"1", ";;", "3"}]}], "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"T", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"1", ";;", "3"}], ",", "4"}], "]"}], "]"}], "}"}], 
       "\[Transpose]"}]}], "}"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.654107438701495*^9, 3.6541075770931664`*^9}, {
   3.6541076103152647`*^9, 3.654107726674172*^9}, {3.654107800327899*^9, 
   3.654107805926005*^9}, {3.654107842157054*^9, 3.654107956534466*^9}, {
   3.6541080276373253`*^9, 3.654108039845397*^9}, {3.654108208328875*^9, 
   3.654108267778264*^9}, {3.654108316603101*^9, 3.65410832858707*^9}, {
   3.654122072990996*^9, 3.654122200142358*^9}, {3.654122232524707*^9, 
   3.6541222637488813`*^9}, {3.654122372486209*^9, 3.65412253592478*^9}, {
   3.654122571686759*^9, 3.654122685636675*^9}, {3.654122740902017*^9, 
   3.6541228215630703`*^9}, {3.654122865671712*^9, 3.654122935620612*^9}, {
   3.654123032181581*^9, 3.6541230914473333`*^9}, {3.654123152783122*^9, 
   3.6541232043612537`*^9}, {3.654123304611115*^9, 3.654123341073502*^9}, {
   3.654123502235703*^9, 3.654123578362132*^9}, {3.654123664279245*^9, 
   3.654123683195951*^9}, {3.6541237878998413`*^9, 3.6541238249788847`*^9}, {
   3.654123940392714*^9, 3.654123947510108*^9}, {3.654124026309593*^9, 
   3.654124026885428*^9}, 3.6541241152729683`*^9, 3.654124170343902*^9, {
   3.6541246995439568`*^9, 3.654124712871656*^9}, {3.6541251843297157`*^9, 
   3.654125231518578*^9}, {3.6541254856851683`*^9, 3.65412548908077*^9}, {
   3.654125547742125*^9, 3.654125551165526*^9}, {3.654125930807577*^9, 
   3.654126007244483*^9}, {3.654126127665163*^9, 3.654126191634789*^9}, {
   3.654126236482831*^9, 3.654126250153975*^9}, {3.6541262848658533`*^9, 
   3.654126288991514*^9}, {3.654126323055903*^9, 3.654126399729628*^9}, {
   3.654126435349374*^9, 3.654126447266036*^9}, {3.654126530077552*^9, 
   3.6541265937421*^9}, {3.654126679867402*^9, 3.6541267650289497`*^9}, {
   3.6541267969631968`*^9, 3.654126798410089*^9}, {3.654126829860013*^9, 
   3.654126881359337*^9}, {3.6541269393824577`*^9, 3.654126959132009*^9}, {
   3.654127079773924*^9, 3.654127194954756*^9}, {3.654127229244482*^9, 
   3.654127253953713*^9}, {3.6541278694900227`*^9, 3.654127878663176*^9}, {
   3.654127969775614*^9, 3.6541279938293123`*^9}, {3.654128051763153*^9, 
   3.654128134016169*^9}, {3.654128326830834*^9, 3.654128326972948*^9}, {
   3.654182305132535*^9, 3.654182317491791*^9}, {3.65418238746202*^9, 
   3.654182511491269*^9}, {3.654182551115921*^9, 3.654182559209998*^9}, {
   3.6541826265390177`*^9, 3.654182732425318*^9}, {3.654182795218339*^9, 
   3.654182802306821*^9}, {3.654182858360195*^9, 3.654182976637673*^9}, {
   3.65418309291822*^9, 3.6541831115452337`*^9}, {3.654183280620055*^9, 
   3.654183381285778*^9}, {3.6541834216733217`*^9, 3.65418343026462*^9}, {
   3.65418347398075*^9, 3.654183479016459*^9}, {3.654183517743698*^9, 
   3.654183590244978*^9}, {3.654183629340012*^9, 3.654183659551435*^9}, {
   3.654183828746057*^9, 3.654183869187777*^9}, {3.654183918271063*^9, 
   3.6541839184304667`*^9}, {3.654206461375032*^9, 3.6542064948942213`*^9}, {
   3.6542065261576433`*^9, 3.654206710642645*^9}, {3.65420685898112*^9, 
   3.654206859498214*^9}, {3.654206912388175*^9, 3.6542069199221067`*^9}, {
   3.654206956850091*^9, 3.654206957769821*^9}, {3.6542070885864773`*^9, 
   3.6542070905801163`*^9}, {3.6542071861274023`*^9, 3.654207197287834*^9}, {
   3.654207355631957*^9, 3.65420737546005*^9}, {3.654207422116619*^9, 
   3.6542074295958633`*^9}, {3.654207513008601*^9, 3.654207622631179*^9}, {
   3.6542077902321663`*^9, 3.6542079082040863`*^9}, {3.654208112675095*^9, 
   3.6542082406765347`*^9}, {3.654208390436673*^9, 3.654208437282127*^9}, {
   3.654208729398788*^9, 3.6542088242969923`*^9}, {3.654208875181876*^9, 
   3.6542089105814543`*^9}, {3.654209036563011*^9, 3.654209042056604*^9}, {
   3.654209131808134*^9, 3.654209211748107*^9}, {3.654277910558556*^9, 
   3.654277962902483*^9}, {3.6542785554956903`*^9, 3.654278555764879*^9}, {
   3.6542801407928543`*^9, 3.654280145647377*^9}, {3.654280336511973*^9, 
   3.654280388661951*^9}, {3.654735519742467*^9, 3.654735526212496*^9}, {
   3.654736711632904*^9, 3.654736744359725*^9}, {3.654736840726715*^9, 
   3.6547369027091503`*^9}, {3.6547369619155817`*^9, 3.65473711893006*^9}, 
   3.654737215212165*^9, {3.6547372623430433`*^9, 3.654737301717353*^9}, {
   3.654737434898181*^9, 3.654737445769989*^9}, {3.654737593349925*^9, 
   3.654737893647337*^9}, {3.654737938282483*^9, 3.654737939560112*^9}, {
   3.654737995469615*^9, 3.65473804382544*^9}, {3.65473814244207*^9, 
   3.65473826286047*^9}, {3.654738473301898*^9, 3.654738519313912*^9}, {
   3.654738551955141*^9, 3.654738559351729*^9}, {3.654738599129403*^9, 
   3.654738599566987*^9}, {3.654738653005966*^9, 3.654738704434928*^9}, {
   3.654738885183668*^9, 3.654738922018218*^9}, {3.654739011880048*^9, 
   3.65473910917871*^9}, {3.654739159170903*^9, 3.654739162120161*^9}, {
   3.6547393230277576`*^9, 3.6547393764227123`*^9}, {3.654739415181912*^9, 
   3.65473942023728*^9}, {3.654739453135948*^9, 3.654739679965816*^9}, {
   3.654739718627033*^9, 3.6547397334487553`*^9}, {3.654739765385715*^9, 
   3.654739851694334*^9}, {3.654739889466123*^9, 3.654740005071364*^9}, {
   3.6547400491757*^9, 3.654740154008595*^9}, 3.654740216700787*^9, {
   3.654740314399178*^9, 3.6547403286014967`*^9}, 3.6547403850818996`*^9, {
   3.654740521314966*^9, 3.654740541208376*^9}, {3.65474063388687*^9, 
   3.654740654515286*^9}, {3.654740701345427*^9, 3.654740810460566*^9}, {
   3.654740848239312*^9, 3.654741082783293*^9}, {3.654741274225429*^9, 
   3.65474127713437*^9}, 3.654741426789631*^9, {3.6547414571147537`*^9, 
   3.654741569824174*^9}, {3.654741604551594*^9, 3.65474161887015*^9}, {
   3.6547416933496304`*^9, 3.654741709459137*^9}, {3.654741935230948*^9, 
   3.654741945307493*^9}, {3.6547830386167917`*^9, 3.654783105454197*^9}, {
   3.6547832406606083`*^9, 3.6547832525310373`*^9}, {3.654783794511154*^9, 
   3.654783837663447*^9}, {3.65478390359721*^9, 3.654783909803577*^9}, {
   3.654783989474423*^9, 3.654784403124803*^9}, {3.654784520313846*^9, 
   3.654784622329711*^9}, {3.6547847231449842`*^9, 3.654784727983326*^9}, {
   3.654785122876478*^9, 3.654785187751635*^9}, {3.654785255283667*^9, 
   3.654785472044736*^9}, {3.654785554330287*^9, 3.6547855634367*^9}, {
   3.6547858133842907`*^9, 3.654785842420493*^9}, {3.654785988696732*^9, 
   3.654785999313698*^9}, {3.654786083383224*^9, 3.654786083827299*^9}, {
   3.654799998454865*^9, 3.654800009014682*^9}, 3.654800058896707*^9, {
   3.6548001027328*^9, 3.654800173381201*^9}, {3.654800206111162*^9, 
   3.654800346038969*^9}, {3.654800415767541*^9, 3.654800685527397*^9}, {
   3.654800717895743*^9, 3.6548007259529123`*^9}, {3.6548007560240192`*^9, 
   3.654800892868227*^9}, {3.654800961067473*^9, 3.6548010443125353`*^9}, {
   3.654801144205307*^9, 3.6548013970409203`*^9}, {3.654801447723054*^9, 
   3.6548014700938597`*^9}, {3.654801562889327*^9, 3.6548017505389137`*^9}, {
   3.6548017965315866`*^9, 3.654801838591158*^9}, {3.654801925163512*^9, 
   3.654801957336872*^9}, {3.654802037838778*^9, 3.654802097667626*^9}, {
   3.6548021338675137`*^9, 3.654802151746142*^9}, {3.6548021938035927`*^9, 
   3.65480226557542*^9}, {3.6548023434469347`*^9, 3.6548024564595747`*^9}, {
   3.654802493167995*^9, 3.654802498462143*^9}, {3.654802632969117*^9, 
   3.654802636326886*^9}, {3.6548026864101667`*^9, 3.6548027624957323`*^9}, {
   3.654802812209731*^9, 3.6548030159498*^9}, {3.6548066359524317`*^9, 
   3.654806720935005*^9}, {3.654806751992766*^9, 3.6548067587144833`*^9}, {
   3.654806821497799*^9, 3.654806889382121*^9}, {3.654807006283039*^9, 
   3.654807210369132*^9}, {3.654807340425975*^9, 3.6548074184588003`*^9}, {
   3.6548074913193197`*^9, 3.654807699931301*^9}, 3.6548078200861998`*^9, {
   3.654807890939335*^9, 3.65480791502777*^9}, {3.654807960842239*^9, 
   3.6548080712336483`*^9}, {3.654808128338978*^9, 3.6548081799548407`*^9}, {
   3.6548101758929577`*^9, 3.654810330104765*^9}, {3.654810401423953*^9, 
   3.654810408457419*^9}, {3.6548104718702717`*^9, 3.6548106690676603`*^9}, {
   3.6548107121438303`*^9, 3.6548108463298893`*^9}, {3.654810878513033*^9, 
   3.6548109250220337`*^9}, {3.654810973064028*^9, 3.6548109963255377`*^9}, {
   3.654811065383171*^9, 3.65481111435124*^9}, {3.6548111568410273`*^9, 
   3.654811165569319*^9}, {3.654811202562601*^9, 3.654811649746052*^9}, {
   3.657067656153129*^9, 3.657067660941557*^9}, {3.6570766750689*^9, 
   3.657076677028944*^9}, {3.658274451899232*^9, 3.6582744912918463`*^9}, {
   3.6583703518545094`*^9, 3.65837035300604*^9}, {3.6755959567829027`*^9, 
   3.675595965979847*^9}, {3.67559603247852*^9, 3.675596033012048*^9}, {
   3.675596680132864*^9, 3.6755966912919407`*^9}, {3.678096115211194*^9, 
   3.6780961185043497`*^9}, {3.690393628363669*^9, 3.6903936548561845`*^9}, 
   3.6908550611099367`*^9, {3.6924695183676157`*^9, 3.6924695606541176`*^9}, {
   3.6931534607233896`*^9, 
   3.6931534623769927`*^9}},ExpressionUUID->"231c024d-75c6-45bd-a348-\
b4411df7ad47"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"TransInv", "[", "T_", "]"}], ":", "\[IndentingNewLine]", "  ", 
     RowBox[{"Takes", " ", "T", " ", "a", " ", "transformation", " ", 
      RowBox[{"matrix", ".", "\[IndentingNewLine]", "Returns"}], " ", "its", 
      " ", 
      RowBox[{"inverse", ".", "\[IndentingNewLine]", "Used"}], " ", "the", 
      " ", "structure", " ", "of", " ", "transformation", " ", "matrices", 
      " ", "to", " ", "avoid", " ", "taking", " ", "a", " ", "matrix", " ", 
      "inverse"}]}], ",", 
    RowBox[{
     RowBox[{"for", " ", 
      RowBox[{"efficiency", "."}]}], "\[IndentingNewLine]", ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Example", ":", "\[IndentingNewLine]", "Input", ":", " ", "invT"}], " ",
       "=", " ", 
      RowBox[{
       RowBox[{"TransInv", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", 
            RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", "0", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}], "]"}],
        "//", 
       RowBox[{"MatrixForm", "\[IndentingNewLine]", 
        RowBox[{"Output", ":", " ", 
         TagBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"1", "0", "0", "0"},
             {"0", "0", "1", 
              RowBox[{"-", "3"}]},
             {"0", 
              RowBox[{"-", "1"}], "0", "0"},
             {"0", "0", "0", "1"}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
          Function[BoxForm`e$, 
           MatrixForm[BoxForm`e$]]]}]}]}]}]}]}], "\[IndentingNewLine]", 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"TransInv", "[", "T_", "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"ArrayFlatten", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"T", "[", 
           RowBox[{"[", 
            RowBox[{
             RowBox[{"1", ";;", "3"}], ",", 
             RowBox[{"1", ";;", "3"}]}], "]"}], "]"}], "\[Transpose]"}], ",", 
         RowBox[{"-", 
          RowBox[{
           RowBox[{
            RowBox[{"T", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"1", ";;", "3"}], ",", 
               RowBox[{"1", ";;", "3"}]}], "]"}], "]"}], "\[Transpose]"}], 
           ".", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"T", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"1", ";;", "3"}], ",", "4"}], "]"}], "]"}], "}"}], 
            "\[Transpose]"}]}]}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "1"}], "}"}]}], "}"}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.654107438701495*^9, 3.6541075770931664`*^9}, {
   3.6541076103152647`*^9, 3.654107726674172*^9}, {3.654107800327899*^9, 
   3.654107805926005*^9}, {3.654107842157054*^9, 3.654107956534466*^9}, {
   3.6541080276373253`*^9, 3.654108039845397*^9}, {3.654108208328875*^9, 
   3.654108267778264*^9}, {3.654108316603101*^9, 3.65410832858707*^9}, {
   3.654122072990996*^9, 3.654122200142358*^9}, {3.654122232524707*^9, 
   3.6541222637488813`*^9}, {3.654122372486209*^9, 3.65412253592478*^9}, {
   3.654122571686759*^9, 3.654122685636675*^9}, {3.654122740902017*^9, 
   3.6541228215630703`*^9}, {3.654122865671712*^9, 3.654122935620612*^9}, {
   3.654123032181581*^9, 3.6541230914473333`*^9}, {3.654123152783122*^9, 
   3.6541232043612537`*^9}, {3.654123304611115*^9, 3.654123341073502*^9}, {
   3.654123502235703*^9, 3.654123578362132*^9}, {3.654123664279245*^9, 
   3.654123683195951*^9}, {3.6541237878998413`*^9, 3.6541238249788847`*^9}, {
   3.654123940392714*^9, 3.654123947510108*^9}, {3.654124026309593*^9, 
   3.654124026885428*^9}, 3.6541241152729683`*^9, 3.654124170343902*^9, {
   3.6541246995439568`*^9, 3.654124712871656*^9}, {3.6541251843297157`*^9, 
   3.654125231518578*^9}, {3.6541254856851683`*^9, 3.65412548908077*^9}, {
   3.654125547742125*^9, 3.654125551165526*^9}, {3.654125930807577*^9, 
   3.654126007244483*^9}, {3.654126127665163*^9, 3.654126191634789*^9}, {
   3.654126236482831*^9, 3.654126250153975*^9}, {3.6541262848658533`*^9, 
   3.654126288991514*^9}, {3.654126323055903*^9, 3.654126399729628*^9}, {
   3.654126435349374*^9, 3.654126447266036*^9}, {3.654126530077552*^9, 
   3.6541265937421*^9}, {3.654126679867402*^9, 3.6541267650289497`*^9}, {
   3.6541267969631968`*^9, 3.654126798410089*^9}, {3.654126829860013*^9, 
   3.654126881359337*^9}, {3.6541269393824577`*^9, 3.654126959132009*^9}, {
   3.654127079773924*^9, 3.654127194954756*^9}, {3.654127229244482*^9, 
   3.654127253953713*^9}, {3.6541278694900227`*^9, 3.654127878663176*^9}, {
   3.654127969775614*^9, 3.6541279938293123`*^9}, {3.654128051763153*^9, 
   3.654128134016169*^9}, {3.654128326830834*^9, 3.654128326972948*^9}, {
   3.654182305132535*^9, 3.654182317491791*^9}, {3.65418238746202*^9, 
   3.654182511491269*^9}, {3.654182551115921*^9, 3.654182559209998*^9}, {
   3.6541826265390177`*^9, 3.654182732425318*^9}, {3.654182795218339*^9, 
   3.654182802306821*^9}, {3.654182858360195*^9, 3.654182976637673*^9}, {
   3.65418309291822*^9, 3.6541831115452337`*^9}, {3.654183280620055*^9, 
   3.654183381285778*^9}, {3.6541834216733217`*^9, 3.65418343026462*^9}, {
   3.65418347398075*^9, 3.654183479016459*^9}, {3.654183517743698*^9, 
   3.654183590244978*^9}, {3.654183629340012*^9, 3.654183659551435*^9}, {
   3.654183828746057*^9, 3.654183869187777*^9}, {3.654183918271063*^9, 
   3.6541839184304667`*^9}, {3.654206461375032*^9, 3.6542064948942213`*^9}, {
   3.6542065261576433`*^9, 3.654206710642645*^9}, {3.65420685898112*^9, 
   3.654206859498214*^9}, {3.654206912388175*^9, 3.6542069199221067`*^9}, {
   3.654206956850091*^9, 3.654206957769821*^9}, {3.6542070885864773`*^9, 
   3.6542070905801163`*^9}, {3.6542071861274023`*^9, 3.654207197287834*^9}, {
   3.654207355631957*^9, 3.65420737546005*^9}, {3.654207422116619*^9, 
   3.6542074295958633`*^9}, {3.654207513008601*^9, 3.654207622631179*^9}, {
   3.6542077902321663`*^9, 3.6542079082040863`*^9}, {3.654208112675095*^9, 
   3.6542082406765347`*^9}, {3.654208390436673*^9, 3.654208437282127*^9}, {
   3.654208729398788*^9, 3.6542088242969923`*^9}, {3.654208875181876*^9, 
   3.6542089105814543`*^9}, {3.654209036563011*^9, 3.654209042056604*^9}, {
   3.654209131808134*^9, 3.654209211748107*^9}, {3.654277910558556*^9, 
   3.654277962902483*^9}, {3.6542785554956903`*^9, 3.654278555764879*^9}, {
   3.6542801407928543`*^9, 3.654280145647377*^9}, {3.654280336511973*^9, 
   3.654280388661951*^9}, {3.654735519742467*^9, 3.654735526212496*^9}, {
   3.654736711632904*^9, 3.654736744359725*^9}, {3.654736840726715*^9, 
   3.6547369027091503`*^9}, {3.6547369619155817`*^9, 3.65473711893006*^9}, 
   3.654737215212165*^9, {3.6547372623430433`*^9, 3.654737301717353*^9}, {
   3.654737434898181*^9, 3.654737445769989*^9}, {3.654737593349925*^9, 
   3.654737893647337*^9}, {3.654737938282483*^9, 3.654737939560112*^9}, {
   3.654737995469615*^9, 3.65473804382544*^9}, {3.65473814244207*^9, 
   3.65473826286047*^9}, {3.654738473301898*^9, 3.654738519313912*^9}, {
   3.654738551955141*^9, 3.654738559351729*^9}, {3.654738599129403*^9, 
   3.654738599566987*^9}, {3.654738653005966*^9, 3.654738704434928*^9}, {
   3.654738885183668*^9, 3.654738922018218*^9}, {3.654739011880048*^9, 
   3.65473910917871*^9}, {3.654739159170903*^9, 3.654739162120161*^9}, {
   3.6547393230277576`*^9, 3.6547393764227123`*^9}, {3.654739415181912*^9, 
   3.65473942023728*^9}, {3.654739453135948*^9, 3.654739679965816*^9}, {
   3.654739718627033*^9, 3.6547397334487553`*^9}, {3.654739765385715*^9, 
   3.654739851694334*^9}, {3.654739889466123*^9, 3.654740005071364*^9}, {
   3.6547400491757*^9, 3.654740154008595*^9}, 3.654740216700787*^9, {
   3.654740314399178*^9, 3.6547403286014967`*^9}, 3.6547403850818996`*^9, {
   3.654740521314966*^9, 3.654740541208376*^9}, {3.65474063388687*^9, 
   3.654740654515286*^9}, {3.654740701345427*^9, 3.654740810460566*^9}, {
   3.654740848239312*^9, 3.654741082783293*^9}, {3.654741274225429*^9, 
   3.65474127713437*^9}, 3.654741426789631*^9, {3.6547414571147537`*^9, 
   3.654741569824174*^9}, {3.654741604551594*^9, 3.65474161887015*^9}, {
   3.6547416933496304`*^9, 3.654741709459137*^9}, {3.654741935230948*^9, 
   3.654741945307493*^9}, {3.6547830386167917`*^9, 3.654783105454197*^9}, {
   3.6547832406606083`*^9, 3.6547832525310373`*^9}, {3.654783794511154*^9, 
   3.654783837663447*^9}, {3.65478390359721*^9, 3.654783909803577*^9}, {
   3.654783989474423*^9, 3.654784403124803*^9}, {3.654784520313846*^9, 
   3.654784622329711*^9}, {3.6547847231449842`*^9, 3.654784727983326*^9}, {
   3.654785122876478*^9, 3.654785187751635*^9}, {3.654785255283667*^9, 
   3.654785472044736*^9}, {3.654785554330287*^9, 3.6547855634367*^9}, {
   3.6547858133842907`*^9, 3.654785842420493*^9}, {3.654785988696732*^9, 
   3.654785999313698*^9}, {3.654786083383224*^9, 3.654786083827299*^9}, {
   3.654799998454865*^9, 3.654800009014682*^9}, 3.654800058896707*^9, {
   3.6548001027328*^9, 3.654800173381201*^9}, {3.654800206111162*^9, 
   3.654800346038969*^9}, {3.654800415767541*^9, 3.654800685527397*^9}, {
   3.654800717895743*^9, 3.6548007259529123`*^9}, {3.6548007560240192`*^9, 
   3.654800892868227*^9}, {3.654800961067473*^9, 3.6548010443125353`*^9}, {
   3.654801144205307*^9, 3.6548013970409203`*^9}, {3.654801447723054*^9, 
   3.6548014700938597`*^9}, {3.654801562889327*^9, 3.6548017505389137`*^9}, {
   3.6548017965315866`*^9, 3.654801838591158*^9}, {3.654801925163512*^9, 
   3.654801957336872*^9}, {3.654802037838778*^9, 3.654802097667626*^9}, {
   3.6548021338675137`*^9, 3.654802151746142*^9}, {3.6548021938035927`*^9, 
   3.65480226557542*^9}, {3.6548023434469347`*^9, 3.6548024564595747`*^9}, {
   3.654802493167995*^9, 3.654802498462143*^9}, {3.654802632969117*^9, 
   3.654802636326886*^9}, {3.6548026864101667`*^9, 3.6548027624957323`*^9}, {
   3.654802812209731*^9, 3.6548030159498*^9}, {3.6548066359524317`*^9, 
   3.654806720935005*^9}, {3.654806751992766*^9, 3.6548067587144833`*^9}, {
   3.654806821497799*^9, 3.654806889382121*^9}, {3.654807006283039*^9, 
   3.654807210369132*^9}, {3.654807340425975*^9, 3.6548074184588003`*^9}, {
   3.6548074913193197`*^9, 3.654807699931301*^9}, 3.6548078200861998`*^9, {
   3.654807890939335*^9, 3.65480791502777*^9}, {3.654807960842239*^9, 
   3.6548080712336483`*^9}, {3.654808128338978*^9, 3.6548081799548407`*^9}, {
   3.6548101758929577`*^9, 3.654810330104765*^9}, {3.654810401423953*^9, 
   3.654810408457419*^9}, {3.6548104718702717`*^9, 3.6548106690676603`*^9}, {
   3.6548107121438303`*^9, 3.6548108463298893`*^9}, {3.654810878513033*^9, 
   3.6548109250220337`*^9}, {3.654810973064028*^9, 3.6548109963255377`*^9}, {
   3.654811065383171*^9, 3.65481111435124*^9}, {3.6548111568410273`*^9, 
   3.654811165569319*^9}, {3.654811202562601*^9, 3.654811649746052*^9}, {
   3.657067656153129*^9, 3.657067660941557*^9}, {3.6570766750689*^9, 
   3.657076677028944*^9}, {3.658274451899232*^9, 3.6582744912918463`*^9}, {
   3.6583703518545094`*^9, 3.65837035300604*^9}, {3.675596758956827*^9, 
   3.675596816647419*^9}, {3.6755968603462763`*^9, 3.675596904061962*^9}, {
   3.675596971182308*^9, 3.675596988729371*^9}, {3.6780961229623423`*^9, 
   3.6780961264717283`*^9}, 3.690855031117347*^9, 3.690855063558672*^9, {
   3.692469609729433*^9, 3.6924696294652824`*^9}, {3.6931534681178026`*^9, 
   3.693153470005406*^9}},ExpressionUUID->"6b00b4cf-8c90-4a79-8772-\
4318b9207225"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"VecTose3", "[", "V_", "]"}], ":", "\[IndentingNewLine]", "   ", 
     RowBox[{
      RowBox[{"Takes", " ", "a", " ", "6"}], "-", 
      RowBox[{"vector", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"representing", " ", "a", " ", "spatial", " ", "velocity"}], 
         ")"}], ".", "\[IndentingNewLine]", "Returns"}], " ", "the", " ", 
       "corresponding", " ", "4", "x4", " ", "se", 
       RowBox[{"(", "3", ")"}], " ", "matrix"}]}]}], "\[IndentingNewLine]", 
    ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "Example", ":", "\[IndentingNewLine]", "Input", ":", " ", "se3mat"}], 
     " ", "=", " ", 
     RowBox[{
      RowBox[{"VecTose3", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"{", 
          RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6"}], 
          "}"}], "}"}], "\[Transpose]"}], "]"}], "//", 
      RowBox[{"MatrixForm", "\[IndentingNewLine]", 
       RowBox[{"Output", ":", " ", 
        TagBox[
         RowBox[{"(", "\[NoBreak]", GridBox[{
            {"0", 
             RowBox[{"-", "3"}], "2", "4"},
            {"3", "0", 
             RowBox[{"-", "1"}], "5"},
            {
             RowBox[{"-", "2"}], "1", "0", "6"},
            {"0", "0", "0", "0"}
           },
           
           GridBoxAlignment->{
            "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
           GridBoxSpacings->{"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.7]}, 
               Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
         Function[BoxForm`e$, 
          MatrixForm[BoxForm`e$]]]}]}]}]}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"VecTose3", "[", "V_", "]"}], ":=", 
    RowBox[{"ArrayFlatten", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"VecToso3", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"V", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"1", ";;", "3"}], ",", "1"}], "]"}], "]"}], "}"}], 
           "\[Transpose]"}], "]"}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"V", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"4", ";;", "6"}], ",", "1"}], "]"}], "]"}], "}"}], 
          "\[Transpose]"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0"}], "}"}]}], "}"}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.654107438701495*^9, 3.6541075770931664`*^9}, {
   3.6541076103152647`*^9, 3.654107726674172*^9}, {3.654107800327899*^9, 
   3.654107805926005*^9}, {3.654107842157054*^9, 3.654107956534466*^9}, {
   3.6541080276373253`*^9, 3.654108039845397*^9}, {3.654108208328875*^9, 
   3.654108267778264*^9}, {3.654108316603101*^9, 3.65410832858707*^9}, {
   3.654122072990996*^9, 3.654122200142358*^9}, {3.654122232524707*^9, 
   3.6541222637488813`*^9}, {3.654122372486209*^9, 3.65412253592478*^9}, {
   3.654122571686759*^9, 3.654122685636675*^9}, {3.654122740902017*^9, 
   3.6541228215630703`*^9}, {3.654122865671712*^9, 3.654122935620612*^9}, {
   3.654123032181581*^9, 3.6541230914473333`*^9}, {3.654123152783122*^9, 
   3.6541232043612537`*^9}, {3.654123304611115*^9, 3.654123341073502*^9}, {
   3.654123502235703*^9, 3.654123578362132*^9}, {3.654123664279245*^9, 
   3.654123683195951*^9}, {3.6541237878998413`*^9, 3.6541238249788847`*^9}, {
   3.654123940392714*^9, 3.654123947510108*^9}, {3.654124026309593*^9, 
   3.654124026885428*^9}, 3.6541241152729683`*^9, 3.654124170343902*^9, {
   3.6541246995439568`*^9, 3.654124712871656*^9}, {3.6541251843297157`*^9, 
   3.654125231518578*^9}, {3.6541254856851683`*^9, 3.65412548908077*^9}, {
   3.654125547742125*^9, 3.654125551165526*^9}, {3.654125930807577*^9, 
   3.654126007244483*^9}, {3.654126127665163*^9, 3.654126191634789*^9}, {
   3.654126236482831*^9, 3.654126250153975*^9}, {3.6541262848658533`*^9, 
   3.654126288991514*^9}, {3.654126323055903*^9, 3.654126399729628*^9}, {
   3.654126435349374*^9, 3.654126447266036*^9}, {3.654126530077552*^9, 
   3.6541265937421*^9}, {3.654126679867402*^9, 3.6541267650289497`*^9}, {
   3.6541267969631968`*^9, 3.654126798410089*^9}, {3.654126829860013*^9, 
   3.654126881359337*^9}, {3.6541269393824577`*^9, 3.654126959132009*^9}, {
   3.654127079773924*^9, 3.654127194954756*^9}, {3.654127229244482*^9, 
   3.654127253953713*^9}, {3.6541278694900227`*^9, 3.654127878663176*^9}, {
   3.654127969775614*^9, 3.6541279938293123`*^9}, {3.654128051763153*^9, 
   3.654128134016169*^9}, {3.654128326830834*^9, 3.654128326972948*^9}, {
   3.654182305132535*^9, 3.654182317491791*^9}, {3.65418238746202*^9, 
   3.654182511491269*^9}, {3.654182551115921*^9, 3.654182559209998*^9}, {
   3.6541826265390177`*^9, 3.654182732425318*^9}, {3.654182795218339*^9, 
   3.654182802306821*^9}, {3.654182858360195*^9, 3.654182976637673*^9}, {
   3.65418309291822*^9, 3.6541831115452337`*^9}, {3.654183280620055*^9, 
   3.654183381285778*^9}, {3.6541834216733217`*^9, 3.65418343026462*^9}, {
   3.65418347398075*^9, 3.654183479016459*^9}, {3.654183517743698*^9, 
   3.654183590244978*^9}, {3.654183629340012*^9, 3.654183659551435*^9}, {
   3.654183828746057*^9, 3.654183869187777*^9}, {3.654183918271063*^9, 
   3.6541839184304667`*^9}, {3.654206461375032*^9, 3.6542064948942213`*^9}, {
   3.6542065261576433`*^9, 3.654206710642645*^9}, {3.65420685898112*^9, 
   3.654206859498214*^9}, {3.654206912388175*^9, 3.6542069199221067`*^9}, {
   3.654206956850091*^9, 3.654206957769821*^9}, {3.6542070885864773`*^9, 
   3.6542070905801163`*^9}, {3.6542071861274023`*^9, 3.654207197287834*^9}, {
   3.654207355631957*^9, 3.65420737546005*^9}, {3.654207422116619*^9, 
   3.6542074295958633`*^9}, {3.654207513008601*^9, 3.654207622631179*^9}, {
   3.6542077902321663`*^9, 3.6542079082040863`*^9}, {3.654208112675095*^9, 
   3.6542082406765347`*^9}, {3.654208390436673*^9, 3.654208437282127*^9}, {
   3.654208729398788*^9, 3.6542088242969923`*^9}, {3.654208875181876*^9, 
   3.6542089105814543`*^9}, {3.654209036563011*^9, 3.654209042056604*^9}, {
   3.654209131808134*^9, 3.654209211748107*^9}, {3.654277910558556*^9, 
   3.654277962902483*^9}, {3.6542785554956903`*^9, 3.654278555764879*^9}, {
   3.6542801407928543`*^9, 3.654280145647377*^9}, {3.654280336511973*^9, 
   3.654280388661951*^9}, {3.654735519742467*^9, 3.654735526212496*^9}, {
   3.654736711632904*^9, 3.654736744359725*^9}, {3.654736840726715*^9, 
   3.6547369027091503`*^9}, {3.6547369619155817`*^9, 3.65473711893006*^9}, 
   3.654737215212165*^9, {3.6547372623430433`*^9, 3.654737301717353*^9}, {
   3.654737434898181*^9, 3.654737445769989*^9}, {3.654737593349925*^9, 
   3.654737893647337*^9}, {3.654737938282483*^9, 3.654737939560112*^9}, {
   3.654737995469615*^9, 3.65473804382544*^9}, {3.65473814244207*^9, 
   3.65473826286047*^9}, {3.654738473301898*^9, 3.654738519313912*^9}, {
   3.654738551955141*^9, 3.654738559351729*^9}, {3.654738599129403*^9, 
   3.654738599566987*^9}, {3.654738653005966*^9, 3.654738704434928*^9}, {
   3.654738885183668*^9, 3.654738922018218*^9}, {3.654739011880048*^9, 
   3.65473910917871*^9}, {3.654739159170903*^9, 3.654739162120161*^9}, {
   3.6547393230277576`*^9, 3.6547393764227123`*^9}, {3.654739415181912*^9, 
   3.65473942023728*^9}, {3.654739453135948*^9, 3.654739679965816*^9}, {
   3.654739718627033*^9, 3.6547397334487553`*^9}, {3.654739765385715*^9, 
   3.654739851694334*^9}, {3.654739889466123*^9, 3.654740005071364*^9}, {
   3.6547400491757*^9, 3.654740154008595*^9}, 3.654740216700787*^9, {
   3.654740314399178*^9, 3.6547403286014967`*^9}, 3.6547403850818996`*^9, {
   3.654740521314966*^9, 3.654740541208376*^9}, {3.65474063388687*^9, 
   3.654740654515286*^9}, {3.654740701345427*^9, 3.654740810460566*^9}, {
   3.654740848239312*^9, 3.654741082783293*^9}, {3.654741274225429*^9, 
   3.65474127713437*^9}, 3.654741426789631*^9, {3.6547414571147537`*^9, 
   3.654741569824174*^9}, {3.654741604551594*^9, 3.65474161887015*^9}, {
   3.6547416933496304`*^9, 3.654741709459137*^9}, {3.654741935230948*^9, 
   3.654741945307493*^9}, {3.6547830386167917`*^9, 3.654783105454197*^9}, {
   3.6547832406606083`*^9, 3.6547832525310373`*^9}, {3.654783794511154*^9, 
   3.654783837663447*^9}, {3.65478390359721*^9, 3.654783909803577*^9}, {
   3.654783989474423*^9, 3.654784403124803*^9}, {3.654784520313846*^9, 
   3.654784622329711*^9}, {3.6547847231449842`*^9, 3.654784727983326*^9}, {
   3.654785122876478*^9, 3.654785187751635*^9}, {3.654785255283667*^9, 
   3.654785472044736*^9}, {3.654785554330287*^9, 3.6547855634367*^9}, {
   3.6547858133842907`*^9, 3.654785842420493*^9}, {3.654785988696732*^9, 
   3.654785999313698*^9}, {3.654786083383224*^9, 3.654786083827299*^9}, {
   3.654799998454865*^9, 3.654800009014682*^9}, 3.654800058896707*^9, {
   3.6548001027328*^9, 3.654800173381201*^9}, {3.654800206111162*^9, 
   3.654800346038969*^9}, {3.654800415767541*^9, 3.654800685527397*^9}, {
   3.654800717895743*^9, 3.6548007259529123`*^9}, {3.6548007560240192`*^9, 
   3.654800892868227*^9}, {3.654800961067473*^9, 3.6548010443125353`*^9}, {
   3.654801144205307*^9, 3.6548013970409203`*^9}, {3.654801447723054*^9, 
   3.6548014700938597`*^9}, {3.654801562889327*^9, 3.6548017505389137`*^9}, {
   3.6548017965315866`*^9, 3.654801838591158*^9}, {3.654801925163512*^9, 
   3.654801957336872*^9}, {3.654802037838778*^9, 3.654802097667626*^9}, {
   3.6548021338675137`*^9, 3.654802151746142*^9}, {3.6548021938035927`*^9, 
   3.65480226557542*^9}, {3.6548023434469347`*^9, 3.6548024564595747`*^9}, {
   3.654802493167995*^9, 3.654802498462143*^9}, {3.654802632969117*^9, 
   3.654802636326886*^9}, {3.6548026864101667`*^9, 3.6548027624957323`*^9}, {
   3.654802812209731*^9, 3.6548030159498*^9}, {3.6548066359524317`*^9, 
   3.654806720935005*^9}, {3.654806751992766*^9, 3.6548067587144833`*^9}, {
   3.654806821497799*^9, 3.654806889382121*^9}, {3.654807006283039*^9, 
   3.654807210369132*^9}, {3.654807340425975*^9, 3.6548074184588003`*^9}, {
   3.6548074913193197`*^9, 3.654807699931301*^9}, 3.6548078200861998`*^9, {
   3.654807890939335*^9, 3.65480791502777*^9}, {3.654807960842239*^9, 
   3.6548080712336483`*^9}, {3.654808128338978*^9, 3.6548081799548407`*^9}, {
   3.6548101758929577`*^9, 3.654810330104765*^9}, {3.654810401423953*^9, 
   3.654810408457419*^9}, {3.6548104718702717`*^9, 3.6548106690676603`*^9}, {
   3.6548107121438303`*^9, 3.6548108463298893`*^9}, {3.654810878513033*^9, 
   3.6548109250220337`*^9}, {3.654810973064028*^9, 3.6548109963255377`*^9}, {
   3.654811065383171*^9, 3.65481111435124*^9}, {3.6548111568410273`*^9, 
   3.654811165569319*^9}, {3.654811202562601*^9, 3.654811649746052*^9}, {
   3.657067656153129*^9, 3.657067660941557*^9}, {3.6570766750689*^9, 
   3.657076677028944*^9}, {3.658274451899232*^9, 3.6582744912918463`*^9}, {
   3.6583703518545094`*^9, 3.65837035300604*^9}, {3.675597080161522*^9, 
   3.675597119970598*^9}, {3.675597158104844*^9, 3.675597160162319*^9}, {
   3.675597211069208*^9, 3.675597216985806*^9}, {3.678096131049049*^9, 
   3.678096133158791*^9}, 3.690425584100696*^9, {3.6908550657287827`*^9, 
   3.690855066083803*^9}, {3.692469640014104*^9, 3.6924696452475147`*^9}, {
   3.693153479115822*^9, 
   3.693153480753825*^9}},ExpressionUUID->"2d25915a-29df-4bc1-87fb-\
88bf40588e9c"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"se3ToVec", "[", "se3mat_", "]"}], ":", "\[IndentingNewLine]", 
     "   ", 
     RowBox[{
      RowBox[{"Takes", " ", "se3mat", " ", "a", " ", "4", "x4", " ", "se", 
       RowBox[{"(", "3", ")"}], " ", 
       RowBox[{"matrix", ".", "\[IndentingNewLine]", "Returns"}], " ", "the", 
       " ", "corresponding", " ", "6"}], "-", 
      RowBox[{"vector", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"representing", " ", "spatial", " ", "velocity"}], ")"}], 
        "."}]}]}]}], "\[IndentingNewLine]", ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Example", ":", "\[IndentingNewLine]", "Input", ":", " ", "V"}], 
     " ", "=", " ", 
     RowBox[{
      RowBox[{"se3ToVec", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", 
           RowBox[{"-", "3"}], ",", "2", ",", "4"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"3", ",", "0", ",", 
           RowBox[{"-", "1"}], ",", "5"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "2"}], ",", "1", ",", "0", ",", "6"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], "]"}], 
      "\[IndentingNewLine]", 
      RowBox[{"Output", ":", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", "1", "}"}], ",", 
         RowBox[{"{", "2", "}"}], ",", 
         RowBox[{"{", "3", "}"}], ",", 
         RowBox[{"{", "4", "}"}], ",", 
         RowBox[{"{", "5", "}"}], ",", 
         RowBox[{"{", "6", "}"}]}], "}"}]}]}]}]}], "\[IndentingNewLine]", 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"se3ToVec", "[", "se3mat_", "]"}], ":=", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"se3mat", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "2"}], "]"}], "]"}], ",", 
        RowBox[{"se3mat", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "3"}], "]"}], "]"}], ",", 
        RowBox[{"se3mat", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "1"}], "]"}], "]"}], ",", 
        RowBox[{"se3mat", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", "4"}], "]"}], "]"}], ",", 
        RowBox[{"se3mat", "[", 
         RowBox[{"[", 
          RowBox[{"2", ",", "4"}], "]"}], "]"}], ",", 
        RowBox[{"se3mat", "[", 
         RowBox[{"[", 
          RowBox[{"3", ",", "4"}], "]"}], "]"}]}], "}"}], "}"}], 
     "\[Transpose]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.654107438701495*^9, 3.6541075770931664`*^9}, {
   3.6541076103152647`*^9, 3.654107726674172*^9}, {3.654107800327899*^9, 
   3.654107805926005*^9}, {3.654107842157054*^9, 3.654107956534466*^9}, {
   3.6541080276373253`*^9, 3.654108039845397*^9}, {3.654108208328875*^9, 
   3.654108267778264*^9}, {3.654108316603101*^9, 3.65410832858707*^9}, {
   3.654122072990996*^9, 3.654122200142358*^9}, {3.654122232524707*^9, 
   3.6541222637488813`*^9}, {3.654122372486209*^9, 3.65412253592478*^9}, {
   3.654122571686759*^9, 3.654122685636675*^9}, {3.654122740902017*^9, 
   3.6541228215630703`*^9}, {3.654122865671712*^9, 3.654122935620612*^9}, {
   3.654123032181581*^9, 3.6541230914473333`*^9}, {3.654123152783122*^9, 
   3.6541232043612537`*^9}, {3.654123304611115*^9, 3.654123341073502*^9}, {
   3.654123502235703*^9, 3.654123578362132*^9}, {3.654123664279245*^9, 
   3.654123683195951*^9}, {3.6541237878998413`*^9, 3.6541238249788847`*^9}, {
   3.654123940392714*^9, 3.654123947510108*^9}, {3.654124026309593*^9, 
   3.654124026885428*^9}, 3.6541241152729683`*^9, 3.654124170343902*^9, {
   3.6541246995439568`*^9, 3.654124712871656*^9}, {3.6541251843297157`*^9, 
   3.654125231518578*^9}, {3.6541254856851683`*^9, 3.65412548908077*^9}, {
   3.654125547742125*^9, 3.654125551165526*^9}, {3.654125930807577*^9, 
   3.654126007244483*^9}, {3.654126127665163*^9, 3.654126191634789*^9}, {
   3.654126236482831*^9, 3.654126250153975*^9}, {3.6541262848658533`*^9, 
   3.654126288991514*^9}, {3.654126323055903*^9, 3.654126399729628*^9}, {
   3.654126435349374*^9, 3.654126447266036*^9}, {3.654126530077552*^9, 
   3.6541265937421*^9}, {3.654126679867402*^9, 3.6541267650289497`*^9}, {
   3.6541267969631968`*^9, 3.654126798410089*^9}, {3.654126829860013*^9, 
   3.654126881359337*^9}, {3.6541269393824577`*^9, 3.654126959132009*^9}, {
   3.654127079773924*^9, 3.654127194954756*^9}, {3.654127229244482*^9, 
   3.654127253953713*^9}, {3.6541278694900227`*^9, 3.654127878663176*^9}, {
   3.654127969775614*^9, 3.6541279938293123`*^9}, {3.654128051763153*^9, 
   3.654128134016169*^9}, {3.654128326830834*^9, 3.654128326972948*^9}, {
   3.654182305132535*^9, 3.654182317491791*^9}, {3.65418238746202*^9, 
   3.654182511491269*^9}, {3.654182551115921*^9, 3.654182559209998*^9}, {
   3.6541826265390177`*^9, 3.654182732425318*^9}, {3.654182795218339*^9, 
   3.654182802306821*^9}, {3.654182858360195*^9, 3.654182976637673*^9}, {
   3.65418309291822*^9, 3.6541831115452337`*^9}, {3.654183280620055*^9, 
   3.654183381285778*^9}, {3.6541834216733217`*^9, 3.65418343026462*^9}, {
   3.65418347398075*^9, 3.654183479016459*^9}, {3.654183517743698*^9, 
   3.654183590244978*^9}, {3.654183629340012*^9, 3.654183659551435*^9}, {
   3.654183828746057*^9, 3.654183869187777*^9}, {3.654183918271063*^9, 
   3.6541839184304667`*^9}, {3.654206461375032*^9, 3.6542064948942213`*^9}, {
   3.6542065261576433`*^9, 3.654206710642645*^9}, {3.65420685898112*^9, 
   3.654206859498214*^9}, {3.654206912388175*^9, 3.6542069199221067`*^9}, {
   3.654206956850091*^9, 3.654206957769821*^9}, {3.6542070885864773`*^9, 
   3.6542070905801163`*^9}, {3.6542071861274023`*^9, 3.654207197287834*^9}, {
   3.654207355631957*^9, 3.65420737546005*^9}, {3.654207422116619*^9, 
   3.6542074295958633`*^9}, {3.654207513008601*^9, 3.654207622631179*^9}, {
   3.6542077902321663`*^9, 3.6542079082040863`*^9}, {3.654208112675095*^9, 
   3.6542082406765347`*^9}, {3.654208390436673*^9, 3.654208437282127*^9}, {
   3.654208729398788*^9, 3.6542088242969923`*^9}, {3.654208875181876*^9, 
   3.6542089105814543`*^9}, {3.654209036563011*^9, 3.654209042056604*^9}, {
   3.654209131808134*^9, 3.654209211748107*^9}, {3.654277910558556*^9, 
   3.654277962902483*^9}, {3.6542785554956903`*^9, 3.654278555764879*^9}, {
   3.6542801407928543`*^9, 3.654280145647377*^9}, {3.654280336511973*^9, 
   3.654280388661951*^9}, {3.654735519742467*^9, 3.654735526212496*^9}, {
   3.654736711632904*^9, 3.654736744359725*^9}, {3.654736840726715*^9, 
   3.6547369027091503`*^9}, {3.6547369619155817`*^9, 3.65473711893006*^9}, 
   3.654737215212165*^9, {3.6547372623430433`*^9, 3.654737301717353*^9}, {
   3.654737434898181*^9, 3.654737445769989*^9}, {3.654737593349925*^9, 
   3.654737893647337*^9}, {3.654737938282483*^9, 3.654737939560112*^9}, {
   3.654737995469615*^9, 3.65473804382544*^9}, {3.65473814244207*^9, 
   3.65473826286047*^9}, {3.654738473301898*^9, 3.654738519313912*^9}, {
   3.654738551955141*^9, 3.654738559351729*^9}, {3.654738599129403*^9, 
   3.654738599566987*^9}, {3.654738653005966*^9, 3.654738704434928*^9}, {
   3.654738885183668*^9, 3.654738922018218*^9}, {3.654739011880048*^9, 
   3.65473910917871*^9}, {3.654739159170903*^9, 3.654739162120161*^9}, {
   3.6547393230277576`*^9, 3.6547393764227123`*^9}, {3.654739415181912*^9, 
   3.65473942023728*^9}, {3.654739453135948*^9, 3.654739679965816*^9}, {
   3.654739718627033*^9, 3.6547397334487553`*^9}, {3.654739765385715*^9, 
   3.654739851694334*^9}, {3.654739889466123*^9, 3.654740005071364*^9}, {
   3.6547400491757*^9, 3.654740154008595*^9}, 3.654740216700787*^9, {
   3.654740314399178*^9, 3.6547403286014967`*^9}, 3.6547403850818996`*^9, {
   3.654740521314966*^9, 3.654740541208376*^9}, {3.65474063388687*^9, 
   3.654740654515286*^9}, {3.654740701345427*^9, 3.654740810460566*^9}, {
   3.654740848239312*^9, 3.654741082783293*^9}, {3.654741274225429*^9, 
   3.65474127713437*^9}, 3.654741426789631*^9, {3.6547414571147537`*^9, 
   3.654741569824174*^9}, {3.654741604551594*^9, 3.65474161887015*^9}, {
   3.6547416933496304`*^9, 3.654741709459137*^9}, {3.654741935230948*^9, 
   3.654741945307493*^9}, {3.6547830386167917`*^9, 3.654783105454197*^9}, {
   3.6547832406606083`*^9, 3.6547832525310373`*^9}, {3.654783794511154*^9, 
   3.654783837663447*^9}, {3.65478390359721*^9, 3.654783909803577*^9}, {
   3.654783989474423*^9, 3.654784403124803*^9}, {3.654784520313846*^9, 
   3.654784622329711*^9}, {3.6547847231449842`*^9, 3.654784727983326*^9}, {
   3.654785122876478*^9, 3.654785187751635*^9}, {3.654785255283667*^9, 
   3.654785472044736*^9}, {3.654785554330287*^9, 3.6547855634367*^9}, {
   3.6547858133842907`*^9, 3.654785842420493*^9}, {3.654785988696732*^9, 
   3.654785999313698*^9}, {3.654786083383224*^9, 3.654786083827299*^9}, {
   3.654799998454865*^9, 3.654800009014682*^9}, 3.654800058896707*^9, {
   3.6548001027328*^9, 3.654800173381201*^9}, {3.654800206111162*^9, 
   3.654800346038969*^9}, {3.654800415767541*^9, 3.654800685527397*^9}, {
   3.654800717895743*^9, 3.6548007259529123`*^9}, {3.6548007560240192`*^9, 
   3.654800892868227*^9}, {3.654800961067473*^9, 3.6548010443125353`*^9}, {
   3.654801144205307*^9, 3.6548013970409203`*^9}, {3.654801447723054*^9, 
   3.6548014700938597`*^9}, {3.654801562889327*^9, 3.6548017505389137`*^9}, {
   3.6548017965315866`*^9, 3.654801838591158*^9}, {3.654801925163512*^9, 
   3.654801957336872*^9}, {3.654802037838778*^9, 3.654802097667626*^9}, {
   3.6548021338675137`*^9, 3.654802151746142*^9}, {3.6548021938035927`*^9, 
   3.65480226557542*^9}, {3.6548023434469347`*^9, 3.6548024564595747`*^9}, {
   3.654802493167995*^9, 3.654802498462143*^9}, {3.654802632969117*^9, 
   3.654802636326886*^9}, {3.6548026864101667`*^9, 3.6548027624957323`*^9}, {
   3.654802812209731*^9, 3.6548030159498*^9}, {3.6548066359524317`*^9, 
   3.654806720935005*^9}, {3.654806751992766*^9, 3.6548067587144833`*^9}, {
   3.654806821497799*^9, 3.654806889382121*^9}, {3.654807006283039*^9, 
   3.654807210369132*^9}, {3.654807340425975*^9, 3.6548074184588003`*^9}, {
   3.6548074913193197`*^9, 3.654807699931301*^9}, 3.6548078200861998`*^9, {
   3.654807890939335*^9, 3.65480791502777*^9}, {3.654807960842239*^9, 
   3.6548080712336483`*^9}, {3.654808128338978*^9, 3.6548081799548407`*^9}, {
   3.6548101758929577`*^9, 3.654810330104765*^9}, {3.654810401423953*^9, 
   3.654810408457419*^9}, {3.6548104718702717`*^9, 3.6548106690676603`*^9}, {
   3.6548107121438303`*^9, 3.6548108463298893`*^9}, {3.654810878513033*^9, 
   3.6548109250220337`*^9}, {3.654810973064028*^9, 3.6548109963255377`*^9}, {
   3.654811065383171*^9, 3.65481111435124*^9}, {3.6548111568410273`*^9, 
   3.654811165569319*^9}, {3.654811202562601*^9, 3.654811649746052*^9}, {
   3.657067656153129*^9, 3.657067660941557*^9}, {3.6570766750689*^9, 
   3.657076677028944*^9}, {3.658274451899232*^9, 3.6582744912918463`*^9}, {
   3.6583703518545094`*^9, 3.65837035300604*^9}, {3.6755973505611753`*^9, 
   3.675597361941107*^9}, {3.675597420571553*^9, 3.675597428321558*^9}, {
   3.6755976369085283`*^9, 3.675597642481595*^9}, {3.6755978045694723`*^9, 
   3.675597816797654*^9}, {3.6780961362188787`*^9, 3.678096138047097*^9}, {
   3.6904267079109745`*^9, 3.6904267082029915`*^9}, 3.6908550701496177`*^9, {
   3.692469658216547*^9, 3.692469661621353*^9}, {3.6931534906910424`*^9, 
   3.693153492095045*^9}},ExpressionUUID->"8a71ceb0-ae72-491a-a009-\
dd65a1a09814"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"Adjoint", "[", "T_", "]"}], ":", "\[IndentingNewLine]", "  ", 
     RowBox[{
     "Takes", " ", "T", " ", "a", " ", "transformation", " ", "matrix", " ", 
      "SE", 
      RowBox[{
       RowBox[{"(", "3", ")"}], ".", "\[IndentingNewLine]", "Returns"}], " ", 
      "the", " ", "corresponding", " ", "6", "x6", " ", "adjoint", " ", 
      RowBox[{"representation", "[", "AdT", "]"}]}]}], "\[IndentingNewLine]", 
    ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "Example", ":", "\[IndentingNewLine]", "Input", ":", " ", "AdT"}], " ", 
     "=", " ", 
     RowBox[{
      RowBox[{"Adjoint", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", "3"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}], "]"}], 
      "//", 
      RowBox[{"MatrixForm", "\[IndentingNewLine]", 
       RowBox[{"Output", ":", " ", 
        TagBox[
         RowBox[{"(", "\[NoBreak]", GridBox[{
            {"1", "0", "0", "0", "0", "0"},
            {"0", "0", 
             RowBox[{"-", "1"}], "0", "0", "0"},
            {"0", "1", "0", "0", "0", "0"},
            {"0", "0", "3", "1", "0", "0"},
            {"3", "0", "0", "0", "0", 
             RowBox[{"-", "1"}]},
            {"0", "0", "0", "0", "1", "0"}
           },
           
           GridBoxAlignment->{
            "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
           GridBoxSpacings->{"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.7]}, 
               Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
         Function[BoxForm`e$, 
          MatrixForm[BoxForm`e$]]]}]}]}]}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"Adjoint", "[", "T_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"R", ",", "p"}], "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"R", ",", "p"}], "}"}], "=", 
        RowBox[{"TransToRp", "[", "T", "]"}]}], ";", 
       RowBox[{"Return", "[", 
        RowBox[{"ArrayFlatten", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"R", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{
              RowBox[{"VecToso3", "[", "p", "]"}], ".", "R"}], ",", "R"}], 
            "}"}]}], "}"}], "]"}], "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.654107438701495*^9, 3.6541075770931664`*^9}, {
   3.6541076103152647`*^9, 3.654107726674172*^9}, {3.654107800327899*^9, 
   3.654107805926005*^9}, {3.654107842157054*^9, 3.654107956534466*^9}, {
   3.6541080276373253`*^9, 3.654108039845397*^9}, {3.654108208328875*^9, 
   3.654108267778264*^9}, {3.654108316603101*^9, 3.65410832858707*^9}, {
   3.654122072990996*^9, 3.654122200142358*^9}, {3.654122232524707*^9, 
   3.6541222637488813`*^9}, {3.654122372486209*^9, 3.65412253592478*^9}, {
   3.654122571686759*^9, 3.654122685636675*^9}, {3.654122740902017*^9, 
   3.6541228215630703`*^9}, {3.654122865671712*^9, 3.654122935620612*^9}, {
   3.654123032181581*^9, 3.6541230914473333`*^9}, {3.654123152783122*^9, 
   3.6541232043612537`*^9}, {3.654123304611115*^9, 3.654123341073502*^9}, {
   3.654123502235703*^9, 3.654123578362132*^9}, {3.654123664279245*^9, 
   3.654123683195951*^9}, {3.6541237878998413`*^9, 3.6541238249788847`*^9}, {
   3.654123940392714*^9, 3.654123947510108*^9}, {3.654124026309593*^9, 
   3.654124026885428*^9}, 3.6541241152729683`*^9, 3.654124170343902*^9, {
   3.6541246995439568`*^9, 3.654124712871656*^9}, {3.6541251843297157`*^9, 
   3.654125231518578*^9}, {3.6541254856851683`*^9, 3.65412548908077*^9}, {
   3.654125547742125*^9, 3.654125551165526*^9}, {3.654125930807577*^9, 
   3.654126007244483*^9}, {3.654126127665163*^9, 3.654126191634789*^9}, {
   3.654126236482831*^9, 3.654126250153975*^9}, {3.6541262848658533`*^9, 
   3.654126288991514*^9}, {3.654126323055903*^9, 3.654126399729628*^9}, {
   3.654126435349374*^9, 3.654126447266036*^9}, {3.654126530077552*^9, 
   3.6541265937421*^9}, {3.654126679867402*^9, 3.6541267650289497`*^9}, {
   3.6541267969631968`*^9, 3.654126798410089*^9}, {3.654126829860013*^9, 
   3.654126881359337*^9}, {3.6541269393824577`*^9, 3.654126959132009*^9}, {
   3.654127079773924*^9, 3.654127194954756*^9}, {3.654127229244482*^9, 
   3.654127253953713*^9}, {3.6541278694900227`*^9, 3.654127878663176*^9}, {
   3.654127969775614*^9, 3.6541279938293123`*^9}, {3.654128051763153*^9, 
   3.654128134016169*^9}, {3.654128326830834*^9, 3.654128326972948*^9}, {
   3.654182305132535*^9, 3.654182317491791*^9}, {3.65418238746202*^9, 
   3.654182511491269*^9}, {3.654182551115921*^9, 3.654182559209998*^9}, {
   3.6541826265390177`*^9, 3.654182732425318*^9}, {3.654182795218339*^9, 
   3.654182802306821*^9}, {3.654182858360195*^9, 3.654182976637673*^9}, {
   3.65418309291822*^9, 3.6541831115452337`*^9}, {3.654183280620055*^9, 
   3.654183381285778*^9}, {3.6541834216733217`*^9, 3.65418343026462*^9}, {
   3.65418347398075*^9, 3.654183479016459*^9}, {3.654183517743698*^9, 
   3.654183590244978*^9}, {3.654183629340012*^9, 3.654183659551435*^9}, {
   3.654183828746057*^9, 3.654183869187777*^9}, {3.654183918271063*^9, 
   3.6541839184304667`*^9}, {3.654206461375032*^9, 3.6542064948942213`*^9}, {
   3.6542065261576433`*^9, 3.654206710642645*^9}, {3.65420685898112*^9, 
   3.654206859498214*^9}, {3.654206912388175*^9, 3.6542069199221067`*^9}, {
   3.654206956850091*^9, 3.654206957769821*^9}, {3.6542070885864773`*^9, 
   3.6542070905801163`*^9}, {3.6542071861274023`*^9, 3.654207197287834*^9}, {
   3.654207355631957*^9, 3.65420737546005*^9}, {3.654207422116619*^9, 
   3.6542074295958633`*^9}, {3.654207513008601*^9, 3.654207622631179*^9}, {
   3.6542077902321663`*^9, 3.6542079082040863`*^9}, {3.654208112675095*^9, 
   3.6542082406765347`*^9}, {3.654208390436673*^9, 3.654208437282127*^9}, {
   3.654208729398788*^9, 3.6542088242969923`*^9}, {3.654208875181876*^9, 
   3.6542089105814543`*^9}, {3.654209036563011*^9, 3.654209042056604*^9}, {
   3.654209131808134*^9, 3.654209211748107*^9}, {3.654277910558556*^9, 
   3.654277962902483*^9}, {3.6542785554956903`*^9, 3.654278555764879*^9}, {
   3.6542801407928543`*^9, 3.654280145647377*^9}, {3.654280336511973*^9, 
   3.654280388661951*^9}, {3.654735519742467*^9, 3.654735526212496*^9}, {
   3.654736711632904*^9, 3.654736744359725*^9}, {3.654736840726715*^9, 
   3.6547369027091503`*^9}, {3.6547369619155817`*^9, 3.65473711893006*^9}, 
   3.654737215212165*^9, {3.6547372623430433`*^9, 3.654737301717353*^9}, {
   3.654737434898181*^9, 3.654737445769989*^9}, {3.654737593349925*^9, 
   3.654737893647337*^9}, {3.654737938282483*^9, 3.654737939560112*^9}, {
   3.654737995469615*^9, 3.65473804382544*^9}, {3.65473814244207*^9, 
   3.65473826286047*^9}, {3.654738473301898*^9, 3.654738519313912*^9}, {
   3.654738551955141*^9, 3.654738559351729*^9}, {3.654738599129403*^9, 
   3.654738599566987*^9}, {3.654738653005966*^9, 3.654738704434928*^9}, {
   3.654738885183668*^9, 3.654738922018218*^9}, {3.654739011880048*^9, 
   3.65473910917871*^9}, {3.654739159170903*^9, 3.654739162120161*^9}, {
   3.6547393230277576`*^9, 3.6547393764227123`*^9}, {3.654739415181912*^9, 
   3.65473942023728*^9}, {3.654739453135948*^9, 3.654739679965816*^9}, {
   3.654739718627033*^9, 3.6547397334487553`*^9}, {3.654739765385715*^9, 
   3.654739851694334*^9}, {3.654739889466123*^9, 3.654740005071364*^9}, {
   3.6547400491757*^9, 3.654740154008595*^9}, 3.654740216700787*^9, {
   3.654740314399178*^9, 3.6547403286014967`*^9}, 3.6547403850818996`*^9, {
   3.654740521314966*^9, 3.654740541208376*^9}, {3.65474063388687*^9, 
   3.654740654515286*^9}, {3.654740701345427*^9, 3.654740810460566*^9}, {
   3.654740848239312*^9, 3.654741082783293*^9}, {3.654741274225429*^9, 
   3.65474127713437*^9}, 3.654741426789631*^9, {3.6547414571147537`*^9, 
   3.654741569824174*^9}, {3.654741604551594*^9, 3.65474161887015*^9}, {
   3.6547416933496304`*^9, 3.654741709459137*^9}, {3.654741935230948*^9, 
   3.654741945307493*^9}, {3.6547830386167917`*^9, 3.654783105454197*^9}, {
   3.6547832406606083`*^9, 3.6547832525310373`*^9}, {3.654783794511154*^9, 
   3.654783837663447*^9}, {3.65478390359721*^9, 3.654783909803577*^9}, {
   3.654783989474423*^9, 3.654784403124803*^9}, {3.654784520313846*^9, 
   3.654784622329711*^9}, {3.6547847231449842`*^9, 3.654784727983326*^9}, {
   3.654785122876478*^9, 3.654785187751635*^9}, {3.654785255283667*^9, 
   3.654785472044736*^9}, {3.654785554330287*^9, 3.6547855634367*^9}, {
   3.6547858133842907`*^9, 3.654785842420493*^9}, {3.654785988696732*^9, 
   3.654785999313698*^9}, {3.654786083383224*^9, 3.654786083827299*^9}, {
   3.654799998454865*^9, 3.654800009014682*^9}, 3.654800058896707*^9, {
   3.6548001027328*^9, 3.654800173381201*^9}, {3.654800206111162*^9, 
   3.654800346038969*^9}, {3.654800415767541*^9, 3.654800685527397*^9}, {
   3.654800717895743*^9, 3.6548007259529123`*^9}, {3.6548007560240192`*^9, 
   3.654800892868227*^9}, {3.654800961067473*^9, 3.6548010443125353`*^9}, {
   3.654801144205307*^9, 3.6548013970409203`*^9}, {3.654801447723054*^9, 
   3.6548014700938597`*^9}, {3.654801562889327*^9, 3.6548017505389137`*^9}, {
   3.6548017965315866`*^9, 3.654801838591158*^9}, {3.654801925163512*^9, 
   3.654801957336872*^9}, {3.654802037838778*^9, 3.654802097667626*^9}, {
   3.6548021338675137`*^9, 3.654802151746142*^9}, {3.6548021938035927`*^9, 
   3.65480226557542*^9}, {3.6548023434469347`*^9, 3.6548024564595747`*^9}, {
   3.654802493167995*^9, 3.654802498462143*^9}, {3.654802632969117*^9, 
   3.654802636326886*^9}, {3.6548026864101667`*^9, 3.6548027624957323`*^9}, {
   3.654802812209731*^9, 3.6548030159498*^9}, {3.6548066359524317`*^9, 
   3.654806720935005*^9}, {3.654806751992766*^9, 3.6548067587144833`*^9}, {
   3.654806821497799*^9, 3.654806889382121*^9}, {3.654807006283039*^9, 
   3.654807210369132*^9}, {3.654807340425975*^9, 3.6548074184588003`*^9}, {
   3.6548074913193197`*^9, 3.654807699931301*^9}, 3.6548078200861998`*^9, {
   3.654807890939335*^9, 3.65480791502777*^9}, {3.654807960842239*^9, 
   3.6548080712336483`*^9}, {3.654808128338978*^9, 3.6548081799548407`*^9}, {
   3.6548101758929577`*^9, 3.654810330104765*^9}, {3.654810401423953*^9, 
   3.654810408457419*^9}, {3.6548104718702717`*^9, 3.6548106690676603`*^9}, {
   3.6548107121438303`*^9, 3.6548108463298893`*^9}, {3.654810878513033*^9, 
   3.6548109250220337`*^9}, {3.654810973064028*^9, 3.6548109963255377`*^9}, {
   3.654811065383171*^9, 3.65481111435124*^9}, {3.6548111568410273`*^9, 
   3.654811165569319*^9}, {3.654811202562601*^9, 3.654811649746052*^9}, {
   3.657067656153129*^9, 3.657067660941557*^9}, {3.6570766750689*^9, 
   3.657076677028944*^9}, {3.658274451899232*^9, 3.6582744912918463`*^9}, {
   3.6583703518545094`*^9, 3.65837035300604*^9}, {3.675597878325226*^9, 
   3.6755979146605263`*^9}, {3.6755980148620157`*^9, 3.675598030554899*^9}, {
   3.678096141013015*^9, 3.678096147753409*^9}, 3.6904267357345657`*^9, {
   3.6904271471640983`*^9, 3.690427155538577*^9}, {3.690427186077324*^9, 
   3.6904272732573104`*^9}, {3.690427309554386*^9, 3.690427453700631*^9}, 
   3.6908550730897727`*^9, {3.6924696712189736`*^9, 3.692469680609393*^9}, {
   3.693153498335056*^9, 
   3.6931535006126595`*^9}},ExpressionUUID->"883d455b-d605-47ff-8abc-\
4fc42cf1f167"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"ScrewToAxis", "[", 
      RowBox[{"q_", ",", "s_", ",", "h_"}], "]"}], ":", "\[IndentingNewLine]",
      "  ", 
     RowBox[{"Takes", " ", "q"}], ":", " ", 
     RowBox[{
     "a", " ", "point", " ", "lying", " ", "on", " ", "the", " ", "screw", 
      " ", "axis"}]}], ",", "\[IndentingNewLine]", "         ", 
    RowBox[{"s", ":", " ", 
     RowBox[{
     "a", " ", "unit", " ", "vector", " ", "in", " ", "the", " ", "direction",
       " ", "of", " ", "the", " ", "screw", " ", "axis"}]}], ",", 
    "\[IndentingNewLine]", "         ", 
    RowBox[{
     RowBox[{"h", ":", " ", 
      RowBox[{"the", " ", "pitch", " ", "of", " ", "the", " ", "screw", " ", 
       RowBox[{"axis", ".", "\[IndentingNewLine]", "Returns"}], " ", "the", 
       " ", "corresponding", " ", "normalized", " ", "screw", " ", 
       RowBox[{"axis", "."}]}]}], "\[IndentingNewLine]", ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Example", ":", "\[IndentingNewLine]", "Input", ":", " ", "S"}],
       " ", "=", " ", 
      RowBox[{
       RowBox[{"ScrewToAxis", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"3", ",", "0", ",", "0"}], "}"}], "}"}], "\[Transpose]"}],
          ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "1"}], "}"}], "}"}], "\[Transpose]"}],
          ",", "2"}], "]"}], "\[IndentingNewLine]", 
       RowBox[{"Output", ":", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "0", "}"}], ",", 
          RowBox[{"{", "0", "}"}], ",", 
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "0", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"-", "3"}], "}"}], ",", 
          RowBox[{"{", "2", "}"}]}], "}"}]}]}]}]}]}], "\[IndentingNewLine]", 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ScrewToAxis", "[", 
     RowBox[{"q_", ",", "s_", ",", "h_"}], "]"}], ":=", 
    RowBox[{"ArrayFlatten", "[", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "s", "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Cross", "[", 
            RowBox[{
             RowBox[{"Flatten", "[", "q", "]"}], ",", 
             RowBox[{"Flatten", "[", "s", "]"}]}], "]"}], "}"}], 
          "\[Transpose]"}], "+", 
         RowBox[{"h", "*", "s"}]}], "}"}]}], "}"}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.654107438701495*^9, 3.6541075770931664`*^9}, {
   3.6541076103152647`*^9, 3.654107726674172*^9}, {3.654107800327899*^9, 
   3.654107805926005*^9}, {3.654107842157054*^9, 3.654107956534466*^9}, {
   3.6541080276373253`*^9, 3.654108039845397*^9}, {3.654108208328875*^9, 
   3.654108267778264*^9}, {3.654108316603101*^9, 3.65410832858707*^9}, {
   3.654122072990996*^9, 3.654122200142358*^9}, {3.654122232524707*^9, 
   3.6541222637488813`*^9}, {3.654122372486209*^9, 3.65412253592478*^9}, {
   3.654122571686759*^9, 3.654122685636675*^9}, {3.654122740902017*^9, 
   3.6541228215630703`*^9}, {3.654122865671712*^9, 3.654122935620612*^9}, {
   3.654123032181581*^9, 3.6541230914473333`*^9}, {3.654123152783122*^9, 
   3.6541232043612537`*^9}, {3.654123304611115*^9, 3.654123341073502*^9}, {
   3.654123502235703*^9, 3.654123578362132*^9}, {3.654123664279245*^9, 
   3.654123683195951*^9}, {3.6541237878998413`*^9, 3.6541238249788847`*^9}, {
   3.654123940392714*^9, 3.654123947510108*^9}, {3.654124026309593*^9, 
   3.654124026885428*^9}, 3.6541241152729683`*^9, 3.654124170343902*^9, {
   3.6541246995439568`*^9, 3.654124712871656*^9}, {3.6541251843297157`*^9, 
   3.654125231518578*^9}, {3.6541254856851683`*^9, 3.65412548908077*^9}, {
   3.654125547742125*^9, 3.654125551165526*^9}, {3.654125930807577*^9, 
   3.654126007244483*^9}, {3.654126127665163*^9, 3.654126191634789*^9}, {
   3.654126236482831*^9, 3.654126250153975*^9}, {3.6541262848658533`*^9, 
   3.654126288991514*^9}, {3.654126323055903*^9, 3.654126399729628*^9}, {
   3.654126435349374*^9, 3.654126447266036*^9}, {3.654126530077552*^9, 
   3.6541265937421*^9}, {3.654126679867402*^9, 3.6541267650289497`*^9}, {
   3.6541267969631968`*^9, 3.654126798410089*^9}, {3.654126829860013*^9, 
   3.654126881359337*^9}, {3.6541269393824577`*^9, 3.654126959132009*^9}, {
   3.654127079773924*^9, 3.654127194954756*^9}, {3.654127229244482*^9, 
   3.654127253953713*^9}, {3.6541278694900227`*^9, 3.654127878663176*^9}, {
   3.654127969775614*^9, 3.6541279938293123`*^9}, {3.654128051763153*^9, 
   3.654128134016169*^9}, {3.654128326830834*^9, 3.654128326972948*^9}, {
   3.654182305132535*^9, 3.654182317491791*^9}, {3.65418238746202*^9, 
   3.654182511491269*^9}, {3.654182551115921*^9, 3.654182559209998*^9}, {
   3.6541826265390177`*^9, 3.654182732425318*^9}, {3.654182795218339*^9, 
   3.654182802306821*^9}, {3.654182858360195*^9, 3.654182976637673*^9}, {
   3.65418309291822*^9, 3.6541831115452337`*^9}, {3.654183280620055*^9, 
   3.654183381285778*^9}, {3.6541834216733217`*^9, 3.65418343026462*^9}, {
   3.65418347398075*^9, 3.654183479016459*^9}, {3.654183517743698*^9, 
   3.654183590244978*^9}, {3.654183629340012*^9, 3.654183659551435*^9}, {
   3.654183828746057*^9, 3.654183869187777*^9}, {3.654183918271063*^9, 
   3.6541839184304667`*^9}, {3.654206461375032*^9, 3.6542064948942213`*^9}, {
   3.6542065261576433`*^9, 3.654206710642645*^9}, {3.65420685898112*^9, 
   3.654206859498214*^9}, {3.654206912388175*^9, 3.6542069199221067`*^9}, {
   3.654206956850091*^9, 3.654206957769821*^9}, {3.6542070885864773`*^9, 
   3.6542070905801163`*^9}, {3.6542071861274023`*^9, 3.654207197287834*^9}, {
   3.654207355631957*^9, 3.65420737546005*^9}, {3.654207422116619*^9, 
   3.6542074295958633`*^9}, {3.654207513008601*^9, 3.654207622631179*^9}, {
   3.6542077902321663`*^9, 3.6542079082040863`*^9}, {3.654208112675095*^9, 
   3.6542082406765347`*^9}, {3.654208390436673*^9, 3.654208437282127*^9}, {
   3.654208729398788*^9, 3.6542088242969923`*^9}, {3.654208875181876*^9, 
   3.6542089105814543`*^9}, {3.654209036563011*^9, 3.654209042056604*^9}, {
   3.654209131808134*^9, 3.654209211748107*^9}, {3.654277910558556*^9, 
   3.654277962902483*^9}, {3.6542785554956903`*^9, 3.654278555764879*^9}, {
   3.6542801407928543`*^9, 3.654280145647377*^9}, {3.654280336511973*^9, 
   3.654280388661951*^9}, {3.654735519742467*^9, 3.654735526212496*^9}, {
   3.654736711632904*^9, 3.654736744359725*^9}, {3.654736840726715*^9, 
   3.6547369027091503`*^9}, {3.6547369619155817`*^9, 3.65473711893006*^9}, 
   3.654737215212165*^9, {3.6547372623430433`*^9, 3.654737301717353*^9}, {
   3.654737434898181*^9, 3.654737445769989*^9}, {3.654737593349925*^9, 
   3.654737893647337*^9}, {3.654737938282483*^9, 3.654737939560112*^9}, {
   3.654737995469615*^9, 3.65473804382544*^9}, {3.65473814244207*^9, 
   3.65473826286047*^9}, {3.654738473301898*^9, 3.654738519313912*^9}, {
   3.654738551955141*^9, 3.654738559351729*^9}, {3.654738599129403*^9, 
   3.654738599566987*^9}, {3.654738653005966*^9, 3.654738704434928*^9}, {
   3.654738885183668*^9, 3.654738922018218*^9}, {3.654739011880048*^9, 
   3.65473910917871*^9}, {3.654739159170903*^9, 3.654739162120161*^9}, {
   3.6547393230277576`*^9, 3.6547393764227123`*^9}, {3.654739415181912*^9, 
   3.65473942023728*^9}, {3.654739453135948*^9, 3.654739679965816*^9}, {
   3.654739718627033*^9, 3.6547397334487553`*^9}, {3.654739765385715*^9, 
   3.654739851694334*^9}, {3.654739889466123*^9, 3.654740005071364*^9}, {
   3.6547400491757*^9, 3.654740154008595*^9}, 3.654740216700787*^9, {
   3.654740314399178*^9, 3.6547403286014967`*^9}, 3.6547403850818996`*^9, {
   3.654740521314966*^9, 3.654740541208376*^9}, {3.65474063388687*^9, 
   3.654740654515286*^9}, {3.654740701345427*^9, 3.654740810460566*^9}, {
   3.654740848239312*^9, 3.654741082783293*^9}, {3.654741274225429*^9, 
   3.65474127713437*^9}, 3.654741426789631*^9, {3.6547414571147537`*^9, 
   3.654741569824174*^9}, {3.654741604551594*^9, 3.65474161887015*^9}, {
   3.6547416933496304`*^9, 3.654741709459137*^9}, {3.654741935230948*^9, 
   3.654741945307493*^9}, {3.6547830386167917`*^9, 3.654783105454197*^9}, {
   3.6547832406606083`*^9, 3.6547832525310373`*^9}, {3.654783794511154*^9, 
   3.654783837663447*^9}, {3.65478390359721*^9, 3.654783909803577*^9}, {
   3.654783989474423*^9, 3.654784403124803*^9}, {3.654784520313846*^9, 
   3.654784622329711*^9}, {3.6547847231449842`*^9, 3.654784727983326*^9}, {
   3.654785122876478*^9, 3.654785187751635*^9}, {3.654785255283667*^9, 
   3.654785472044736*^9}, {3.654785554330287*^9, 3.6547855634367*^9}, {
   3.6547858133842907`*^9, 3.654785842420493*^9}, {3.654785988696732*^9, 
   3.654785999313698*^9}, {3.654786083383224*^9, 3.654786083827299*^9}, {
   3.654799998454865*^9, 3.654800009014682*^9}, 3.654800058896707*^9, {
   3.6548001027328*^9, 3.654800173381201*^9}, {3.654800206111162*^9, 
   3.654800346038969*^9}, {3.654800415767541*^9, 3.654800685527397*^9}, {
   3.654800717895743*^9, 3.6548007259529123`*^9}, {3.6548007560240192`*^9, 
   3.654800892868227*^9}, {3.654800961067473*^9, 3.6548010443125353`*^9}, {
   3.654801144205307*^9, 3.6548013970409203`*^9}, {3.654801447723054*^9, 
   3.6548014700938597`*^9}, {3.654801562889327*^9, 3.6548017505389137`*^9}, {
   3.6548017965315866`*^9, 3.654801838591158*^9}, {3.654801925163512*^9, 
   3.654801957336872*^9}, {3.654802037838778*^9, 3.654802097667626*^9}, {
   3.6548021338675137`*^9, 3.654802151746142*^9}, {3.6548021938035927`*^9, 
   3.65480226557542*^9}, {3.6548023434469347`*^9, 3.6548024564595747`*^9}, {
   3.654802493167995*^9, 3.654802498462143*^9}, {3.654802632969117*^9, 
   3.654802636326886*^9}, {3.6548026864101667`*^9, 3.6548027624957323`*^9}, {
   3.654802812209731*^9, 3.6548030159498*^9}, {3.6548066359524317`*^9, 
   3.654806720935005*^9}, {3.654806751992766*^9, 3.6548067587144833`*^9}, {
   3.654806821497799*^9, 3.654806889382121*^9}, {3.654807006283039*^9, 
   3.654807210369132*^9}, {3.654807340425975*^9, 3.6548074184588003`*^9}, {
   3.6548074913193197`*^9, 3.654807699931301*^9}, 3.6548078200861998`*^9, {
   3.654807890939335*^9, 3.65480791502777*^9}, {3.654807960842239*^9, 
   3.6548080712336483`*^9}, {3.654808128338978*^9, 3.6548081799548407`*^9}, {
   3.6548101758929577`*^9, 3.654810330104765*^9}, {3.654810401423953*^9, 
   3.654810408457419*^9}, {3.6548104718702717`*^9, 3.6548106690676603`*^9}, {
   3.6548107121438303`*^9, 3.6548108463298893`*^9}, {3.654810878513033*^9, 
   3.6548109250220337`*^9}, {3.654810973064028*^9, 3.6548109963255377`*^9}, {
   3.654811065383171*^9, 3.65481111435124*^9}, {3.6548111568410273`*^9, 
   3.654811165569319*^9}, {3.654811202562601*^9, 3.654811649746052*^9}, {
   3.657067656153129*^9, 3.657067660941557*^9}, {3.6570766750689*^9, 
   3.657076677028944*^9}, {3.658274451899232*^9, 3.6582744912918463`*^9}, {
   3.6583703518545094`*^9, 3.65837035300604*^9}, {3.675598055508669*^9, 
   3.675598057083598*^9}, {3.675598169865116*^9, 3.6755982065219803`*^9}, {
   3.675598239676413*^9, 3.675598240245709*^9}, {3.675598295505789*^9, 
   3.675598303845595*^9}, 3.675598755218297*^9, {3.675601452088194*^9, 
   3.675601456989585*^9}, 3.678096151946823*^9, {3.689124095917945*^9, 
   3.689124123410983*^9}, {3.6904602993220882`*^9, 3.6904603012564917`*^9}, {
   3.690460343750966*^9, 3.6904603675722084`*^9}, 3.6908550752764926`*^9, {
   3.6924697082304506`*^9, 3.6924697713209963`*^9}, {3.6931536131044574`*^9, 
   3.693153616879664*^9}},ExpressionUUID->"a4b8d789-2193-4eb4-89e8-\
f131c17e84af"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"AxisAng6", "[", "expc6_", "]"}], ":", "\[IndentingNewLine]", 
     "   ", 
     RowBox[{
      RowBox[{"Takes", " ", "a", " ", "6"}], "-", 
      RowBox[{
      "vector", " ", "of", " ", "exponential", " ", "coordinates", " ", "for",
        " ", "rigid"}], "-", 
      RowBox[{"body", " ", "motion", " ", "S", "*", 
       RowBox[{"theta", ".", "\[IndentingNewLine]", "Returns"}], " ", "S"}]}],
      ":", " ", 
     RowBox[{
     "the", " ", "corresponding", " ", "normalized", " ", "screw", " ", 
      "axis"}]}], ",", "\[IndentingNewLine]", "            ", 
    RowBox[{
     RowBox[{"theta", ":", " ", 
      RowBox[{"the", " ", "distance", " ", "traveled", " ", 
       RowBox[{"along", "/", "about"}], " ", 
       RowBox[{"S", ".", " ", "\[IndentingNewLine]", " ", "The"}], " ", 
       "first", " ", "element", " ", "of", " ", "the", " ", "output", " ", 
       "is", " ", "the", " ", "screw", " ", "axis", " ", "S", " ", "and", " ",
        "the", " ", "second", " ", "is", " ", "the", " ", "distance", " ", 
       RowBox[{"theta", "."}]}]}], "\[IndentingNewLine]", ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Example", ":", "\[IndentingNewLine]", "Input", ":", " ", 
       RowBox[{"{", 
        RowBox[{"S", ",", " ", "theta"}], "}"}]}], " ", "=", " ", 
      RowBox[{
       RowBox[{"AxisAng6", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "0", "}"}], ",", 
          RowBox[{"{", "0", "}"}], ",", 
          RowBox[{"{", "1", "}"}], ",", 
          RowBox[{"{", "2", "}"}], ",", 
          RowBox[{"{", "3", "}"}]}], "}"}], "]"}], "\[IndentingNewLine]", 
       RowBox[{"Output", ":", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "1", "}"}], ",", 
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "0", "}"}], ",", 
            RowBox[{"{", "1", "}"}], ",", 
            RowBox[{"{", "2", "}"}], ",", 
            RowBox[{"{", "3", "}"}]}], "}"}], ",", "1"}], "}"}]}]}]}]}]}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"AxisAng6", "[", "expc6_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "theta", "}"}], ",", 
      RowBox[{
       RowBox[{"theta", "=", 
        RowBox[{"Norm", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"expc6", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"1", ";;", "3"}], ",", "1"}], "]"}], "]"}], "}"}], 
          "\[Transpose]"}], "]"}]}], ";", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"NearZero", "[", "theta", "]"}], ",", 
         RowBox[{"theta", "=", 
          RowBox[{"Norm", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"expc6", "[", 
              RowBox[{"[", 
               RowBox[{
                RowBox[{"4", ";;", "6"}], ",", "1"}], "]"}], "]"}], "}"}], 
            "\[Transpose]"}], "]"}]}]}], "]"}], ";", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"expc6", "/", "theta"}], ",", "theta"}], "}"}], "]"}]}]}], 
     "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.654107438701495*^9, 3.6541075770931664`*^9}, {
   3.6541076103152647`*^9, 3.654107726674172*^9}, {3.654107800327899*^9, 
   3.654107805926005*^9}, {3.654107842157054*^9, 3.654107956534466*^9}, {
   3.6541080276373253`*^9, 3.654108039845397*^9}, {3.654108208328875*^9, 
   3.654108267778264*^9}, {3.654108316603101*^9, 3.65410832858707*^9}, {
   3.654122072990996*^9, 3.654122200142358*^9}, {3.654122232524707*^9, 
   3.6541222637488813`*^9}, {3.654122372486209*^9, 3.65412253592478*^9}, {
   3.654122571686759*^9, 3.654122685636675*^9}, {3.654122740902017*^9, 
   3.6541228215630703`*^9}, {3.654122865671712*^9, 3.654122935620612*^9}, {
   3.654123032181581*^9, 3.6541230914473333`*^9}, {3.654123152783122*^9, 
   3.6541232043612537`*^9}, {3.654123304611115*^9, 3.654123341073502*^9}, {
   3.654123502235703*^9, 3.654123578362132*^9}, {3.654123664279245*^9, 
   3.654123683195951*^9}, {3.6541237878998413`*^9, 3.6541238249788847`*^9}, {
   3.654123940392714*^9, 3.654123947510108*^9}, {3.654124026309593*^9, 
   3.654124026885428*^9}, 3.6541241152729683`*^9, 3.654124170343902*^9, {
   3.6541246995439568`*^9, 3.654124712871656*^9}, {3.6541251843297157`*^9, 
   3.654125231518578*^9}, {3.6541254856851683`*^9, 3.65412548908077*^9}, {
   3.654125547742125*^9, 3.654125551165526*^9}, {3.654125930807577*^9, 
   3.654126007244483*^9}, {3.654126127665163*^9, 3.654126191634789*^9}, {
   3.654126236482831*^9, 3.654126250153975*^9}, {3.6541262848658533`*^9, 
   3.654126288991514*^9}, {3.654126323055903*^9, 3.654126399729628*^9}, {
   3.654126435349374*^9, 3.654126447266036*^9}, {3.654126530077552*^9, 
   3.6541265937421*^9}, {3.654126679867402*^9, 3.6541267650289497`*^9}, {
   3.6541267969631968`*^9, 3.654126798410089*^9}, {3.654126829860013*^9, 
   3.654126881359337*^9}, {3.6541269393824577`*^9, 3.654126959132009*^9}, {
   3.654127079773924*^9, 3.654127194954756*^9}, {3.654127229244482*^9, 
   3.654127253953713*^9}, {3.6541278694900227`*^9, 3.654127878663176*^9}, {
   3.654127969775614*^9, 3.6541279938293123`*^9}, {3.654128051763153*^9, 
   3.654128134016169*^9}, {3.654128326830834*^9, 3.654128326972948*^9}, {
   3.654182305132535*^9, 3.654182317491791*^9}, {3.65418238746202*^9, 
   3.654182511491269*^9}, {3.654182551115921*^9, 3.654182559209998*^9}, {
   3.6541826265390177`*^9, 3.654182732425318*^9}, {3.654182795218339*^9, 
   3.654182802306821*^9}, {3.654182858360195*^9, 3.654182976637673*^9}, {
   3.65418309291822*^9, 3.6541831115452337`*^9}, {3.654183280620055*^9, 
   3.654183381285778*^9}, {3.6541834216733217`*^9, 3.65418343026462*^9}, {
   3.65418347398075*^9, 3.654183479016459*^9}, {3.654183517743698*^9, 
   3.654183590244978*^9}, {3.654183629340012*^9, 3.654183659551435*^9}, {
   3.654183828746057*^9, 3.654183869187777*^9}, {3.654183918271063*^9, 
   3.6541839184304667`*^9}, {3.654206461375032*^9, 3.6542064948942213`*^9}, {
   3.6542065261576433`*^9, 3.654206710642645*^9}, {3.65420685898112*^9, 
   3.654206859498214*^9}, {3.654206912388175*^9, 3.6542069199221067`*^9}, {
   3.654206956850091*^9, 3.654206957769821*^9}, {3.6542070885864773`*^9, 
   3.6542070905801163`*^9}, {3.6542071861274023`*^9, 3.654207197287834*^9}, {
   3.654207355631957*^9, 3.65420737546005*^9}, {3.654207422116619*^9, 
   3.6542074295958633`*^9}, {3.654207513008601*^9, 3.654207622631179*^9}, {
   3.6542077902321663`*^9, 3.6542079082040863`*^9}, {3.654208112675095*^9, 
   3.6542082406765347`*^9}, {3.654208390436673*^9, 3.654208437282127*^9}, {
   3.654208729398788*^9, 3.6542088242969923`*^9}, {3.654208875181876*^9, 
   3.6542089105814543`*^9}, {3.654209036563011*^9, 3.654209042056604*^9}, {
   3.654209131808134*^9, 3.654209211748107*^9}, {3.654277910558556*^9, 
   3.654277962902483*^9}, {3.6542785554956903`*^9, 3.654278555764879*^9}, {
   3.6542801407928543`*^9, 3.654280145647377*^9}, {3.654280336511973*^9, 
   3.654280388661951*^9}, {3.654735519742467*^9, 3.654735526212496*^9}, {
   3.654736711632904*^9, 3.654736744359725*^9}, {3.654736840726715*^9, 
   3.6547369027091503`*^9}, {3.6547369619155817`*^9, 3.65473711893006*^9}, 
   3.654737215212165*^9, {3.6547372623430433`*^9, 3.654737301717353*^9}, {
   3.654737434898181*^9, 3.654737445769989*^9}, {3.654737593349925*^9, 
   3.654737893647337*^9}, {3.654737938282483*^9, 3.654737939560112*^9}, {
   3.654737995469615*^9, 3.65473804382544*^9}, {3.65473814244207*^9, 
   3.65473826286047*^9}, {3.654738473301898*^9, 3.654738519313912*^9}, {
   3.654738551955141*^9, 3.654738559351729*^9}, {3.654738599129403*^9, 
   3.654738599566987*^9}, {3.654738653005966*^9, 3.654738704434928*^9}, {
   3.654738885183668*^9, 3.654738922018218*^9}, {3.654739011880048*^9, 
   3.65473910917871*^9}, {3.654739159170903*^9, 3.654739162120161*^9}, {
   3.6547393230277576`*^9, 3.6547393764227123`*^9}, {3.654739415181912*^9, 
   3.65473942023728*^9}, {3.654739453135948*^9, 3.654739679965816*^9}, {
   3.654739718627033*^9, 3.6547397334487553`*^9}, {3.654739765385715*^9, 
   3.654739851694334*^9}, {3.654739889466123*^9, 3.654740005071364*^9}, {
   3.6547400491757*^9, 3.654740154008595*^9}, 3.654740216700787*^9, {
   3.654740314399178*^9, 3.6547403286014967`*^9}, 3.6547403850818996`*^9, {
   3.654740521314966*^9, 3.654740541208376*^9}, {3.65474063388687*^9, 
   3.654740654515286*^9}, {3.654740701345427*^9, 3.654740810460566*^9}, {
   3.654740848239312*^9, 3.654741082783293*^9}, {3.654741274225429*^9, 
   3.65474127713437*^9}, 3.654741426789631*^9, {3.6547414571147537`*^9, 
   3.654741569824174*^9}, {3.654741604551594*^9, 3.65474161887015*^9}, {
   3.6547416933496304`*^9, 3.654741709459137*^9}, {3.654741935230948*^9, 
   3.654741945307493*^9}, {3.6547830386167917`*^9, 3.654783105454197*^9}, {
   3.6547832406606083`*^9, 3.6547832525310373`*^9}, {3.654783794511154*^9, 
   3.654783837663447*^9}, {3.65478390359721*^9, 3.654783909803577*^9}, {
   3.654783989474423*^9, 3.654784403124803*^9}, {3.654784520313846*^9, 
   3.654784622329711*^9}, {3.6547847231449842`*^9, 3.654784727983326*^9}, {
   3.654785122876478*^9, 3.654785187751635*^9}, {3.654785255283667*^9, 
   3.654785472044736*^9}, {3.654785554330287*^9, 3.6547855634367*^9}, {
   3.6547858133842907`*^9, 3.654785842420493*^9}, {3.654785988696732*^9, 
   3.654785999313698*^9}, {3.654786083383224*^9, 3.654786083827299*^9}, {
   3.654799998454865*^9, 3.654800009014682*^9}, 3.654800058896707*^9, {
   3.6548001027328*^9, 3.654800173381201*^9}, {3.654800206111162*^9, 
   3.654800346038969*^9}, {3.654800415767541*^9, 3.654800685527397*^9}, {
   3.654800717895743*^9, 3.6548007259529123`*^9}, {3.6548007560240192`*^9, 
   3.654800892868227*^9}, {3.654800961067473*^9, 3.6548010443125353`*^9}, {
   3.654801144205307*^9, 3.6548013970409203`*^9}, {3.654801447723054*^9, 
   3.6548014700938597`*^9}, {3.654801562889327*^9, 3.6548017505389137`*^9}, {
   3.6548017965315866`*^9, 3.654801838591158*^9}, {3.654801925163512*^9, 
   3.654801957336872*^9}, {3.654802037838778*^9, 3.654802097667626*^9}, {
   3.6548021338675137`*^9, 3.654802151746142*^9}, {3.6548021938035927`*^9, 
   3.65480226557542*^9}, {3.6548023434469347`*^9, 3.6548024564595747`*^9}, {
   3.654802493167995*^9, 3.654802498462143*^9}, {3.654802632969117*^9, 
   3.654802636326886*^9}, {3.6548026864101667`*^9, 3.6548027624957323`*^9}, {
   3.654802812209731*^9, 3.6548030159498*^9}, {3.6548066359524317`*^9, 
   3.654806720935005*^9}, {3.654806751992766*^9, 3.6548067587144833`*^9}, {
   3.654806821497799*^9, 3.654806889382121*^9}, {3.654807006283039*^9, 
   3.654807210369132*^9}, {3.654807340425975*^9, 3.6548074184588003`*^9}, {
   3.6548074913193197`*^9, 3.654807699931301*^9}, 3.6548078200861998`*^9, {
   3.654807890939335*^9, 3.65480791502777*^9}, {3.654807960842239*^9, 
   3.6548080712336483`*^9}, {3.654808128338978*^9, 3.6548081799548407`*^9}, {
   3.6548101758929577`*^9, 3.654810330104765*^9}, {3.654810401423953*^9, 
   3.654810408457419*^9}, {3.6548104718702717`*^9, 3.6548106690676603`*^9}, {
   3.6548107121438303`*^9, 3.6548108463298893`*^9}, {3.654810878513033*^9, 
   3.6548109250220337`*^9}, {3.654810973064028*^9, 3.6548109963255377`*^9}, {
   3.654811065383171*^9, 3.65481111435124*^9}, {3.6548111568410273`*^9, 
   3.654811165569319*^9}, {3.654811202562601*^9, 3.654811649746052*^9}, {
   3.657067656153129*^9, 3.657067660941557*^9}, {3.6570766750689*^9, 
   3.657076677028944*^9}, {3.658274451899232*^9, 3.6582744912918463`*^9}, {
   3.6583703518545094`*^9, 3.65837035300604*^9}, {3.6755985001383038`*^9, 
   3.675598581679422*^9}, {3.675598613345693*^9, 3.675598641956484*^9}, {
   3.675598705465678*^9, 3.675598735438822*^9}, 3.678096156180605*^9, {
   3.6891242180401173`*^9, 3.6891242578011737`*^9}, {3.690461719030828*^9, 
   3.6904619133687925`*^9}, 3.690855077692618*^9, {3.692469788064231*^9, 
   3.692469825517315*^9}, 3.693099536242242*^9, {3.693153629718487*^9, 
   3.6931536382673016`*^9}},ExpressionUUID->"ec6248e6-c8a6-47c2-b31f-\
5eddd1d42a35"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"MatrixExp6", "[", "se3mat", "]"}], ":", "\[IndentingNewLine]", 
      "  ", 
      RowBox[{"Takes", " ", "a", " ", "se", 
       RowBox[{"(", "3", ")"}], " ", "representation", " ", "of", " ", 
       "exponential", " ", 
       RowBox[{"coordinates", ".", "\[IndentingNewLine]", "Returns"}], " ", 
       "a", " ", "T", " ", "matrix", " ", "SE", 
       RowBox[{"(", "3", ")"}], " ", "that", " ", "is", " ", "achieved", " ", 
       "by", " ", "traveling", " ", 
       RowBox[{"along", "/", "about"}], " ", "the", " ", "screw", " ", "axis",
        " ", "S", " ", "for", " ", "a", " ", "distance", " ", "theta", " ", 
       "from", " ", "an", " ", "initial", " ", "configuration", " ", "T"}]}], 
     "=", 
     RowBox[{"I", "."}]}], "\[IndentingNewLine]", ";", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Example", ":", "\[IndentingNewLine]", "Input", ":", " ", "T"}], 
     " ", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"MatrixExp6", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", 
            RowBox[{"-", "1.5707963267948966"}], ",", "2.3561944901923448"}], 
           "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "0", ",", "1.5707963267948966", ",", "0", ",", 
            "2.3561944901923448"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}]}], "}"}], "]"}],
        "//", "MatrixForm"}], "//", 
      RowBox[{"N", "\[IndentingNewLine]", 
       RowBox[{"Output", ":", " ", 
        TagBox[
         RowBox[{"(", "\[NoBreak]", GridBox[{
            {"1.", "0.", "0.", "0."},
            {"0.", "0.", 
             RowBox[{"-", "1."}], "0."},
            {"0.", "1.", "0.", "3."},
            {"0.", "0.", "0.", "1."}
           },
           
           GridBoxAlignment->{
            "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
           GridBoxSpacings->{"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.7]}, 
               Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}, "RowsIndexed" -> {}}], ")"}],
         Function[BoxForm`e$, 
          MatrixForm[BoxForm`e$]]]}]}]}]}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MatrixExp6", "[", "se3mat_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "omgtheta", ",", "omghat", ",", "theta", ",", "omgmat", ",", "G"}], 
       "}"}], ",", 
      RowBox[{
       RowBox[{"omgtheta", "=", 
        RowBox[{"so3ToVec", "[", 
         RowBox[{"se3mat", "[", 
          RowBox[{"[", 
           RowBox[{
            RowBox[{"1", ";;", "3"}], ",", 
            RowBox[{"1", ";;", "3"}]}], "]"}], "]"}], "]"}]}], ";", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"NearZero", "[", 
          RowBox[{"Norm", "[", "omgtheta", "]"}], "]"}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"ArrayFlatten", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"IdentityMatrix", "[", "3", "]"}], ",", 
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"se3mat", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"1", ";;", "3"}], ",", "4"}], "]"}], "]"}], "}"}],
                 "\[Transpose]"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"0", ",", "1"}], "}"}]}], "}"}], "]"}], "]"}], ",", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{"omghat", ",", "theta"}], "}"}], " ", "=", " ", 
           RowBox[{"AxisAng3", "[", "omgtheta", "]"}]}], ";", 
          RowBox[{"omgmat", "=", 
           RowBox[{
            RowBox[{"se3mat", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"1", ";;", "3"}], ",", 
               RowBox[{"1", ";;", "3"}]}], "]"}], "]"}], "/", "theta"}]}], 
          ";", 
          RowBox[{"Return", "[", 
           RowBox[{"ArrayFlatten", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"MatrixExp3", "[", 
                 RowBox[{"se3mat", "[", 
                  RowBox[{"[", 
                   RowBox[{
                    RowBox[{"1", ";;", "3"}], ",", 
                    RowBox[{"1", ";;", "3"}]}], "]"}], "]"}], "]"}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"IdentityMatrix", "[", "3", "]"}], "*", "theta"}],
                    "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"Cos", "[", "theta", "]"}]}], ")"}], "*", 
                    "omgmat"}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"theta", "-", 
                    RowBox[{"Sin", "[", "theta", "]"}]}], ")"}], "*", 
                    RowBox[{"omgmat", ".", "omgmat"}]}]}], ")"}], ".", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"{", 
                    RowBox[{"se3mat", "[", 
                    RowBox[{"[", 
                    RowBox[{
                    RowBox[{"1", ";;", "3"}], ",", "4"}], "]"}], "]"}], "}"}],
                     "\[Transpose]"}], "/", "theta"}], ")"}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}]}], "}"}], "]"}], "]"}]}]}], 
        "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.654107438701495*^9, 3.6541075770931664`*^9}, {
   3.6541076103152647`*^9, 3.654107726674172*^9}, {3.654107800327899*^9, 
   3.654107805926005*^9}, {3.654107842157054*^9, 3.654107956534466*^9}, {
   3.6541080276373253`*^9, 3.654108039845397*^9}, {3.654108208328875*^9, 
   3.654108267778264*^9}, {3.654108316603101*^9, 3.65410832858707*^9}, {
   3.654122072990996*^9, 3.654122200142358*^9}, {3.654122232524707*^9, 
   3.6541222637488813`*^9}, {3.654122372486209*^9, 3.65412253592478*^9}, {
   3.654122571686759*^9, 3.654122685636675*^9}, {3.654122740902017*^9, 
   3.6541228215630703`*^9}, {3.654122865671712*^9, 3.654122935620612*^9}, {
   3.654123032181581*^9, 3.6541230914473333`*^9}, {3.654123152783122*^9, 
   3.6541232043612537`*^9}, {3.654123304611115*^9, 3.654123341073502*^9}, {
   3.654123502235703*^9, 3.654123578362132*^9}, {3.654123664279245*^9, 
   3.654123683195951*^9}, {3.6541237878998413`*^9, 3.6541238249788847`*^9}, {
   3.654123940392714*^9, 3.654123947510108*^9}, {3.654124026309593*^9, 
   3.654124026885428*^9}, 3.6541241152729683`*^9, 3.654124170343902*^9, {
   3.6541246995439568`*^9, 3.654124712871656*^9}, {3.6541251843297157`*^9, 
   3.654125231518578*^9}, {3.6541254856851683`*^9, 3.65412548908077*^9}, {
   3.654125547742125*^9, 3.654125551165526*^9}, {3.654125930807577*^9, 
   3.654126007244483*^9}, {3.654126127665163*^9, 3.654126191634789*^9}, {
   3.654126236482831*^9, 3.654126250153975*^9}, {3.6541262848658533`*^9, 
   3.654126288991514*^9}, {3.654126323055903*^9, 3.654126399729628*^9}, {
   3.654126435349374*^9, 3.654126447266036*^9}, {3.654126530077552*^9, 
   3.6541265937421*^9}, {3.654126679867402*^9, 3.6541267650289497`*^9}, {
   3.6541267969631968`*^9, 3.654126798410089*^9}, {3.654126829860013*^9, 
   3.654126881359337*^9}, {3.6541269393824577`*^9, 3.654126959132009*^9}, {
   3.654127079773924*^9, 3.654127194954756*^9}, {3.654127229244482*^9, 
   3.654127253953713*^9}, {3.6541278694900227`*^9, 3.654127878663176*^9}, {
   3.654127969775614*^9, 3.6541279938293123`*^9}, {3.654128051763153*^9, 
   3.654128134016169*^9}, {3.654128326830834*^9, 3.654128326972948*^9}, {
   3.654182305132535*^9, 3.654182317491791*^9}, {3.65418238746202*^9, 
   3.654182511491269*^9}, {3.654182551115921*^9, 3.654182559209998*^9}, {
   3.6541826265390177`*^9, 3.654182732425318*^9}, {3.654182795218339*^9, 
   3.654182802306821*^9}, {3.654182858360195*^9, 3.654182976637673*^9}, {
   3.65418309291822*^9, 3.6541831115452337`*^9}, {3.654183280620055*^9, 
   3.654183381285778*^9}, {3.6541834216733217`*^9, 3.65418343026462*^9}, {
   3.65418347398075*^9, 3.654183479016459*^9}, {3.654183517743698*^9, 
   3.654183590244978*^9}, {3.654183629340012*^9, 3.654183659551435*^9}, {
   3.654183828746057*^9, 3.654183869187777*^9}, {3.654183918271063*^9, 
   3.6541839184304667`*^9}, {3.654206461375032*^9, 3.6542064948942213`*^9}, {
   3.6542065261576433`*^9, 3.654206710642645*^9}, {3.65420685898112*^9, 
   3.654206859498214*^9}, {3.654206912388175*^9, 3.6542069199221067`*^9}, {
   3.654206956850091*^9, 3.654206957769821*^9}, {3.6542070885864773`*^9, 
   3.6542070905801163`*^9}, {3.6542071861274023`*^9, 3.654207197287834*^9}, {
   3.654207355631957*^9, 3.65420737546005*^9}, {3.654207422116619*^9, 
   3.6542074295958633`*^9}, {3.654207513008601*^9, 3.654207622631179*^9}, {
   3.6542077902321663`*^9, 3.6542079082040863`*^9}, {3.654208112675095*^9, 
   3.6542082406765347`*^9}, {3.654208390436673*^9, 3.654208437282127*^9}, {
   3.654208729398788*^9, 3.6542088242969923`*^9}, {3.654208875181876*^9, 
   3.6542089105814543`*^9}, {3.654209036563011*^9, 3.654209042056604*^9}, {
   3.654209131808134*^9, 3.654209211748107*^9}, {3.654277910558556*^9, 
   3.654277962902483*^9}, {3.6542785554956903`*^9, 3.654278555764879*^9}, {
   3.6542801407928543`*^9, 3.654280145647377*^9}, {3.654280336511973*^9, 
   3.654280388661951*^9}, {3.654735519742467*^9, 3.654735526212496*^9}, {
   3.654736711632904*^9, 3.654736744359725*^9}, {3.654736840726715*^9, 
   3.6547369027091503`*^9}, {3.6547369619155817`*^9, 3.65473711893006*^9}, 
   3.654737215212165*^9, {3.6547372623430433`*^9, 3.654737301717353*^9}, {
   3.654737434898181*^9, 3.654737445769989*^9}, {3.654737593349925*^9, 
   3.654737893647337*^9}, {3.654737938282483*^9, 3.654737939560112*^9}, {
   3.654737995469615*^9, 3.65473804382544*^9}, {3.65473814244207*^9, 
   3.65473826286047*^9}, {3.654738473301898*^9, 3.654738519313912*^9}, {
   3.654738551955141*^9, 3.654738559351729*^9}, {3.654738599129403*^9, 
   3.654738599566987*^9}, {3.654738653005966*^9, 3.654738704434928*^9}, {
   3.654738885183668*^9, 3.654738922018218*^9}, {3.654739011880048*^9, 
   3.65473910917871*^9}, {3.654739159170903*^9, 3.654739162120161*^9}, {
   3.6547393230277576`*^9, 3.6547393764227123`*^9}, {3.654739415181912*^9, 
   3.65473942023728*^9}, {3.654739453135948*^9, 3.654739679965816*^9}, {
   3.654739718627033*^9, 3.6547397334487553`*^9}, {3.654739765385715*^9, 
   3.654739851694334*^9}, {3.654739889466123*^9, 3.654740005071364*^9}, {
   3.6547400491757*^9, 3.654740154008595*^9}, 3.654740216700787*^9, {
   3.654740314399178*^9, 3.6547403286014967`*^9}, 3.6547403850818996`*^9, {
   3.654740521314966*^9, 3.654740541208376*^9}, {3.65474063388687*^9, 
   3.654740654515286*^9}, {3.654740701345427*^9, 3.654740810460566*^9}, {
   3.654740848239312*^9, 3.654741082783293*^9}, {3.654741274225429*^9, 
   3.65474127713437*^9}, 3.654741426789631*^9, {3.6547414571147537`*^9, 
   3.654741569824174*^9}, {3.654741604551594*^9, 3.65474161887015*^9}, {
   3.6547416933496304`*^9, 3.654741709459137*^9}, {3.654741935230948*^9, 
   3.654741945307493*^9}, {3.6547830386167917`*^9, 3.654783105454197*^9}, {
   3.6547832406606083`*^9, 3.6547832525310373`*^9}, {3.654783794511154*^9, 
   3.654783837663447*^9}, {3.65478390359721*^9, 3.654783909803577*^9}, {
   3.654783989474423*^9, 3.654784403124803*^9}, {3.654784520313846*^9, 
   3.654784622329711*^9}, {3.6547847231449842`*^9, 3.654784727983326*^9}, {
   3.654785122876478*^9, 3.654785187751635*^9}, {3.654785255283667*^9, 
   3.654785472044736*^9}, {3.654785554330287*^9, 3.6547855634367*^9}, {
   3.6547858133842907`*^9, 3.654785842420493*^9}, {3.654785988696732*^9, 
   3.654785999313698*^9}, {3.654786083383224*^9, 3.654786083827299*^9}, {
   3.654799998454865*^9, 3.654800009014682*^9}, 3.654800058896707*^9, {
   3.6548001027328*^9, 3.654800173381201*^9}, {3.654800206111162*^9, 
   3.654800346038969*^9}, {3.654800415767541*^9, 3.654800685527397*^9}, {
   3.654800717895743*^9, 3.6548007259529123`*^9}, {3.6548007560240192`*^9, 
   3.654800892868227*^9}, {3.654800961067473*^9, 3.6548010443125353`*^9}, {
   3.654801144205307*^9, 3.6548013970409203`*^9}, {3.654801447723054*^9, 
   3.6548014700938597`*^9}, {3.654801562889327*^9, 3.6548017505389137`*^9}, {
   3.6548017965315866`*^9, 3.654801838591158*^9}, {3.654801925163512*^9, 
   3.654801957336872*^9}, {3.654802037838778*^9, 3.654802097667626*^9}, {
   3.6548021338675137`*^9, 3.654802151746142*^9}, {3.6548021938035927`*^9, 
   3.65480226557542*^9}, {3.6548023434469347`*^9, 3.6548024564595747`*^9}, {
   3.654802493167995*^9, 3.654802498462143*^9}, {3.654802632969117*^9, 
   3.654802636326886*^9}, {3.6548026864101667`*^9, 3.6548027624957323`*^9}, {
   3.654802812209731*^9, 3.6548030159498*^9}, {3.6548066359524317`*^9, 
   3.654806720935005*^9}, {3.654806751992766*^9, 3.6548067587144833`*^9}, {
   3.654806821497799*^9, 3.654806889382121*^9}, {3.654807006283039*^9, 
   3.654807210369132*^9}, {3.654807340425975*^9, 3.6548074184588003`*^9}, {
   3.6548074913193197`*^9, 3.654807699931301*^9}, 3.6548078200861998`*^9, {
   3.654807890939335*^9, 3.65480791502777*^9}, {3.654807960842239*^9, 
   3.6548080712336483`*^9}, {3.654808128338978*^9, 3.6548081799548407`*^9}, {
   3.6548101758929577`*^9, 3.654810330104765*^9}, {3.654810401423953*^9, 
   3.654810408457419*^9}, {3.6548104718702717`*^9, 3.6548106690676603`*^9}, {
   3.6548107121438303`*^9, 3.6548108463298893`*^9}, {3.654810878513033*^9, 
   3.6548109250220337`*^9}, {3.654810973064028*^9, 3.6548109963255377`*^9}, {
   3.654811065383171*^9, 3.65481111435124*^9}, {3.6548111568410273`*^9, 
   3.654811165569319*^9}, {3.654811202562601*^9, 3.654811649746052*^9}, {
   3.657067656153129*^9, 3.657067660941557*^9}, {3.6570766750689*^9, 
   3.657076677028944*^9}, {3.658274451899232*^9, 3.6582744912918463`*^9}, {
   3.6583703518545094`*^9, 3.65837035300604*^9}, {3.6755988080579853`*^9, 
   3.675598809147863*^9}, {3.67559891787045*^9, 3.675598943668881*^9}, {
   3.675599076607477*^9, 3.675599086502984*^9}, {3.675599163344201*^9, 
   3.675599246140224*^9}, {3.675599495513714*^9, 3.675599501889613*^9}, {
   3.6756003985310173`*^9, 3.67560041869237*^9}, {3.675600613139152*^9, 
   3.675600616115411*^9}, {3.675600652001363*^9, 3.6756006755021143`*^9}, {
   3.675600735634182*^9, 3.6756007488548737`*^9}, {3.67560092599559*^9, 
   3.675600966443502*^9}, 3.67561176087851*^9, {3.675614302769956*^9, 
   3.675614306885004*^9}, {3.675614423023447*^9, 3.675614423525736*^9}, 
   3.678096161809099*^9, {3.689124390276373*^9, 3.6891244327234344`*^9}, 
   3.6904655248817186`*^9, {3.6904657025972514`*^9, 3.6904657281132965`*^9}, {
   3.690465837887202*^9, 3.6904659438953967`*^9}, {3.6904660709156213`*^9, 
   3.6904660860717483`*^9}, {3.6904661740336037`*^9, 3.690466204669458*^9}, {
   3.690466287340516*^9, 3.6904663114681587`*^9}, {3.690466356136339*^9, 
   3.690466371287966*^9}, {3.690466405029338*^9, 3.6904664909169974`*^9}, {
   3.6904665250646596`*^9, 3.690466648441888*^9}, {3.690466693050069*^9, 
   3.690466820960202*^9}, {3.6904668777386026`*^9, 3.6904668854918165`*^9}, {
   3.690466979476494*^9, 3.690466999505231*^9}, {3.690467043933509*^9, 
   3.6904670502203207`*^9}, {3.6904671421806884`*^9, 
   3.6904672154541245`*^9}, {3.6904761776892157`*^9, 
   3.6904761866748314`*^9}, {3.690853707533787*^9, 3.6908537180965414`*^9}, {
   3.690853754712088*^9, 3.6908538141704364`*^9}, 3.6908539660488844`*^9, {
   3.6908546093581734`*^9, 3.6908546307019024`*^9}, {3.6908548189158974`*^9, 
   3.690854823667144*^9}, {3.690854870014203*^9, 3.6908549195384235`*^9}, {
   3.690855006521449*^9, 3.690855014308058*^9}, 3.690855083439123*^9, {
   3.69246983542494*^9, 3.6924699200499463`*^9}, 3.693099537023243*^9, {
   3.693153642338909*^9, 3.6931536540233293`*^9}, {3.6931907105719614`*^9, 
   3.693190710899562*^9}},ExpressionUUID->"cb2b4b25-a328-4451-b1a7-\
53449ff8db62"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"MatrixLog6", "[", "T_", "]"}], ":", "\[IndentingNewLine]", 
     "   ", 
     RowBox[{
     "Takes", " ", "a", " ", "transformation", " ", "matrix", " ", "T", " ", 
      "in", " ", "SE", 
      RowBox[{
       RowBox[{"(", "3", ")"}], ".", "\[IndentingNewLine]", "Returns"}], " ", 
      "the", " ", "corresponding", " ", "se", 
      RowBox[{"(", "3", ")"}], " ", "representation", " ", "of", " ", 
      "exponential", " ", 
      RowBox[{"coordinates", "."}]}]}], "\[IndentingNewLine]", ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "Example", ":", "\[IndentingNewLine]", "Input", ":", " ", "se3mat"}], 
     " ", "=", " ", 
     RowBox[{
      RowBox[{
       RowBox[{"MatrixLog6", "[", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", 
            RowBox[{"-", "1"}], ",", "0"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1", ",", "0", ",", "3"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}], "]"}],
        "//", "MatrixForm"}], "//", 
      RowBox[{"N", "\[IndentingNewLine]", 
       RowBox[{"Output", ":", " ", 
        TagBox[
         RowBox[{"(", "\[NoBreak]", GridBox[{
            {"0.", "0.", "0.", "0."},
            {"0.", "0.", 
             RowBox[{"-", "1.5707963267948966"}], "2.356194490192345"},
            {"0.", "1.5707963267948966", "0.", "2.356194490192345"},
            {"0.", "0.", "0.", "0."}
           },
           
           GridBoxAlignment->{
            "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
             "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
           GridBoxSpacings->{"Columns" -> {
               Offset[0.27999999999999997`], {
                Offset[0.7]}, 
               Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
               Offset[0.2], {
                Offset[0.4]}, 
               Offset[0.2]}, "RowsIndexed" -> {}}], ")"}],
         Function[BoxForm`e$, 
          MatrixForm[BoxForm`e$]]]}]}]}]}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MatrixLog6", "[", "T_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"R", ",", "p", ",", "acosinput", ",", "theta", ",", "omgmat"}],
        "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"R", ",", "p"}], "}"}], "=", 
        RowBox[{"TransToRp", "[", "T", "]"}]}], ";", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{"NearZero", "[", 
          RowBox[{"Norm", "[", 
           RowBox[{"R", "-", 
            RowBox[{"IdentityMatrix", "[", "3", "]"}]}], "]"}], "]"}], ",", 
         RowBox[{"ArrayFlatten", "[", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"ConstantArray", "[", 
               RowBox[{"0", ",", 
                RowBox[{"{", 
                 RowBox[{"3", ",", "3"}], "}"}]}], "]"}], ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"T", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"1", ";;", "3"}], ",", "4"}], "]"}], "]"}], "}"}], 
               "\[Transpose]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0"}], "}"}]}], "}"}], "]"}], ",", 
         RowBox[{
          RowBox[{"acosinput", "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Tr", "[", "R", "]"}], "-", "1"}], ")"}], "/", "2"}]}], 
          ";", 
          RowBox[{"Which", "[", 
           RowBox[{
            RowBox[{"acosinput", ">", "1"}], ",", 
            RowBox[{"acosinput", "=", "1"}], ",", 
            RowBox[{"acosinput", "<", 
             RowBox[{"-", "1"}]}], ",", 
            RowBox[{"acosinput", "=", 
             RowBox[{"-", "1"}]}]}], "]"}], ";", 
          RowBox[{"theta", "=", 
           RowBox[{"ArcCos", "[", "acosinput", "]"}]}], ";", 
          RowBox[{"omgmat", "=", 
           RowBox[{"MatrixLog3", "[", "R", "]"}]}], ";", 
          RowBox[{"Return", "[", 
           RowBox[{"ArrayFlatten", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"omgmat", ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"IdentityMatrix", "[", "3", "]"}], "-", 
                   RowBox[{"omgmat", "/", "2"}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"1", "/", "theta"}], "-", 
                    RowBox[{
                    RowBox[{"Cot", "[", 
                    RowBox[{"theta", "/", "2"}], "]"}], "/", "2"}]}], ")"}], 
                    "*", 
                    RowBox[{
                    RowBox[{"omgmat", ".", "omgmat"}], "/", "theta"}]}]}], 
                  ")"}], ".", "p"}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "0"}], "}"}]}], "}"}], "]"}], "]"}]}]}], 
        "]"}]}]}], "]"}]}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"ProjectToSO3", "[", "mat_", "]"}], ":", "\[IndentingNewLine]", 
      "  ", 
      RowBox[{
       RowBox[{"Takes", " ", "a", " ", "matrix", " ", "near", " ", "SO", 
        RowBox[{"(", "3", ")"}], " ", "to", " ", "project", " ", "to", " ", 
        "SO", 
        RowBox[{
         RowBox[{"(", "3", ")"}], ".", "\[IndentingNewLine]", "Returns"}], 
        " ", "the", " ", "closest", " ", "rotation", " ", "matrix", " ", 
        "that", " ", "is", " ", "in", " ", "SO", 
        RowBox[{
         RowBox[{"(", "3", ")"}], ".", "\[IndentingNewLine]", "This"}], " ", 
        "function", " ", "uses", " ", "singular"}], "-", 
       RowBox[{
       "value", " ", "decomposition", " ", "and", " ", "is", " ", "only", " ",
         "compatible", " ", "with", " ", "matrices", " ", "close", " ", "to", 
        " ", "SO", 
        RowBox[{
         RowBox[{"(", "3", ")"}], "."}]}]}]}], "\[IndentingNewLine]", ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Example", ":", "\[IndentingNewLine]", "Input", ":", " ", "R"}],
       " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"ProjectToSO3", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0.675", ",", "0.150", ",", "0.720"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.370", ",", "0.771", ",", 
             RowBox[{"-", "0.511"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "0.630"}], ",", "0.619", ",", "0.472"}], "}"}]}], 
          "}"}], "]"}], "//", "N"}], "//", 
       RowBox[{"MatrixForm", "\[IndentingNewLine]", 
        RowBox[{"Output", ":", " ", 
         TagBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"0.679011360677236", "0.14894516151550888", 
              "0.7188594514453904"},
             {"0.37320707882284543", "0.7731958439349471", 
              RowBox[{"-", "0.512722793757254"}]},
             {
              RowBox[{"-", "0.6321867195597888"}], "0.616428037797474", 
              "0.4694213734262528"}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], ")"}],
          Function[BoxForm`e$, 
           MatrixForm[BoxForm`e$]]]}]}]}]}]}], "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ProjectToSO3", "[", "mat_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"R", ",", "u", ",", "w", ",", "v"}], "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"u", ",", "w", ",", "v"}], "}"}], "=", 
        RowBox[{"SingularValueDecomposition", "[", "mat", "]"}]}], ";", 
       RowBox[{"R", "=", 
        RowBox[{"u", ".", 
         RowBox[{"v", "\[Transpose]"}]}]}], ";", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Det", "[", "R", "]"}], "<", "0"}], ",", 
         RowBox[{"Return", "[", 
          RowBox[{"ArrayFlatten", "[", 
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"R", "[", 
               RowBox[{"[", 
                RowBox[{";;", ",", 
                 RowBox[{"1", ";;", "2"}]}], "]"}], "]"}], ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"-", 
                 RowBox[{"R", "[", 
                  RowBox[{"[", 
                   RowBox[{";;", ",", "3"}], "]"}], "]"}]}], "}"}], 
               "\[Transpose]"}]}], "}"}], "}"}], "]"}], "]"}], ",", 
         RowBox[{"Return", "[", "R", "]"}]}], "]"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
      RowBox[{"ProjectToSE3", "[", "mat_", "]"}], ":", "\[IndentingNewLine]", 
      "  ", 
      RowBox[{
       RowBox[{"Takes", " ", "a", " ", "matrix", " ", "near", " ", "SE", 
        RowBox[{"(", "3", ")"}], " ", "to", " ", "project", " ", "to", " ", 
        "SE", 
        RowBox[{
         RowBox[{"(", "3", ")"}], ".", "\[IndentingNewLine]", "Returns"}], 
        " ", "the", " ", "closest", " ", "rotation", " ", "matrix", " ", 
        "that", " ", "is", " ", "in", " ", "SE", 
        RowBox[{
         RowBox[{"(", "3", ")"}], ".", "\[IndentingNewLine]", "This"}], " ", 
        "function", " ", "uses", " ", "singular"}], "-", 
       RowBox[{
       "value", " ", "decomposition", " ", "and", " ", "is", " ", "only", " ",
         "compatible", " ", "with", " ", "matrices", " ", "close", " ", "to", 
        " ", "SE", 
        RowBox[{
         RowBox[{"(", "3", ")"}], "."}]}]}]}], "\[IndentingNewLine]", ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Example", ":", "\[IndentingNewLine]", "Input", ":", " ", "T"}],
       " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"ProjectToSE3", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0.675", ",", "0.150", ",", "0.720", ",", "1.2"}], "}"}], 
           ",", 
           RowBox[{"{", 
            RowBox[{"0.370", ",", "0.771", ",", 
             RowBox[{"-", "0.511"}], ",", "5.4"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "0.630"}], ",", "0.619", ",", "0.472", ",", "3.6"}],
             "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.003", ",", "0.002", ",", "0.010", ",", "0.9"}], 
            "}"}]}], "}"}], "]"}], "//", "N"}], "//", 
       RowBox[{"MatrixForm", "\[IndentingNewLine]", 
        RowBox[{"Output", ":", " ", 
         TagBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"0.679011360677236", "0.14894516151550888", 
              "0.7188594514453904", "1.2"},
             {"0.37320707882284543", "0.7731958439349471", 
              RowBox[{"-", "0.512722793757254"}], "5.4"},
             {
              RowBox[{"-", "0.6321867195597888"}], "0.616428037797474", 
              "0.4694213734262528", "3.6"},
             {"0.", "0.", "0.", "1."}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
          Function[BoxForm`e$, 
           MatrixForm[BoxForm`e$]]]}]}]}]}]}], "\[IndentingNewLine]", "*)"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ProjectToSE3", "[", "mat_", "]"}], ":=", 
    RowBox[{"RpToTrans", "[", 
     RowBox[{
      RowBox[{"ProjectToSO3", "[", 
       RowBox[{"mat", "[", 
        RowBox[{"[", 
         RowBox[{
          RowBox[{"1", ";;", "3"}], ",", 
          RowBox[{"1", ";;", "3"}]}], "]"}], "]"}], "]"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"mat", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"1", ";;", "3"}], ",", "4"}], "]"}], "]"}], "}"}], 
       "\[Transpose]"}]}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.654107438701495*^9, 3.6541075770931664`*^9}, {
   3.6541076103152647`*^9, 3.654107726674172*^9}, {3.654107800327899*^9, 
   3.654107805926005*^9}, {3.654107842157054*^9, 3.654107956534466*^9}, {
   3.6541080276373253`*^9, 3.654108039845397*^9}, {3.654108208328875*^9, 
   3.654108267778264*^9}, {3.654108316603101*^9, 3.65410832858707*^9}, {
   3.654122072990996*^9, 3.654122200142358*^9}, {3.654122232524707*^9, 
   3.6541222637488813`*^9}, {3.654122372486209*^9, 3.65412253592478*^9}, {
   3.654122571686759*^9, 3.654122685636675*^9}, {3.654122740902017*^9, 
   3.6541228215630703`*^9}, {3.654122865671712*^9, 3.654122935620612*^9}, {
   3.654123032181581*^9, 3.6541230914473333`*^9}, {3.654123152783122*^9, 
   3.6541232043612537`*^9}, {3.654123304611115*^9, 3.654123341073502*^9}, {
   3.654123502235703*^9, 3.654123578362132*^9}, {3.654123664279245*^9, 
   3.654123683195951*^9}, {3.6541237878998413`*^9, 3.6541238249788847`*^9}, {
   3.654123940392714*^9, 3.654123947510108*^9}, {3.654124026309593*^9, 
   3.654124026885428*^9}, 3.6541241152729683`*^9, 3.654124170343902*^9, {
   3.6541246995439568`*^9, 3.654124712871656*^9}, {3.6541251843297157`*^9, 
   3.654125231518578*^9}, {3.6541254856851683`*^9, 3.65412548908077*^9}, {
   3.654125547742125*^9, 3.654125551165526*^9}, {3.654125930807577*^9, 
   3.654126007244483*^9}, {3.654126127665163*^9, 3.654126191634789*^9}, {
   3.654126236482831*^9, 3.654126250153975*^9}, {3.6541262848658533`*^9, 
   3.654126288991514*^9}, {3.654126323055903*^9, 3.654126399729628*^9}, {
   3.654126435349374*^9, 3.654126447266036*^9}, {3.654126530077552*^9, 
   3.6541265937421*^9}, {3.654126679867402*^9, 3.6541267650289497`*^9}, {
   3.6541267969631968`*^9, 3.654126798410089*^9}, {3.654126829860013*^9, 
   3.654126881359337*^9}, {3.6541269393824577`*^9, 3.654126959132009*^9}, {
   3.654127079773924*^9, 3.654127194954756*^9}, {3.654127229244482*^9, 
   3.654127253953713*^9}, {3.6541278694900227`*^9, 3.654127878663176*^9}, {
   3.654127969775614*^9, 3.6541279938293123`*^9}, {3.654128051763153*^9, 
   3.654128134016169*^9}, {3.654128326830834*^9, 3.654128326972948*^9}, {
   3.654182305132535*^9, 3.654182317491791*^9}, {3.65418238746202*^9, 
   3.654182511491269*^9}, {3.654182551115921*^9, 3.654182559209998*^9}, {
   3.6541826265390177`*^9, 3.654182732425318*^9}, {3.654182795218339*^9, 
   3.654182802306821*^9}, {3.654182858360195*^9, 3.654182976637673*^9}, {
   3.65418309291822*^9, 3.6541831115452337`*^9}, {3.654183280620055*^9, 
   3.654183381285778*^9}, {3.6541834216733217`*^9, 3.65418343026462*^9}, {
   3.65418347398075*^9, 3.654183479016459*^9}, {3.654183517743698*^9, 
   3.654183590244978*^9}, {3.654183629340012*^9, 3.654183659551435*^9}, {
   3.654183828746057*^9, 3.654183869187777*^9}, {3.654183918271063*^9, 
   3.6541839184304667`*^9}, {3.654206461375032*^9, 3.6542064948942213`*^9}, {
   3.6542065261576433`*^9, 3.654206710642645*^9}, {3.65420685898112*^9, 
   3.654206859498214*^9}, {3.654206912388175*^9, 3.6542069199221067`*^9}, {
   3.654206956850091*^9, 3.654206957769821*^9}, {3.6542070885864773`*^9, 
   3.6542070905801163`*^9}, {3.6542071861274023`*^9, 3.654207197287834*^9}, {
   3.654207355631957*^9, 3.65420737546005*^9}, {3.654207422116619*^9, 
   3.6542074295958633`*^9}, {3.654207513008601*^9, 3.654207622631179*^9}, {
   3.6542077902321663`*^9, 3.6542079082040863`*^9}, {3.654208112675095*^9, 
   3.6542082406765347`*^9}, {3.654208390436673*^9, 3.654208437282127*^9}, {
   3.654208729398788*^9, 3.6542088242969923`*^9}, {3.654208875181876*^9, 
   3.6542089105814543`*^9}, {3.654209036563011*^9, 3.654209042056604*^9}, {
   3.654209131808134*^9, 3.654209211748107*^9}, {3.654277910558556*^9, 
   3.654277962902483*^9}, {3.6542785554956903`*^9, 3.654278555764879*^9}, {
   3.6542801407928543`*^9, 3.654280145647377*^9}, {3.654280336511973*^9, 
   3.654280388661951*^9}, {3.654735519742467*^9, 3.654735526212496*^9}, {
   3.654736711632904*^9, 3.654736744359725*^9}, {3.654736840726715*^9, 
   3.6547369027091503`*^9}, {3.6547369619155817`*^9, 3.65473711893006*^9}, 
   3.654737215212165*^9, {3.6547372623430433`*^9, 3.654737301717353*^9}, {
   3.654737434898181*^9, 3.654737445769989*^9}, {3.654737593349925*^9, 
   3.654737893647337*^9}, {3.654737938282483*^9, 3.654737939560112*^9}, {
   3.654737995469615*^9, 3.65473804382544*^9}, {3.65473814244207*^9, 
   3.65473826286047*^9}, {3.654738473301898*^9, 3.654738519313912*^9}, {
   3.654738551955141*^9, 3.654738559351729*^9}, {3.654738599129403*^9, 
   3.654738599566987*^9}, {3.654738653005966*^9, 3.654738704434928*^9}, {
   3.654738885183668*^9, 3.654738922018218*^9}, {3.654739011880048*^9, 
   3.65473910917871*^9}, {3.654739159170903*^9, 3.654739162120161*^9}, {
   3.6547393230277576`*^9, 3.6547393764227123`*^9}, {3.654739415181912*^9, 
   3.65473942023728*^9}, {3.654739453135948*^9, 3.654739679965816*^9}, {
   3.654739718627033*^9, 3.6547397334487553`*^9}, {3.654739765385715*^9, 
   3.654739851694334*^9}, {3.654739889466123*^9, 3.654740005071364*^9}, {
   3.6547400491757*^9, 3.654740154008595*^9}, 3.654740216700787*^9, {
   3.654740314399178*^9, 3.6547403286014967`*^9}, 3.6547403850818996`*^9, {
   3.654740521314966*^9, 3.654740541208376*^9}, {3.65474063388687*^9, 
   3.654740654515286*^9}, {3.654740701345427*^9, 3.654740810460566*^9}, {
   3.654740848239312*^9, 3.654741082783293*^9}, {3.654741274225429*^9, 
   3.65474127713437*^9}, 3.654741426789631*^9, {3.6547414571147537`*^9, 
   3.654741569824174*^9}, {3.654741604551594*^9, 3.65474161887015*^9}, {
   3.6547416933496304`*^9, 3.654741709459137*^9}, {3.654741935230948*^9, 
   3.654741945307493*^9}, {3.6547830386167917`*^9, 3.654783105454197*^9}, {
   3.6547832406606083`*^9, 3.6547832525310373`*^9}, {3.654783794511154*^9, 
   3.654783837663447*^9}, {3.65478390359721*^9, 3.654783909803577*^9}, {
   3.654783989474423*^9, 3.654784403124803*^9}, {3.654784520313846*^9, 
   3.654784622329711*^9}, {3.6547847231449842`*^9, 3.654784727983326*^9}, {
   3.654785122876478*^9, 3.654785187751635*^9}, {3.654785255283667*^9, 
   3.654785472044736*^9}, {3.654785554330287*^9, 3.6547855634367*^9}, {
   3.6547858133842907`*^9, 3.654785842420493*^9}, {3.654785988696732*^9, 
   3.654785999313698*^9}, {3.654786083383224*^9, 3.654786083827299*^9}, {
   3.654799998454865*^9, 3.654800009014682*^9}, 3.654800058896707*^9, {
   3.6548001027328*^9, 3.654800173381201*^9}, {3.654800206111162*^9, 
   3.654800346038969*^9}, {3.654800415767541*^9, 3.654800685527397*^9}, {
   3.654800717895743*^9, 3.6548007259529123`*^9}, {3.6548007560240192`*^9, 
   3.654800892868227*^9}, {3.654800961067473*^9, 3.6548010443125353`*^9}, {
   3.654801144205307*^9, 3.6548013970409203`*^9}, {3.654801447723054*^9, 
   3.6548014700938597`*^9}, {3.654801562889327*^9, 3.6548017505389137`*^9}, {
   3.6548017965315866`*^9, 3.654801838591158*^9}, {3.654801925163512*^9, 
   3.654801957336872*^9}, {3.654802037838778*^9, 3.654802097667626*^9}, {
   3.6548021338675137`*^9, 3.654802151746142*^9}, {3.6548021938035927`*^9, 
   3.65480226557542*^9}, {3.6548023434469347`*^9, 3.6548024564595747`*^9}, {
   3.654802493167995*^9, 3.654802498462143*^9}, {3.654802632969117*^9, 
   3.654802636326886*^9}, {3.6548026864101667`*^9, 3.6548027624957323`*^9}, {
   3.654802812209731*^9, 3.6548030159498*^9}, {3.6548066359524317`*^9, 
   3.654806720935005*^9}, {3.654806751992766*^9, 3.6548067587144833`*^9}, {
   3.654806821497799*^9, 3.654806889382121*^9}, {3.654807006283039*^9, 
   3.654807210369132*^9}, {3.654807340425975*^9, 3.6548074184588003`*^9}, {
   3.6548074913193197`*^9, 3.654807699931301*^9}, 3.6548078200861998`*^9, {
   3.654807890939335*^9, 3.65480791502777*^9}, {3.654807960842239*^9, 
   3.6548080712336483`*^9}, {3.654808128338978*^9, 3.6548081799548407`*^9}, {
   3.6548101758929577`*^9, 3.654810330104765*^9}, {3.654810401423953*^9, 
   3.654810408457419*^9}, {3.6548104718702717`*^9, 3.6548106690676603`*^9}, {
   3.6548107121438303`*^9, 3.6548108463298893`*^9}, {3.654810878513033*^9, 
   3.6548109250220337`*^9}, {3.654810973064028*^9, 3.6548109963255377`*^9}, {
   3.654811065383171*^9, 3.65481111435124*^9}, {3.6548111568410273`*^9, 
   3.654811165569319*^9}, {3.654811202562601*^9, 3.654811649746052*^9}, {
   3.657067656153129*^9, 3.657067660941557*^9}, {3.6570766750689*^9, 
   3.657076677028944*^9}, {3.658274451899232*^9, 3.6582744912918463`*^9}, {
   3.6583703518545094`*^9, 3.65837035300604*^9}, {3.675601244578272*^9, 
   3.675601274744042*^9}, {3.675601332061564*^9, 3.6756013660455017`*^9}, {
   3.675601414151766*^9, 3.675601425123197*^9}, {3.6756015530027637`*^9, 
   3.675601569614365*^9}, {3.6756016074254293`*^9, 3.6756016077890882`*^9}, {
   3.675601716305842*^9, 3.675601756140202*^9}, 3.678096166990847*^9, {
   3.689098490580514*^9, 3.689098507300537*^9}, {3.689111564919878*^9, 
   3.689111586179908*^9}, 3.6891116904600563`*^9, {3.6891118051222205`*^9, 
   3.689111809086226*^9}, {3.689379383872934*^9, 3.6893794400131445`*^9}, {
   3.68938243800862*^9, 3.689382448001191*^9}, 3.689382610528487*^9, {
   3.6908553028715415`*^9, 3.690855319790837*^9}, {3.690855465409556*^9, 
   3.69085553112724*^9}, {3.6908555755599923`*^9, 3.690855621936455*^9}, {
   3.690855691278123*^9, 3.690855730212586*^9}, {3.69085576541925*^9, 
   3.6908557663243017`*^9}, {3.6908558009069347`*^9, 
   3.6908558302116833`*^9}, {3.6908558673282585`*^9, 
   3.6908558827748747`*^9}, {3.690855999875291*^9, 3.69085615320261*^9}, {
   3.6908561939683766`*^9, 3.690856456654299*^9}, {3.6924699265289583`*^9, 
   3.692469953753217*^9}, 3.693099537729245*^9, 3.6931536614021425`*^9, 
   3.6931536952074013`*^9, {3.7391158284028535`*^9, 3.739115846124895*^9}, {
   3.7391159048031483`*^9, 3.7391159068335824`*^9}, {3.739116238931116*^9, 
   3.73911626143726*^9}, {3.739116335724085*^9, 3.7391163382390027`*^9}, 
   3.739116387831684*^9, {3.7391166872658195`*^9, 3.7391167391645985`*^9}, 
   3.73911689622915*^9, {3.7391169899705286`*^9, 3.7391170057853622`*^9}, {
   3.739117092397702*^9, 3.739117111270105*^9}, {3.7391171757994213`*^9, 
   3.739117191161585*^9}, {3.7391201535470085`*^9, 3.739120155032319*^9}, {
   3.7391204662333665`*^9, 3.7391204820915923`*^9}, 3.739120835052953*^9, {
   3.7391208996490088`*^9, 3.73912091282839*^9}, {3.739121542939597*^9, 
   3.7391215559662857`*^9}, {3.7391224511166444`*^9, 3.739122457603085*^9}, {
   3.739122564870072*^9, 3.7391225688833127`*^9}, {3.739123129003651*^9, 
   3.7391231526767683`*^9}, {3.739123758931058*^9, 3.7391237867909555`*^9}, {
   3.7391239502498274`*^9, 3.7391240409630785`*^9}, {3.739124739958088*^9, 
   3.7391247482039185`*^9}, {3.7391264152358837`*^9, 
   3.739126432068795*^9}},ExpressionUUID->"30cfbd3e-57bb-4e33-99e1-\
c83444da6e3e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["CHAPTER  4: FORWARD KINEMATICS",
 FontSize->24,
 FontWeight->"Bold",
 FontColor->RGBColor[0, 0, 1]]], "Title",
 CellChangeTimes->{{3.6755319110417843`*^9, 3.675531927048277*^9}, {
  3.675531958735077*^9, 3.67553201284205*^9}, {3.675607857109823*^9, 
  3.6756079117244864`*^9}},ExpressionUUID->"2c8ea6eb-fa7d-47e8-92f0-\
27b5858ae3f0"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"FKinBody", "[", 
      RowBox[{"M_", ",", "Blist_", ",", "thetalist_"}], "]"}], ":", 
     "\[IndentingNewLine]", "   ", 
     RowBox[{"Takes", " ", "M"}], ":", " ", 
     RowBox[{
      RowBox[{"The", " ", "home", " ", "configuration", " ", 
       RowBox[{"(", 
        RowBox[{"position", " ", "and", " ", "orientation"}], ")"}], " ", 
       "of", " ", "the", " ", "end"}], "-", "effector"}]}], ",", 
    "\[IndentingNewLine]", "          ", 
    RowBox[{"Blist", ":", " ", 
     RowBox[{
      RowBox[{
      "The", " ", "joint", " ", "screw", " ", "axes", " ", "in", " ", "the", 
       " ", "end"}], "-", 
      RowBox[{
      "effector", " ", "frame", " ", "when", " ", "the", " ", "manipulator", 
       " ", "is", " ", "at", " ", "the", " ", "home", " ", "position"}]}]}], 
    ",", " ", 
    RowBox[{
    "in", " ", "the", " ", "format", " ", "of", " ", "a", " ", "matrix", " ", 
     "with", " ", "axes", " ", "as", " ", "the", " ", "columns"}], ",", 
    "\[IndentingNewLine]", "          ", 
    RowBox[{
     RowBox[{"thetalist", ":", " ", 
      RowBox[{
       RowBox[{"A", " ", "list", " ", "of", " ", "joint", " ", 
        RowBox[{"coordinates", ".", "\[IndentingNewLine]", "Returns"}], " ", 
        "T", " ", "in", " ", "SE", 
        RowBox[{"(", "3", ")"}], " ", "representing", " ", "the", " ", 
        "end"}], "-", 
       RowBox[{
       "effector", " ", "frame", " ", "when", " ", "the", " ", "joints", " ", 
        "are", " ", "at", " ", "the", " ", "specified", " ", "coordinates", 
        " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"i", ".", "t", ".", "o"}], " ", "Body", " ", "Frame"}], 
          ")"}], "."}]}]}]}], "\[IndentingNewLine]", ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Example", ":", "\[IndentingNewLine]", "Inputs", ":", 
       "\[IndentingNewLine]", "M"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "6"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", 
          RowBox[{"-", "1"}], ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\n", "  ", 
     RowBox[{"Blist", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           RowBox[{"-", "1"}], ",", "2", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0.1"}], 
          "}"}]}], "}"}], "\[Transpose]"}]}], ";", "\n", "  ", 
     RowBox[{"thetalist", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"Pi", "/", "2.0"}], ")"}], ",", "3", ",", "Pi"}], "}"}], 
        "}"}], "\[Transpose]"}]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"T", " ", "=", " ", 
      RowBox[{
       RowBox[{"FKinBody", "[", 
        RowBox[{"M", ",", "Blist", ",", "thetalist"}], "]"}], "//", 
       RowBox[{"MatrixForm", "\[IndentingNewLine]", 
        RowBox[{"Output", ":", " ", "\[IndentingNewLine]", 
         TagBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"0.", "1.", "0.", 
              RowBox[{"-", "5."}]},
             {"1.", "0.", "0.", "4."},
             {"0.", "0.", 
              RowBox[{"-", "1."}], "1.6858407346410207"},
             {"0.", "0.", "0.", "1."}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
          Function[BoxForm`e$, 
           MatrixForm[BoxForm`e$]]]}]}]}]}]}]}], "\[IndentingNewLine]", 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"FKinBody", "[", 
     RowBox[{"M_", ",", "Blist_", ",", "thetalist_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"n", ",", "T", ",", "i"}], "}"}], ",", 
      RowBox[{
       RowBox[{"T", "=", "M"}], ";", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"T", "=", 
          RowBox[{"T", ".", 
           RowBox[{"MatrixExp6", "[", 
            RowBox[{"VecTose3", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"Blist", "[", 
                 RowBox[{"[", 
                  RowBox[{";;", ",", "i"}], "]"}], "]"}], "}"}], 
               "\[Transpose]"}], "*", 
              RowBox[{"thetalist", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}], "]"}]}]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "thetalist", "]"}]}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "T", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.6755319110417843`*^9, 3.675531927048277*^9}, {
   3.675531958735077*^9, 3.675532032779791*^9}, {3.6755321540719852`*^9, 
   3.675532155394449*^9}, 3.67559226134205*^9, {3.675596340559066*^9, 
   3.675596342576479*^9}, {3.675608043908893*^9, 3.67560805615449*^9}, {
   3.6756083091754017`*^9, 3.675608326044199*^9}, {3.6756089089651537`*^9, 
   3.6756089115657463`*^9}, {3.675609347333695*^9, 3.6756093476969*^9}, {
   3.675614529395809*^9, 3.675614539340641*^9}, {3.675614717287609*^9, 
   3.6756147189544277`*^9}, {3.675614753634843*^9, 3.675614844854802*^9}, {
   3.6756150166027203`*^9, 3.6756150520677147`*^9}, {3.6756150854940557`*^9, 
   3.675615119635448*^9}, {3.67561583526125*^9, 3.675615944525145*^9}, {
   3.675615986252219*^9, 3.67561600346618*^9}, {3.676118088970602*^9, 
   3.676118088974634*^9}, {3.676119594877483*^9, 3.676119639850988*^9}, 
   3.6780961875824127`*^9, {3.690904713168393*^9, 3.690904724455039*^9}, {
   3.690905180246108*^9, 3.690905247655964*^9}, {3.690905481129318*^9, 
   3.6909055264869127`*^9}, {3.6909093445092907`*^9, 3.690909346678415*^9}, {
   3.690913217309802*^9, 3.6909132234171515`*^9}, {3.690913769452383*^9, 
   3.690913778017873*^9}, {3.69091678495786*^9, 3.6909168381479025`*^9}, {
   3.690916907209852*^9, 3.69091690908796*^9}, {3.690917071469248*^9, 
   3.6909171230241966`*^9}, {3.692471405863173*^9, 3.692471476641342*^9}, {
   3.6931537191066437`*^9, 3.69315372827946*^9}, {3.730652472624791*^9, 
   3.7306524732940173`*^9}},ExpressionUUID->"42e3cd6c-7142-4593-924a-\
642228db11d2"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"FKinSpace", "[", 
      RowBox[{"M_", ",", "Slist_", ",", "thetalist_"}], "]"}], ":", 
     "\[IndentingNewLine]", "    ", 
     RowBox[{"Takes", " ", "M"}], ":", " ", 
     RowBox[{
      RowBox[{"the", " ", "home", " ", "configuration", " ", 
       RowBox[{"(", 
        RowBox[{"position", " ", "and", " ", "orientation"}], ")"}], " ", 
       "of", " ", "the", " ", "end"}], "-", "effector"}]}], ",", 
    "\[IndentingNewLine]", "           ", 
    RowBox[{"Slist", ":", " ", 
     RowBox[{
     "The", " ", "joint", " ", "screw", " ", "axes", " ", "in", " ", "the", 
      " ", "space", " ", "frame", " ", "when", " ", "the", " ", "manipulator",
       " ", "is", " ", "at", " ", "the", " ", "home", " ", "position"}]}], 
    ",", " ", 
    RowBox[{
    "in", " ", "the", " ", "format", " ", "of", " ", "a", " ", "matrix", " ", 
     "with", " ", "screw", " ", "axes", " ", "as", " ", "the", " ", 
     "columns"}], ",", "\[IndentingNewLine]", "           ", 
    RowBox[{
     RowBox[{"thetalist", ":", " ", 
      RowBox[{
       RowBox[{"A", " ", "list", " ", "of", " ", "joint", " ", 
        RowBox[{"coordinates", ".", " ", "\[IndentingNewLine]", "Returns"}], 
        " ", "T", " ", "in", " ", "SE", 
        RowBox[{"(", "3", ")"}], " ", "representing", " ", "the", " ", 
        "end"}], "-", 
       RowBox[{
       "effector", " ", "frame", " ", "when", " ", "the", " ", "joints", " ", 
        "are", " ", "at", " ", "the", " ", "specified", " ", "coordinates", 
        " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"i", ".", "t", ".", "o"}], " ", "Fixed", " ", "Space", " ",
            "Frame"}], ")"}], "."}]}]}]}], "\[IndentingNewLine]", ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Example", ":", "\[IndentingNewLine]", "Inputs", ":", 
       "\[IndentingNewLine]", "M"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "6"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", 
          RowBox[{"-", "1"}], ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\n", "  ", 
     RowBox[{"Slist", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1", ",", "4", ",", "0", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           RowBox[{"-", "1"}], ",", 
           RowBox[{"-", "6"}], ",", "0", ",", 
           RowBox[{"-", "0.1"}]}], "}"}]}], "}"}], "\[Transpose]"}]}], ";", 
     "\n", "  ", 
     RowBox[{"thetalist", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Pi", "/", "2"}], ",", "3", ",", "Pi"}], "}"}], "}"}], 
       "\[Transpose]"}]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"T", " ", "=", " ", 
      RowBox[{
       RowBox[{"FKinSpace", "[", 
        RowBox[{"M", ",", "Slist", ",", "thetalist"}], "]"}], "//", 
       RowBox[{"MatrixForm", "\[IndentingNewLine]", 
        RowBox[{"Output", ":", " ", "\[IndentingNewLine]", 
         TagBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"0.", "1.", "0.", 
              RowBox[{"-", "5."}]},
             {"1.", "0.", "0.", "4.000000000000001"},
             {"0.", "0.", 
              RowBox[{"-", "1."}], "1.6858407346410207"},
             {"0.", "0.", "0.", "1."}
            },
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], ")"}],
          Function[BoxForm`e$, 
           MatrixForm[BoxForm`e$]]]}]}]}]}]}]}], "\[IndentingNewLine]", 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"FKinSpace", "[", 
     RowBox[{"M_", ",", "Slist_", ",", "thetalist_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"n", ",", "T"}], "}"}], ",", 
      RowBox[{
       RowBox[{"T", "=", "M"}], ";", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{"T", "=", 
          RowBox[{
           RowBox[{"MatrixExp6", "[", 
            RowBox[{"VecTose3", "[", 
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{"Slist", "[", 
                 RowBox[{"[", 
                  RowBox[{";;", ",", "i"}], "]"}], "]"}], "}"}], 
               "\[Transpose]"}], "*", 
              RowBox[{"thetalist", "[", 
               RowBox[{"[", 
                RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "]"}], "]"}], ".", 
           "T"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "thetalist", "]"}], ",", "1", ",", 
           RowBox[{"-", "1"}]}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "T", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.67561602324156*^9, 3.6756160562747183`*^9}, {
   3.675616098480197*^9, 3.6756162304999313`*^9}, {3.675616267860519*^9, 
   3.6756162750402412`*^9}, {3.675616305671249*^9, 3.675616309582301*^9}, {
   3.6756163906900806`*^9, 3.675616392204427*^9}, {3.675616509110962*^9, 
   3.675616528559065*^9}, {3.676118088983922*^9, 3.676118088989098*^9}, {
   3.6774897363386793`*^9, 3.6774897422094803`*^9}, {3.677489976352415*^9, 
   3.677489976705158*^9}, 3.6780961963052464`*^9, {3.69090928837708*^9, 
   3.690909520265343*^9}, {3.690913200376834*^9, 3.690913206713196*^9}, {
   3.6909137447619705`*^9, 3.6909137493342323`*^9}, 3.690914243936522*^9, {
   3.6909171313316717`*^9, 3.690917211043231*^9}, {3.690999375578245*^9, 
   3.690999384735461*^9}, {3.6924715529323044`*^9, 3.6924716042118273`*^9}, {
   3.693153734503871*^9, 3.693153743817087*^9}, {3.730652152397312*^9, 
   3.730652188763254*^9}},ExpressionUUID->"3e604bd8-121f-4823-845b-\
8af9015f2e0b"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["CHAPTER  5: VELOCITY KINEMATICS AND STATICS",
 FontSize->24,
 FontWeight->"Bold",
 FontColor->RGBColor[0, 0, 1]]], "Title",
 CellChangeTimes->{{3.6755319110417843`*^9, 3.675531927048277*^9}, {
  3.675531958735077*^9, 3.67553201284205*^9}, {3.675607857109823*^9, 
  3.6756079117244864`*^9}, {3.6756821024917507`*^9, 
  3.6756821283850946`*^9}},ExpressionUUID->"000ed3dd-e640-4394-bfdd-\
112e054fe39e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"JacobianBody", "[", 
      RowBox[{"Blist_", ",", "thetalist_"}], "]"}], ":", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"Takes", " ", "Blist"}], ":", " ", 
     RowBox[{
      RowBox[{
      "The", " ", "joint", " ", "screw", " ", "axes", " ", "in", " ", "the", 
       " ", "end"}], "-", 
      RowBox[{
      "effector", " ", "frame", " ", "when", " ", "the", " ", "manipulator", 
       " ", "is", " ", "at", " ", "the", " ", "home", " ", "position"}]}]}], 
    ",", " ", 
    RowBox[{
    "in", " ", "the", " ", "format", " ", "of", " ", "a", " ", "matrix", " ", 
     "with", " ", "axes", " ", "as", " ", "the", " ", "columns"}], ",", 
    "\[IndentingNewLine]", "         ", 
    RowBox[{
     RowBox[{"thetalist", ":", 
      RowBox[{"A", " ", "list", " ", "of", " ", "joint", " ", 
       RowBox[{"coordinates", ".", "\[IndentingNewLine]", "Returns"}], " ", 
       "the", " ", "corresponding", " ", "body", " ", "Jacobian", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"6", "xn", " ", "real", " ", "numbers"}], ")"}], "."}]}]}], 
     "\[IndentingNewLine]", ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Example", ":", "\[IndentingNewLine]", "Input", ":", 
       "\[IndentingNewLine]", "Blist"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1", ",", "0", ",", "0.2", ",", "0.2"}],
           "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0", ",", "2", ",", "0", ",", "3"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", "0", ",", "2", ",", "1"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
          "1", ",", "0", ",", "0", ",", "0.2", ",", "0.3", ",", "0.4"}], 
          "}"}]}], "}"}], "\[Transpose]"}]}], ";", "\n", 
     RowBox[{"thetalist", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0.2", ",", "1.1", ",", "0.1", ",", "1.2"}], "}"}], "}"}], 
       "\[Transpose]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Jb", "=", 
      RowBox[{
       RowBox[{"JacobianBody", "[", 
        RowBox[{"Blist", ",", "thetalist"}], "]"}], "//", 
       RowBox[{"MatrixForm", "\[IndentingNewLine]", 
        RowBox[{"Output", ":", "\[IndentingNewLine]", 
         TagBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {
              RowBox[{"-", "0.04528405057966491"}], "0.9950041652780258", 
              "0.", "1"},
             {"0.7435931265563965", "0.09304864640049498", 
              "0.3623577544766736", "0"},
             {
              RowBox[{"-", "0.6670971570177624"}], "0.03617541267787882", 
              RowBox[{"-", "0.9320390859672263"}], "0"},
             {"2.3258604714595155", "1.668090004953633", "0.5641083080438885",
               "0.2"},
             {
              RowBox[{"-", "1.4432116718196153"}], "2.945612749911765", 
              "1.4330652142884392", "0.3"},
             {
              RowBox[{"-", "2.066395648760265"}], "1.8288172246233696", 
              RowBox[{"-", "1.5886862785321807"}], "0.4"}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
          Function[BoxForm`e$, 
           MatrixForm[BoxForm`e$]]]}]}]}]}]}]}], "\[IndentingNewLine]", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"JacobianBody", "[", 
     RowBox[{"Blist_", ",", "thetalist_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Jb", "=", "Blist"}], ",", 
        RowBox[{"T", "=", 
         RowBox[{"IdentityMatrix", "[", "4", "]"}]}]}], "}"}], ",", 
      RowBox[{
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"T", "=", 
           RowBox[{"T", ".", 
            RowBox[{"MatrixExp6", "[", 
             RowBox[{"VecTose3", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"Blist", "[", 
                  RowBox[{"[", 
                   RowBox[{";;", ",", 
                    RowBox[{"i", "+", "1"}]}], "]"}], "]"}], "}"}], 
                "\[Transpose]"}], "*", 
               RowBox[{"-", 
                RowBox[{"thetalist", "[", 
                 RowBox[{"[", 
                  RowBox[{
                   RowBox[{"i", "+", "1"}], ",", "1"}], "]"}], "]"}]}]}], 
              "]"}], "]"}]}]}], ";", 
          RowBox[{
           RowBox[{"Jb", "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", "i"}], "]"}], "]"}], "=", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Adjoint", "[", "T", "]"}], ".", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Blist", "[", 
                RowBox[{"[", 
                 RowBox[{";;", ",", "i"}], "]"}], "]"}], "}"}], 
              "\[Transpose]"}]}], "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{
            RowBox[{"Length", "[", "thetalist", "]"}], "-", "1"}], ",", "1", 
           ",", 
           RowBox[{"-", "1"}]}], "}"}]}], "]"}], ";", 
       RowBox[{"Return", "[", "Jb", "]"}]}]}], "]"}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.654107438701495*^9, 3.6541075770931664`*^9}, {
   3.6541076103152647`*^9, 3.654107726674172*^9}, {3.654107800327899*^9, 
   3.654107805926005*^9}, {3.654107842157054*^9, 3.654107956534466*^9}, {
   3.6541080276373253`*^9, 3.654108039845397*^9}, {3.654108208328875*^9, 
   3.654108267778264*^9}, {3.654108316603101*^9, 3.65410832858707*^9}, {
   3.654122072990996*^9, 3.654122200142358*^9}, {3.654122232524707*^9, 
   3.6541222637488813`*^9}, {3.654122372486209*^9, 3.65412253592478*^9}, {
   3.654122571686759*^9, 3.654122685636675*^9}, {3.654122740902017*^9, 
   3.6541228215630703`*^9}, {3.654122865671712*^9, 3.654122935620612*^9}, {
   3.654123032181581*^9, 3.6541230914473333`*^9}, {3.654123152783122*^9, 
   3.6541232043612537`*^9}, {3.654123304611115*^9, 3.654123341073502*^9}, {
   3.654123502235703*^9, 3.654123578362132*^9}, {3.654123664279245*^9, 
   3.654123683195951*^9}, {3.6541237878998413`*^9, 3.6541238249788847`*^9}, {
   3.654123940392714*^9, 3.654123947510108*^9}, {3.654124026309593*^9, 
   3.654124026885428*^9}, 3.6541241152729683`*^9, 3.654124170343902*^9, {
   3.6541246995439568`*^9, 3.654124712871656*^9}, {3.6541251843297157`*^9, 
   3.654125231518578*^9}, {3.6541254856851683`*^9, 3.65412548908077*^9}, {
   3.654125547742125*^9, 3.654125551165526*^9}, {3.654125930807577*^9, 
   3.654126007244483*^9}, {3.654126127665163*^9, 3.654126191634789*^9}, {
   3.654126236482831*^9, 3.654126250153975*^9}, {3.6541262848658533`*^9, 
   3.654126288991514*^9}, {3.654126323055903*^9, 3.654126399729628*^9}, {
   3.654126435349374*^9, 3.654126447266036*^9}, {3.654126530077552*^9, 
   3.6541265937421*^9}, {3.654126679867402*^9, 3.6541267650289497`*^9}, {
   3.6541267969631968`*^9, 3.654126798410089*^9}, {3.654126829860013*^9, 
   3.654126881359337*^9}, {3.6541269393824577`*^9, 3.654126959132009*^9}, {
   3.654127079773924*^9, 3.654127194954756*^9}, {3.654127229244482*^9, 
   3.654127253953713*^9}, {3.6541278694900227`*^9, 3.654127878663176*^9}, {
   3.654127969775614*^9, 3.6541279938293123`*^9}, {3.654128051763153*^9, 
   3.654128134016169*^9}, {3.654128326830834*^9, 3.654128326972948*^9}, {
   3.654182305132535*^9, 3.654182317491791*^9}, {3.65418238746202*^9, 
   3.654182511491269*^9}, {3.654182551115921*^9, 3.654182559209998*^9}, {
   3.6541826265390177`*^9, 3.654182732425318*^9}, {3.654182795218339*^9, 
   3.654182802306821*^9}, {3.654182858360195*^9, 3.654182976637673*^9}, {
   3.65418309291822*^9, 3.6541831115452337`*^9}, {3.654183280620055*^9, 
   3.654183381285778*^9}, {3.6541834216733217`*^9, 3.65418343026462*^9}, {
   3.65418347398075*^9, 3.654183479016459*^9}, {3.654183517743698*^9, 
   3.654183590244978*^9}, {3.654183629340012*^9, 3.654183659551435*^9}, {
   3.654183828746057*^9, 3.654183869187777*^9}, {3.654183918271063*^9, 
   3.6541839184304667`*^9}, {3.654206461375032*^9, 3.6542064948942213`*^9}, {
   3.6542065261576433`*^9, 3.654206710642645*^9}, {3.65420685898112*^9, 
   3.654206859498214*^9}, {3.654206912388175*^9, 3.6542069199221067`*^9}, {
   3.654206956850091*^9, 3.654206957769821*^9}, {3.6542070885864773`*^9, 
   3.6542070905801163`*^9}, {3.6542071861274023`*^9, 3.654207197287834*^9}, {
   3.654207355631957*^9, 3.65420737546005*^9}, {3.654207422116619*^9, 
   3.6542074295958633`*^9}, {3.654207513008601*^9, 3.654207622631179*^9}, {
   3.6542077902321663`*^9, 3.6542079082040863`*^9}, {3.654208112675095*^9, 
   3.6542082406765347`*^9}, {3.654208390436673*^9, 3.654208437282127*^9}, {
   3.654208729398788*^9, 3.6542088242969923`*^9}, {3.654208875181876*^9, 
   3.6542089105814543`*^9}, {3.654209036563011*^9, 3.654209042056604*^9}, {
   3.654209131808134*^9, 3.654209211748107*^9}, {3.654277910558556*^9, 
   3.654277962902483*^9}, {3.6542785554956903`*^9, 3.654278555764879*^9}, {
   3.6542801407928543`*^9, 3.654280145647377*^9}, {3.654280336511973*^9, 
   3.654280388661951*^9}, {3.654735519742467*^9, 3.654735526212496*^9}, {
   3.654736711632904*^9, 3.654736744359725*^9}, {3.654736840726715*^9, 
   3.6547369027091503`*^9}, {3.6547369619155817`*^9, 3.65473711893006*^9}, 
   3.654737215212165*^9, {3.6547372623430433`*^9, 3.654737301717353*^9}, {
   3.654737434898181*^9, 3.654737445769989*^9}, {3.654737593349925*^9, 
   3.654737893647337*^9}, {3.654737938282483*^9, 3.654737939560112*^9}, {
   3.654737995469615*^9, 3.65473804382544*^9}, {3.65473814244207*^9, 
   3.65473826286047*^9}, {3.654738473301898*^9, 3.654738519313912*^9}, {
   3.654738551955141*^9, 3.654738559351729*^9}, {3.654738599129403*^9, 
   3.654738599566987*^9}, {3.654738653005966*^9, 3.654738704434928*^9}, {
   3.654738885183668*^9, 3.654738922018218*^9}, {3.654739011880048*^9, 
   3.65473910917871*^9}, {3.654739159170903*^9, 3.654739162120161*^9}, {
   3.6547393230277576`*^9, 3.6547393764227123`*^9}, {3.654739415181912*^9, 
   3.65473942023728*^9}, {3.654739453135948*^9, 3.654739679965816*^9}, {
   3.654739718627033*^9, 3.6547397334487553`*^9}, {3.654739765385715*^9, 
   3.654739851694334*^9}, {3.654739889466123*^9, 3.654740005071364*^9}, {
   3.6547400491757*^9, 3.654740154008595*^9}, 3.654740216700787*^9, {
   3.654740314399178*^9, 3.6547403286014967`*^9}, 3.6547403850818996`*^9, {
   3.654740521314966*^9, 3.654740541208376*^9}, {3.65474063388687*^9, 
   3.654740654515286*^9}, {3.654740701345427*^9, 3.654740810460566*^9}, {
   3.654740848239312*^9, 3.654741082783293*^9}, {3.654741274225429*^9, 
   3.65474127713437*^9}, 3.654741426789631*^9, {3.6547414571147537`*^9, 
   3.654741569824174*^9}, {3.654741604551594*^9, 3.65474161887015*^9}, {
   3.6547416933496304`*^9, 3.654741709459137*^9}, {3.654741935230948*^9, 
   3.654741945307493*^9}, {3.6547830386167917`*^9, 3.654783105454197*^9}, {
   3.6547832406606083`*^9, 3.6547832525310373`*^9}, {3.654783794511154*^9, 
   3.654783837663447*^9}, {3.65478390359721*^9, 3.654783909803577*^9}, {
   3.654783989474423*^9, 3.654784403124803*^9}, {3.654784520313846*^9, 
   3.654784622329711*^9}, {3.6547847231449842`*^9, 3.654784727983326*^9}, {
   3.654785122876478*^9, 3.654785187751635*^9}, {3.654785255283667*^9, 
   3.654785472044736*^9}, {3.654785554330287*^9, 3.6547855634367*^9}, {
   3.6547858133842907`*^9, 3.654785842420493*^9}, {3.654785988696732*^9, 
   3.654785999313698*^9}, {3.654786083383224*^9, 3.654786083827299*^9}, {
   3.654799998454865*^9, 3.654800009014682*^9}, 3.654800058896707*^9, {
   3.6548001027328*^9, 3.654800173381201*^9}, {3.654800206111162*^9, 
   3.654800346038969*^9}, {3.654800415767541*^9, 3.654800685527397*^9}, {
   3.654800717895743*^9, 3.6548007259529123`*^9}, {3.6548007560240192`*^9, 
   3.654800892868227*^9}, {3.654800961067473*^9, 3.6548010443125353`*^9}, {
   3.654801144205307*^9, 3.6548013970409203`*^9}, {3.654801447723054*^9, 
   3.6548014700938597`*^9}, {3.654801562889327*^9, 3.6548017505389137`*^9}, {
   3.6548017965315866`*^9, 3.654801838591158*^9}, {3.654801925163512*^9, 
   3.654801957336872*^9}, {3.654802037838778*^9, 3.654802097667626*^9}, {
   3.6548021338675137`*^9, 3.654802151746142*^9}, {3.6548021938035927`*^9, 
   3.65480226557542*^9}, {3.6548023434469347`*^9, 3.6548024564595747`*^9}, {
   3.654802493167995*^9, 3.654802498462143*^9}, {3.654802632969117*^9, 
   3.654802636326886*^9}, {3.6548026864101667`*^9, 3.6548027624957323`*^9}, {
   3.654802812209731*^9, 3.6548030159498*^9}, {3.6548066359524317`*^9, 
   3.654806720935005*^9}, {3.654806751992766*^9, 3.6548067587144833`*^9}, {
   3.654806821497799*^9, 3.654806889382121*^9}, {3.654807006283039*^9, 
   3.654807210369132*^9}, {3.654807340425975*^9, 3.6548074184588003`*^9}, {
   3.6548074913193197`*^9, 3.654807699931301*^9}, 3.6548078200861998`*^9, {
   3.654807890939335*^9, 3.65480791502777*^9}, {3.654807960842239*^9, 
   3.6548080712336483`*^9}, {3.654808128338978*^9, 3.6548081799548407`*^9}, {
   3.6548101758929577`*^9, 3.654810330104765*^9}, {3.654810401423953*^9, 
   3.654810408457419*^9}, {3.6548104718702717`*^9, 3.6548106690676603`*^9}, {
   3.6548107121438303`*^9, 3.6548108463298893`*^9}, {3.654810878513033*^9, 
   3.6548109250220337`*^9}, {3.654810973064028*^9, 3.6548109963255377`*^9}, {
   3.654811065383171*^9, 3.65481111435124*^9}, {3.6548111568410273`*^9, 
   3.654811165569319*^9}, {3.654811202562601*^9, 3.654811649746052*^9}, {
   3.657067656153129*^9, 3.657067660941557*^9}, {3.6570766750689*^9, 
   3.657076677028944*^9}, {3.658274451899232*^9, 3.6582744912918463`*^9}, {
   3.6583703518545094`*^9, 3.65837035300604*^9}, {3.675682824450754*^9, 
   3.6756828836706333`*^9}, {3.6756829858535852`*^9, 3.675683093476144*^9}, {
   3.675683163431617*^9, 3.675683301926485*^9}, {3.6756834458193197`*^9, 
   3.675683520674423*^9}, {3.675683569012762*^9, 3.675683584065415*^9}, 
   3.675683635500771*^9, {3.675684508273862*^9, 3.675684520687911*^9}, {
   3.676118088998353*^9, 3.6761180890027103`*^9}, {3.6780962114132557`*^9, 
   3.6780962222523317`*^9}, {3.690913621955947*^9, 3.6909136343216543`*^9}, {
   3.6909136679215755`*^9, 3.690913725619876*^9}, {3.690913797528989*^9, 
   3.6909138031643114`*^9}, {3.690914105377597*^9, 3.6909142142378235`*^9}, {
   3.6909142598524323`*^9, 3.6909143132884884`*^9}, {3.6909143596851425`*^9, 
   3.690914398644371*^9}, {3.690914598697813*^9, 3.690914613259646*^9}, {
   3.690914668211789*^9, 3.690914685903801*^9}, {3.690914747675334*^9, 
   3.69091474865139*^9}, {3.690914908730546*^9, 3.690914919761177*^9}, 
   3.690915080529372*^9, {3.6909151348674803`*^9, 3.69091517210761*^9}, {
   3.6909152557973967`*^9, 3.6909153375360723`*^9}, {3.6909172880516353`*^9, 
   3.690917438477239*^9}, {3.6909175950231934`*^9, 3.6909176033206673`*^9}, {
   3.690917683287242*^9, 3.6909176858573885`*^9}, {3.690917719940338*^9, 
   3.6909177389524255`*^9}, {3.6909853171351404`*^9, 3.690985339935088*^9}, {
   3.690985502174197*^9, 3.690985506302885*^9}, {3.6909855510623407`*^9, 
   3.6909856006920443`*^9}, 3.69098572316947*^9, {3.690985829611455*^9, 
   3.6909858397746425`*^9}, {3.690985881794064*^9, 3.69098589040903*^9}, {
   3.6909859209394445`*^9, 3.6909859300320067`*^9}, {3.690986739189022*^9, 
   3.6909867483930387`*^9}, {3.6909898070292606`*^9, 
   3.6909898474961324`*^9}, {3.690989877981586*^9, 3.690989899620225*^9}, {
   3.6909903529604497`*^9, 3.690990508746724*^9}, {3.6924716549023256`*^9, 
   3.69247168464919*^9}, {3.7306524812012043`*^9, 
   3.73065248177044*^9}},ExpressionUUID->"240e2dfc-5e90-4b05-a228-\
e4214db5aa73"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"JacobianSpace", "[", 
      RowBox[{"Slist_", ",", "thetalist_"}], "]"}], ":", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"Takes", " ", "Slist"}], ":", " ", 
     RowBox[{
     "The", " ", "joint", " ", "screw", " ", "axes", " ", "in", " ", "the", 
      " ", "space", " ", "frame", " ", "when", " ", "the", " ", "manipulator",
       " ", "is", " ", "at", " ", "the", " ", "home", " ", "position"}]}], 
    ",", " ", 
    RowBox[{
    "in", " ", "the", " ", "format", " ", "of", " ", "a", " ", "matrix", " ", 
     "with", " ", "axes", " ", "as", " ", "the", " ", "columns"}], ",", 
    "\[IndentingNewLine]", "         ", 
    RowBox[{
     RowBox[{"thetalist", ":", 
      RowBox[{"A", " ", "list", " ", "of", " ", "joint", " ", 
       RowBox[{"coordinates", ".", "\[IndentingNewLine]", "Returns"}], " ", 
       "the", " ", "corresponding", " ", "space", " ", "Jacobian", " ", 
       RowBox[{"(", 
        RowBox[{"6", "xn", " ", "real", " ", "numbers"}], ")"}]}]}], 
     "\[IndentingNewLine]", ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Example", ":", "\[IndentingNewLine]", "Input", ":", 
       "\[IndentingNewLine]", "Slist"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1", ",", "0", ",", "0.2", ",", "0.2"}],
           "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "0", ",", "2", ",", "0", ",", "3"}], 
          "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", "0", ",", "2", ",", "1"}], 
          "}"}], ",", " ", 
         RowBox[{"{", 
          RowBox[{
          "1", ",", "0", ",", "0", ",", "0.2", ",", "0.3", ",", "0.4"}], 
          "}"}]}], "}"}], "\[Transpose]"}]}], ";", "\n", 
     RowBox[{"thetalist", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0.2", ",", "1.1", ",", "0.1", ",", "1.2"}], "}"}], "}"}], 
       "\[Transpose]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Js", " ", "=", " ", 
      RowBox[{
       RowBox[{"JacobianSpace", "[", 
        RowBox[{"Slist", ",", " ", "thetalist"}], "]"}], "//", 
       RowBox[{"MatrixForm", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"Ouput", ":", "\[IndentingNewLine]", 
         TagBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"0", "0.9800665778412416", 
              RowBox[{"-", "0.09011563789485476"}], "0.957494264730031"},
             {"0", "0.19866933079506122", "0.4445543984476258", 
              "0.28487556541794845"},
             {"1", "0.", "0.8912073600614354", 
              RowBox[{"-", "0.04528405057966491"}]},
             {"0", "1.9521863824506809", 
              RowBox[{"-", "2.216352156896298"}], 
              RowBox[{"-", "0.5116153729819477"}]},
             {"0.2", "0.4365413247037721", 
              RowBox[{"-", "2.437125727653321"}], "2.7753571339551537"},
             {"0.2", "2.960266133840988", "3.2357306532803083", 
              "2.22512443353574"}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
          Function[BoxForm`e$, 
           MatrixForm[BoxForm`e$]]]}]}]}]}]}]}], "\[IndentingNewLine]", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"JacobianSpace", "[", 
     RowBox[{"Slist_", ",", "thetalist_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Js", "=", "Slist"}], ",", 
        RowBox[{"T", "=", 
         RowBox[{"IdentityMatrix", "[", "4", "]"}]}]}], "}"}], ",", 
      RowBox[{
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"T", "=", 
           RowBox[{"T", ".", 
            RowBox[{"MatrixExp6", "[", 
             RowBox[{"VecTose3", "[", 
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"Slist", "[", 
                  RowBox[{"[", 
                   RowBox[{";;", ",", 
                    RowBox[{"i", "-", "1"}]}], "]"}], "]"}], "}"}], 
                "\[Transpose]"}], "*", 
               RowBox[{"thetalist", "[", 
                RowBox[{"[", 
                 RowBox[{
                  RowBox[{"i", "-", "1"}], ",", "1"}], "]"}], "]"}]}], "]"}], 
             "]"}]}]}], ";", 
          RowBox[{
           RowBox[{"Js", "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", "i"}], "]"}], "]"}], "=", 
           RowBox[{"Flatten", "[", 
            RowBox[{
             RowBox[{"Adjoint", "[", "T", "]"}], ".", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Slist", "[", 
                RowBox[{"[", 
                 RowBox[{";;", ",", "i"}], "]"}], "]"}], "}"}], 
              "\[Transpose]"}]}], "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", 
           RowBox[{"Length", "[", "thetalist", "]"}]}], "}"}]}], "]"}], ";", 
       RowBox[{"Return", "[", "Js", "]"}]}]}], "]"}]}], 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.654107438701495*^9, 3.6541075770931664`*^9}, {
   3.6541076103152647`*^9, 3.654107726674172*^9}, {3.654107800327899*^9, 
   3.654107805926005*^9}, {3.654107842157054*^9, 3.654107956534466*^9}, {
   3.6541080276373253`*^9, 3.654108039845397*^9}, {3.654108208328875*^9, 
   3.654108267778264*^9}, {3.654108316603101*^9, 3.65410832858707*^9}, {
   3.654122072990996*^9, 3.654122200142358*^9}, {3.654122232524707*^9, 
   3.6541222637488813`*^9}, {3.654122372486209*^9, 3.65412253592478*^9}, {
   3.654122571686759*^9, 3.654122685636675*^9}, {3.654122740902017*^9, 
   3.6541228215630703`*^9}, {3.654122865671712*^9, 3.654122935620612*^9}, {
   3.654123032181581*^9, 3.6541230914473333`*^9}, {3.654123152783122*^9, 
   3.6541232043612537`*^9}, {3.654123304611115*^9, 3.654123341073502*^9}, {
   3.654123502235703*^9, 3.654123578362132*^9}, {3.654123664279245*^9, 
   3.654123683195951*^9}, {3.6541237878998413`*^9, 3.6541238249788847`*^9}, {
   3.654123940392714*^9, 3.654123947510108*^9}, {3.654124026309593*^9, 
   3.654124026885428*^9}, 3.6541241152729683`*^9, 3.654124170343902*^9, {
   3.6541246995439568`*^9, 3.654124712871656*^9}, {3.6541251843297157`*^9, 
   3.654125231518578*^9}, {3.6541254856851683`*^9, 3.65412548908077*^9}, {
   3.654125547742125*^9, 3.654125551165526*^9}, {3.654125930807577*^9, 
   3.654126007244483*^9}, {3.654126127665163*^9, 3.654126191634789*^9}, {
   3.654126236482831*^9, 3.654126250153975*^9}, {3.6541262848658533`*^9, 
   3.654126288991514*^9}, {3.654126323055903*^9, 3.654126399729628*^9}, {
   3.654126435349374*^9, 3.654126447266036*^9}, {3.654126530077552*^9, 
   3.6541265937421*^9}, {3.654126679867402*^9, 3.6541267650289497`*^9}, {
   3.6541267969631968`*^9, 3.654126798410089*^9}, {3.654126829860013*^9, 
   3.654126881359337*^9}, {3.6541269393824577`*^9, 3.654126959132009*^9}, {
   3.654127079773924*^9, 3.654127194954756*^9}, {3.654127229244482*^9, 
   3.654127253953713*^9}, {3.6541278694900227`*^9, 3.654127878663176*^9}, {
   3.654127969775614*^9, 3.6541279938293123`*^9}, {3.654128051763153*^9, 
   3.654128134016169*^9}, {3.654128326830834*^9, 3.654128326972948*^9}, {
   3.654182305132535*^9, 3.654182317491791*^9}, {3.65418238746202*^9, 
   3.654182511491269*^9}, {3.654182551115921*^9, 3.654182559209998*^9}, {
   3.6541826265390177`*^9, 3.654182732425318*^9}, {3.654182795218339*^9, 
   3.654182802306821*^9}, {3.654182858360195*^9, 3.654182976637673*^9}, {
   3.65418309291822*^9, 3.6541831115452337`*^9}, {3.654183280620055*^9, 
   3.654183381285778*^9}, {3.6541834216733217`*^9, 3.65418343026462*^9}, {
   3.65418347398075*^9, 3.654183479016459*^9}, {3.654183517743698*^9, 
   3.654183590244978*^9}, {3.654183629340012*^9, 3.654183659551435*^9}, {
   3.654183828746057*^9, 3.654183869187777*^9}, {3.654183918271063*^9, 
   3.6541839184304667`*^9}, {3.654206461375032*^9, 3.6542064948942213`*^9}, {
   3.6542065261576433`*^9, 3.654206710642645*^9}, {3.65420685898112*^9, 
   3.654206859498214*^9}, {3.654206912388175*^9, 3.6542069199221067`*^9}, {
   3.654206956850091*^9, 3.654206957769821*^9}, {3.6542070885864773`*^9, 
   3.6542070905801163`*^9}, {3.6542071861274023`*^9, 3.654207197287834*^9}, {
   3.654207355631957*^9, 3.65420737546005*^9}, {3.654207422116619*^9, 
   3.6542074295958633`*^9}, {3.654207513008601*^9, 3.654207622631179*^9}, {
   3.6542077902321663`*^9, 3.6542079082040863`*^9}, {3.654208112675095*^9, 
   3.6542082406765347`*^9}, {3.654208390436673*^9, 3.654208437282127*^9}, {
   3.654208729398788*^9, 3.6542088242969923`*^9}, {3.654208875181876*^9, 
   3.6542089105814543`*^9}, {3.654209036563011*^9, 3.654209042056604*^9}, {
   3.654209131808134*^9, 3.654209211748107*^9}, {3.654277910558556*^9, 
   3.654277962902483*^9}, {3.6542785554956903`*^9, 3.654278555764879*^9}, {
   3.6542801407928543`*^9, 3.654280145647377*^9}, {3.654280336511973*^9, 
   3.654280388661951*^9}, {3.654735519742467*^9, 3.654735526212496*^9}, {
   3.654736711632904*^9, 3.654736744359725*^9}, {3.654736840726715*^9, 
   3.6547369027091503`*^9}, {3.6547369619155817`*^9, 3.65473711893006*^9}, 
   3.654737215212165*^9, {3.6547372623430433`*^9, 3.654737301717353*^9}, {
   3.654737434898181*^9, 3.654737445769989*^9}, {3.654737593349925*^9, 
   3.654737893647337*^9}, {3.654737938282483*^9, 3.654737939560112*^9}, {
   3.654737995469615*^9, 3.65473804382544*^9}, {3.65473814244207*^9, 
   3.65473826286047*^9}, {3.654738473301898*^9, 3.654738519313912*^9}, {
   3.654738551955141*^9, 3.654738559351729*^9}, {3.654738599129403*^9, 
   3.654738599566987*^9}, {3.654738653005966*^9, 3.654738704434928*^9}, {
   3.654738885183668*^9, 3.654738922018218*^9}, {3.654739011880048*^9, 
   3.65473910917871*^9}, {3.654739159170903*^9, 3.654739162120161*^9}, {
   3.6547393230277576`*^9, 3.6547393764227123`*^9}, {3.654739415181912*^9, 
   3.65473942023728*^9}, {3.654739453135948*^9, 3.654739679965816*^9}, {
   3.654739718627033*^9, 3.6547397334487553`*^9}, {3.654739765385715*^9, 
   3.654739851694334*^9}, {3.654739889466123*^9, 3.654740005071364*^9}, {
   3.6547400491757*^9, 3.654740154008595*^9}, 3.654740216700787*^9, {
   3.654740314399178*^9, 3.6547403286014967`*^9}, 3.6547403850818996`*^9, {
   3.654740521314966*^9, 3.654740541208376*^9}, {3.65474063388687*^9, 
   3.654740654515286*^9}, {3.654740701345427*^9, 3.654740810460566*^9}, {
   3.654740848239312*^9, 3.654741082783293*^9}, {3.654741274225429*^9, 
   3.65474127713437*^9}, 3.654741426789631*^9, {3.6547414571147537`*^9, 
   3.654741569824174*^9}, {3.654741604551594*^9, 3.65474161887015*^9}, {
   3.6547416933496304`*^9, 3.654741709459137*^9}, {3.654741935230948*^9, 
   3.654741945307493*^9}, {3.6547830386167917`*^9, 3.654783105454197*^9}, {
   3.6547832406606083`*^9, 3.6547832525310373`*^9}, {3.654783794511154*^9, 
   3.654783837663447*^9}, {3.65478390359721*^9, 3.654783909803577*^9}, {
   3.654783989474423*^9, 3.654784403124803*^9}, {3.654784520313846*^9, 
   3.654784622329711*^9}, {3.6547847231449842`*^9, 3.654784727983326*^9}, {
   3.654785122876478*^9, 3.654785187751635*^9}, {3.654785255283667*^9, 
   3.654785472044736*^9}, {3.654785554330287*^9, 3.6547855634367*^9}, {
   3.6547858133842907`*^9, 3.654785842420493*^9}, {3.654785988696732*^9, 
   3.654785999313698*^9}, {3.654786083383224*^9, 3.654786083827299*^9}, {
   3.654799998454865*^9, 3.654800009014682*^9}, 3.654800058896707*^9, {
   3.6548001027328*^9, 3.654800173381201*^9}, {3.654800206111162*^9, 
   3.654800346038969*^9}, {3.654800415767541*^9, 3.654800685527397*^9}, {
   3.654800717895743*^9, 3.6548007259529123`*^9}, {3.6548007560240192`*^9, 
   3.654800892868227*^9}, {3.654800961067473*^9, 3.6548010443125353`*^9}, {
   3.654801144205307*^9, 3.6548013970409203`*^9}, {3.654801447723054*^9, 
   3.6548014700938597`*^9}, {3.654801562889327*^9, 3.6548017505389137`*^9}, {
   3.6548017965315866`*^9, 3.654801838591158*^9}, {3.654801925163512*^9, 
   3.654801957336872*^9}, {3.654802037838778*^9, 3.654802097667626*^9}, {
   3.6548021338675137`*^9, 3.654802151746142*^9}, {3.6548021938035927`*^9, 
   3.65480226557542*^9}, {3.6548023434469347`*^9, 3.6548024564595747`*^9}, {
   3.654802493167995*^9, 3.654802498462143*^9}, {3.654802632969117*^9, 
   3.654802636326886*^9}, {3.6548026864101667`*^9, 3.6548027624957323`*^9}, {
   3.654802812209731*^9, 3.6548030159498*^9}, {3.6548066359524317`*^9, 
   3.654806720935005*^9}, {3.654806751992766*^9, 3.6548067587144833`*^9}, {
   3.654806821497799*^9, 3.654806889382121*^9}, {3.654807006283039*^9, 
   3.654807210369132*^9}, {3.654807340425975*^9, 3.6548074184588003`*^9}, {
   3.6548074913193197`*^9, 3.654807699931301*^9}, 3.6548078200861998`*^9, {
   3.654807890939335*^9, 3.65480791502777*^9}, {3.654807960842239*^9, 
   3.6548080712336483`*^9}, {3.654808128338978*^9, 3.6548081799548407`*^9}, {
   3.6548101758929577`*^9, 3.654810330104765*^9}, {3.654810401423953*^9, 
   3.654810408457419*^9}, {3.6548104718702717`*^9, 3.6548106690676603`*^9}, {
   3.6548107121438303`*^9, 3.6548108463298893`*^9}, {3.654810878513033*^9, 
   3.6548109250220337`*^9}, {3.654810973064028*^9, 3.6548109963255377`*^9}, {
   3.654811065383171*^9, 3.65481111435124*^9}, {3.6548111568410273`*^9, 
   3.654811165569319*^9}, {3.654811202562601*^9, 3.654811649746052*^9}, {
   3.657067656153129*^9, 3.657067660941557*^9}, {3.6570766750689*^9, 
   3.657076677028944*^9}, {3.658274451899232*^9, 3.6582744912918463`*^9}, {
   3.6583703518545094`*^9, 3.65837035300604*^9}, {3.675684467101232*^9, 
   3.6756844876690702`*^9}, 3.675685101672298*^9, {3.675685132865593*^9, 
   3.675685170606345*^9}, {3.6756852137594137`*^9, 3.675685253900947*^9}, {
   3.675685284425191*^9, 3.6756853403668823`*^9}, {3.6756853826789017`*^9, 
   3.675685417250636*^9}, {3.6761180890121613`*^9, 3.6761180890163*^9}, {
   3.6772374764222107`*^9, 3.677237478976756*^9}, 3.6774898698726873`*^9, {
   3.67748999177361*^9, 3.677489992267871*^9}, {3.678096227392668*^9, 
   3.6780962321466627`*^9}, {3.6909992890056925`*^9, 
   3.6909993428453875`*^9}, {3.690999403441894*^9, 3.6909994879708433`*^9}, {
   3.6909995975862417`*^9, 3.6909997130448446`*^9}, {3.692471696981022*^9, 
   3.692471714808461*^9}, {3.7306522065596848`*^9, 
   3.7306522070637074`*^9}},ExpressionUUID->"537c0d96-762a-44d8-9b3b-\
ae7cd65b0ad8"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["CHAPTER  6: INVERSE KINEMATICS",
 FontSize->24,
 FontWeight->"Bold",
 FontColor->RGBColor[0, 0, 1]]], "Title",
 CellChangeTimes->{{3.6755319110417843`*^9, 3.675531927048277*^9}, {
  3.675531958735077*^9, 3.67553201284205*^9}, {3.675607857109823*^9, 
  3.6756079117244864`*^9}, {3.6756821024917507`*^9, 3.6756821283850946`*^9}, {
  3.6757648758196497`*^9, 
  3.675764892595064*^9}},ExpressionUUID->"9b65060d-851c-4e01-9b60-\
18f3c42fd7f6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"IKinBody", "[", 
      RowBox[{
      "Blist_", ",", "M_", ",", "T_", ",", "thetalist0_", ",", "eomg_", ",", 
       "ev_"}], "]"}], ":", "\[IndentingNewLine]", "   ", 
     RowBox[{"Takes", " ", "Blist"}], ":", " ", 
     RowBox[{
      RowBox[{
      "The", " ", "joint", " ", "screw", " ", "axes", " ", "in", " ", "the", 
       " ", "end"}], "-", 
      RowBox[{
      "effector", " ", "frame", " ", "when", " ", "the", " ", "manipulator", 
       " ", "is", " ", "at", " ", "the", " ", "home", " ", "position"}]}]}], 
    ",", " ", 
    RowBox[{
    "in", " ", "the", " ", "format", " ", "of", " ", "a", " ", "matrix", " ", 
     "with", " ", "axes", " ", "as", " ", "the", " ", "columns"}], ",", 
    "\[IndentingNewLine]", "          ", 
    RowBox[{"M", ":", " ", 
     RowBox[{
      RowBox[{
      "The", " ", "home", " ", "configuration", " ", "of", " ", "the", " ", 
       "end"}], "-", "effector"}]}], ",", "\[IndentingNewLine]", "          ", 
    RowBox[{"T", ":", " ", 
     RowBox[{
      RowBox[{"The", " ", "desired", " ", "end"}], "-", 
      RowBox[{"effector", " ", "configuration", " ", "T"}]}]}], ",", "\n", 
    "          ", 
    RowBox[{"thetalist0", ":", " ", 
     RowBox[{
     "An", " ", "initial", " ", "guess", " ", "of", " ", "joint", " ", 
      "angles", " ", "that", " ", "are", " ", "close", " ", "to", " ", 
      "satisfying", " ", "T"}]}], ",", "\n", "          ", 
    RowBox[{"eomg", ":", " ", 
     RowBox[{
      RowBox[{
      "A", " ", "small", " ", "positive", " ", "tolerance", " ", "on", " ", 
       "the", " ", "end"}], "-", 
      RowBox[{"effector", " ", "orientation", " ", 
       RowBox[{"error", ".", " ", "The"}], " ", "returned", " ", "joint", " ",
        "angles", " ", "must", " ", "give", " ", "an", " ", "end"}], "-", 
      RowBox[{
      "effector", " ", "orientation", " ", "error", " ", "less", " ", "than", 
       " ", "eomg"}]}]}], ",", "\[IndentingNewLine]", "          ", 
    RowBox[{"ev", ":", " ", 
     RowBox[{
      RowBox[{
      "A", " ", "small", " ", "positive", " ", "tolerance", " ", "on", " ", 
       "the", " ", "end"}], "-", 
      RowBox[{"effector", " ", "linear", " ", "position", " ", 
       RowBox[{"error", ".", " ", "The"}], " ", "returned", " ", "joint", " ",
        "angles", " ", "must", " ", "give", " ", "an", " ", "end"}], "-", 
      RowBox[{
      "effector", " ", "position", " ", "error", " ", "less", " ", "than", 
       " ", 
       RowBox[{"ev", ".", " ", "\[IndentingNewLine]", "Returns"}], " ", 
       "thetalist"}]}], ":", " ", 
     RowBox[{
     "Joint", " ", "angles", " ", "that", " ", "achieve", " ", "T", " ", 
      "within", " ", "the", " ", "specified", " ", "tolerance"}]}], ",", " ", 
    RowBox[{"success", ":", " ", 
     RowBox[{
      RowBox[{
      "A", " ", "logical", " ", "value", " ", "where", " ", "True", " ", 
       "means", " ", "that", " ", "the", " ", "function", " ", "found", " ", 
       "a", " ", "solution", " ", "and", " ", "False", " ", "means", " ", 
       "that", " ", "it", " ", "ran", " ", "through", " ", "the", " ", "set", 
       " ", "number", " ", "of", " ", "maximum", " ", "iterations", " ", 
       "without", " ", "finding", " ", "a", " ", "solution", " ", "within", 
       " ", "the", " ", "tolerances", " ", "eomg", " ", "and", " ", 
       RowBox[{"ev", ".", "\[IndentingNewLine]", "Uses"}], " ", "an", " ", 
       "iterative", " ", "Newton"}], "-", 
      RowBox[{"Raphson", " ", "root"}], "-", 
      RowBox[{"finding", " ", 
       RowBox[{"method", ".", "\[IndentingNewLine]", "The"}], " ", "maximum", 
       " ", "number", " ", "of", " ", "iterations", " ", "before", " ", "the",
        " ", "algorithm", " ", "is", " ", "terminated", " ", "has", " ", 
       "been", " ", "hardcoded", " ", "in", " ", "as", " ", "a", " ", 
       "variable", " ", "called", " ", 
       RowBox[{"maxiterations", ".", "It"}], " ", "is", " ", "set", " ", "to",
        " ", "20", " ", "at", " ", "the", " ", "start", " ", "of", " ", "the",
        " ", "function"}]}]}], ",", 
    RowBox[{
     RowBox[{"but", " ", "can", " ", "be", " ", "changed", " ", "if", " ", 
      RowBox[{"needed", "."}]}], "\[IndentingNewLine]", ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Exapmle", ":", "\[IndentingNewLine]", "Input", ":", 
       "\[IndentingNewLine]", "Blist"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           RowBox[{"-", "1"}], ",", "2", ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1", ",", "0", ",", "0", ",", "0.1"}], 
          "}"}]}], "}"}], "\[Transpose]"}]}], ";", "\[IndentingNewLine]", 
     "  ", 
     RowBox[{"M", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "6"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", 
          RowBox[{"-", "1"}], ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     " ", "\[IndentingNewLine]", "  ", 
     RowBox[{"T", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", 
          RowBox[{"-", "5"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "4"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", 
          RowBox[{"-", "1"}], ",", "1.6858"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"thetalist0", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"1.5", ",", "2.5", ",", "3"}], "}"}], "}"}], 
       "\[Transpose]"}]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"eomg", "=", "0.01"}], ";", "\n", "  ", 
     RowBox[{"ev", "=", "0.001"}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"thetalist", ",", "success"}], "}"}], " ", "=", " ", 
      RowBox[{
       RowBox[{"IKinBody", "[", 
        RowBox[{
        "Blist", ",", "M", ",", "T", ",", "thetalist0", ",", "eomg", ",", 
         "ev"}], "]"}], "\[IndentingNewLine]", 
       RowBox[{"Ouput", ":", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "1.5707381937148923", "}"}], ",", 
            RowBox[{"{", "2.999666997382942", "}"}], ",", 
            RowBox[{"{", "3.141539129217613", "}"}]}], "}"}], ",", "True"}], 
         "}"}]}]}]}]}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"IKinBody", "[", 
     RowBox[{
     "Blist_", ",", "M_", ",", "T_", ",", "thetalist0_", ",", "eomg_", ",", 
      "ev_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Vb", ",", 
        RowBox[{"thetalist", "=", "thetalist0"}], ",", "err", ",", 
        RowBox[{"i", "=", "0"}], ",", 
        RowBox[{"maxiterations", " ", "=", " ", "20"}]}], "}"}], ",", 
      RowBox[{
       RowBox[{"Vb", " ", "=", " ", 
        RowBox[{"se3ToVec", "[", 
         RowBox[{"MatrixLog6", "[", 
          RowBox[{
           RowBox[{"TransInv", "[", 
            RowBox[{"FKinBody", "[", 
             RowBox[{"M", ",", "Blist", ",", "thetalist"}], "]"}], "]"}], ".",
            "T"}], "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"err", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Norm", "[", 
           RowBox[{"Vb", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"1", ";;", "3"}], ",", "1"}], "]"}], "]"}], "]"}], ">", 
          "eomg"}], " ", "||", " ", 
         RowBox[{
          RowBox[{"Norm", "[", 
           RowBox[{"Vb", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"4", ";;", "6"}], ",", "1"}], "]"}], "]"}], "]"}], ">", 
          "ev"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{"err", " ", "&&", 
          RowBox[{"i", " ", "<", " ", "maxiterations"}]}], ",", 
         RowBox[{
          RowBox[{"thetalist", "=", " ", 
           RowBox[{"thetalist", "+", 
            RowBox[{
             RowBox[{"PseudoInverse", "[", 
              RowBox[{"JacobianBody", "[", 
               RowBox[{"Blist", ",", "thetalist"}], "]"}], "]"}], ".", 
             "Vb"}]}]}], ";", 
          RowBox[{"i", "++"}], ";", 
          RowBox[{"Vb", " ", "=", " ", 
           RowBox[{"se3ToVec", "[", 
            RowBox[{"MatrixLog6", "[", 
             RowBox[{
              RowBox[{"TransInv", "[", 
               RowBox[{"FKinBody", "[", 
                RowBox[{"M", ",", "Blist", ",", "thetalist"}], "]"}], "]"}], 
              ".", "T"}], "]"}], "]"}]}], ";", 
          RowBox[{"err", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Norm", "[", 
              RowBox[{"Vb", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"1", ";;", "3"}], ",", "1"}], "]"}], "]"}], "]"}], 
             ">", "eomg"}], " ", "||", " ", 
            RowBox[{
             RowBox[{"Norm", "[", 
              RowBox[{"Vb", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"4", ";;", "6"}], ",", "1"}], "]"}], "]"}], "]"}], 
             ">", "ev"}]}]}]}]}], "]"}], ";", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"thetalist", ",", " ", 
          RowBox[{"!", "err"}]}], "}"}], "]"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.654107438701495*^9, 3.6541075770931664`*^9}, {
   3.6541076103152647`*^9, 3.654107726674172*^9}, {3.654107800327899*^9, 
   3.654107805926005*^9}, {3.654107842157054*^9, 3.654107956534466*^9}, {
   3.6541080276373253`*^9, 3.654108039845397*^9}, {3.654108208328875*^9, 
   3.654108267778264*^9}, {3.654108316603101*^9, 3.65410832858707*^9}, {
   3.654122072990996*^9, 3.654122200142358*^9}, {3.654122232524707*^9, 
   3.6541222637488813`*^9}, {3.654122372486209*^9, 3.65412253592478*^9}, {
   3.654122571686759*^9, 3.654122685636675*^9}, {3.654122740902017*^9, 
   3.6541228215630703`*^9}, {3.654122865671712*^9, 3.654122935620612*^9}, {
   3.654123032181581*^9, 3.6541230914473333`*^9}, {3.654123152783122*^9, 
   3.6541232043612537`*^9}, {3.654123304611115*^9, 3.654123341073502*^9}, {
   3.654123502235703*^9, 3.654123578362132*^9}, {3.654123664279245*^9, 
   3.654123683195951*^9}, {3.6541237878998413`*^9, 3.6541238249788847`*^9}, {
   3.654123940392714*^9, 3.654123947510108*^9}, {3.654124026309593*^9, 
   3.654124026885428*^9}, 3.6541241152729683`*^9, 3.654124170343902*^9, {
   3.6541246995439568`*^9, 3.654124712871656*^9}, {3.6541251843297157`*^9, 
   3.654125231518578*^9}, {3.6541254856851683`*^9, 3.65412548908077*^9}, {
   3.654125547742125*^9, 3.654125551165526*^9}, {3.654125930807577*^9, 
   3.654126007244483*^9}, {3.654126127665163*^9, 3.654126191634789*^9}, {
   3.654126236482831*^9, 3.654126250153975*^9}, {3.6541262848658533`*^9, 
   3.654126288991514*^9}, {3.654126323055903*^9, 3.654126399729628*^9}, {
   3.654126435349374*^9, 3.654126447266036*^9}, {3.654126530077552*^9, 
   3.6541265937421*^9}, {3.654126679867402*^9, 3.6541267650289497`*^9}, {
   3.6541267969631968`*^9, 3.654126798410089*^9}, {3.654126829860013*^9, 
   3.654126881359337*^9}, {3.6541269393824577`*^9, 3.654126959132009*^9}, {
   3.654127079773924*^9, 3.654127194954756*^9}, {3.654127229244482*^9, 
   3.654127253953713*^9}, {3.6541278694900227`*^9, 3.654127878663176*^9}, {
   3.654127969775614*^9, 3.6541279938293123`*^9}, {3.654128051763153*^9, 
   3.654128134016169*^9}, {3.654128326830834*^9, 3.654128326972948*^9}, {
   3.654182305132535*^9, 3.654182317491791*^9}, {3.65418238746202*^9, 
   3.654182511491269*^9}, {3.654182551115921*^9, 3.654182559209998*^9}, {
   3.6541826265390177`*^9, 3.654182732425318*^9}, {3.654182795218339*^9, 
   3.654182802306821*^9}, {3.654182858360195*^9, 3.654182976637673*^9}, {
   3.65418309291822*^9, 3.6541831115452337`*^9}, {3.654183280620055*^9, 
   3.654183381285778*^9}, {3.6541834216733217`*^9, 3.65418343026462*^9}, {
   3.65418347398075*^9, 3.654183479016459*^9}, {3.654183517743698*^9, 
   3.654183590244978*^9}, {3.654183629340012*^9, 3.654183659551435*^9}, {
   3.654183828746057*^9, 3.654183869187777*^9}, {3.654183918271063*^9, 
   3.6541839184304667`*^9}, {3.654206461375032*^9, 3.6542064948942213`*^9}, {
   3.6542065261576433`*^9, 3.654206710642645*^9}, {3.65420685898112*^9, 
   3.654206859498214*^9}, {3.654206912388175*^9, 3.6542069199221067`*^9}, {
   3.654206956850091*^9, 3.654206957769821*^9}, {3.6542070885864773`*^9, 
   3.6542070905801163`*^9}, {3.6542071861274023`*^9, 3.654207197287834*^9}, {
   3.654207355631957*^9, 3.65420737546005*^9}, {3.654207422116619*^9, 
   3.6542074295958633`*^9}, {3.654207513008601*^9, 3.654207622631179*^9}, {
   3.6542077902321663`*^9, 3.6542079082040863`*^9}, {3.654208112675095*^9, 
   3.6542082406765347`*^9}, {3.654208390436673*^9, 3.654208437282127*^9}, {
   3.654208729398788*^9, 3.6542088242969923`*^9}, {3.654208875181876*^9, 
   3.6542089105814543`*^9}, {3.654209036563011*^9, 3.654209042056604*^9}, {
   3.654209131808134*^9, 3.654209211748107*^9}, {3.654277910558556*^9, 
   3.654277962902483*^9}, {3.6542785554956903`*^9, 3.654278555764879*^9}, {
   3.6542801407928543`*^9, 3.654280145647377*^9}, {3.654280336511973*^9, 
   3.654280388661951*^9}, {3.654735519742467*^9, 3.654735526212496*^9}, {
   3.654736711632904*^9, 3.654736744359725*^9}, {3.654736840726715*^9, 
   3.6547369027091503`*^9}, {3.6547369619155817`*^9, 3.65473711893006*^9}, 
   3.654737215212165*^9, {3.6547372623430433`*^9, 3.654737301717353*^9}, {
   3.654737434898181*^9, 3.654737445769989*^9}, {3.654737593349925*^9, 
   3.654737893647337*^9}, {3.654737938282483*^9, 3.654737939560112*^9}, {
   3.654737995469615*^9, 3.65473804382544*^9}, {3.65473814244207*^9, 
   3.65473826286047*^9}, {3.654738473301898*^9, 3.654738519313912*^9}, {
   3.654738551955141*^9, 3.654738559351729*^9}, {3.654738599129403*^9, 
   3.654738599566987*^9}, {3.654738653005966*^9, 3.654738704434928*^9}, {
   3.654738885183668*^9, 3.654738922018218*^9}, {3.654739011880048*^9, 
   3.65473910917871*^9}, {3.654739159170903*^9, 3.654739162120161*^9}, {
   3.6547393230277576`*^9, 3.6547393764227123`*^9}, {3.654739415181912*^9, 
   3.65473942023728*^9}, {3.654739453135948*^9, 3.654739679965816*^9}, {
   3.654739718627033*^9, 3.6547397334487553`*^9}, {3.654739765385715*^9, 
   3.654739851694334*^9}, {3.654739889466123*^9, 3.654740005071364*^9}, {
   3.6547400491757*^9, 3.654740154008595*^9}, 3.654740216700787*^9, {
   3.654740314399178*^9, 3.6547403286014967`*^9}, 3.6547403850818996`*^9, {
   3.654740521314966*^9, 3.654740541208376*^9}, {3.65474063388687*^9, 
   3.654740654515286*^9}, {3.654740701345427*^9, 3.654740810460566*^9}, {
   3.654740848239312*^9, 3.654741082783293*^9}, {3.654741274225429*^9, 
   3.65474127713437*^9}, 3.654741426789631*^9, {3.6547414571147537`*^9, 
   3.654741569824174*^9}, {3.654741604551594*^9, 3.65474161887015*^9}, {
   3.6547416933496304`*^9, 3.654741709459137*^9}, {3.654741935230948*^9, 
   3.654741945307493*^9}, {3.6547830386167917`*^9, 3.654783105454197*^9}, {
   3.6547832406606083`*^9, 3.6547832525310373`*^9}, {3.654783794511154*^9, 
   3.654783837663447*^9}, {3.65478390359721*^9, 3.654783909803577*^9}, {
   3.654783989474423*^9, 3.654784403124803*^9}, {3.654784520313846*^9, 
   3.654784622329711*^9}, {3.6547847231449842`*^9, 3.654784727983326*^9}, {
   3.654785122876478*^9, 3.654785187751635*^9}, {3.654785255283667*^9, 
   3.654785472044736*^9}, {3.654785554330287*^9, 3.6547855634367*^9}, {
   3.6547858133842907`*^9, 3.654785842420493*^9}, {3.654785988696732*^9, 
   3.654785999313698*^9}, {3.654786083383224*^9, 3.654786083827299*^9}, {
   3.654799998454865*^9, 3.654800009014682*^9}, 3.654800058896707*^9, {
   3.6548001027328*^9, 3.654800173381201*^9}, {3.654800206111162*^9, 
   3.654800346038969*^9}, {3.654800415767541*^9, 3.654800685527397*^9}, {
   3.654800717895743*^9, 3.6548007259529123`*^9}, {3.6548007560240192`*^9, 
   3.654800892868227*^9}, {3.654800961067473*^9, 3.6548010443125353`*^9}, {
   3.654801144205307*^9, 3.6548013970409203`*^9}, {3.654801447723054*^9, 
   3.6548014700938597`*^9}, {3.654801562889327*^9, 3.6548017505389137`*^9}, {
   3.6548017965315866`*^9, 3.654801838591158*^9}, {3.654801925163512*^9, 
   3.654801957336872*^9}, {3.654802037838778*^9, 3.654802097667626*^9}, {
   3.6548021338675137`*^9, 3.654802151746142*^9}, {3.6548021938035927`*^9, 
   3.65480226557542*^9}, {3.6548023434469347`*^9, 3.6548024564595747`*^9}, {
   3.654802493167995*^9, 3.654802498462143*^9}, {3.654802632969117*^9, 
   3.654802636326886*^9}, {3.6548026864101667`*^9, 3.6548027624957323`*^9}, {
   3.654802812209731*^9, 3.6548030159498*^9}, {3.6548066359524317`*^9, 
   3.654806720935005*^9}, {3.654806751992766*^9, 3.6548067587144833`*^9}, {
   3.654806821497799*^9, 3.654806889382121*^9}, {3.654807006283039*^9, 
   3.654807210369132*^9}, {3.654807340425975*^9, 3.6548074184588003`*^9}, {
   3.6548074913193197`*^9, 3.654807699931301*^9}, 3.6548078200861998`*^9, {
   3.654807890939335*^9, 3.65480791502777*^9}, {3.654807960842239*^9, 
   3.6548080712336483`*^9}, {3.654808128338978*^9, 3.6548081799548407`*^9}, {
   3.6548101758929577`*^9, 3.654810330104765*^9}, {3.654810401423953*^9, 
   3.654810408457419*^9}, {3.6548104718702717`*^9, 3.6548106690676603`*^9}, {
   3.6548107121438303`*^9, 3.6548108463298893`*^9}, {3.654810878513033*^9, 
   3.6548109250220337`*^9}, {3.654810973064028*^9, 3.6548109963255377`*^9}, {
   3.654811065383171*^9, 3.65481111435124*^9}, {3.6548111568410273`*^9, 
   3.654811165569319*^9}, {3.654811202562601*^9, 3.654811649746052*^9}, {
   3.657067656153129*^9, 3.657067660941557*^9}, {3.6570766750689*^9, 
   3.657076677028944*^9}, {3.658274451899232*^9, 3.6582744912918463`*^9}, {
   3.6583703518545094`*^9, 3.65837035300604*^9}, {3.675682824450754*^9, 
   3.6756828836706333`*^9}, {3.6756829858535852`*^9, 3.675683093476144*^9}, {
   3.675683163431617*^9, 3.675683301926485*^9}, {3.6756834458193197`*^9, 
   3.675683520674423*^9}, {3.675683569012762*^9, 3.675683584065415*^9}, 
   3.675683635500771*^9, {3.675684508273862*^9, 3.675684520687911*^9}, {
   3.675764977565001*^9, 3.675764979617189*^9}, {3.6757662451157312`*^9, 
   3.675766254498831*^9}, {3.675766317871736*^9, 3.675766345394107*^9}, {
   3.6757664078898573`*^9, 3.675766419041957*^9}, {3.6757665260531073`*^9, 
   3.6757665599652433`*^9}, {3.675766688881428*^9, 3.675766693414764*^9}, {
   3.675766760364307*^9, 3.675766898736827*^9}, {3.675766931380547*^9, 
   3.675766932915333*^9}, 3.675767022524777*^9, 3.675767053903921*^9, {
   3.675767094663486*^9, 3.675767157353602*^9}, {3.6757672038039017`*^9, 
   3.67576720815028*^9}, {3.675767263478516*^9, 3.675767302851701*^9}, {
   3.6757673469407463`*^9, 3.6757675158730087`*^9}, {3.675767609117689*^9, 
   3.6757676149377613`*^9}, 3.676110621848937*^9, {3.676110673192341*^9, 
   3.676110708132433*^9}, {3.676110758266004*^9, 3.676110779724792*^9}, {
   3.676110837502541*^9, 3.676110924302658*^9}, {3.676111015370205*^9, 
   3.676111023652515*^9}, {3.676111616884136*^9, 3.676111619101164*^9}, {
   3.67611165132108*^9, 3.67611182175666*^9}, 3.6761124388093357`*^9, {
   3.6761125310577183`*^9, 3.676112535417371*^9}, {3.67611278534865*^9, 
   3.676112852293083*^9}, {3.6761129469420633`*^9, 3.6761129566090517`*^9}, {
   3.6761133261675377`*^9, 3.6761133851728067`*^9}, {3.6761134570078707`*^9, 
   3.6761134886549597`*^9}, {3.676113519585043*^9, 3.676113581404831*^9}, {
   3.676113994051722*^9, 3.6761140495138607`*^9}, {3.67611471759483*^9, 
   3.676114727326268*^9}, {3.676114788083909*^9, 3.676114788267289*^9}, {
   3.67611493328951*^9, 3.6761149644016867`*^9}, {3.6761149993051443`*^9, 
   3.676115038096011*^9}, {3.676115419194528*^9, 3.676115484935451*^9}, {
   3.6761155900865583`*^9, 3.676115605985518*^9}, {3.676115760093829*^9, 
   3.676115778909306*^9}, {3.676115982499289*^9, 3.676116037133542*^9}, {
   3.6761161990700502`*^9, 3.676116233908482*^9}, {3.676116286507206*^9, 
   3.676116286712512*^9}, {3.67611639463448*^9, 3.676116464258135*^9}, {
   3.6761165873897543`*^9, 3.676116602580727*^9}, {3.6761174556753473`*^9, 
   3.67611745672952*^9}, {3.676117506535368*^9, 3.6761175229462357`*^9}, {
   3.676117600215383*^9, 3.6761176442364273`*^9}, {3.676117677849012*^9, 
   3.6761177082717953`*^9}, {3.67611812248459*^9, 3.6761181278825502`*^9}, {
   3.676118580166224*^9, 3.67611860485815*^9}, {3.676118651876894*^9, 
   3.6761187537386017`*^9}, {3.676118838160269*^9, 3.676118838374693*^9}, {
   3.67611887610327*^9, 3.676118940213615*^9}, {3.6761191096213007`*^9, 
   3.676119140757559*^9}, {3.6761192665343122`*^9, 3.676119273783136*^9}, {
   3.67611936142714*^9, 3.676119363325075*^9}, {3.676119488561606*^9, 
   3.676119492487294*^9}, {3.6761200703687267`*^9, 3.6761200707356052`*^9}, {
   3.6761202104386873`*^9, 3.676120268289008*^9}, {3.676120410677075*^9, 
   3.676120443293746*^9}, {3.676120474583932*^9, 3.676120475526285*^9}, {
   3.6761206125852633`*^9, 3.6761206205196333`*^9}, {3.6761234586125507`*^9, 
   3.676123489461384*^9}, {3.6761235483793917`*^9, 3.676123569634534*^9}, {
   3.676124493441423*^9, 3.676124518157651*^9}, {3.676124553443336*^9, 
   3.676124582966502*^9}, {3.6761246820730133`*^9, 3.676124716437358*^9}, {
   3.67612487549886*^9, 3.676124882235661*^9}, {3.676124956893395*^9, 
   3.676124958216114*^9}, {3.6761249904362507`*^9, 3.676124994364197*^9}, {
   3.676125048497746*^9, 3.676125189073619*^9}, {3.676125219923954*^9, 
   3.6761253767254953`*^9}, {3.6761261361020412`*^9, 3.676126180304117*^9}, {
   3.6761262318219957`*^9, 3.676126312208794*^9}, {3.6761263690337877`*^9, 
   3.6761264446350737`*^9}, {3.676126475578731*^9, 3.676126485467072*^9}, {
   3.676126538828438*^9, 3.676126562090301*^9}, {3.676126633785634*^9, 
   3.6761266365895157`*^9}, 3.6761268247458773`*^9, 3.676126912241247*^9, {
   3.676126960168599*^9, 3.676126960170166*^9}, {3.676127961375718*^9, 
   3.676127975299335*^9}, {3.676128268770321*^9, 3.676128269338847*^9}, 
   3.676128811729394*^9, {3.677836754519267*^9, 3.6778367717532873`*^9}, 
   3.67809625024065*^9, 3.689380335363355*^9, {3.6893829735532513`*^9, 
   3.689383002923931*^9}, {3.691020104798397*^9, 3.6910201089496346`*^9}, {
   3.6910201777305684`*^9, 3.691020183893921*^9}, {3.691020235296861*^9, 
   3.6910202732930346`*^9}, {3.6910203243449545`*^9, 
   3.6910203267120895`*^9}, {3.691020559810422*^9, 3.6910206644754086`*^9}, {
   3.6910207871354246`*^9, 3.691020794730859*^9}, {3.6910209046111436`*^9, 
   3.6910209689858255`*^9}, {3.6910210393288493`*^9, 3.691021392074025*^9}, {
   3.691024282901371*^9, 3.691024307291766*^9}, {3.691087747352803*^9, 
   3.6910877526568127`*^9}, {3.692471869950526*^9, 3.692472081378619*^9}, 
   3.6924721337466145`*^9, {3.6924722147252464`*^9, 3.6924722761497593`*^9}, {
   3.692472394155509*^9, 3.692472397761715*^9}, {3.69310613421097*^9, 
   3.6931062576971726`*^9}, {3.693106385545392*^9, 3.693106400715414*^9}, {
   3.693153754253505*^9, 3.693153757545111*^9}, {3.693238620895026*^9, 
   3.6932386630669003`*^9}, {3.7306524885783353`*^9, 
   3.7306524892256756`*^9}},ExpressionUUID->"faf42c91-d222-47ba-a1cf-\
c70438e66ed9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"IKinSpace", "[", 
      RowBox[{
      "Slist_", ",", "M_", ",", "T_", ",", "thetalist0_", ",", "eomg_", ",", 
       "ev_"}], "]"}], ":", "\[IndentingNewLine]", "   ", 
     RowBox[{"Takes", " ", "Slist"}], ":", " ", 
     RowBox[{
     "The", " ", "joint", " ", "screw", " ", "axes", " ", "in", " ", "the", 
      " ", "space", " ", "frame", " ", "when", " ", "the", " ", "manipulator",
       " ", "is", " ", "at", " ", "the", " ", "home", " ", "position"}]}], 
    ",", " ", 
    RowBox[{
    "in", " ", "the", " ", "format", " ", "of", " ", "a", " ", "matrix", " ", 
     "with", " ", "axes", " ", "as", " ", "the", " ", "columns"}], ",", 
    "\[IndentingNewLine]", "          ", 
    RowBox[{"M", ":", " ", 
     RowBox[{
      RowBox[{
      "The", " ", "home", " ", "configuration", " ", "of", " ", "the", " ", 
       "end"}], "-", "effector"}]}], ",", "\[IndentingNewLine]", "          ", 
    RowBox[{"T", ":", " ", 
     RowBox[{
      RowBox[{"The", " ", "desired", " ", "end"}], "-", 
      RowBox[{"effector", " ", "configuration", " ", "T"}]}]}], ",", "\n", 
    "          ", 
    RowBox[{"thetalist0", ":", " ", 
     RowBox[{
     "An", " ", "initial", " ", "guess", " ", "of", " ", "joint", " ", 
      "angles", " ", "that", " ", "are", " ", "close", " ", "to", " ", 
      "satisfying", " ", "T"}]}], ",", "\n", "          ", 
    RowBox[{"eomg", ":", " ", 
     RowBox[{
      RowBox[{
      "A", " ", "small", " ", "positive", " ", "tolerance", " ", "on", " ", 
       "the", " ", "end"}], "-", 
      RowBox[{"effector", " ", "orientation", " ", 
       RowBox[{"error", ".", " ", "The"}], " ", "returned", " ", "joint", " ",
        "angles", " ", "must", " ", "give", " ", "an", " ", "end"}], "-", 
      RowBox[{
      "effector", " ", "orientation", " ", "error", " ", "less", " ", "than", 
       " ", "eomg"}]}]}], ",", "\[IndentingNewLine]", "          ", 
    RowBox[{"ev", ":", " ", 
     RowBox[{
      RowBox[{
      "A", " ", "small", " ", "positive", " ", "tolerance", " ", "on", " ", 
       "the", " ", "end"}], "-", 
      RowBox[{"effector", " ", "linear", " ", "position", " ", 
       RowBox[{"error", ".", " ", "The"}], " ", "returned", " ", "joint", " ",
        "angles", " ", "must", " ", "give", " ", "an", " ", "end"}], "-", 
      RowBox[{
      "effector", " ", "position", " ", "error", " ", "less", " ", "than", 
       " ", 
       RowBox[{"ev", ".", "\[IndentingNewLine]", "Returns"}], " ", 
       "thetalist"}]}], ":", " ", 
     RowBox[{
     "Joint", " ", "angles", " ", "that", " ", "achieve", " ", "T", " ", 
      "within", " ", "the", " ", "specified", " ", "tolerances"}]}], ",", " ",
     "\[IndentingNewLine]", 
    RowBox[{"success", ":", 
     RowBox[{
      RowBox[{
      "A", " ", "logical", " ", "value", " ", "where", " ", "True", " ", 
       "means", " ", "that", " ", "the", " ", "function", " ", "found", " ", 
       "a", " ", "solution", " ", "and", " ", "False", " ", "means", " ", 
       "that", " ", "it", " ", "ran", " ", "through", " ", "the", " ", "set", 
       " ", "number", " ", "of", " ", "maximum", " ", "iterations", " ", 
       "without", " ", "finding", " ", "a", " ", "solution", " ", "within", 
       " ", "the", " ", "tolerances", " ", "eomg", " ", "and", " ", 
       RowBox[{"ev", ".", "\[IndentingNewLine]", "Uses"}], " ", "an", " ", 
       "iterative", " ", "Newton"}], "-", 
      RowBox[{"Raphson", " ", "root"}], "-", 
      RowBox[{"finding", " ", 
       RowBox[{"method", ".", "\[IndentingNewLine]", "The"}], " ", "maximum", 
       " ", "number", " ", "of", " ", "iterations", " ", "before", " ", "the",
        " ", "algorithm", " ", "is", " ", "terminated", " ", "has", " ", 
       "been", " ", "hardcoded", " ", "in", " ", "as", " ", "a", " ", 
       "variable", " ", "called", " ", 
       RowBox[{"maxiterations", ".", "It"}], " ", "is", " ", "set", " ", "to",
        " ", "20", " ", "at", " ", "the", " ", "start", " ", "of", " ", "the",
        " ", "function"}]}]}], ",", 
    RowBox[{
     RowBox[{"but", " ", "can", " ", "be", " ", "changed", " ", "if", " ", 
      RowBox[{"needed", "."}]}], "\[IndentingNewLine]", ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Exapmle", ":", "\[IndentingNewLine]", "Input", ":", 
       "\[IndentingNewLine]", "Slist"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "1", ",", "4", ",", "0", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "0", ",", 
           RowBox[{"-", "1"}], ",", 
           RowBox[{"-", "6"}], ",", "0", ",", 
           RowBox[{"-", "0.1"}]}], "}"}]}], "}"}], "\[Transpose]"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"M", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "6"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", 
          RowBox[{"-", "1"}], ",", "2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"T", " ", "=", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", 
          RowBox[{"-", "5"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "4"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", 
          RowBox[{"-", "1"}], ",", "1.6858"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"thetalist0", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"1.5", ",", "2.5", ",", "3"}], "}"}], "}"}], 
       "\[Transpose]"}]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"eomg", "=", "0.01"}], ";", "\n", "  ", 
     RowBox[{"ev", "=", "0.001"}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"thetalist", ",", "success"}], "}"}], " ", "=", " ", 
      RowBox[{
       RowBox[{"IKinSpace", "[", 
        RowBox[{
        "Slist", ",", "M", ",", "T", ",", "thetalist0", ",", "eomg", ",", 
         "ev"}], "]"}], "\[IndentingNewLine]", 
       RowBox[{"Ouput", ":", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "1.5707378450946832", "}"}], ",", 
            RowBox[{"{", "2.9996640511341215", "}"}], ",", 
            RowBox[{"{", "3.1415412500167736", "}"}]}], "}"}], ",", "True"}], 
         "}"}]}]}]}]}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"IKinSpace", "[", 
     RowBox[{
     "Slist_", ",", "M_", ",", "T_", ",", "thetalist0_", ",", "eomg_", ",", 
      "ev_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"Tsb", ",", "Vs", ",", 
        RowBox[{"thetalist", "=", "thetalist0"}], ",", "err", ",", 
        RowBox[{"i", "=", "0"}], ",", 
        RowBox[{"maxiterations", " ", "=", " ", "20"}]}], "}"}], ",", 
      RowBox[{
       RowBox[{"Tsb", "=", 
        RowBox[{"FKinSpace", "[", 
         RowBox[{"M", ",", "Slist", ",", "thetalist"}], "]"}]}], ";", 
       RowBox[{"Vs", " ", "=", " ", 
        RowBox[{
         RowBox[{"Adjoint", "[", "Tsb", "]"}], ".", 
         RowBox[{"se3ToVec", "[", 
          RowBox[{"MatrixLog6", "[", 
           RowBox[{
            RowBox[{"TransInv", "[", "Tsb", "]"}], ".", "T"}], "]"}], 
          "]"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"err", "=", 
        RowBox[{
         RowBox[{
          RowBox[{"Norm", "[", 
           RowBox[{"Vs", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"1", ";;", "3"}], ",", "1"}], "]"}], "]"}], "]"}], ">", 
          "eomg"}], " ", "||", " ", 
         RowBox[{
          RowBox[{"Norm", "[", 
           RowBox[{"Vs", "[", 
            RowBox[{"[", 
             RowBox[{
              RowBox[{"4", ";;", "6"}], ",", "1"}], "]"}], "]"}], "]"}], ">", 
          "ev"}]}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"While", "[", 
        RowBox[{
         RowBox[{"err", " ", "&&", 
          RowBox[{"i", " ", "<", " ", "maxiterations"}]}], ",", 
         RowBox[{
          RowBox[{"thetalist", "=", " ", 
           RowBox[{"thetalist", "+", 
            RowBox[{
             RowBox[{"PseudoInverse", "[", 
              RowBox[{"JacobianSpace", "[", 
               RowBox[{"Slist", ",", "thetalist"}], "]"}], "]"}], ".", 
             "Vs"}]}]}], ";", 
          RowBox[{"i", "++"}], ";", 
          RowBox[{"Tsb", "=", 
           RowBox[{"FKinSpace", "[", 
            RowBox[{"M", ",", "Slist", ",", "thetalist"}], "]"}]}], ";", 
          RowBox[{"Vs", " ", "=", " ", 
           RowBox[{
            RowBox[{"Adjoint", "[", "Tsb", "]"}], ".", 
            RowBox[{"se3ToVec", "[", 
             RowBox[{"MatrixLog6", "[", 
              RowBox[{
               RowBox[{"TransInv", "[", "Tsb", "]"}], ".", "T"}], "]"}], 
             "]"}]}]}], ";", 
          RowBox[{"err", "=", 
           RowBox[{
            RowBox[{
             RowBox[{"Norm", "[", 
              RowBox[{"Vs", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"1", ";;", "3"}], ",", "1"}], "]"}], "]"}], "]"}], 
             ">", "eomg"}], " ", "||", " ", 
            RowBox[{
             RowBox[{"Norm", "[", 
              RowBox[{"Vs", "[", 
               RowBox[{"[", 
                RowBox[{
                 RowBox[{"4", ";;", "6"}], ",", "1"}], "]"}], "]"}], "]"}], 
             ">", "ev"}]}]}]}]}], "]"}], ";", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"thetalist", ",", " ", 
          RowBox[{"!", "err"}]}], "}"}], "]"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.654107438701495*^9, 3.6541075770931664`*^9}, {
   3.6541076103152647`*^9, 3.654107726674172*^9}, {3.654107800327899*^9, 
   3.654107805926005*^9}, {3.654107842157054*^9, 3.654107956534466*^9}, {
   3.6541080276373253`*^9, 3.654108039845397*^9}, {3.654108208328875*^9, 
   3.654108267778264*^9}, {3.654108316603101*^9, 3.65410832858707*^9}, {
   3.654122072990996*^9, 3.654122200142358*^9}, {3.654122232524707*^9, 
   3.6541222637488813`*^9}, {3.654122372486209*^9, 3.65412253592478*^9}, {
   3.654122571686759*^9, 3.654122685636675*^9}, {3.654122740902017*^9, 
   3.6541228215630703`*^9}, {3.654122865671712*^9, 3.654122935620612*^9}, {
   3.654123032181581*^9, 3.6541230914473333`*^9}, {3.654123152783122*^9, 
   3.6541232043612537`*^9}, {3.654123304611115*^9, 3.654123341073502*^9}, {
   3.654123502235703*^9, 3.654123578362132*^9}, {3.654123664279245*^9, 
   3.654123683195951*^9}, {3.6541237878998413`*^9, 3.6541238249788847`*^9}, {
   3.654123940392714*^9, 3.654123947510108*^9}, {3.654124026309593*^9, 
   3.654124026885428*^9}, 3.6541241152729683`*^9, 3.654124170343902*^9, {
   3.6541246995439568`*^9, 3.654124712871656*^9}, {3.6541251843297157`*^9, 
   3.654125231518578*^9}, {3.6541254856851683`*^9, 3.65412548908077*^9}, {
   3.654125547742125*^9, 3.654125551165526*^9}, {3.654125930807577*^9, 
   3.654126007244483*^9}, {3.654126127665163*^9, 3.654126191634789*^9}, {
   3.654126236482831*^9, 3.654126250153975*^9}, {3.6541262848658533`*^9, 
   3.654126288991514*^9}, {3.654126323055903*^9, 3.654126399729628*^9}, {
   3.654126435349374*^9, 3.654126447266036*^9}, {3.654126530077552*^9, 
   3.6541265937421*^9}, {3.654126679867402*^9, 3.6541267650289497`*^9}, {
   3.6541267969631968`*^9, 3.654126798410089*^9}, {3.654126829860013*^9, 
   3.654126881359337*^9}, {3.6541269393824577`*^9, 3.654126959132009*^9}, {
   3.654127079773924*^9, 3.654127194954756*^9}, {3.654127229244482*^9, 
   3.654127253953713*^9}, {3.6541278694900227`*^9, 3.654127878663176*^9}, {
   3.654127969775614*^9, 3.6541279938293123`*^9}, {3.654128051763153*^9, 
   3.654128134016169*^9}, {3.654128326830834*^9, 3.654128326972948*^9}, {
   3.654182305132535*^9, 3.654182317491791*^9}, {3.65418238746202*^9, 
   3.654182511491269*^9}, {3.654182551115921*^9, 3.654182559209998*^9}, {
   3.6541826265390177`*^9, 3.654182732425318*^9}, {3.654182795218339*^9, 
   3.654182802306821*^9}, {3.654182858360195*^9, 3.654182976637673*^9}, {
   3.65418309291822*^9, 3.6541831115452337`*^9}, {3.654183280620055*^9, 
   3.654183381285778*^9}, {3.6541834216733217`*^9, 3.65418343026462*^9}, {
   3.65418347398075*^9, 3.654183479016459*^9}, {3.654183517743698*^9, 
   3.654183590244978*^9}, {3.654183629340012*^9, 3.654183659551435*^9}, {
   3.654183828746057*^9, 3.654183869187777*^9}, {3.654183918271063*^9, 
   3.6541839184304667`*^9}, {3.654206461375032*^9, 3.6542064948942213`*^9}, {
   3.6542065261576433`*^9, 3.654206710642645*^9}, {3.65420685898112*^9, 
   3.654206859498214*^9}, {3.654206912388175*^9, 3.6542069199221067`*^9}, {
   3.654206956850091*^9, 3.654206957769821*^9}, {3.6542070885864773`*^9, 
   3.6542070905801163`*^9}, {3.6542071861274023`*^9, 3.654207197287834*^9}, {
   3.654207355631957*^9, 3.65420737546005*^9}, {3.654207422116619*^9, 
   3.6542074295958633`*^9}, {3.654207513008601*^9, 3.654207622631179*^9}, {
   3.6542077902321663`*^9, 3.6542079082040863`*^9}, {3.654208112675095*^9, 
   3.6542082406765347`*^9}, {3.654208390436673*^9, 3.654208437282127*^9}, {
   3.654208729398788*^9, 3.6542088242969923`*^9}, {3.654208875181876*^9, 
   3.6542089105814543`*^9}, {3.654209036563011*^9, 3.654209042056604*^9}, {
   3.654209131808134*^9, 3.654209211748107*^9}, {3.654277910558556*^9, 
   3.654277962902483*^9}, {3.6542785554956903`*^9, 3.654278555764879*^9}, {
   3.6542801407928543`*^9, 3.654280145647377*^9}, {3.654280336511973*^9, 
   3.654280388661951*^9}, {3.654735519742467*^9, 3.654735526212496*^9}, {
   3.654736711632904*^9, 3.654736744359725*^9}, {3.654736840726715*^9, 
   3.6547369027091503`*^9}, {3.6547369619155817`*^9, 3.65473711893006*^9}, 
   3.654737215212165*^9, {3.6547372623430433`*^9, 3.654737301717353*^9}, {
   3.654737434898181*^9, 3.654737445769989*^9}, {3.654737593349925*^9, 
   3.654737893647337*^9}, {3.654737938282483*^9, 3.654737939560112*^9}, {
   3.654737995469615*^9, 3.65473804382544*^9}, {3.65473814244207*^9, 
   3.65473826286047*^9}, {3.654738473301898*^9, 3.654738519313912*^9}, {
   3.654738551955141*^9, 3.654738559351729*^9}, {3.654738599129403*^9, 
   3.654738599566987*^9}, {3.654738653005966*^9, 3.654738704434928*^9}, {
   3.654738885183668*^9, 3.654738922018218*^9}, {3.654739011880048*^9, 
   3.65473910917871*^9}, {3.654739159170903*^9, 3.654739162120161*^9}, {
   3.6547393230277576`*^9, 3.6547393764227123`*^9}, {3.654739415181912*^9, 
   3.65473942023728*^9}, {3.654739453135948*^9, 3.654739679965816*^9}, {
   3.654739718627033*^9, 3.6547397334487553`*^9}, {3.654739765385715*^9, 
   3.654739851694334*^9}, {3.654739889466123*^9, 3.654740005071364*^9}, {
   3.6547400491757*^9, 3.654740154008595*^9}, 3.654740216700787*^9, {
   3.654740314399178*^9, 3.6547403286014967`*^9}, 3.6547403850818996`*^9, {
   3.654740521314966*^9, 3.654740541208376*^9}, {3.65474063388687*^9, 
   3.654740654515286*^9}, {3.654740701345427*^9, 3.654740810460566*^9}, {
   3.654740848239312*^9, 3.654741082783293*^9}, {3.654741274225429*^9, 
   3.65474127713437*^9}, 3.654741426789631*^9, {3.6547414571147537`*^9, 
   3.654741569824174*^9}, {3.654741604551594*^9, 3.65474161887015*^9}, {
   3.6547416933496304`*^9, 3.654741709459137*^9}, {3.654741935230948*^9, 
   3.654741945307493*^9}, {3.6547830386167917`*^9, 3.654783105454197*^9}, {
   3.6547832406606083`*^9, 3.6547832525310373`*^9}, {3.654783794511154*^9, 
   3.654783837663447*^9}, {3.65478390359721*^9, 3.654783909803577*^9}, {
   3.654783989474423*^9, 3.654784403124803*^9}, {3.654784520313846*^9, 
   3.654784622329711*^9}, {3.6547847231449842`*^9, 3.654784727983326*^9}, {
   3.654785122876478*^9, 3.654785187751635*^9}, {3.654785255283667*^9, 
   3.654785472044736*^9}, {3.654785554330287*^9, 3.6547855634367*^9}, {
   3.6547858133842907`*^9, 3.654785842420493*^9}, {3.654785988696732*^9, 
   3.654785999313698*^9}, {3.654786083383224*^9, 3.654786083827299*^9}, {
   3.654799998454865*^9, 3.654800009014682*^9}, 3.654800058896707*^9, {
   3.6548001027328*^9, 3.654800173381201*^9}, {3.654800206111162*^9, 
   3.654800346038969*^9}, {3.654800415767541*^9, 3.654800685527397*^9}, {
   3.654800717895743*^9, 3.6548007259529123`*^9}, {3.6548007560240192`*^9, 
   3.654800892868227*^9}, {3.654800961067473*^9, 3.6548010443125353`*^9}, {
   3.654801144205307*^9, 3.6548013970409203`*^9}, {3.654801447723054*^9, 
   3.6548014700938597`*^9}, {3.654801562889327*^9, 3.6548017505389137`*^9}, {
   3.6548017965315866`*^9, 3.654801838591158*^9}, {3.654801925163512*^9, 
   3.654801957336872*^9}, {3.654802037838778*^9, 3.654802097667626*^9}, {
   3.6548021338675137`*^9, 3.654802151746142*^9}, {3.6548021938035927`*^9, 
   3.65480226557542*^9}, {3.6548023434469347`*^9, 3.6548024564595747`*^9}, {
   3.654802493167995*^9, 3.654802498462143*^9}, {3.654802632969117*^9, 
   3.654802636326886*^9}, {3.6548026864101667`*^9, 3.6548027624957323`*^9}, {
   3.654802812209731*^9, 3.6548030159498*^9}, {3.6548066359524317`*^9, 
   3.654806720935005*^9}, {3.654806751992766*^9, 3.6548067587144833`*^9}, {
   3.654806821497799*^9, 3.654806889382121*^9}, {3.654807006283039*^9, 
   3.654807210369132*^9}, {3.654807340425975*^9, 3.6548074184588003`*^9}, {
   3.6548074913193197`*^9, 3.654807699931301*^9}, 3.6548078200861998`*^9, {
   3.654807890939335*^9, 3.65480791502777*^9}, {3.654807960842239*^9, 
   3.6548080712336483`*^9}, {3.654808128338978*^9, 3.6548081799548407`*^9}, {
   3.6548101758929577`*^9, 3.654810330104765*^9}, {3.654810401423953*^9, 
   3.654810408457419*^9}, {3.6548104718702717`*^9, 3.6548106690676603`*^9}, {
   3.6548107121438303`*^9, 3.6548108463298893`*^9}, {3.654810878513033*^9, 
   3.6548109250220337`*^9}, {3.654810973064028*^9, 3.6548109963255377`*^9}, {
   3.654811065383171*^9, 3.65481111435124*^9}, {3.6548111568410273`*^9, 
   3.654811165569319*^9}, {3.654811202562601*^9, 3.654811649746052*^9}, {
   3.657067656153129*^9, 3.657067660941557*^9}, {3.6570766750689*^9, 
   3.657076677028944*^9}, {3.658274451899232*^9, 3.6582744912918463`*^9}, {
   3.6583703518545094`*^9, 3.65837035300604*^9}, {3.675682824450754*^9, 
   3.6756828836706333`*^9}, {3.6756829858535852`*^9, 3.675683093476144*^9}, {
   3.675683163431617*^9, 3.675683301926485*^9}, {3.6756834458193197`*^9, 
   3.675683520674423*^9}, {3.675683569012762*^9, 3.675683584065415*^9}, 
   3.675683635500771*^9, {3.675684508273862*^9, 3.675684520687911*^9}, {
   3.675764977565001*^9, 3.675764979617189*^9}, {3.6757662451157312`*^9, 
   3.675766254498831*^9}, {3.675766317871736*^9, 3.675766345394107*^9}, {
   3.6757664078898573`*^9, 3.675766419041957*^9}, {3.6757665260531073`*^9, 
   3.6757665599652433`*^9}, {3.675766688881428*^9, 3.675766693414764*^9}, {
   3.675766760364307*^9, 3.675766898736827*^9}, {3.675766931380547*^9, 
   3.675766932915333*^9}, 3.675767022524777*^9, 3.675767053903921*^9, {
   3.675767094663486*^9, 3.675767157353602*^9}, {3.6757672038039017`*^9, 
   3.67576720815028*^9}, {3.675767263478516*^9, 3.675767302851701*^9}, {
   3.6757673469407463`*^9, 3.6757675158730087`*^9}, {3.675767609117689*^9, 
   3.6757676149377613`*^9}, 3.676110621848937*^9, {3.676110673192341*^9, 
   3.676110708132433*^9}, {3.676110758266004*^9, 3.676110779724792*^9}, {
   3.676110837502541*^9, 3.676110924302658*^9}, {3.676111015370205*^9, 
   3.676111023652515*^9}, {3.676111616884136*^9, 3.676111619101164*^9}, {
   3.67611165132108*^9, 3.67611182175666*^9}, 3.6761124388093357`*^9, {
   3.6761125310577183`*^9, 3.676112535417371*^9}, {3.67611278534865*^9, 
   3.676112852293083*^9}, {3.6761129469420633`*^9, 3.6761129566090517`*^9}, {
   3.6761133261675377`*^9, 3.6761133851728067`*^9}, {3.6761134570078707`*^9, 
   3.6761134886549597`*^9}, {3.676113519585043*^9, 3.676113581404831*^9}, {
   3.676113994051722*^9, 3.6761140495138607`*^9}, {3.67611471759483*^9, 
   3.676114727326268*^9}, {3.676114788083909*^9, 3.676114788267289*^9}, {
   3.67611493328951*^9, 3.6761149644016867`*^9}, {3.6761149993051443`*^9, 
   3.676115038096011*^9}, {3.676115419194528*^9, 3.676115484935451*^9}, {
   3.6761155900865583`*^9, 3.676115605985518*^9}, {3.676115760093829*^9, 
   3.676115778909306*^9}, {3.676115982499289*^9, 3.676116037133542*^9}, {
   3.6761161990700502`*^9, 3.676116233908482*^9}, {3.676116286507206*^9, 
   3.676116286712512*^9}, {3.67611639463448*^9, 3.676116464258135*^9}, {
   3.6761165873897543`*^9, 3.676116602580727*^9}, {3.6761174556753473`*^9, 
   3.67611745672952*^9}, {3.676117506535368*^9, 3.6761175229462357`*^9}, {
   3.676117600215383*^9, 3.6761176442364273`*^9}, {3.676117677849012*^9, 
   3.6761177082717953`*^9}, {3.67611812248459*^9, 3.6761181278825502`*^9}, {
   3.676118580166224*^9, 3.67611860485815*^9}, {3.676118651876894*^9, 
   3.6761187537386017`*^9}, {3.676118838160269*^9, 3.676118838374693*^9}, {
   3.67611887610327*^9, 3.676118940213615*^9}, {3.6761191096213007`*^9, 
   3.676119140757559*^9}, {3.6761192665343122`*^9, 3.676119273783136*^9}, {
   3.67611936142714*^9, 3.676119363325075*^9}, {3.676119488561606*^9, 
   3.676119492487294*^9}, {3.6761200703687267`*^9, 3.6761200707356052`*^9}, {
   3.6761202104386873`*^9, 3.676120268289008*^9}, {3.676120410677075*^9, 
   3.676120443293746*^9}, {3.676120474583932*^9, 3.676120475526285*^9}, {
   3.6761206125852633`*^9, 3.6761206205196333`*^9}, {3.6761234586125507`*^9, 
   3.676123489461384*^9}, {3.6761235483793917`*^9, 3.676123569634534*^9}, {
   3.676124493441423*^9, 3.676124518157651*^9}, {3.676124553443336*^9, 
   3.676124582966502*^9}, {3.6761246820730133`*^9, 3.676124716437358*^9}, {
   3.67612487549886*^9, 3.676124882235661*^9}, {3.676124956893395*^9, 
   3.676124958216114*^9}, {3.6761249904362507`*^9, 3.676124994364197*^9}, {
   3.676125048497746*^9, 3.676125189073619*^9}, {3.676125219923954*^9, 
   3.6761253767254953`*^9}, {3.6761261361020412`*^9, 3.676126180304117*^9}, {
   3.6761262318219957`*^9, 3.676126312208794*^9}, {3.6761263690337877`*^9, 
   3.6761264446350737`*^9}, {3.676126475578731*^9, 3.676126485467072*^9}, {
   3.676126538828438*^9, 3.676126562090301*^9}, {3.676126633785634*^9, 
   3.6761266365895157`*^9}, 3.6761269067489443`*^9, {3.676126941350791*^9, 
   3.676127003932433*^9}, {3.6761275996551237`*^9, 3.676127642283627*^9}, {
   3.6761279161285563`*^9, 3.6761279412801857`*^9}, {3.6761280105764437`*^9, 
   3.676128037774667*^9}, {3.676128092513379*^9, 3.676128127330976*^9}, 
   3.676128221290659*^9, {3.676128273312995*^9, 3.676128326326386*^9}, {
   3.676129382956367*^9, 3.676129408886795*^9}, {3.676129456274128*^9, 
   3.6761295004906263`*^9}, {3.676129547547868*^9, 3.676129590188859*^9}, 
   3.677237481686187*^9, {3.6772375151100492`*^9, 3.677237518364565*^9}, {
   3.677489743906653*^9, 3.677489745104307*^9}, {3.6774903277274837`*^9, 
   3.6774903278784943`*^9}, {3.677836773282992*^9, 3.677836780209435*^9}, 
   3.678096258635654*^9, 3.6890433458033247`*^9, {3.6890434053454146`*^9, 
   3.6890434199284363`*^9}, {3.6890434611274986`*^9, 
   3.6890434997985554`*^9}, {3.689112213714801*^9, 3.6891122722758837`*^9}, {
   3.6891123040729294`*^9, 3.6891123604780345`*^9}, 3.689380295105053*^9, {
   3.6893828628119173`*^9, 3.6893829526540556`*^9}, {3.6910240135629654`*^9, 
   3.6910241507148104`*^9}, {3.6910241972084694`*^9, 3.691024272485775*^9}, {
   3.6924722961669044`*^9, 3.6924724469235272`*^9}, {3.69310628166721*^9, 
   3.693106472273528*^9}, {3.6931538659809017`*^9, 3.693153874670117*^9}, {
   3.693238672584917*^9, 3.693238682509535*^9}, {3.730652218721517*^9, 
   3.730652220724013*^9}, {3.7306522929253364`*^9, 
   3.730652302988132*^9}},ExpressionUUID->"cd8261cd-edb7-439b-80ea-\
07f7f0f661f2"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["CHAPTER  8: DYNAMICS OF OPEN CHAINS",
 FontSize->24,
 FontWeight->"Bold",
 FontColor->RGBColor[0, 0, 1]]], "Title",
 CellChangeTimes->{{3.6755319110417843`*^9, 3.675531927048277*^9}, {
  3.675531958735077*^9, 3.67553201284205*^9}, {3.675607857109823*^9, 
  3.6756079117244864`*^9}, {3.6756821024917507`*^9, 3.6756821283850946`*^9}, {
  3.675777792107044*^9, 3.67577781248841*^9}, {3.676210079313513*^9, 
  3.676210092833352*^9}},ExpressionUUID->"81e5be89-ffaf-473a-8cbb-\
55c594f704e9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"ad", "[", "V_", "]"}], ":", "\[IndentingNewLine]", "   ", 
      RowBox[{
       RowBox[{"Takes", " ", "6"}], "-", 
       RowBox[{"vector", " ", "spatial", " ", 
        RowBox[{"velocity", ".", "\[IndentingNewLine]", "Returns"}], " ", 
        "the", " ", "corresponding", " ", "6", "x6", " ", 
        RowBox[{
         RowBox[{"matrix", "[", "adV", "]"}], ".", "\[IndentingNewLine]", 
         "Used"}], " ", "to", " ", "calculate", " ", "the", " ", "Lie", " ", 
        RowBox[{"bracket", "[", 
         RowBox[{"V1", ",", "V2"}], "]"}]}]}]}], "=", 
     RowBox[{
      RowBox[{"[", "adV1", "]"}], "V2"}]}], "\[IndentingNewLine]", ";", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
     "Example", ":", "\[IndentingNewLine]", " ", "Input", ":", 
      "\[IndentingNewLine]", "V"}], "  ", "=", " ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5", ",", "6"}], 
        "}"}], "}"}], "\[Transpose]"}]}], ";", "\[IndentingNewLine]", "  ", 
    RowBox[{
     RowBox[{"ad", "[", "V", "]"}], "//", 
     RowBox[{"MatrixForm", "\n", 
      RowBox[{"Output", ":", "\[IndentingNewLine]", 
       TagBox[
        RowBox[{"(", "\[NoBreak]", GridBox[{
           {"0", 
            RowBox[{"-", "3"}], "2", "0", "0", "0"},
           {"3", "0", 
            RowBox[{"-", "1"}], "0", "0", "0"},
           {
            RowBox[{"-", "2"}], "1", "0", "0", "0", "0"},
           {"0", 
            RowBox[{"-", "6"}], "5", "0", 
            RowBox[{"-", "3"}], "2"},
           {"6", "0", 
            RowBox[{"-", "4"}], "3", "0", 
            RowBox[{"-", "1"}]},
           {
            RowBox[{"-", "5"}], "4", "0", 
            RowBox[{"-", "2"}], "1", "0"}
          },
          
          GridBoxAlignment->{
           "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
            "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
          GridBoxSpacings->{"Columns" -> {
              Offset[0.27999999999999997`], {
               Offset[0.7]}, 
              Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
              Offset[0.2], {
               Offset[0.4]}, 
              Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
        Function[BoxForm`e$, 
         MatrixForm[BoxForm`e$]]]}]}]}]}], "\[IndentingNewLine]", "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ad", "[", "V_", "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "w", "}"}], ",", 
      RowBox[{
       RowBox[{"w", "=", 
        RowBox[{"VecToso3", "[", 
         RowBox[{"V", "[", 
          RowBox[{"[", 
           RowBox[{"1", ";;", "3"}], "]"}], "]"}], "]"}]}], ";", 
       RowBox[{"Return", "[", 
        RowBox[{"ArrayFlatten", "[", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"w", ",", "0"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"VecToso3", "[", 
              RowBox[{"V", "[", 
               RowBox[{"[", 
                RowBox[{"4", ";;", "6"}], "]"}], "]"}], "]"}], ",", "w"}], 
            "}"}]}], "}"}], "]"}], "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.658273872689763*^9, 3.658273988902459*^9}, {
   3.658274157743518*^9, 3.6582741742369556`*^9}, {3.65827421723704*^9, 
   3.6582742187327127`*^9}, {3.6582742677636137`*^9, 3.658274330534523*^9}, {
   3.658274365312026*^9, 3.6582744138260403`*^9}, {3.658274810942898*^9, 
   3.658274859112701*^9}, {3.658275033847995*^9, 3.658275109340135*^9}, {
   3.658275161547172*^9, 3.6582752536631193`*^9}, {3.65827533442001*^9, 
   3.658275354865328*^9}, {3.6582755590331087`*^9, 3.658275644746291*^9}, {
   3.658275839400229*^9, 3.6582758455265408`*^9}, {3.6582758973266172`*^9, 
   3.658276032713943*^9}, {3.658276065782716*^9, 3.6582762151364822`*^9}, {
   3.658276271302123*^9, 3.6582763371711683`*^9}, 3.658276384203477*^9, {
   3.658276429293391*^9, 3.658276729581854*^9}, {3.658276847155965*^9, 
   3.6582768822910967`*^9}, 3.658277078361019*^9, {3.658277454514134*^9, 
   3.65827755246841*^9}, {3.658277707616706*^9, 3.658277724793824*^9}, {
   3.658277775557291*^9, 3.658277790046358*^9}, {3.6582778408966618`*^9, 
   3.658277880321537*^9}, {3.658277965874803*^9, 3.658278001723259*^9}, {
   3.658278068864526*^9, 3.658278122465324*^9}, {3.6582782743035307`*^9, 
   3.658278463989525*^9}, {3.658278495324057*^9, 3.6582785116036882`*^9}, {
   3.6582787258401527`*^9, 3.6582787620388193`*^9}, {3.658278813660791*^9, 
   3.658278890779448*^9}, {3.658278981426128*^9, 3.6582789851507807`*^9}, {
   3.658279023852993*^9, 3.658279071286935*^9}, {3.6582792891814613`*^9, 
   3.6582793220434237`*^9}, {3.658279596716886*^9, 3.658279661442956*^9}, {
   3.658279700093648*^9, 3.658279706815292*^9}, {3.658279792551382*^9, 
   3.658279815830398*^9}, {3.658279878622261*^9, 3.658279897713276*^9}, {
   3.658279959320986*^9, 3.658279968167665*^9}, {3.658280159539792*^9, 
   3.658280259153908*^9}, {3.658280389314715*^9, 3.658280492142959*^9}, {
   3.65828054504196*^9, 3.6582806104625673`*^9}, {3.658280703485147*^9, 
   3.6582807265634003`*^9}, {3.658280783403376*^9, 3.658280995068233*^9}, {
   3.658332125643222*^9, 3.658332285669385*^9}, {3.658332356434971*^9, 
   3.658332432532056*^9}, {3.6583324694681797`*^9, 3.658332536889868*^9}, {
   3.6583325787135487`*^9, 3.658332603918232*^9}, {3.658332777986459*^9, 
   3.658332831919935*^9}, {3.6583329211917048`*^9, 3.6583329244763107`*^9}, {
   3.65833298690902*^9, 3.6583329940420103`*^9}, {3.658333033513297*^9, 
   3.658333041965459*^9}, {3.658333140934991*^9, 3.6583331410849524`*^9}, {
   3.658333260874716*^9, 3.658333325111835*^9}, {3.6583333640450163`*^9, 
   3.658333602194475*^9}, {3.658333866428316*^9, 3.658333876484424*^9}, {
   3.6583340410637217`*^9, 3.658334041446103*^9}, {3.658334239767832*^9, 
   3.658334256853527*^9}, {3.658334325290709*^9, 3.658334328931733*^9}, {
   3.658334454601124*^9, 3.658334541125682*^9}, {3.658334583676895*^9, 
   3.658334664745475*^9}, {3.658334705147303*^9, 3.6583347127203903`*^9}, {
   3.658334814800128*^9, 3.658334905957917*^9}, {3.658334952676396*^9, 
   3.658334989092309*^9}, {3.658335053255745*^9, 3.658335071690804*^9}, {
   3.658335129550527*^9, 3.658335241594574*^9}, {3.6583353167377977`*^9, 
   3.658335317096506*^9}, {3.658335384569755*^9, 3.658335396679709*^9}, {
   3.658335459752262*^9, 3.658335474398382*^9}, {3.658335569564763*^9, 
   3.6583356135466957`*^9}, {3.658335963702228*^9, 3.6583360118223963`*^9}, {
   3.6583361961257257`*^9, 3.658336324493081*^9}, {3.658336387471901*^9, 
   3.658336413286467*^9}, {3.6583364883081408`*^9, 3.658336518027725*^9}, {
   3.6583497860827847`*^9, 3.658349831490996*^9}, {3.658349861737459*^9, 
   3.658349862153501*^9}, {3.658349942786976*^9, 3.658349965329233*^9}, {
   3.6583500320501423`*^9, 3.658350038684167*^9}, {3.6583500726428823`*^9, 
   3.658350074339263*^9}, {3.658350117777423*^9, 3.658350161383792*^9}, {
   3.6583501955208597`*^9, 3.658350234542882*^9}, {3.6583502755982323`*^9, 
   3.658350338283965*^9}, {3.658350380319613*^9, 3.6583503814310093`*^9}, {
   3.658350450869604*^9, 3.658350549946392*^9}, {3.658350685268361*^9, 
   3.6583506855161467`*^9}, {3.658350727058009*^9, 3.6583507290251617`*^9}, {
   3.658350771093258*^9, 3.658350847603608*^9}, {3.658350951089933*^9, 
   3.658350961855956*^9}, {3.658351021399521*^9, 3.658351021591137*^9}, {
   3.6583511160719757`*^9, 3.658351121390588*^9}, {3.658351310629883*^9, 
   3.658351330581682*^9}, {3.658351453089098*^9, 3.6583514579767447`*^9}, {
   3.6583514969183617`*^9, 3.6583514999993277`*^9}, {3.658351570635014*^9, 
   3.658351577593944*^9}, {3.6583516106406183`*^9, 3.658351657352182*^9}, {
   3.658351766088022*^9, 3.658351770343424*^9}, {3.658351890506502*^9, 
   3.658351904164137*^9}, {3.6583519453391848`*^9, 3.65835200222512*^9}, {
   3.658352444511814*^9, 3.6583524450885687`*^9}, {3.65835945210156*^9, 
   3.658359582160754*^9}, {3.6583597573611526`*^9, 3.658359895421398*^9}, {
   3.6583600200459547`*^9, 3.658360209087796*^9}, {3.6583604062023983`*^9, 
   3.658360556362865*^9}, {3.658369386717368*^9, 3.658369415920825*^9}, {
   3.658369495583129*^9, 3.658369511397794*^9}, {3.658369604058823*^9, 
   3.6583698687217712`*^9}, {3.658369905522255*^9, 3.658370289459115*^9}, {
   3.658435473074052*^9, 3.65843549562414*^9}, {3.658435606368175*^9, 
   3.658435611544252*^9}, {3.6584356461976643`*^9, 3.6584356582216187`*^9}, {
   3.65843569293461*^9, 3.658435693127248*^9}, {3.6584357386455507`*^9, 
   3.6584357504379663`*^9}, {3.658437328158703*^9, 3.658437328842226*^9}, {
   3.658451386320923*^9, 3.658451396416233*^9}, {3.6584514558014927`*^9, 
   3.658451498437763*^9}, {3.65845176533173*^9, 3.658451769500102*^9}, {
   3.658451827834752*^9, 3.658451828192766*^9}, {3.6584518628797626`*^9, 
   3.658451915580929*^9}, {3.658451961311802*^9, 3.658451961463069*^9}, {
   3.658452686235773*^9, 3.658452689778323*^9}, {3.6584528065184526`*^9, 
   3.658452806708708*^9}, {3.6586220651258087`*^9, 3.658622180449822*^9}, {
   3.658622217313324*^9, 3.658622381467565*^9}, {3.658622437008402*^9, 
   3.658622500999549*^9}, {3.658623683248323*^9, 3.6586241287979918`*^9}, {
   3.658624240472498*^9, 3.658624332091518*^9}, {3.6586243934910803`*^9, 
   3.6586246606532173`*^9}, {3.6757780749103928`*^9, 3.675778092666944*^9}, {
   3.6757781317770443`*^9, 3.675778148103283*^9}, {3.675778193206167*^9, 
   3.675778200868908*^9}, {3.6757782344147387`*^9, 3.675778299338944*^9}, {
   3.676118088954138*^9, 3.676118088960745*^9}, {3.676210121948041*^9, 
   3.6762101271997538`*^9}, {3.676212687043581*^9, 3.676212739302689*^9}, {
   3.676212821098608*^9, 3.6762128555983953`*^9}, {3.676212894839349*^9, 
   3.676212899651846*^9}, {3.676213280902792*^9, 3.6762133170611897`*^9}, {
   3.6762133722711687`*^9, 3.676213420278404*^9}, {3.676213490348229*^9, 
   3.676213507276989*^9}, {3.6762136472488127`*^9, 3.676213647419341*^9}, {
   3.676213686097926*^9, 3.676213707298381*^9}, {3.6762137454501057`*^9, 
   3.676213746612797*^9}, {3.6762142650551157`*^9, 3.676214334303116*^9}, {
   3.676216025217536*^9, 3.676216073648109*^9}, {3.676216233956223*^9, 
   3.676216234458477*^9}, {3.6762944072751217`*^9, 3.676294572531825*^9}, 
   3.677238397377141*^9, 3.6772388506211557`*^9, {3.677238962412993*^9, 
   3.677238962996073*^9}, {3.677245446690844*^9, 3.6772454628094*^9}, {
   3.678096299605474*^9, 3.678096309489983*^9}, {3.691027328198552*^9, 
   3.6910274631952734`*^9}, {3.691095227787376*^9, 3.6910952655862427`*^9}, {
   3.6911618379687304`*^9, 3.6911618393415327`*^9}, {3.69247246637964*^9, 
   3.6924724791353693`*^9}, {3.693153895636554*^9, 
   3.693153896931356*^9}},ExpressionUUID->"eebfa9bb-9b2c-44e6-9326-\
456220a27d55"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"InverseDynamics", "[", 
      RowBox[{
      "thetalist_", ",", "dthetalist_", ",", "ddthetalist_", ",", "g_", ",", 
       "Ftip_", ",", "Mlist_", ",", "Glist_", ",", "Slist_"}], "]"}], ":", 
     "\[IndentingNewLine]", "   ", 
     RowBox[{"Takes", " ", "thetalist"}], ":", " ", 
     RowBox[{"n", "-", 
      RowBox[{"vector", " ", "of", " ", "joint", " ", "variables"}]}]}], ",", 
    "\[IndentingNewLine]", "          ", 
    RowBox[{"dthetalist", ":", " ", 
     RowBox[{"n", "-", 
      RowBox[{"vector", " ", "of", " ", "joint", " ", "rates"}]}]}], ",", 
    "\[IndentingNewLine]", "          ", 
    RowBox[{"ddthetalist", ":", " ", 
     RowBox[{"n", "-", 
      RowBox[{"vector", " ", "of", " ", "joint", " ", "accelerations"}]}]}], 
    ",", "\[IndentingNewLine]", "          ", 
    RowBox[{"g", ":", " ", 
     RowBox[{"Gravity", " ", "vector", " ", "g"}]}], ",", 
    "\[IndentingNewLine]", "          ", 
    RowBox[{"Ftip", ":", " ", 
     RowBox[{
      RowBox[{
      "Spatial", " ", "force", " ", "applied", " ", "by", " ", "the", " ", 
       "end"}], "-", 
      RowBox[{"effector", " ", "expressed", " ", "in", " ", "frame", " ", 
       RowBox[{"{", 
        RowBox[{"n", "+", "1"}], "}"}]}]}]}], ",", "\[IndentingNewLine]", 
    "          ", 
    RowBox[{"Mlist", ":", 
     RowBox[{"L", " ", "ist", " ", "of", " ", "link", " ", "frames", " ", 
      RowBox[{"{", "i", "}"}], " ", "relative", " ", "to", " ", 
      RowBox[{"{", 
       RowBox[{"i", "-", "1"}], "}"}], " ", "at", " ", "the", " ", "home", 
      " ", "position"}]}], ",", "\[IndentingNewLine]", "          ", 
    RowBox[{"Glist", ":", " ", 
     RowBox[{
     "Spatial", " ", "inertia", " ", "matrices", " ", "Gi", " ", "of", " ", 
      "the", " ", "links"}]}], ",", "\[IndentingNewLine]", "          ", 
    RowBox[{"Slist", ":", " ", 
     RowBox[{
     "Screw", " ", "axes", " ", "Si", " ", "of", " ", "the", " ", "joints", 
      " ", "in", " ", "a", " ", "space", " ", "frame"}]}], "\:ff0c", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "in", " ", "the", " ", "format", " ", "of", " ", "a", " ", "matrix", 
       " ", "with", " ", "axes", " ", "as", " ", "the", " ", 
       RowBox[{"columns", ".", " ", "\[IndentingNewLine]", " ", "Returns"}], 
       " ", 
       RowBox[{"taulist", ":", 
        RowBox[{
         RowBox[{"The", " ", "n"}], "-", 
         RowBox[{"vector", " ", "of", " ", "required", " ", "joint", " ", 
          RowBox[{"forces", "/", 
           RowBox[{"torques", ".", "\[IndentingNewLine]", "This"}]}], " ", 
          "function", " ", "uses", " ", "forward"}], "-", 
         RowBox[{"backward", " ", "Newton"}], "-", 
         RowBox[{
         "Euler", " ", "iterations", " ", "to", " ", "solve", " ", "the", " ",
           "equation"}]}], ":", "\[IndentingNewLine]", "taulist"}]}], "=", 
      RowBox[{
       RowBox[{"Mlist", 
        RowBox[{"(", "thetalist", ")"}], "ddthetalist"}], "+", 
       RowBox[{"c", 
        RowBox[{"(", 
         RowBox[{"thetalist", ",", "dthetalist"}], ")"}]}], "+", 
       RowBox[{"g", 
        RowBox[{"(", "thetalist", ")"}]}], "+", 
       RowBox[{"Jtr", 
        RowBox[{"(", "thetalist", ")"}], "Ftip"}]}]}], "\[IndentingNewLine]", 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Example", " ", "Input", " ", 
        RowBox[{"(", 
         RowBox[{"3", " ", "Link", " ", "Robot"}], ")"}]}], ":", 
       "\[IndentingNewLine]", "thetalist"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0.1", ",", "0.1", ",", "0.1"}], "}"}], "}"}], 
       "\[Transpose]"}]}], ";", "  ", "\[IndentingNewLine]", "  ", 
     RowBox[{"dthetalist", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0.1", ",", "0.2", ",", "0.3"}], "}"}], "}"}], 
       "\[Transpose]"}]}], ";", "  ", "\[IndentingNewLine]", "  ", 
     RowBox[{"ddthetalist", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"2", ",", "1.5", ",", "1"}], "}"}], "}"}], 
       "\[Transpose]"}]}], ";", " ", "\[IndentingNewLine]", "  ", 
     RowBox[{"g", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", 
          RowBox[{"-", "9.8"}]}], "}"}], "}"}], "\[Transpose]"}]}], ";", " ", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"Ftip", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], 
         "}"}], "}"}], "\[Transpose]"}]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"M01", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.089159"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     " ", "\[IndentingNewLine]", "  ", 
     RowBox[{"M12", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.28"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0.13585"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"M23", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", 
          RowBox[{"-", "0.1197"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.395"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     " ", "\[IndentingNewLine]", "  ", 
     RowBox[{"M34", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.14225"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     " ", "\[IndentingNewLine]", "  ", 
     RowBox[{"G1", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
        "0.010267", ",", "0.010267", ",", "0.00666", ",", "3.7", ",", "3.7", 
         ",", "3.7"}], "}"}], "]"}]}], ";", " ", "\[IndentingNewLine]", "  ", 
     RowBox[{"G2", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
        "0.22689", ",", "0.22689", ",", "0.0151074", ",", "8.393", ",", 
         "8.393", ",", "8.393"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "  ", 
     RowBox[{"G3", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
        "0.0494433", ",", "0.0494433", ",", "0.004095", ",", "2.275", ",", 
         "2.275", ",", "2.275"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "  ", 
     RowBox[{"Glist", "=", 
      RowBox[{"{", 
       RowBox[{"G1", ",", "G2", ",", "G3"}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"Mlist", "=", 
      RowBox[{"{", 
       RowBox[{"M01", ",", "M12", ",", "M23", ",", "M34"}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"Slist", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", 
           RowBox[{"-", "0.089"}], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", 
           RowBox[{"-", "0.089"}], ",", "0", ",", "0.425"}], "}"}]}], "}"}], 
       "\[Transpose]"}]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"taulist", " ", "=", " ", 
      RowBox[{
       RowBox[{"InverseDynamics", "[", 
        RowBox[{
        "thetalist", ",", "dthetalist", ",", "ddthetalist", ",", "g", ",", 
         "Ftip", ",", "Mlist", ",", "Glist", ",", "Slist"}], "]"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Output", ":", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "74.41297704450305", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"-", "32.94408933077205"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"-", "3.218558853605959"}], "}"}]}], "}"}]}]}]}]}]}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"InverseDynamics", "[", 
     RowBox[{
     "thetalist_", ",", "dthetalist_", ",", "ddthetalist_", ",", "g_", ",", 
      "Ftip_", ",", "Mlist_", ",", "Glist_", ",", "Slist_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "n", " ", ",", "Ai", ",", "AdTi", ",", "Ti", ",", "Vi", ",", "Vdi", 
        ",", 
        RowBox[{"Fi", "=", "Ftip"}], ",", "taulist", ",", 
        RowBox[{"Mi", "=", 
         RowBox[{"IdentityMatrix", "[", "4", "]"}]}]}], "}"}], ",", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "thetalist", "]"}]}], ";", 
       RowBox[{"Ai", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"6", ",", "n"}], "}"}]}], "]"}]}], ";", 
       RowBox[{"AdTi", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"Null", ",", 
          RowBox[{"{", 
           RowBox[{"1", ",", 
            RowBox[{"n", "+", "1"}]}], "}"}]}], "]"}]}], ";", 
       RowBox[{"Vi", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"6", ",", 
            RowBox[{"n", "+", "1"}]}], "}"}]}], "]"}]}], ";", 
       RowBox[{"Vdi", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"6", ",", 
            RowBox[{"n", "+", "1"}]}], "}"}]}], "]"}]}], ";", 
       RowBox[{
        RowBox[{"Vdi", "[", 
         RowBox[{"[", 
          RowBox[{
           RowBox[{"4", ";;", "6"}], ",", "1"}], "]"}], "]"}], "=", 
        RowBox[{"Flatten", "[", 
         RowBox[{"-", "g"}], "]"}]}], ";", 
       RowBox[{
        RowBox[{"AdTi", "[", 
         RowBox[{"[", 
          RowBox[{"1", ",", 
           RowBox[{"n", "+", "1"}]}], "]"}], "]"}], "=", 
        RowBox[{"Adjoint", "[", 
         RowBox[{"TransInv", "[", 
          RowBox[{"Mlist", "[", 
           RowBox[{"[", 
            RowBox[{"n", "+", "1"}], "]"}], "]"}], "]"}], "]"}]}], ";", 
       RowBox[{"taulist", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{"n", ",", "1"}], "}"}]}], "]"}]}], ";", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Mi", "=", 
           RowBox[{"Mi", ".", 
            RowBox[{"Mlist", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}]}], ";", 
          RowBox[{
           RowBox[{"Ai", "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", "i"}], "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{"Adjoint", "[", 
             RowBox[{"TransInv", "[", "Mi", "]"}], "]"}], ".", 
            RowBox[{"Slist", "[", 
             RowBox[{"[", 
              RowBox[{";;", ",", "i"}], "]"}], "]"}]}]}], ";", 
          RowBox[{
           RowBox[{"AdTi", "[", 
            RowBox[{"[", 
             RowBox[{"1", ",", "i"}], "]"}], "]"}], "=", 
           RowBox[{"Adjoint", "[", 
            RowBox[{
             RowBox[{"MatrixExp6", "[", 
              RowBox[{"VecTose3", "[", 
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"Ai", "[", 
                   RowBox[{"[", 
                    RowBox[{";;", ",", "i"}], "]"}], "]"}], "}"}], 
                 "\[Transpose]"}], "*", 
                RowBox[{"-", 
                 RowBox[{"thetalist", "[", 
                  RowBox[{"[", 
                   RowBox[{"i", ",", "1"}], "]"}], "]"}]}]}], "]"}], "]"}], 
             ".", 
             RowBox[{"TransInv", "[", 
              RowBox[{"Mlist", "[", 
               RowBox[{"[", "i", "]"}], "]"}], "]"}]}], "]"}]}], ";", 
          RowBox[{
           RowBox[{"Vi", "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", 
              RowBox[{"i", "+", "1"}]}], "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{
             RowBox[{"AdTi", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "i"}], "]"}], "]"}], ".", 
             RowBox[{"Vi", "[", 
              RowBox[{"[", 
               RowBox[{";;", ",", "i"}], "]"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Ai", "[", 
                RowBox[{"[", 
                 RowBox[{";;", ",", "i"}], "]"}], "]"}], "}"}], 
              "\[Transpose]"}], "*", 
             RowBox[{"dthetalist", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}]}]}]}], ";", 
          RowBox[{
           RowBox[{"Vdi", "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", 
              RowBox[{"i", "+", "1"}]}], "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{
             RowBox[{"AdTi", "[", 
              RowBox[{"[", 
               RowBox[{"1", ",", "i"}], "]"}], "]"}], ".", 
             RowBox[{"Vdi", "[", 
              RowBox[{"[", 
               RowBox[{";;", ",", "i"}], "]"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{
              RowBox[{"{", 
               RowBox[{"Ai", "[", 
                RowBox[{"[", 
                 RowBox[{";;", ",", "i"}], "]"}], "]"}], "}"}], 
              "\[Transpose]"}], "*", 
             RowBox[{"ddthetalist", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}]}], "+", 
            RowBox[{
             RowBox[{
              RowBox[{"ad", "[", 
               RowBox[{"Vi", "[", 
                RowBox[{"[", 
                 RowBox[{";;", ",", 
                  RowBox[{"i", "+", "1"}]}], "]"}], "]"}], "]"}], ".", 
              RowBox[{"Ai", "[", 
               RowBox[{"[", 
                RowBox[{";;", ",", "i"}], "]"}], "]"}]}], "*", 
             RowBox[{"dthetalist", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", "1"}], "]"}], "]"}]}]}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "n"}], "}"}]}], "]"}], ";", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Fi", "=", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"AdTi", "[", 
               RowBox[{"[", 
                RowBox[{"1", ",", 
                 RowBox[{"i", "+", "1"}]}], "]"}], "]"}], "\[Transpose]"}], 
             ".", "Fi"}], "+", 
            RowBox[{
             RowBox[{"Glist", "[", 
              RowBox[{"[", "i", "]"}], "]"}], ".", 
             RowBox[{"Vdi", "[", 
              RowBox[{"[", 
               RowBox[{";;", ",", 
                RowBox[{"i", "+", "1"}]}], "]"}], "]"}]}], "-", 
            RowBox[{
             RowBox[{
              RowBox[{"ad", "[", 
               RowBox[{"Vi", "[", 
                RowBox[{"[", 
                 RowBox[{";;", ",", 
                  RowBox[{"i", "+", "1"}]}], "]"}], "]"}], "]"}], 
              "\[Transpose]"}], ".", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Glist", "[", 
                RowBox[{"[", "i", "]"}], "]"}], ".", 
               RowBox[{"Vi", "[", 
                RowBox[{"[", 
                 RowBox[{";;", ",", 
                  RowBox[{"i", "+", "1"}]}], "]"}], "]"}]}], ")"}]}]}]}], ";", 
          RowBox[{
           RowBox[{"taulist", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], "=", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Fi", "\[Transpose]"}], ".", 
              RowBox[{"Ai", "[", 
               RowBox[{"[", 
                RowBox[{";;", ",", "i"}], "]"}], "]"}]}], ")"}], "[", 
            RowBox[{"[", "1", "]"}], "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n", ",", "1", ",", 
           RowBox[{"-", "1"}]}], "}"}]}], "]"}], ";", 
       RowBox[{"Return", "[", "taulist", "]"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.658273872689763*^9, 3.658273988902459*^9}, {
   3.658274157743518*^9, 3.6582741742369556`*^9}, {3.65827421723704*^9, 
   3.6582742187327127`*^9}, {3.6582742677636137`*^9, 3.658274330534523*^9}, {
   3.658274365312026*^9, 3.6582744138260403`*^9}, {3.658274810942898*^9, 
   3.658274859112701*^9}, {3.658275033847995*^9, 3.658275109340135*^9}, {
   3.658275161547172*^9, 3.6582752536631193`*^9}, {3.65827533442001*^9, 
   3.658275354865328*^9}, {3.6582755590331087`*^9, 3.658275644746291*^9}, {
   3.658275839400229*^9, 3.6582758455265408`*^9}, {3.6582758973266172`*^9, 
   3.658276032713943*^9}, {3.658276065782716*^9, 3.6582762151364822`*^9}, {
   3.658276271302123*^9, 3.6582763371711683`*^9}, 3.658276384203477*^9, {
   3.658276429293391*^9, 3.658276729581854*^9}, {3.658276847155965*^9, 
   3.6582768822910967`*^9}, 3.658277078361019*^9, {3.658277454514134*^9, 
   3.65827755246841*^9}, {3.658277707616706*^9, 3.658277724793824*^9}, {
   3.658277775557291*^9, 3.658277790046358*^9}, {3.6582778408966618`*^9, 
   3.658277880321537*^9}, {3.658277965874803*^9, 3.658278001723259*^9}, {
   3.658278068864526*^9, 3.658278122465324*^9}, {3.6582782743035307`*^9, 
   3.658278463989525*^9}, {3.658278495324057*^9, 3.6582785116036882`*^9}, {
   3.6582787258401527`*^9, 3.6582787620388193`*^9}, {3.658278813660791*^9, 
   3.658278890779448*^9}, {3.658278981426128*^9, 3.6582789851507807`*^9}, {
   3.658279023852993*^9, 3.658279071286935*^9}, {3.6582792891814613`*^9, 
   3.6582793220434237`*^9}, {3.658279596716886*^9, 3.658279661442956*^9}, {
   3.658279700093648*^9, 3.658279706815292*^9}, {3.658279792551382*^9, 
   3.658279815830398*^9}, {3.658279878622261*^9, 3.658279897713276*^9}, {
   3.658279959320986*^9, 3.658279968167665*^9}, {3.658280159539792*^9, 
   3.658280259153908*^9}, {3.658280389314715*^9, 3.658280492142959*^9}, {
   3.65828054504196*^9, 3.6582806104625673`*^9}, {3.658280703485147*^9, 
   3.6582807265634003`*^9}, {3.658280783403376*^9, 3.658280995068233*^9}, {
   3.658332125643222*^9, 3.658332285669385*^9}, {3.658332356434971*^9, 
   3.658332432532056*^9}, {3.6583324694681797`*^9, 3.658332536889868*^9}, {
   3.6583325787135487`*^9, 3.658332603918232*^9}, {3.658332777986459*^9, 
   3.658332831919935*^9}, {3.6583329211917048`*^9, 3.6583329244763107`*^9}, {
   3.65833298690902*^9, 3.6583329940420103`*^9}, {3.658333033513297*^9, 
   3.658333041965459*^9}, {3.658333140934991*^9, 3.6583331410849524`*^9}, {
   3.658333260874716*^9, 3.658333325111835*^9}, {3.6583333640450163`*^9, 
   3.658333602194475*^9}, {3.658333866428316*^9, 3.658333876484424*^9}, {
   3.6583340410637217`*^9, 3.658334041446103*^9}, {3.658334239767832*^9, 
   3.658334256853527*^9}, {3.658334325290709*^9, 3.658334328931733*^9}, {
   3.658334454601124*^9, 3.658334541125682*^9}, {3.658334583676895*^9, 
   3.658334664745475*^9}, {3.658334705147303*^9, 3.6583347127203903`*^9}, {
   3.658334814800128*^9, 3.658334905957917*^9}, {3.658334952676396*^9, 
   3.658334989092309*^9}, {3.658335053255745*^9, 3.658335071690804*^9}, {
   3.658335129550527*^9, 3.658335241594574*^9}, {3.6583353167377977`*^9, 
   3.658335317096506*^9}, {3.658335384569755*^9, 3.658335396679709*^9}, {
   3.658335459752262*^9, 3.658335474398382*^9}, {3.658335569564763*^9, 
   3.6583356135466957`*^9}, {3.658335963702228*^9, 3.6583360118223963`*^9}, {
   3.6583361961257257`*^9, 3.658336324493081*^9}, {3.658336387471901*^9, 
   3.658336413286467*^9}, {3.6583364883081408`*^9, 3.658336518027725*^9}, {
   3.6583497860827847`*^9, 3.658349831490996*^9}, {3.658349861737459*^9, 
   3.658349862153501*^9}, {3.658349942786976*^9, 3.658349965329233*^9}, {
   3.6583500320501423`*^9, 3.658350038684167*^9}, {3.6583500726428823`*^9, 
   3.658350074339263*^9}, {3.658350117777423*^9, 3.658350161383792*^9}, {
   3.6583501955208597`*^9, 3.658350234542882*^9}, {3.6583502755982323`*^9, 
   3.658350338283965*^9}, {3.658350380319613*^9, 3.6583503814310093`*^9}, {
   3.658350450869604*^9, 3.658350549946392*^9}, {3.658350685268361*^9, 
   3.6583506855161467`*^9}, {3.658350727058009*^9, 3.6583507290251617`*^9}, {
   3.658350771093258*^9, 3.658350847603608*^9}, {3.658350951089933*^9, 
   3.658350961855956*^9}, {3.658351021399521*^9, 3.658351021591137*^9}, {
   3.6583511160719757`*^9, 3.658351121390588*^9}, {3.658351310629883*^9, 
   3.658351330581682*^9}, {3.658351453089098*^9, 3.6583514579767447`*^9}, {
   3.6583514969183617`*^9, 3.6583514999993277`*^9}, {3.658351570635014*^9, 
   3.658351577593944*^9}, {3.6583516106406183`*^9, 3.658351657352182*^9}, {
   3.658351766088022*^9, 3.658351770343424*^9}, {3.658351890506502*^9, 
   3.658351904164137*^9}, {3.6583519453391848`*^9, 3.65835200222512*^9}, {
   3.658352444511814*^9, 3.6583524450885687`*^9}, {3.65835945210156*^9, 
   3.658359582160754*^9}, {3.6583597573611526`*^9, 3.658359895421398*^9}, {
   3.6583600200459547`*^9, 3.658360209087796*^9}, {3.6583604062023983`*^9, 
   3.658360556362865*^9}, {3.658369386717368*^9, 3.658369415920825*^9}, {
   3.658369495583129*^9, 3.658369511397794*^9}, {3.658369604058823*^9, 
   3.6583698687217712`*^9}, {3.658369905522255*^9, 3.658370289459115*^9}, {
   3.658435473074052*^9, 3.65843549562414*^9}, {3.658435606368175*^9, 
   3.658435611544252*^9}, {3.6584356461976643`*^9, 3.6584356582216187`*^9}, {
   3.65843569293461*^9, 3.658435693127248*^9}, {3.6584357386455507`*^9, 
   3.6584357504379663`*^9}, {3.658437328158703*^9, 3.658437328842226*^9}, {
   3.658451386320923*^9, 3.658451396416233*^9}, {3.6584514558014927`*^9, 
   3.658451498437763*^9}, {3.65845176533173*^9, 3.658451769500102*^9}, {
   3.658451827834752*^9, 3.658451828192766*^9}, {3.6584518628797626`*^9, 
   3.658451915580929*^9}, {3.658451961311802*^9, 3.658451961463069*^9}, {
   3.658452686235773*^9, 3.658452689778323*^9}, {3.6584528065184526`*^9, 
   3.658452806708708*^9}, {3.6586220651258087`*^9, 3.658622180449822*^9}, {
   3.658622217313324*^9, 3.658622381467565*^9}, {3.658622437008402*^9, 
   3.658622500999549*^9}, {3.658623683248323*^9, 3.6586241287979918`*^9}, {
   3.658624240472498*^9, 3.658624332091518*^9}, {3.6586243934910803`*^9, 
   3.6586246606532173`*^9}, {3.6772391025485983`*^9, 3.6772391030813503`*^9}, 
   3.677244355984013*^9, {3.677244432148254*^9, 3.677244504323576*^9}, {
   3.677244554123225*^9, 3.677244576679357*^9}, {3.677244685399939*^9, 
   3.677244756023776*^9}, 3.67724480098313*^9, {3.677245676616014*^9, 
   3.67724568111721*^9}, {3.677246001533386*^9, 3.6772461750994062`*^9}, {
   3.677246209080035*^9, 3.677246229640416*^9}, {3.677246271327312*^9, 
   3.677246312154667*^9}, {3.677246368623028*^9, 3.677246384540496*^9}, {
   3.677246494811397*^9, 3.677246548249215*^9}, {3.677246627246484*^9, 
   3.677246772095085*^9}, {3.67724729367937*^9, 3.677247340339321*^9}, {
   3.677247372979681*^9, 3.677247391909115*^9}, {3.677247561296047*^9, 
   3.6772475644357*^9}, {3.6772476504484663`*^9, 3.6772476565869627`*^9}, {
   3.6772476975735493`*^9, 3.677247723351466*^9}, {3.6772477583612003`*^9, 
   3.677247782172574*^9}, {3.677247813053689*^9, 3.677247821497436*^9}, {
   3.67724786098481*^9, 3.677247887660157*^9}, {3.677247918383231*^9, 
   3.6772479227268*^9}, {3.677248051666149*^9, 3.677248152419401*^9}, {
   3.6772481871568413`*^9, 3.677248213947154*^9}, {3.677248311113554*^9, 
   3.677248386749319*^9}, {3.677248426650477*^9, 3.6772484275017853`*^9}, {
   3.6772485383032217`*^9, 3.677248588205284*^9}, {3.677248681364223*^9, 
   3.6772486890120153`*^9}, {3.6772487541715918`*^9, 
   3.6772488872632723`*^9}, {3.677248932718923*^9, 3.67724893344909*^9}, {
   3.677249002513879*^9, 3.677249115230443*^9}, {3.6772491452713337`*^9, 
   3.677249198829335*^9}, 3.677249242707559*^9, {3.677249353801366*^9, 
   3.6772494274284277`*^9}, {3.6772495211811447`*^9, 3.677249528268223*^9}, {
   3.677249676107225*^9, 3.677249714971898*^9}, {3.677249813626606*^9, 
   3.6772501354896927`*^9}, 3.677250272338114*^9, {3.677250388806677*^9, 
   3.677250512226314*^9}, {3.6772505488546057`*^9, 3.677250548946186*^9}, {
   3.6772506625894833`*^9, 3.677250834033412*^9}, {3.6772508642856293`*^9, 
   3.677250926794492*^9}, {3.677251890854176*^9, 3.677251908541988*^9}, {
   3.677251955063167*^9, 3.677251982543026*^9}, {3.677252082789035*^9, 
   3.677252135707983*^9}, {3.6772547120542088`*^9, 3.677254778367365*^9}, {
   3.677254809940134*^9, 3.677254810694992*^9}, {3.677254936380105*^9, 
   3.6772550358368607`*^9}, {3.677255175840102*^9, 3.677255202520162*^9}, {
   3.6772552720212193`*^9, 3.677255272480659*^9}, 3.677255321516757*^9, 
   3.6772554026994257`*^9, {3.677255533302904*^9, 3.677255548144637*^9}, {
   3.677255924206114*^9, 3.6772559564821453`*^9}, {3.677255990775902*^9, 
   3.6772560084051123`*^9}, {3.677256048499477*^9, 3.677256101134179*^9}, {
   3.677256255849882*^9, 3.677256431791498*^9}, {3.677256470560192*^9, 
   3.677256537679666*^9}, {3.6772567050765944`*^9, 3.6772567532846327`*^9}, {
   3.677256819553606*^9, 3.677256943552742*^9}, {3.677257016408537*^9, 
   3.677257041328187*^9}, {3.677257086092701*^9, 3.677257325334237*^9}, {
   3.6772573735555563`*^9, 3.677257448101842*^9}, {3.6772575152209272`*^9, 
   3.677257535140091*^9}, {3.6772576590287313`*^9, 3.677257677722865*^9}, {
   3.677257729412159*^9, 3.677257788180209*^9}, {3.677257833538631*^9, 
   3.677257942254745*^9}, {3.6772585288153133`*^9, 3.677258592724414*^9}, {
   3.6772588085902243`*^9, 3.677258819342699*^9}, {3.677258983718956*^9, 
   3.6772590167734127`*^9}, {3.677259130975376*^9, 3.6772591650591803`*^9}, {
   3.677259274513762*^9, 3.677259372680434*^9}, {3.677259417310178*^9, 
   3.6772596693390636`*^9}, {3.677259912324069*^9, 3.6772600207718277`*^9}, {
   3.677260060802122*^9, 3.677260207489208*^9}, {3.677260242637308*^9, 
   3.677260382454686*^9}, {3.67726042036277*^9, 3.677260507331476*^9}, {
   3.67726056708534*^9, 3.677260571117894*^9}, 3.677260611982997*^9, {
   3.677260659686365*^9, 3.677260696376569*^9}, {3.677260881888175*^9, 
   3.677260909792899*^9}, {3.677260943377907*^9, 3.677260943956663*^9}, {
   3.677261046331066*^9, 3.67726106321067*^9}, {3.6772611189125423`*^9, 
   3.677261159467651*^9}, {3.6772612579889803`*^9, 3.6772613036200323`*^9}, {
   3.677261343258348*^9, 3.67726164112537*^9}, {3.67726168069374*^9, 
   3.677261684921814*^9}, {3.677261739688339*^9, 3.677261795521442*^9}, {
   3.67726184472169*^9, 3.677261850163794*^9}, {3.677261889920115*^9, 
   3.677261917748721*^9}, {3.677261953319784*^9, 3.677262018774967*^9}, {
   3.6772620665573263`*^9, 3.67726206684867*^9}, {3.677262109500868*^9, 
   3.67726226901488*^9}, {3.677262344350646*^9, 3.6772623894785347`*^9}, {
   3.677262443299412*^9, 3.677262547832739*^9}, {3.6772626032030478`*^9, 
   3.677262634813252*^9}, 3.6772627141364517`*^9, {3.6772627478397913`*^9, 
   3.677262922790249*^9}, {3.6772630014493*^9, 3.6772630257156763`*^9}, 
   3.677315262280599*^9, {3.67749043474179*^9, 3.677490435196591*^9}, 
   3.678096323305634*^9, {3.689425372571526*^9, 3.6894253786515346`*^9}, 
   3.6894255331707864`*^9, {3.6894256983130226`*^9, 3.6894257019930277`*^9}, {
   3.68942594175738*^9, 3.689425947906389*^9}, {3.6910877988152933`*^9, 
   3.69108784198057*^9}, {3.691087942741146*^9, 3.691088086089798*^9}, {
   3.6910899615168066`*^9, 3.691090039782144*^9}, {3.6910900911062346`*^9, 
   3.691090380845543*^9}, {3.6910904608892837`*^9, 3.691090461622485*^9}, {
   3.691090633246855*^9, 3.691090645404476*^9}, {3.691090688852553*^9, 
   3.691090698321769*^9}, {3.691090830722822*^9, 3.6910909020681744`*^9}, {
   3.691090936654836*^9, 3.6910909622428813`*^9}, {3.691091150496703*^9, 
   3.6910911825461597`*^9}, {3.691091267007641*^9, 3.6910912928454895`*^9}, {
   3.691091452032501*^9, 3.691091706237749*^9}, {3.691091806043125*^9, 
   3.6910918338775744`*^9}, {3.6910918795000553`*^9, 
   3.6910920615431805`*^9}, {3.691092124965292*^9, 3.6910921297545004`*^9}, {
   3.6910921680253677`*^9, 3.6910928825158305`*^9}, {3.6910938532617574`*^9, 
   3.6910939062862506`*^9}, {3.691093945348719*^9, 3.691093946487521*^9}, {
   3.691093986002391*^9, 3.69109401976085*^9}, {3.691094099991791*^9, 
   3.691094112799413*^9}, {3.6910941512222805`*^9, 3.6910942130763893`*^9}, {
   3.6910942447756453`*^9, 3.6910943098345594`*^9}, {3.6910943633862534`*^9, 
   3.6910944765020523`*^9}, {3.6910946728164015`*^9, 
   3.6910948599699297`*^9}, {3.6910949224168396`*^9, 
   3.6910949332276583`*^9}, {3.691094975144932*^9, 3.691095007670989*^9}, {
   3.6910950547206717`*^9, 3.691095100865553*^9}, {3.6910951462460327`*^9, 
   3.6910951524548435`*^9}, {3.6910952907022867`*^9, 3.6910952927926903`*^9}, 
   3.6910953256931477`*^9, {3.691095363850815*^9, 3.6910954988222523`*^9}, {
   3.6910955487735395`*^9, 3.691095596603224*^9}, {3.691095637163295*^9, 
   3.691095672107356*^9}, {3.691095718049437*^9, 3.6910957558483033`*^9}, {
   3.691095797625177*^9, 3.6910958338640404`*^9}, {3.6910958989629545`*^9, 
   3.6910959288526073`*^9}, {3.6910959727198844`*^9, 
   3.6910959746386876`*^9}, {3.691096008319147*^9, 3.691096255626381*^9}, {
   3.6910962893692403`*^9, 3.6910963868382115`*^9}, {3.691096435401097*^9, 
   3.691096474697566*^9}, {3.691096507488824*^9, 3.6910965739449406`*^9}, {
   3.691096745202041*^9, 3.6910968655874524`*^9}, {3.6910969087839284`*^9, 
   3.6910969107495317`*^9}, {3.6910969482987976`*^9, 
   3.6910970279213376`*^9}, {3.6910970787618265`*^9, 3.691097124391907*^9}, {
   3.6910971561535625`*^9, 3.6910973171146455`*^9}, {3.691097355490713*^9, 
   3.6910974337716503`*^9}, {3.6910974804157324`*^9, 3.691097579772307*^9}, {
   3.6910976711572676`*^9, 3.6910980782399826`*^9}, {3.6910981464100056`*^9, 
   3.691098181510067*^9}, {3.6910982601090083`*^9, 3.6910982929782662`*^9}, {
   3.6910984759651403`*^9, 3.6910985514104557`*^9}, 3.6910989209605927`*^9, {
   3.691098952641405*^9, 3.6910990286157503`*^9}, {3.6910990813687677`*^9, 
   3.6910990900512643`*^9}, {3.691099122065095*^9, 3.6910991992945127`*^9}, {
   3.6910992359446087`*^9, 3.6910992937299137`*^9}, {3.691099323873638*^9, 
   3.691099377304694*^9}, {3.691099408146458*^9, 3.691099433338899*^9}, {
   3.6910994652877264`*^9, 3.6910995545958347`*^9}, {3.691108080578456*^9, 
   3.6911080965528836`*^9}, {3.691160563848493*^9, 3.691160565938897*^9}, {
   3.691160763173643*^9, 3.691160883091053*^9}, {3.691160934212343*^9, 
   3.69116094973437*^9}, {3.6911610989954324`*^9, 3.6911611191662683`*^9}, {
   3.6911611801623755`*^9, 3.6911611940307994`*^9}, {3.691161287989764*^9, 
   3.6911612974433813`*^9}, {3.6911615389942055`*^9, 
   3.6911615577766385`*^9}, {3.6911616312371674`*^9, 3.6911616374927783`*^9}, 
   3.69116177494462*^9, {3.691161806331875*^9, 3.691161816471893*^9}, {
   3.6912154015777874`*^9, 3.6912154342286444`*^9}, {3.691215597202131*^9, 
   3.6912156235193768`*^9}, {3.692472488882927*^9, 3.692472631883106*^9}, {
   3.693153903935768*^9, 3.6931539074145746`*^9}, {3.730652245281781*^9, 
   3.7306522689027996`*^9}, {3.73065231239746*^9, 
   3.7306523195354214`*^9}},ExpressionUUID->"d13bd5d8-2632-4dc0-b0b1-\
630524e24a38"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"MassMatrix", "[", 
      RowBox[{"thetalist_", ",", "Mlist_", ",", "Glist_", ",", "Slist_"}], 
      "]"}], ":", "\[IndentingNewLine]", "   ", 
     RowBox[{"Takes", " ", "thetalist"}], ":", " ", 
     RowBox[{"A", " ", "list", " ", "of", " ", "joint", " ", "variables"}]}], 
    ",", 
    RowBox[{"Mlist", ":", 
     RowBox[{
      RowBox[{
      "List", " ", "of", " ", "link", " ", "frames", " ", "i", " ", 
       "relative", " ", "to", " ", "i"}], "-", 
      RowBox[{"1", " ", "at", " ", "the", " ", "home", " ", "position"}]}]}], 
    ",", 
    RowBox[{"Glist", ":", 
     RowBox[{
     "Spatial", " ", "inertia", " ", "matrices", " ", "Gi", " ", "of", " ", 
      "the", " ", "links"}]}], ",", "\[IndentingNewLine]", "          ", 
    RowBox[{"Slist", ":", 
     RowBox[{
     "Screw", " ", "axes", " ", "Si", " ", "of", " ", "the", " ", "joints", 
      " ", "in", " ", "a", " ", "space", " ", "frame"}]}], ",", " ", 
    RowBox[{
    "in", " ", "the", " ", "format", " ", "of", " ", "a", " ", "matrix", " ", 
     "with", " ", "axes", " ", "as", " ", "the", " ", 
     RowBox[{"columns", ".", "\[IndentingNewLine]", "  ", "Returns"}], " ", 
     RowBox[{"M", ":", " ", 
      RowBox[{
       RowBox[{
       "The", " ", "numerical", " ", "inertia", " ", "matrix", " ", "M", 
        RowBox[{"(", "thetalist", ")"}], " ", "of", " ", "an", " ", "n"}], 
       "-", 
       RowBox[{
       "joint", " ", "serial", " ", "chain", " ", "at", " ", "the", " ", 
        "given", " ", "configuration", " ", 
        RowBox[{"thetalist", ".", "\[IndentingNewLine]", "This"}], " ", 
        "function", " ", "calls", " ", "InverseDynamics", " ", "n", " ", 
        "times"}]}]}]}], ",", 
    RowBox[{
    "each", " ", "time", " ", "passing", " ", "a", " ", "ddthetalist", " ", 
     "vector", " ", "with", " ", "a", " ", "single", " ", "element", " ", 
     "equal", " ", "to", " ", "one", " ", "and", " ", "all", " ", "other", 
     " ", "inputs", " ", "set", " ", "to", " ", 
     RowBox[{"zero", ".", " ", "Each"}], " ", "call", " ", "of", " ", 
     "InverseDynamics", " ", "generates", " ", "a", " ", "single", " ", 
     "column"}], ",", 
    RowBox[{
     RowBox[{
     "and", " ", "these", " ", "columns", " ", "are", " ", "assembled", " ", 
      "to", " ", "create", " ", "the", " ", "inertia", " ", 
      RowBox[{"matrix", "."}]}], "\[IndentingNewLine]", ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Example", " ", "Input", " ", 
        RowBox[{"(", 
         RowBox[{"3", " ", "Link", " ", "Robot"}], ")"}]}], ":", 
       "\[IndentingNewLine]", "thetalist"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0.1", ",", "0.1", ",", "0.1"}], "}"}], "}"}], 
       "\[Transpose]"}]}], ";", "  ", "\[IndentingNewLine]", "  ", 
     RowBox[{"M01", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.089159"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     " ", "\[IndentingNewLine]", "  ", 
     RowBox[{"M12", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.28"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0.13585"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     " ", "\[IndentingNewLine]", "  ", 
     RowBox[{"M23", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", 
          RowBox[{"-", "0.1197"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.395"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     " ", "\[IndentingNewLine]", "  ", 
     RowBox[{"M34", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.14225"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     " ", "\[IndentingNewLine]", "  ", 
     RowBox[{"G1", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
        "0.010267", ",", "0.010267", ",", "0.00666", ",", "3.7", ",", "3.7", 
         ",", "3.7"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"G2", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
        "0.22689", ",", "0.22689", ",", "0.0151074", ",", "8.393", ",", 
         "8.393", ",", "8.393"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "  ", 
     RowBox[{"G3", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
        "0.0494433", ",", "0.0494433", ",", "0.004095", ",", "2.275", ",", 
         "2.275", ",", "2.275"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "  ", 
     RowBox[{"Glist", "=", 
      RowBox[{"{", 
       RowBox[{"G1", ",", "G2", ",", "G3"}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"Mlist", "=", 
      RowBox[{"{", 
       RowBox[{"M01", ",", "M12", ",", "M23", ",", "M34"}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"Slist", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", 
           RowBox[{"-", "0.089"}], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", 
           RowBox[{"-", "0.089"}], ",", "0", ",", "0.425"}], "}"}]}], "}"}], 
       "\[Transpose]"}]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"M", " ", "=", " ", 
      RowBox[{
       RowBox[{"MassMatrix", "[", 
        RowBox[{"thetalist", ",", "Mlist", ",", "Glist", ",", "Slist"}], 
        "]"}], "//", 
       RowBox[{"MatrixForm", "\[IndentingNewLine]", 
        RowBox[{"Output", ":", "\[IndentingNewLine]", 
         TagBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"22.543338035546054", 
              RowBox[{"-", "0.3071467542246569"}], 
              RowBox[{"-", "0.0071842639094406744"}]},
             {
              RowBox[{"-", "0.307146754224657"}], "1.968507166255545", 
              "0.43215736829319346"},
             {
              RowBox[{"-", "0.007184263909440675"}], "0.43215736829319357", 
              "0.19163085751427505"}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
          Function[BoxForm`e$, 
           MatrixForm[BoxForm`e$]]]}]}]}]}]}]}], "\[IndentingNewLine]", 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"MassMatrix", "[", 
     RowBox[{"thetalist_", ",", "Mlist_", ",", "Glist_", ",", "Slist_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "n", ",", "dthetalist", ",", "ddthetalist", ",", "g", ",", "Ftip", ",",
         "taulist", ",", "M"}], "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"n", " ", "=", " ", 
         RowBox[{"Length", "[", "thetalist", "]"}]}], ";", 
        RowBox[{"M", " ", "=", " ", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "n"}], "}"}]}], "]"}]}], ";"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"ddthetalist", " ", "=", " ", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0", ",", 
             RowBox[{"{", 
              RowBox[{"n", ",", "1"}], "}"}]}], "]"}]}], ";", 
          RowBox[{
           RowBox[{"ddthetalist", "[", 
            RowBox[{"[", 
             RowBox[{"i", ",", "1"}], "]"}], "]"}], " ", "=", " ", "1"}], ";", 
          RowBox[{
           RowBox[{"M", "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", "i"}], "]"}], "]"}], "=", " ", 
           RowBox[{"Flatten", "[", 
            RowBox[{"InverseDynamics", "[", 
             RowBox[{"thetalist", ",", 
              RowBox[{"ConstantArray", "[", 
               RowBox[{"0", ",", 
                RowBox[{"{", 
                 RowBox[{"6", ",", "n"}], "}"}]}], "]"}], ",", "ddthetalist", 
              ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"{", 
                 RowBox[{"0", ",", "0", ",", "0"}], "}"}], "}"}], 
               "\[Transpose]"}], ",", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"{", 
                 RowBox[{
                 "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
                 "}"}], "}"}], "\[Transpose]"}], ",", "Mlist", ",", "Glist", 
              ",", "Slist"}], "]"}], "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", "M", "]"}]}]}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.658273872689763*^9, 3.658273988902459*^9}, {
   3.658274157743518*^9, 3.6582741742369556`*^9}, {3.65827421723704*^9, 
   3.6582742187327127`*^9}, {3.6582742677636137`*^9, 3.658274330534523*^9}, {
   3.658274365312026*^9, 3.6582744138260403`*^9}, {3.658274810942898*^9, 
   3.658274859112701*^9}, {3.658275033847995*^9, 3.658275109340135*^9}, {
   3.658275161547172*^9, 3.6582752536631193`*^9}, {3.65827533442001*^9, 
   3.658275354865328*^9}, {3.6582755590331087`*^9, 3.658275644746291*^9}, {
   3.658275839400229*^9, 3.6582758455265408`*^9}, {3.6582758973266172`*^9, 
   3.658276032713943*^9}, {3.658276065782716*^9, 3.6582762151364822`*^9}, {
   3.658276271302123*^9, 3.6582763371711683`*^9}, 3.658276384203477*^9, {
   3.658276429293391*^9, 3.658276729581854*^9}, {3.658276847155965*^9, 
   3.6582768822910967`*^9}, 3.658277078361019*^9, {3.658277454514134*^9, 
   3.65827755246841*^9}, {3.658277707616706*^9, 3.658277724793824*^9}, {
   3.658277775557291*^9, 3.658277790046358*^9}, {3.6582778408966618`*^9, 
   3.658277880321537*^9}, {3.658277965874803*^9, 3.658278001723259*^9}, {
   3.658278068864526*^9, 3.658278122465324*^9}, {3.6582782743035307`*^9, 
   3.658278463989525*^9}, {3.658278495324057*^9, 3.6582785116036882`*^9}, {
   3.6582787258401527`*^9, 3.6582787620388193`*^9}, {3.658278813660791*^9, 
   3.658278890779448*^9}, {3.658278981426128*^9, 3.6582789851507807`*^9}, {
   3.658279023852993*^9, 3.658279071286935*^9}, {3.6582792891814613`*^9, 
   3.6582793220434237`*^9}, {3.658279596716886*^9, 3.658279661442956*^9}, {
   3.658279700093648*^9, 3.658279706815292*^9}, {3.658279792551382*^9, 
   3.658279815830398*^9}, {3.658279878622261*^9, 3.658279897713276*^9}, {
   3.658279959320986*^9, 3.658279968167665*^9}, {3.658280159539792*^9, 
   3.658280259153908*^9}, {3.658280389314715*^9, 3.658280492142959*^9}, {
   3.65828054504196*^9, 3.6582806104625673`*^9}, {3.658280703485147*^9, 
   3.6582807265634003`*^9}, {3.658280783403376*^9, 3.658280995068233*^9}, {
   3.658332125643222*^9, 3.658332285669385*^9}, {3.658332356434971*^9, 
   3.658332432532056*^9}, {3.6583324694681797`*^9, 3.658332536889868*^9}, {
   3.6583325787135487`*^9, 3.658332603918232*^9}, {3.658332777986459*^9, 
   3.658332831919935*^9}, {3.6583329211917048`*^9, 3.6583329244763107`*^9}, {
   3.65833298690902*^9, 3.6583329940420103`*^9}, {3.658333033513297*^9, 
   3.658333041965459*^9}, {3.658333140934991*^9, 3.6583331410849524`*^9}, {
   3.658333260874716*^9, 3.658333325111835*^9}, {3.6583333640450163`*^9, 
   3.658333602194475*^9}, {3.658333866428316*^9, 3.658333876484424*^9}, {
   3.6583340410637217`*^9, 3.658334041446103*^9}, {3.658334239767832*^9, 
   3.658334256853527*^9}, {3.658334325290709*^9, 3.658334328931733*^9}, {
   3.658334454601124*^9, 3.658334541125682*^9}, {3.658334583676895*^9, 
   3.658334664745475*^9}, {3.658334705147303*^9, 3.6583347127203903`*^9}, {
   3.658334814800128*^9, 3.658334905957917*^9}, {3.658334952676396*^9, 
   3.658334989092309*^9}, {3.658335053255745*^9, 3.658335071690804*^9}, {
   3.658335129550527*^9, 3.658335241594574*^9}, {3.6583353167377977`*^9, 
   3.658335317096506*^9}, {3.658335384569755*^9, 3.658335396679709*^9}, {
   3.658335459752262*^9, 3.658335474398382*^9}, {3.658335569564763*^9, 
   3.6583356135466957`*^9}, {3.658335963702228*^9, 3.6583360118223963`*^9}, {
   3.6583361961257257`*^9, 3.658336324493081*^9}, {3.658336387471901*^9, 
   3.658336413286467*^9}, {3.6583364883081408`*^9, 3.658336518027725*^9}, {
   3.6583497860827847`*^9, 3.658349831490996*^9}, {3.658349861737459*^9, 
   3.658349862153501*^9}, {3.658349942786976*^9, 3.658349965329233*^9}, {
   3.6583500320501423`*^9, 3.658350038684167*^9}, {3.6583500726428823`*^9, 
   3.658350074339263*^9}, {3.658350117777423*^9, 3.658350161383792*^9}, {
   3.6583501955208597`*^9, 3.658350234542882*^9}, {3.6583502755982323`*^9, 
   3.658350338283965*^9}, {3.658350380319613*^9, 3.6583503814310093`*^9}, {
   3.658350450869604*^9, 3.658350549946392*^9}, {3.658350685268361*^9, 
   3.6583506855161467`*^9}, {3.658350727058009*^9, 3.6583507290251617`*^9}, {
   3.658350771093258*^9, 3.658350847603608*^9}, {3.658350951089933*^9, 
   3.658350961855956*^9}, {3.658351021399521*^9, 3.658351021591137*^9}, {
   3.6583511160719757`*^9, 3.658351121390588*^9}, {3.658351310629883*^9, 
   3.658351330581682*^9}, {3.658351453089098*^9, 3.6583514579767447`*^9}, {
   3.6583514969183617`*^9, 3.6583514999993277`*^9}, {3.658351570635014*^9, 
   3.658351577593944*^9}, {3.6583516106406183`*^9, 3.658351657352182*^9}, {
   3.658351766088022*^9, 3.658351770343424*^9}, {3.658351890506502*^9, 
   3.658351904164137*^9}, {3.6583519453391848`*^9, 3.65835200222512*^9}, {
   3.658352444511814*^9, 3.6583524450885687`*^9}, {3.65835945210156*^9, 
   3.658359582160754*^9}, {3.6583597573611526`*^9, 3.658359895421398*^9}, {
   3.6583600200459547`*^9, 3.658360209087796*^9}, {3.6583604062023983`*^9, 
   3.658360556362865*^9}, {3.658369386717368*^9, 3.658369415920825*^9}, {
   3.658369495583129*^9, 3.658369511397794*^9}, {3.658369604058823*^9, 
   3.6583698687217712`*^9}, {3.658369905522255*^9, 3.658370289459115*^9}, {
   3.658435473074052*^9, 3.65843549562414*^9}, {3.658435606368175*^9, 
   3.658435611544252*^9}, {3.6584356461976643`*^9, 3.6584356582216187`*^9}, {
   3.65843569293461*^9, 3.658435693127248*^9}, {3.6584357386455507`*^9, 
   3.6584357504379663`*^9}, {3.658437328158703*^9, 3.658437328842226*^9}, {
   3.658451386320923*^9, 3.658451396416233*^9}, {3.6584514558014927`*^9, 
   3.658451498437763*^9}, {3.65845176533173*^9, 3.658451769500102*^9}, {
   3.658451827834752*^9, 3.658451828192766*^9}, {3.6584518628797626`*^9, 
   3.658451915580929*^9}, {3.658451961311802*^9, 3.658451961463069*^9}, {
   3.658452686235773*^9, 3.658452689778323*^9}, {3.6584528065184526`*^9, 
   3.658452806708708*^9}, {3.6586220651258087`*^9, 3.658622180449822*^9}, {
   3.658622217313324*^9, 3.658622381467565*^9}, {3.658622437008402*^9, 
   3.658622500999549*^9}, {3.658623683248323*^9, 3.6586241287979918`*^9}, {
   3.658624240472498*^9, 3.658624332091518*^9}, {3.6586243934910803`*^9, 
   3.6586246606532173`*^9}, {3.677315383100857*^9, 3.6773153874097767`*^9}, {
   3.677315451577257*^9, 3.67731550527804*^9}, {3.677315540973567*^9, 
   3.67731554925203*^9}, {3.677315687843329*^9, 3.677315714044332*^9}, {
   3.677316340908476*^9, 3.6773165375560226`*^9}, {3.677316574393567*^9, 
   3.6773165751686068`*^9}, {3.677316741164989*^9, 3.677316779517893*^9}, {
   3.67731693109394*^9, 3.677316983329446*^9}, {3.677317041029996*^9, 
   3.677317088346855*^9}, {3.6773171561703167`*^9, 3.677317188692944*^9}, {
   3.677318007172571*^9, 3.677318025098009*^9}, {3.677490445750225*^9, 
   3.677490446389659*^9}, 3.678096332476907*^9, {3.681451008340869*^9, 
   3.681451020942246*^9}, {3.6911117904422407`*^9, 3.69111183014431*^9}, {
   3.6911119168336625`*^9, 3.6911121390716524`*^9}, {3.6911121834537306`*^9, 
   3.6911122504246483`*^9}, {3.691160202785859*^9, 3.691160204377062*^9}, 
   3.6911602529555473`*^9, {3.6924727035902076`*^9, 3.6924728492545395`*^9}, {
   3.6931539138105855`*^9, 3.693153917476592*^9}, {3.693162166200325*^9, 
   3.6931621959781785`*^9}, {3.73065233340291*^9, 
   3.7306523386703863`*^9}},ExpressionUUID->"92528685-883e-4c0c-bac2-\
bf106210e42b"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"VelQuadraticForces", "[", 
      RowBox[{
      "thetalist_", ",", "dthetalist_", ",", "Mlist_", ",", "Glist_", ",", 
       "Slist_"}], "]"}], ":", "\[IndentingNewLine]", "   ", 
     RowBox[{"Takes", " ", "thetalist"}], ":", " ", 
     RowBox[{"A", " ", "list", " ", "of", " ", "joint", " ", "variables"}]}], 
    ",", "\[IndentingNewLine]", "          ", 
    RowBox[{"dthetalist", ":", " ", 
     RowBox[{"A", " ", "list", " ", "of", " ", "joint", " ", "rates"}]}], ",",
     "\[IndentingNewLine]", "          ", 
    RowBox[{"Mlist", ":", " ", 
     RowBox[{
      RowBox[{
      "List", " ", "of", " ", "link", " ", "frames", " ", "i", " ", 
       "relative", " ", "to", " ", "i"}], "-", 
      RowBox[{"1", " ", "at", " ", "the", " ", "home", " ", "position"}]}]}], 
    ",", "\[IndentingNewLine]", "          ", 
    RowBox[{"Glist", ":", " ", 
     RowBox[{
     "Spatial", " ", "inertia", " ", "matrices", " ", "Gi", " ", "of", " ", 
      "the", " ", "links"}]}], ",", "\[IndentingNewLine]", "          ", 
    RowBox[{"Slist", ":", " ", 
     RowBox[{
     "Screw", " ", "axes", " ", "Si", " ", "of", " ", "the", " ", "joints", 
      " ", "in", " ", "a", " ", "space", " ", "frame"}]}], ",", " ", 
    RowBox[{
     RowBox[{
     "in", " ", "the", " ", "format", " ", "of", " ", "a", " ", "matrix", " ",
       "with", " ", "axes", " ", "as", " ", "the", " ", 
      RowBox[{"columns", ".", "\[IndentingNewLine]", " ", "Returns"}], " ", 
      RowBox[{"c", ":", " ", 
       RowBox[{"The", " ", "vector", " ", "c", 
        RowBox[{"(", 
         RowBox[{"thetalist", ",", "dthetalist"}], ")"}], " ", "of", " ", 
        "Coriolis", " ", "and", " ", "centripetal", " ", "terms", " ", "for", 
        " ", "a", " ", "given", " ", "thetalist", " ", "and", " ", 
        RowBox[{"dthetalist", ".", "\n", "    ", "This"}], " ", "function", 
        " ", "calls", " ", "InverseDynamics", " ", "with", " ", "g"}]}]}], 
     "=", "0"}], ",", 
    RowBox[{"Ftip", "=", "0"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"and", " ", "ddthetalist"}], "=", "0."}], "\[IndentingNewLine]",
      ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Example", " ", "Input", " ", 
        RowBox[{"(", 
         RowBox[{"3", " ", "Link", " ", "Robot"}], ")"}]}], ":", 
       "\[IndentingNewLine]", "thetalist"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0.1", ",", "0.1", ",", "0.1"}], "}"}], "}"}], 
       "\[Transpose]"}]}], ";", "  ", "\[IndentingNewLine]", "  ", 
     RowBox[{"dthetalist", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0.1", ",", "0.2", ",", "0.3"}], "}"}], "}"}], 
       "\[Transpose]"}]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"M01", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.089159"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"M12", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.28"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0.13585"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"M23", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", 
          RowBox[{"-", "0.1197"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.395"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"M34", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.14225"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"G1", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
        "0.010267", ",", "0.010267", ",", "0.00666", ",", "3.7", ",", "3.7", 
         ",", "3.7"}], "}"}], "]"}]}], ";", " ", "\[IndentingNewLine]", "  ", 
     RowBox[{"G2", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
        "0.22689", ",", "0.22689", ",", "0.0151074", ",", "8.393", ",", 
         "8.393", ",", "8.393"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "  ", 
     RowBox[{"G3", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
        "0.0494433", ",", "0.0494433", ",", "0.004095", ",", "2.275", ",", 
         "2.275", ",", "2.275"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "  ", 
     RowBox[{"Glist", "=", 
      RowBox[{"{", 
       RowBox[{"G1", ",", "G2", ",", "G3"}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"Mlist", "=", 
      RowBox[{"{", 
       RowBox[{"M01", ",", "M12", ",", "M23", ",", "M34"}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"Slist", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", 
           RowBox[{"-", "0.089"}], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", 
           RowBox[{"-", "0.089"}], ",", "0", ",", "0.425"}], "}"}]}], "}"}], 
       "\[Transpose]"}]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"c", " ", "=", " ", 
      RowBox[{
       RowBox[{"VelQuadraticForces", "[", 
        RowBox[{
        "thetalist", ",", "dthetalist", ",", "Mlist", ",", "Glist", ",", 
         "Slist"}], "]"}], "//", 
       RowBox[{"MatrixForm", "\[IndentingNewLine]", 
        RowBox[{"Output", ":", "\[IndentingNewLine]", 
         TagBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"0.26453118054501235"},
             {
              RowBox[{"-", "0.0550515682891655"}]},
             {
              RowBox[{"-", "0.006891320068248913"}]}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
          Function[BoxForm`e$, 
           MatrixForm[BoxForm`e$]]]}]}]}]}]}]}], "\[IndentingNewLine]", 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"VelQuadraticForces", "[", 
     RowBox[{
     "thetalist_", ",", "dthetalist_", ",", "Mlist_", ",", "Glist_", ",", 
      "Slist_"}], "]"}], ":=", 
    RowBox[{"InverseDynamics", "[", 
     RowBox[{"thetalist", ",", "dthetalist", ",", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"0", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Length", "[", "thetalist", "]"}], ",", "1"}], "}"}]}], 
       "]"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}], "}"}], "\[Transpose]"}], 
      ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
         "}"}], "}"}], "\[Transpose]"}], ",", "Mlist", ",", "Glist", ",", 
      "Slist"}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.658273872689763*^9, 3.658273988902459*^9}, {
   3.658274157743518*^9, 3.6582741742369556`*^9}, {3.65827421723704*^9, 
   3.6582742187327127`*^9}, {3.6582742677636137`*^9, 3.658274330534523*^9}, {
   3.658274365312026*^9, 3.6582744138260403`*^9}, {3.658274810942898*^9, 
   3.658274859112701*^9}, {3.658275033847995*^9, 3.658275109340135*^9}, {
   3.658275161547172*^9, 3.6582752536631193`*^9}, {3.65827533442001*^9, 
   3.658275354865328*^9}, {3.6582755590331087`*^9, 3.658275644746291*^9}, {
   3.658275839400229*^9, 3.6582758455265408`*^9}, {3.6582758973266172`*^9, 
   3.658276032713943*^9}, {3.658276065782716*^9, 3.6582762151364822`*^9}, {
   3.658276271302123*^9, 3.6582763371711683`*^9}, 3.658276384203477*^9, {
   3.658276429293391*^9, 3.658276729581854*^9}, {3.658276847155965*^9, 
   3.6582768822910967`*^9}, 3.658277078361019*^9, {3.658277454514134*^9, 
   3.65827755246841*^9}, {3.658277707616706*^9, 3.658277724793824*^9}, {
   3.658277775557291*^9, 3.658277790046358*^9}, {3.6582778408966618`*^9, 
   3.658277880321537*^9}, {3.658277965874803*^9, 3.658278001723259*^9}, {
   3.658278068864526*^9, 3.658278122465324*^9}, {3.6582782743035307`*^9, 
   3.658278463989525*^9}, {3.658278495324057*^9, 3.6582785116036882`*^9}, {
   3.6582787258401527`*^9, 3.6582787620388193`*^9}, {3.658278813660791*^9, 
   3.658278890779448*^9}, {3.658278981426128*^9, 3.6582789851507807`*^9}, {
   3.658279023852993*^9, 3.658279071286935*^9}, {3.6582792891814613`*^9, 
   3.6582793220434237`*^9}, {3.658279596716886*^9, 3.658279661442956*^9}, {
   3.658279700093648*^9, 3.658279706815292*^9}, {3.658279792551382*^9, 
   3.658279815830398*^9}, {3.658279878622261*^9, 3.658279897713276*^9}, {
   3.658279959320986*^9, 3.658279968167665*^9}, {3.658280159539792*^9, 
   3.658280259153908*^9}, {3.658280389314715*^9, 3.658280492142959*^9}, {
   3.65828054504196*^9, 3.6582806104625673`*^9}, {3.658280703485147*^9, 
   3.6582807265634003`*^9}, {3.658280783403376*^9, 3.658280995068233*^9}, {
   3.658332125643222*^9, 3.658332285669385*^9}, {3.658332356434971*^9, 
   3.658332432532056*^9}, {3.6583324694681797`*^9, 3.658332536889868*^9}, {
   3.6583325787135487`*^9, 3.658332603918232*^9}, {3.658332777986459*^9, 
   3.658332831919935*^9}, {3.6583329211917048`*^9, 3.6583329244763107`*^9}, {
   3.65833298690902*^9, 3.6583329940420103`*^9}, {3.658333033513297*^9, 
   3.658333041965459*^9}, {3.658333140934991*^9, 3.6583331410849524`*^9}, {
   3.658333260874716*^9, 3.658333325111835*^9}, {3.6583333640450163`*^9, 
   3.658333602194475*^9}, {3.658333866428316*^9, 3.658333876484424*^9}, {
   3.6583340410637217`*^9, 3.658334041446103*^9}, {3.658334239767832*^9, 
   3.658334256853527*^9}, {3.658334325290709*^9, 3.658334328931733*^9}, {
   3.658334454601124*^9, 3.658334541125682*^9}, {3.658334583676895*^9, 
   3.658334664745475*^9}, {3.658334705147303*^9, 3.6583347127203903`*^9}, {
   3.658334814800128*^9, 3.658334905957917*^9}, {3.658334952676396*^9, 
   3.658334989092309*^9}, {3.658335053255745*^9, 3.658335071690804*^9}, {
   3.658335129550527*^9, 3.658335241594574*^9}, {3.6583353167377977`*^9, 
   3.658335317096506*^9}, {3.658335384569755*^9, 3.658335396679709*^9}, {
   3.658335459752262*^9, 3.658335474398382*^9}, {3.658335569564763*^9, 
   3.6583356135466957`*^9}, {3.658335963702228*^9, 3.6583360118223963`*^9}, {
   3.6583361961257257`*^9, 3.658336324493081*^9}, {3.658336387471901*^9, 
   3.658336413286467*^9}, {3.6583364883081408`*^9, 3.658336518027725*^9}, {
   3.6583497860827847`*^9, 3.658349831490996*^9}, {3.658349861737459*^9, 
   3.658349862153501*^9}, {3.658349942786976*^9, 3.658349965329233*^9}, {
   3.6583500320501423`*^9, 3.658350038684167*^9}, {3.6583500726428823`*^9, 
   3.658350074339263*^9}, {3.658350117777423*^9, 3.658350161383792*^9}, {
   3.6583501955208597`*^9, 3.658350234542882*^9}, {3.6583502755982323`*^9, 
   3.658350338283965*^9}, {3.658350380319613*^9, 3.6583503814310093`*^9}, {
   3.658350450869604*^9, 3.658350549946392*^9}, {3.658350685268361*^9, 
   3.6583506855161467`*^9}, {3.658350727058009*^9, 3.6583507290251617`*^9}, {
   3.658350771093258*^9, 3.658350847603608*^9}, {3.658350951089933*^9, 
   3.658350961855956*^9}, {3.658351021399521*^9, 3.658351021591137*^9}, {
   3.6583511160719757`*^9, 3.658351121390588*^9}, {3.658351310629883*^9, 
   3.658351330581682*^9}, {3.658351453089098*^9, 3.6583514579767447`*^9}, {
   3.6583514969183617`*^9, 3.6583514999993277`*^9}, {3.658351570635014*^9, 
   3.658351577593944*^9}, {3.6583516106406183`*^9, 3.658351657352182*^9}, {
   3.658351766088022*^9, 3.658351770343424*^9}, {3.658351890506502*^9, 
   3.658351904164137*^9}, {3.6583519453391848`*^9, 3.65835200222512*^9}, {
   3.658352444511814*^9, 3.6583524450885687`*^9}, {3.65835945210156*^9, 
   3.658359582160754*^9}, {3.6583597573611526`*^9, 3.658359895421398*^9}, {
   3.6583600200459547`*^9, 3.658360209087796*^9}, {3.6583604062023983`*^9, 
   3.658360556362865*^9}, {3.658369386717368*^9, 3.658369415920825*^9}, {
   3.658369495583129*^9, 3.658369511397794*^9}, {3.658369604058823*^9, 
   3.6583698687217712`*^9}, {3.658369905522255*^9, 3.658370289459115*^9}, {
   3.658435473074052*^9, 3.65843549562414*^9}, {3.658435606368175*^9, 
   3.658435611544252*^9}, {3.6584356461976643`*^9, 3.6584356582216187`*^9}, {
   3.65843569293461*^9, 3.658435693127248*^9}, {3.6584357386455507`*^9, 
   3.6584357504379663`*^9}, {3.658437328158703*^9, 3.658437328842226*^9}, {
   3.658451386320923*^9, 3.658451396416233*^9}, {3.6584514558014927`*^9, 
   3.658451498437763*^9}, {3.65845176533173*^9, 3.658451769500102*^9}, {
   3.658451827834752*^9, 3.658451828192766*^9}, {3.6584518628797626`*^9, 
   3.658451915580929*^9}, {3.658451961311802*^9, 3.658451961463069*^9}, {
   3.658452686235773*^9, 3.658452689778323*^9}, {3.6584528065184526`*^9, 
   3.658452806708708*^9}, {3.6586220651258087`*^9, 3.658622180449822*^9}, {
   3.658622217313324*^9, 3.658622381467565*^9}, {3.658622437008402*^9, 
   3.658622500999549*^9}, {3.658623683248323*^9, 3.6586241287979918`*^9}, {
   3.658624240472498*^9, 3.658624332091518*^9}, {3.6586243934910803`*^9, 
   3.6586246606532173`*^9}, {3.677317411138452*^9, 3.677317488094689*^9}, {
   3.677317526836624*^9, 3.6773175326578627`*^9}, {3.677317664909581*^9, 
   3.6773177047834806`*^9}, {3.677317735802031*^9, 3.677317802344627*^9}, {
   3.677317840881192*^9, 3.677317897783889*^9}, {3.677317993699333*^9, 
   3.677317999721787*^9}, {3.677318816262457*^9, 3.6773188165402718`*^9}, {
   3.677490452561892*^9, 3.6774904527054863`*^9}, 3.6780963385542927`*^9, {
   3.678449190708435*^9, 3.6784492009951878`*^9}, 3.6911133614117994`*^9, {
   3.691113616815448*^9, 3.691113618359851*^9}, {3.691159215370124*^9, 
   3.6911592166493263`*^9}, {3.6911592647286105`*^9, 
   3.6911593580479746`*^9}, {3.69115942412969*^9, 3.691159444487726*^9}, {
   3.69115952638027*^9, 3.6911595273006716`*^9}, {3.6911618605419703`*^9, 
   3.691161876032797*^9}, {3.692472871888834*^9, 3.6924730025533075`*^9}, {
   3.6931539222814007`*^9, 3.6931539237946033`*^9}, {3.730652349345854*^9, 
   3.730652356540124*^9}},ExpressionUUID->"f3f61900-aa02-4fd1-9e7e-\
e8d496ab43f7"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"GravityForces", "[", 
      RowBox[{
      "thetalist_", ",", "g_", ",", "Mlist_", ",", "Glist_", ",", "Slist_"}], 
      "]"}], ":", "\[IndentingNewLine]", "   ", 
     RowBox[{"Takes", " ", "thetalist"}], ":", " ", 
     RowBox[{"A", " ", "list", " ", "of", " ", "joint", " ", "variables"}]}], 
    ",", "\[IndentingNewLine]", "          ", 
    RowBox[{"g", ":", " ", 
     RowBox[{"3", "-", 
      RowBox[{
      "vector", " ", "for", " ", "gravitational", " ", "acceleration"}]}]}], 
    ",", "\[IndentingNewLine]", "          ", 
    RowBox[{"Mlist", ":", " ", 
     RowBox[{
      RowBox[{
      "List", " ", "of", " ", "link", " ", "frames", " ", "i", " ", 
       "relative", " ", "to", " ", "i"}], "-", 
      RowBox[{"1", " ", "at", " ", "the", " ", "home", " ", "position"}]}]}], 
    ",", "\[IndentingNewLine]", "          ", 
    RowBox[{"Glist", ":", " ", 
     RowBox[{
     "Spatial", " ", "inertia", " ", "matrices", " ", "Gi", " ", "of", " ", 
      "the", " ", "links"}]}], ",", "\[IndentingNewLine]", "          ", 
    RowBox[{"Slist", ":", " ", 
     RowBox[{
     "Screw", " ", "axes", " ", "Si", " ", "of", " ", "the", " ", "joints", 
      " ", "in", " ", "a", " ", "space", " ", "frame"}]}], ",", " ", 
    RowBox[{
     RowBox[{
     "in", " ", "the", " ", "format", " ", "of", " ", "a", " ", "matrix", " ",
       "with", " ", "axes", " ", "as", " ", "the", " ", 
      RowBox[{"columns", ".", "\[IndentingNewLine]", " ", "Returns"}], " ", 
      RowBox[{"grav", ":", " ", 
       RowBox[{"The", " ", "joint", " ", 
        RowBox[{"forces", "/", "torques"}], " ", "required", " ", "to", " ", 
        "overcome", " ", "gravity", " ", "at", " ", 
        RowBox[{"thetalist", ".", "\n", "    ", "This"}], " ", "function", 
        " ", "calls", " ", "InverseDynamics", " ", "with", " ", "Ftip"}]}]}], 
     "=", "0"}], ",", 
    RowBox[{"dthetalist", "=", "0"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"and", " ", "ddthetalist"}], "=", "0."}], "\[IndentingNewLine]",
      ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Example", " ", "Input", " ", 
        RowBox[{"(", 
         RowBox[{"3", " ", "Link", " ", "Robot"}], ")"}]}], ":", 
       "\[IndentingNewLine]", "thetalist"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0.1", ",", "0.1", ",", "0.1"}], "}"}], "}"}], 
       "\[Transpose]"}]}], ";", "  ", "\[IndentingNewLine]", "  ", 
     RowBox[{"g", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", 
          RowBox[{"-", "9.8"}]}], "}"}], "}"}], "\[Transpose]"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"M01", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.089159"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"M12", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.28"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0.13585"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"M23", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", 
          RowBox[{"-", "0.1197"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.395"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"M34", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.14225"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"G1", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
        "0.010267", ",", "0.010267", ",", "0.00666", ",", "3.7", ",", "3.7", 
         ",", "3.7"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"G2", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
        "0.22689", ",", "0.22689", ",", "0.0151074", ",", "8.393", ",", 
         "8.393", ",", "8.393"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "  ", 
     RowBox[{"G3", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
        "0.0494433", ",", "0.0494433", ",", "0.004095", ",", "2.275", ",", 
         "2.275", ",", "2.275"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "  ", 
     RowBox[{"Glist", "=", 
      RowBox[{"{", 
       RowBox[{"G1", ",", "G2", ",", "G3"}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"Mlist", "=", 
      RowBox[{"{", 
       RowBox[{"M01", ",", "M12", ",", "M23", ",", "M34"}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"Slist", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", 
           RowBox[{"-", "0.089"}], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", 
           RowBox[{"-", "0.089"}], ",", "0", ",", "0.425"}], "}"}]}], "}"}], 
       "\[Transpose]"}]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"grav", " ", "=", " ", 
      RowBox[{
       RowBox[{"GravityForces", "[", 
        RowBox[{
        "thetalist", ",", "g", ",", "Mlist", ",", "Glist", ",", "Slist"}], 
        "]"}], "\[IndentingNewLine]", 
       RowBox[{"Output", ":", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "28.40331261821983", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"-", "37.64094817177068"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"-", "5.4415891999683605"}], "}"}]}], "}"}]}]}]}]}]}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"GravityForces", "[", 
     RowBox[{
     "thetalist_", ",", "g_", ",", "Mlist_", ",", "Glist_", ",", "Slist_"}], 
     "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "thetalist", "]"}]}], "}"}], ",", 
      RowBox[{"Return", "[", 
       RowBox[{"InverseDynamics", "[", 
        RowBox[{"thetalist", ",", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "1"}], "}"}]}], "]"}], ",", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "1"}], "}"}]}], "]"}], ",", "g", ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
            "}"}], "}"}], "\[Transpose]"}], ",", "Mlist", ",", "Glist", ",", 
         "Slist"}], "]"}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.658273872689763*^9, 3.658273988902459*^9}, {
   3.658274157743518*^9, 3.6582741742369556`*^9}, {3.65827421723704*^9, 
   3.6582742187327127`*^9}, {3.6582742677636137`*^9, 3.658274330534523*^9}, {
   3.658274365312026*^9, 3.6582744138260403`*^9}, {3.658274810942898*^9, 
   3.658274859112701*^9}, {3.658275033847995*^9, 3.658275109340135*^9}, {
   3.658275161547172*^9, 3.6582752536631193`*^9}, {3.65827533442001*^9, 
   3.658275354865328*^9}, {3.6582755590331087`*^9, 3.658275644746291*^9}, {
   3.658275839400229*^9, 3.6582758455265408`*^9}, {3.6582758973266172`*^9, 
   3.658276032713943*^9}, {3.658276065782716*^9, 3.6582762151364822`*^9}, {
   3.658276271302123*^9, 3.6582763371711683`*^9}, 3.658276384203477*^9, {
   3.658276429293391*^9, 3.658276729581854*^9}, {3.658276847155965*^9, 
   3.6582768822910967`*^9}, 3.658277078361019*^9, {3.658277454514134*^9, 
   3.65827755246841*^9}, {3.658277707616706*^9, 3.658277724793824*^9}, {
   3.658277775557291*^9, 3.658277790046358*^9}, {3.6582778408966618`*^9, 
   3.658277880321537*^9}, {3.658277965874803*^9, 3.658278001723259*^9}, {
   3.658278068864526*^9, 3.658278122465324*^9}, {3.6582782743035307`*^9, 
   3.658278463989525*^9}, {3.658278495324057*^9, 3.6582785116036882`*^9}, {
   3.6582787258401527`*^9, 3.6582787620388193`*^9}, {3.658278813660791*^9, 
   3.658278890779448*^9}, {3.658278981426128*^9, 3.6582789851507807`*^9}, {
   3.658279023852993*^9, 3.658279071286935*^9}, {3.6582792891814613`*^9, 
   3.6582793220434237`*^9}, {3.658279596716886*^9, 3.658279661442956*^9}, {
   3.658279700093648*^9, 3.658279706815292*^9}, {3.658279792551382*^9, 
   3.658279815830398*^9}, {3.658279878622261*^9, 3.658279897713276*^9}, {
   3.658279959320986*^9, 3.658279968167665*^9}, {3.658280159539792*^9, 
   3.658280259153908*^9}, {3.658280389314715*^9, 3.658280492142959*^9}, {
   3.65828054504196*^9, 3.6582806104625673`*^9}, {3.658280703485147*^9, 
   3.6582807265634003`*^9}, {3.658280783403376*^9, 3.658280995068233*^9}, {
   3.658332125643222*^9, 3.658332285669385*^9}, {3.658332356434971*^9, 
   3.658332432532056*^9}, {3.6583324694681797`*^9, 3.658332536889868*^9}, {
   3.6583325787135487`*^9, 3.658332603918232*^9}, {3.658332777986459*^9, 
   3.658332831919935*^9}, {3.6583329211917048`*^9, 3.6583329244763107`*^9}, {
   3.65833298690902*^9, 3.6583329940420103`*^9}, {3.658333033513297*^9, 
   3.658333041965459*^9}, {3.658333140934991*^9, 3.6583331410849524`*^9}, {
   3.658333260874716*^9, 3.658333325111835*^9}, {3.6583333640450163`*^9, 
   3.658333602194475*^9}, {3.658333866428316*^9, 3.658333876484424*^9}, {
   3.6583340410637217`*^9, 3.658334041446103*^9}, {3.658334239767832*^9, 
   3.658334256853527*^9}, {3.658334325290709*^9, 3.658334328931733*^9}, {
   3.658334454601124*^9, 3.658334541125682*^9}, {3.658334583676895*^9, 
   3.658334664745475*^9}, {3.658334705147303*^9, 3.6583347127203903`*^9}, {
   3.658334814800128*^9, 3.658334905957917*^9}, {3.658334952676396*^9, 
   3.658334989092309*^9}, {3.658335053255745*^9, 3.658335071690804*^9}, {
   3.658335129550527*^9, 3.658335241594574*^9}, {3.6583353167377977`*^9, 
   3.658335317096506*^9}, {3.658335384569755*^9, 3.658335396679709*^9}, {
   3.658335459752262*^9, 3.658335474398382*^9}, {3.658335569564763*^9, 
   3.6583356135466957`*^9}, {3.658335963702228*^9, 3.6583360118223963`*^9}, {
   3.6583361961257257`*^9, 3.658336324493081*^9}, {3.658336387471901*^9, 
   3.658336413286467*^9}, {3.6583364883081408`*^9, 3.658336518027725*^9}, {
   3.6583497860827847`*^9, 3.658349831490996*^9}, {3.658349861737459*^9, 
   3.658349862153501*^9}, {3.658349942786976*^9, 3.658349965329233*^9}, {
   3.6583500320501423`*^9, 3.658350038684167*^9}, {3.6583500726428823`*^9, 
   3.658350074339263*^9}, {3.658350117777423*^9, 3.658350161383792*^9}, {
   3.6583501955208597`*^9, 3.658350234542882*^9}, {3.6583502755982323`*^9, 
   3.658350338283965*^9}, {3.658350380319613*^9, 3.6583503814310093`*^9}, {
   3.658350450869604*^9, 3.658350549946392*^9}, {3.658350685268361*^9, 
   3.6583506855161467`*^9}, {3.658350727058009*^9, 3.6583507290251617`*^9}, {
   3.658350771093258*^9, 3.658350847603608*^9}, {3.658350951089933*^9, 
   3.658350961855956*^9}, {3.658351021399521*^9, 3.658351021591137*^9}, {
   3.6583511160719757`*^9, 3.658351121390588*^9}, {3.658351310629883*^9, 
   3.658351330581682*^9}, {3.658351453089098*^9, 3.6583514579767447`*^9}, {
   3.6583514969183617`*^9, 3.6583514999993277`*^9}, {3.658351570635014*^9, 
   3.658351577593944*^9}, {3.6583516106406183`*^9, 3.658351657352182*^9}, {
   3.658351766088022*^9, 3.658351770343424*^9}, {3.658351890506502*^9, 
   3.658351904164137*^9}, {3.6583519453391848`*^9, 3.65835200222512*^9}, {
   3.658352444511814*^9, 3.6583524450885687`*^9}, {3.65835945210156*^9, 
   3.658359582160754*^9}, {3.6583597573611526`*^9, 3.658359895421398*^9}, {
   3.6583600200459547`*^9, 3.658360209087796*^9}, {3.6583604062023983`*^9, 
   3.658360556362865*^9}, {3.658369386717368*^9, 3.658369415920825*^9}, {
   3.658369495583129*^9, 3.658369511397794*^9}, {3.658369604058823*^9, 
   3.6583698687217712`*^9}, {3.658369905522255*^9, 3.658370289459115*^9}, {
   3.658435473074052*^9, 3.65843549562414*^9}, {3.658435606368175*^9, 
   3.658435611544252*^9}, {3.6584356461976643`*^9, 3.6584356582216187`*^9}, {
   3.65843569293461*^9, 3.658435693127248*^9}, {3.6584357386455507`*^9, 
   3.6584357504379663`*^9}, {3.658437328158703*^9, 3.658437328842226*^9}, {
   3.658451386320923*^9, 3.658451396416233*^9}, {3.6584514558014927`*^9, 
   3.658451498437763*^9}, {3.65845176533173*^9, 3.658451769500102*^9}, {
   3.658451827834752*^9, 3.658451828192766*^9}, {3.6584518628797626`*^9, 
   3.658451915580929*^9}, {3.658451961311802*^9, 3.658451961463069*^9}, {
   3.658452686235773*^9, 3.658452689778323*^9}, {3.6584528065184526`*^9, 
   3.658452806708708*^9}, {3.6586220651258087`*^9, 3.658622180449822*^9}, {
   3.658622217313324*^9, 3.658622381467565*^9}, {3.658622437008402*^9, 
   3.658622500999549*^9}, {3.658623683248323*^9, 3.6586241287979918`*^9}, {
   3.658624240472498*^9, 3.658624332091518*^9}, {3.6586243934910803`*^9, 
   3.6586246606532173`*^9}, {3.6773181226916533`*^9, 3.677318187212339*^9}, {
   3.677318223833849*^9, 3.677318304494225*^9}, {3.677318387435951*^9, 
   3.677318391354529*^9}, {3.677318421693688*^9, 3.67731848053815*^9}, {
   3.677318518292635*^9, 3.677318589025486*^9}, {3.677318623307369*^9, 
   3.677318659212624*^9}, {3.6773187956764297`*^9, 3.677318796630522*^9}, {
   3.677318844715273*^9, 3.6773188452284517`*^9}, {3.6774899146551743`*^9, 
   3.6774899486273317`*^9}, 3.6780963445239964`*^9, {3.6911622041325736`*^9, 
   3.6911623908649015`*^9}, {3.6911637568981695`*^9, 3.69116377596926*^9}, {
   3.6911638900637856`*^9, 3.691163905613675*^9}, {3.6924730191782584`*^9, 
   3.692473148785671*^9}, {3.6931539296446133`*^9, 3.6931539309706154`*^9}, {
   3.7306523653335624`*^9, 
   3.7306523684534063`*^9}},ExpressionUUID->"a7efa093-4b6e-496e-9dcb-\
6d6052ee3445"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"EndEffectorForces", "[", 
      RowBox[{
      "thetalist_", ",", "Ftip_", ",", "Mlist_", ",", "Glist_", ",", 
       "Slist_"}], "]"}], ":", "\[IndentingNewLine]", "    ", 
     RowBox[{"Takes", " ", "thetalist"}], ":", " ", 
     RowBox[{"A", " ", "list", " ", "of", " ", "joint", " ", "variables"}]}], 
    ",", "\[IndentingNewLine]", "           ", 
    RowBox[{"Ftip", ":", " ", 
     RowBox[{
      RowBox[{
      "Spatial", " ", "force", " ", "applied", " ", "by", " ", "the", " ", 
       "end"}], "-", 
      RowBox[{"effector", " ", "expressed", " ", "in", " ", "frame", " ", 
       RowBox[{"{", 
        RowBox[{"n", "+", "1"}], "}"}]}]}]}], ",", "\[IndentingNewLine]", 
    "           ", 
    RowBox[{"Mlist", ":", " ", 
     RowBox[{
      RowBox[{
      "List", " ", "of", " ", "link", " ", "frames", " ", "i", " ", 
       "relative", " ", "to", " ", "i"}], "-", 
      RowBox[{"1", " ", "at", " ", "the", " ", "home", " ", "position"}]}]}], 
    ",", "\[IndentingNewLine]", "           ", 
    RowBox[{"Glist", ":", " ", 
     RowBox[{
     "Spatial", " ", "inertia", " ", "matrices", " ", "Gi", " ", "of", " ", 
      "the", " ", "links"}]}], ",", "\[IndentingNewLine]", "           ", 
    RowBox[{"Slist", ":", " ", 
     RowBox[{
     "Screw", " ", "axes", " ", "Si", " ", "of", " ", "the", " ", "joints", 
      " ", "in", " ", "a", " ", "space", " ", "frame"}]}], ",", " ", 
    RowBox[{
     RowBox[{
     "in", " ", "the", " ", "format", " ", "of", " ", "a", " ", "matrix", " ",
       "with", " ", "axes", " ", "as", " ", "the", " ", 
      RowBox[{"columns", ".", "\[IndentingNewLine]", "  ", "Returns"}], " ", 
      RowBox[{"JTFtip", ":", 
       RowBox[{
        RowBox[{
        "The", " ", "joint", " ", "forces", " ", "and", " ", "torques", " ", 
         "required", " ", "only", " ", "to", " ", "create", " ", "the", " ", 
         "end"}], "-", 
        RowBox[{"effector", " ", "force", " ", 
         RowBox[{"Ftip", ".", "\[IndentingNewLine]", "This"}], " ", 
         "function", " ", "calls", " ", "InverseDynamics", " ", "with", " ", 
         "g"}]}]}]}], "=", "0"}], ",", 
    RowBox[{"dthetalist", "=", "0"}], ",", 
    RowBox[{
     RowBox[{
      RowBox[{"and", " ", "ddthetalist"}], "=", "0."}], "\[IndentingNewLine]",
      ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Example", " ", "Input", " ", 
        RowBox[{"(", 
         RowBox[{"3", " ", "Link", " ", "Robot"}], ")"}]}], ":", 
       "\[IndentingNewLine]", "thetalist"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0.1", ",", "0.1", ",", "0.1"}], "}"}], "}"}], 
       "\[Transpose]"}]}], ";", "  ", "\[IndentingNewLine]", "  ", 
     RowBox[{"Ftip", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], 
         "}"}], "}"}], "\[Transpose]"}]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"M01", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.089159"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"M12", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.28"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0.13585"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"M23", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", 
          RowBox[{"-", "0.1197"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.395"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"M34", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.14225"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"G1", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
        "0.010267", ",", "0.010267", ",", "0.00666", ",", "3.7", ",", "3.7", 
         ",", "3.7"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"G2", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
        "0.22689", ",", "0.22689", ",", "0.0151074", ",", "8.393", ",", 
         "8.393", ",", "8.393"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "  ", 
     RowBox[{"G3", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
        "0.0494433", ",", "0.0494433", ",", "0.004095", ",", "2.275", ",", 
         "2.275", ",", "2.275"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "  ", 
     RowBox[{"Glist", "=", 
      RowBox[{"{", 
       RowBox[{"G1", ",", "G2", ",", "G3"}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"Mlist", "=", 
      RowBox[{"{", 
       RowBox[{"M01", ",", "M12", ",", "M23", ",", "M34"}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"Slist", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", 
           RowBox[{"-", "0.089"}], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", 
           RowBox[{"-", "0.089"}], ",", "0", ",", "0.425"}], "}"}]}], "}"}], 
       "\[Transpose]"}]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"JTFtip", " ", "=", " ", 
      RowBox[{
       RowBox[{"EndEffectorForces", "[", 
        RowBox[{
        "thetalist", ",", "Ftip", ",", "Mlist", ",", "Glist", ",", "Slist"}], 
        "]"}], "\[IndentingNewLine]", 
       RowBox[{"Output", ":", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "1.4095460782639782", "}"}], ",", 
          RowBox[{"{", "1.8577149723180628", "}"}], ",", 
          RowBox[{"{", "1.392409", "}"}]}], "}"}]}]}]}]}]}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"EndEffectorForces", "[", 
     RowBox[{
     "thetalist_", ",", "Ftip_", ",", "Mlist_", ",", "Glist_", ",", 
      "Slist_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"n", "=", 
        RowBox[{"Length", "[", "thetalist", "]"}]}], "}"}], ",", 
      RowBox[{"Return", "[", 
       RowBox[{"InverseDynamics", "[", 
        RowBox[{"thetalist", ",", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "1"}], "}"}]}], "]"}], ",", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"0", ",", 
           RowBox[{"{", 
            RowBox[{"n", ",", "1"}], "}"}]}], "]"}], ",", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"{", 
            RowBox[{"0", ",", "0", ",", "0"}], "}"}], "}"}], "\[Transpose]"}],
          ",", "Ftip", ",", "Mlist", ",", "Glist", ",", "Slist"}], "]"}], 
       "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.677319029687563*^9, 3.677319233082024*^9}, {
   3.677319283141276*^9, 3.677319344821434*^9}, {3.6774904635778027`*^9, 
   3.677490465727865*^9}, 3.678096352332324*^9, {3.691163661939738*^9, 
   3.691163750908827*^9}, {3.6911637930762386`*^9, 3.69116382632514*^9}, {
   3.6911639372694855`*^9, 3.691164030416814*^9}, {3.692473168599805*^9, 
   3.6924732701186113`*^9}, {3.693153936056225*^9, 3.6931539374914274`*^9}, {
   3.730652377245806*^9, 
   3.730652381201791*^9}},ExpressionUUID->"050d5074-a82f-46cd-af46-\
1b1b25e99315"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"ForwardDynamics", "[", 
      RowBox[{
      "thetalist_", ",", "dthetalist_", ",", "taulist_", ",", "g_", ",", 
       "Ftip_", ",", "Mlist_", ",", "Glist_", ",", "Slist_"}], "]"}], ":", 
     "\[IndentingNewLine]", "   ", 
     RowBox[{"Takes", " ", "thetalist"}], ":", " ", 
     RowBox[{"A", " ", "list", " ", "of", " ", "joint", " ", "variables"}]}], 
    ",", "\[IndentingNewLine]", "          ", 
    RowBox[{"dthetalist", ":", " ", 
     RowBox[{"A", " ", "list", " ", "of", " ", "joint", " ", "rates"}]}], ",",
     "\[IndentingNewLine]", "          ", 
    RowBox[{"taulist", ":", " ", 
     RowBox[{
      RowBox[{"An", " ", "n"}], "-", 
      RowBox[{"vector", " ", "of", " ", "joint", " ", 
       RowBox[{"forces", "/", "torques"}]}]}]}], ",", "\[IndentingNewLine]", 
    "          ", 
    RowBox[{"g", ":", " ", 
     RowBox[{"Gravity", " ", "vector", " ", "g"}]}], ",", 
    "\[IndentingNewLine]", "          ", 
    RowBox[{"Ftip", ":", " ", 
     RowBox[{
      RowBox[{
      "Spatial", " ", "force", " ", "applied", " ", "by", " ", "the", " ", 
       "end"}], "-", 
      RowBox[{"effector", " ", "expressed", " ", "in", " ", "frame", " ", 
       RowBox[{"{", 
        RowBox[{"n", "+", "1"}], "}"}]}]}]}], ",", "                ", 
    "\[IndentingNewLine]", "          ", 
    RowBox[{"Mlist", ":", " ", 
     RowBox[{
      RowBox[{
      "List", " ", "of", " ", "link", " ", "frames", " ", "i", " ", 
       "relative", " ", "to", " ", "i"}], "-", 
      RowBox[{"1", " ", "at", " ", "the", " ", "home", " ", "position"}]}]}], 
    ",", "\[IndentingNewLine]", "          ", 
    RowBox[{"Glist", ":", " ", 
     RowBox[{
     "Spatial", " ", "inertia", " ", "matrices", " ", "Gi", " ", "of", " ", 
      "the", " ", "links"}]}], ",", "\[IndentingNewLine]", "          ", 
    RowBox[{"Slist", ":", " ", 
     RowBox[{
     "Screw", " ", "axes", " ", "Si", " ", "of", " ", "the", " ", "joints", 
      " ", "in", " ", "a", " ", "space", " ", "frame"}]}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "in", " ", "the", " ", "format", " ", "of", " ", "a", " ", "matrix", 
       " ", "with", " ", "axes", " ", "as", " ", "the", " ", 
       RowBox[{"columns", ".", "\[IndentingNewLine]", " ", "Returns"}], " ", 
       RowBox[{"ddthetalist", ":", " ", 
        RowBox[{"The", " ", "resulting", " ", "joint", " ", 
         RowBox[{"accelerations", ".", "\[IndentingNewLine]", "This"}], " ", 
         "function", " ", "computes", " ", "ddthetalist", " ", "by", " ", 
         RowBox[{"solving", ":", "\[IndentingNewLine]", 
          RowBox[{"Mlist", 
           RowBox[{"(", "thetalist", ")"}], "ddthetalist"}]}]}]}]}], "=", 
      RowBox[{"taulist", "-", 
       RowBox[{"c", 
        RowBox[{"(", 
         RowBox[{"thetalist", ",", "dthetalist"}], ")"}]}], "-", 
       RowBox[{"g", 
        RowBox[{"(", "thetalist", ")"}]}], "-", 
       RowBox[{"Jtr", 
        RowBox[{"(", "thetalist", ")"}], "Ftip"}]}]}], "\[IndentingNewLine]", 
     ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Example", " ", "Input", " ", 
        RowBox[{"(", 
         RowBox[{"3", " ", "Link", " ", "Robot"}], ")"}]}], ":", 
       "\[IndentingNewLine]", "thetalist"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0.1", ",", "0.1", ",", "0.1"}], "}"}], "}"}], 
       "\[Transpose]"}]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"dthetalist", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0.1", ",", "0.2", ",", "0.3"}], "}"}], "}"}], 
       "\[Transpose]"}]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"taulist", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0.5", ",", "0.6", ",", "0.7"}], "}"}], "}"}], 
       "\[Transpose]"}]}], ";", "  ", "\[IndentingNewLine]", "  ", 
     RowBox[{"g", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", 
          RowBox[{"-", "9.8"}]}], "}"}], "}"}], "\[Transpose]"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"Ftip", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1"}], 
         "}"}], "}"}], "\[Transpose]"}]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"M01", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.089159"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"M12", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.28"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0.13585"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"M23", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", 
          RowBox[{"-", "0.1197"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.395"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"M34", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.14225"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"G1", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
        "0.010267", ",", "0.010267", ",", "0.00666", ",", "3.7", ",", "3.7", 
         ",", "3.7"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"G2", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
        "0.22689", ",", "0.22689", ",", "0.0151074", ",", "8.393", ",", 
         "8.393", ",", "8.393"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "  ", 
     RowBox[{"G3", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
        "0.0494433", ",", "0.0494433", ",", "0.004095", ",", "2.275", ",", 
         "2.275", ",", "2.275"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "  ", 
     RowBox[{"Glist", "=", 
      RowBox[{"{", 
       RowBox[{"G1", ",", "G2", ",", "G3"}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"Mlist", "=", 
      RowBox[{"{", 
       RowBox[{"M01", ",", "M12", ",", "M23", ",", "M34"}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"Slist", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", 
           RowBox[{"-", "0.089"}], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", 
           RowBox[{"-", "0.089"}], ",", "0", ",", "0.425"}], "}"}]}], "}"}], 
       "\[Transpose]"}]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"ddthetalist", " ", "=", " ", 
      RowBox[{
       RowBox[{"ForwardDynamics", "[", 
        RowBox[{
        "thetalist", ",", "dthetalist", ",", "taulist", ",", "g", ",", "Ftip",
          ",", "Mlist", ",", "Glist", ",", "Slist"}], "]"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Output", ":", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"-", "0.9739290670855624"}], "}"}], ",", 
          RowBox[{"{", "25.584667840340558", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"-", "32.91499212478149"}], "}"}]}], "}"}]}]}]}]}]}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ForwardDynamics", "[", 
     RowBox[{
     "thetalist_", ",", "dthetalist_", ",", "taulist_", ",", "g_", ",", 
      "Ftip_", ",", "Mlist_", ",", "Glist_", ",", "Slist_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"Inverse", "[", 
      RowBox[{"MassMatrix", "[", 
       RowBox[{"thetalist", ",", "Mlist", ",", "Glist", ",", "Slist"}], "]"}],
       "]"}], ".", 
     RowBox[{"(", 
      RowBox[{"taulist", " ", "-", " ", 
       RowBox[{"VelQuadraticForces", "[", 
        RowBox[{
        "thetalist", ",", "dthetalist", ",", "Mlist", ",", "Glist", ",", 
         "Slist"}], "]"}], "-", 
       RowBox[{"GravityForces", "[", 
        RowBox[{
        "thetalist", ",", "g", ",", "Mlist", ",", "Glist", ",", "Slist"}], 
        "]"}], "-", 
       RowBox[{"EndEffectorForces", "[", 
        RowBox[{
        "thetalist", ",", "Ftip", ",", "Mlist", ",", "Glist", ",", "Slist"}], 
        "]"}]}], ")"}]}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.658273872689763*^9, 3.658273988902459*^9}, {
   3.658274157743518*^9, 3.6582741742369556`*^9}, {3.65827421723704*^9, 
   3.6582742187327127`*^9}, {3.6582742677636137`*^9, 3.658274330534523*^9}, {
   3.658274365312026*^9, 3.6582744138260403`*^9}, {3.658274810942898*^9, 
   3.658274859112701*^9}, {3.658275033847995*^9, 3.658275109340135*^9}, {
   3.658275161547172*^9, 3.6582752536631193`*^9}, {3.65827533442001*^9, 
   3.658275354865328*^9}, {3.6582755590331087`*^9, 3.658275644746291*^9}, {
   3.658275839400229*^9, 3.6582758455265408`*^9}, {3.6582758973266172`*^9, 
   3.658276032713943*^9}, {3.658276065782716*^9, 3.6582762151364822`*^9}, {
   3.658276271302123*^9, 3.6582763371711683`*^9}, 3.658276384203477*^9, {
   3.658276429293391*^9, 3.658276729581854*^9}, {3.658276847155965*^9, 
   3.6582768822910967`*^9}, 3.658277078361019*^9, {3.658277454514134*^9, 
   3.65827755246841*^9}, {3.658277707616706*^9, 3.658277724793824*^9}, {
   3.658277775557291*^9, 3.658277790046358*^9}, {3.6582778408966618`*^9, 
   3.658277880321537*^9}, {3.658277965874803*^9, 3.658278001723259*^9}, {
   3.658278068864526*^9, 3.658278122465324*^9}, {3.6582782743035307`*^9, 
   3.658278463989525*^9}, {3.658278495324057*^9, 3.6582785116036882`*^9}, {
   3.6582787258401527`*^9, 3.6582787620388193`*^9}, {3.658278813660791*^9, 
   3.658278890779448*^9}, {3.658278981426128*^9, 3.6582789851507807`*^9}, {
   3.658279023852993*^9, 3.658279071286935*^9}, {3.6582792891814613`*^9, 
   3.6582793220434237`*^9}, {3.658279596716886*^9, 3.658279661442956*^9}, {
   3.658279700093648*^9, 3.658279706815292*^9}, {3.658279792551382*^9, 
   3.658279815830398*^9}, {3.658279878622261*^9, 3.658279897713276*^9}, {
   3.658279959320986*^9, 3.658279968167665*^9}, {3.658280159539792*^9, 
   3.658280259153908*^9}, {3.658280389314715*^9, 3.658280492142959*^9}, {
   3.65828054504196*^9, 3.6582806104625673`*^9}, {3.658280703485147*^9, 
   3.6582807265634003`*^9}, {3.658280783403376*^9, 3.658280995068233*^9}, {
   3.658332125643222*^9, 3.658332285669385*^9}, {3.658332356434971*^9, 
   3.658332432532056*^9}, {3.6583324694681797`*^9, 3.658332536889868*^9}, {
   3.6583325787135487`*^9, 3.658332603918232*^9}, {3.658332777986459*^9, 
   3.658332831919935*^9}, {3.6583329211917048`*^9, 3.6583329244763107`*^9}, {
   3.65833298690902*^9, 3.6583329940420103`*^9}, {3.658333033513297*^9, 
   3.658333041965459*^9}, {3.658333140934991*^9, 3.6583331410849524`*^9}, {
   3.658333260874716*^9, 3.658333325111835*^9}, {3.6583333640450163`*^9, 
   3.658333602194475*^9}, {3.658333866428316*^9, 3.658333876484424*^9}, {
   3.6583340410637217`*^9, 3.658334041446103*^9}, {3.658334239767832*^9, 
   3.658334256853527*^9}, {3.658334325290709*^9, 3.658334328931733*^9}, {
   3.658334454601124*^9, 3.658334541125682*^9}, {3.658334583676895*^9, 
   3.658334664745475*^9}, {3.658334705147303*^9, 3.6583347127203903`*^9}, {
   3.658334814800128*^9, 3.658334905957917*^9}, {3.658334952676396*^9, 
   3.658334989092309*^9}, {3.658335053255745*^9, 3.658335071690804*^9}, {
   3.658335129550527*^9, 3.658335241594574*^9}, {3.6583353167377977`*^9, 
   3.658335317096506*^9}, {3.658335384569755*^9, 3.658335396679709*^9}, {
   3.658335459752262*^9, 3.658335474398382*^9}, {3.658335569564763*^9, 
   3.6583356135466957`*^9}, {3.658335963702228*^9, 3.6583360118223963`*^9}, {
   3.6583361961257257`*^9, 3.658336324493081*^9}, {3.658336387471901*^9, 
   3.658336413286467*^9}, {3.6583364883081408`*^9, 3.658336518027725*^9}, {
   3.6583497860827847`*^9, 3.658349831490996*^9}, {3.658349861737459*^9, 
   3.658349862153501*^9}, {3.658349942786976*^9, 3.658349965329233*^9}, {
   3.6583500320501423`*^9, 3.658350038684167*^9}, {3.6583500726428823`*^9, 
   3.658350074339263*^9}, {3.658350117777423*^9, 3.658350161383792*^9}, {
   3.6583501955208597`*^9, 3.658350234542882*^9}, {3.6583502755982323`*^9, 
   3.658350338283965*^9}, {3.658350380319613*^9, 3.6583503814310093`*^9}, {
   3.658350450869604*^9, 3.658350549946392*^9}, {3.658350685268361*^9, 
   3.6583506855161467`*^9}, {3.658350727058009*^9, 3.6583507290251617`*^9}, {
   3.658350771093258*^9, 3.658350847603608*^9}, {3.658350951089933*^9, 
   3.658350961855956*^9}, {3.658351021399521*^9, 3.658351021591137*^9}, {
   3.6583511160719757`*^9, 3.658351121390588*^9}, {3.658351310629883*^9, 
   3.658351330581682*^9}, {3.658351453089098*^9, 3.6583514579767447`*^9}, {
   3.6583514969183617`*^9, 3.6583514999993277`*^9}, {3.658351570635014*^9, 
   3.658351577593944*^9}, {3.6583516106406183`*^9, 3.658351657352182*^9}, {
   3.658351766088022*^9, 3.658351770343424*^9}, {3.658351890506502*^9, 
   3.658351904164137*^9}, {3.6583519453391848`*^9, 3.65835200222512*^9}, {
   3.658352444511814*^9, 3.6583524450885687`*^9}, {3.65835945210156*^9, 
   3.658359582160754*^9}, {3.6583597573611526`*^9, 3.658359895421398*^9}, {
   3.6583600200459547`*^9, 3.658360209087796*^9}, {3.6583604062023983`*^9, 
   3.658360556362865*^9}, {3.658369386717368*^9, 3.658369415920825*^9}, {
   3.658369495583129*^9, 3.658369511397794*^9}, {3.658369604058823*^9, 
   3.6583698687217712`*^9}, {3.658369905522255*^9, 3.658370289459115*^9}, {
   3.658435473074052*^9, 3.65843549562414*^9}, {3.658435606368175*^9, 
   3.658435611544252*^9}, {3.6584356461976643`*^9, 3.6584356582216187`*^9}, {
   3.65843569293461*^9, 3.658435693127248*^9}, {3.6584357386455507`*^9, 
   3.6584357504379663`*^9}, {3.658437328158703*^9, 3.658437328842226*^9}, {
   3.658451386320923*^9, 3.658451396416233*^9}, {3.6584514558014927`*^9, 
   3.658451498437763*^9}, {3.65845176533173*^9, 3.658451769500102*^9}, {
   3.658451827834752*^9, 3.658451828192766*^9}, {3.6584518628797626`*^9, 
   3.658451915580929*^9}, {3.658451961311802*^9, 3.658451961463069*^9}, {
   3.658452686235773*^9, 3.658452689778323*^9}, {3.6584528065184526`*^9, 
   3.658452806708708*^9}, {3.6586220651258087`*^9, 3.658622180449822*^9}, {
   3.658622217313324*^9, 3.658622381467565*^9}, {3.658622437008402*^9, 
   3.658622500999549*^9}, {3.658623683248323*^9, 3.6586241287979918`*^9}, {
   3.658624240472498*^9, 3.658624332091518*^9}, {3.6586243934910803`*^9, 
   3.6586246606532173`*^9}, {3.677319777222876*^9, 3.677319911210836*^9}, {
   3.677319978967498*^9, 3.6773200301939793`*^9}, {3.677320101176361*^9, 
   3.677320165996676*^9}, {3.677320275527318*^9, 3.677320277148011*^9}, {
   3.6773204032483463`*^9, 3.677320433741617*^9}, {3.67732052567733*^9, 
   3.677320526931965*^9}, {3.677320560922406*^9, 3.6773205774510202`*^9}, {
   3.6773206325151443`*^9, 3.677320917826007*^9}, {3.677320961401045*^9, 
   3.6773210650000067`*^9}, {3.67749047640164*^9, 3.677490476845508*^9}, 
   3.678096359107258*^9, 3.67844919580091*^9, 3.681451022756323*^9, 
   3.691166174765463*^9, {3.6911708289592667`*^9, 3.691170882040303*^9}, {
   3.691170930136054*^9, 3.6911710045903125`*^9}, {3.6924737024313383`*^9, 
   3.6924738363019953`*^9}, {3.6931539414694343`*^9, 
   3.6931539445738397`*^9}, {3.730652388956833*^9, 
   3.730652391756236*^9}},ExpressionUUID->"d6589c3c-8957-41cb-b657-\
352eb72af4ed"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"EulerStep", "[", 
      RowBox[{
      "thetalist_", ",", "dthetalist_", ",", "ddthetalist_", ",", "dt_"}], 
      "]"}], ":", "\[IndentingNewLine]", "  ", 
     RowBox[{"Takes", " ", "thetalist"}], ":", " ", 
     RowBox[{"n", "-", 
      RowBox[{"vector", " ", "of", " ", "joint", " ", "variables"}]}]}], ",", 
    "\[IndentingNewLine]", "         ", 
    RowBox[{"dthetalist", ":", " ", 
     RowBox[{"n", "-", 
      RowBox[{"vector", " ", "of", " ", "joint", " ", "rates"}]}]}], ",", 
    "\[IndentingNewLine]", "         ", 
    RowBox[{"ddthetalist", ":", " ", 
     RowBox[{"n", "-", 
      RowBox[{"vector", " ", "of", " ", "joint", " ", "accelerations"}]}]}], 
    ",", "\[IndentingNewLine]", "         ", 
    RowBox[{"dt", ":", " ", 
     RowBox[{"The", " ", "timestep", " ", "delta", " ", 
      RowBox[{"t", ".", "\[IndentingNewLine]", "Returns"}], " ", 
      "thetalistNext"}], ":", " ", 
     RowBox[{
     "Vector", " ", "of", " ", "joint", " ", "variables", " ", "after", " ", 
      "dt", " ", "from", " ", "first", " ", "order", " ", "Euler", " ", 
      "integration"}]}], ",", "\[IndentingNewLine]", "           ", 
    RowBox[{
     RowBox[{"dthetalistNext", ":", " ", 
      RowBox[{
      "Vector", " ", "of", " ", "joint", " ", "rates", " ", "after", " ", 
       "dt", " ", "from", " ", "first", " ", "order", " ", "Euler", " ", 
       RowBox[{"integration", "."}]}]}], "\[IndentingNewLine]", ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"Example", " ", "Inputs", " ", 
        RowBox[{"(", 
         RowBox[{"3", " ", "Link", " ", "Robot"}], ")"}]}], ":", 
       "\[IndentingNewLine]", "thetalist"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0.1", ",", "0.1", ",", "0.1"}], "}"}], "}"}], 
       "\[Transpose]"}]}], ";", "\n", 
     RowBox[{"dthetalist", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0.1", ",", "0.2", ",", "0.3"}], "}"}], "}"}], 
       "\[Transpose]"}]}], ";", "\n", 
     RowBox[{"ddthetalist", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"2", ",", "1.5", ",", "1"}], "}"}], "}"}], 
       "\[Transpose]"}]}], ";", "\n", 
     RowBox[{"dt", "=", "0.1"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"thetalistNext", ",", "dthetalistNext"}], "}"}], " ", "=", " ", 
      RowBox[{
       RowBox[{"EulerStep", "[", 
        RowBox[{
        "thetalist", ",", "dthetalist", ",", "ddthetalist", ",", "dt"}], 
        "]"}], "\[IndentingNewLine]", 
       RowBox[{"Output", ":", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "0.11", "}"}], ",", 
            RowBox[{"{", "0.12", "}"}], ",", 
            RowBox[{"{", "0.13", "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", "0.3", "}"}], ",", 
            RowBox[{"{", "0.35", "}"}], ",", 
            RowBox[{"{", "0.4", "}"}]}], "}"}]}], "}"}]}]}]}]}]}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"EulerStep", "[", 
     RowBox[{
     "thetalist_", ",", "dthetalist_", ",", "ddthetalist_", ",", "dt_"}], 
     "]"}], ":=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"thetalist", " ", "+", " ", 
       RowBox[{"dt", "*", "dthetalist"}]}], ",", 
      RowBox[{"dthetalist", " ", "+", " ", 
       RowBox[{"dt", "*", "ddthetalist"}]}]}], "}"}]}], "\[IndentingNewLine]",
    "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.658273872689763*^9, 3.658273988902459*^9}, {
   3.658274157743518*^9, 3.6582741742369556`*^9}, {3.65827421723704*^9, 
   3.6582742187327127`*^9}, {3.6582742677636137`*^9, 3.658274330534523*^9}, {
   3.658274365312026*^9, 3.6582744138260403`*^9}, {3.658274810942898*^9, 
   3.658274859112701*^9}, {3.658275033847995*^9, 3.658275109340135*^9}, {
   3.658275161547172*^9, 3.6582752536631193`*^9}, {3.65827533442001*^9, 
   3.658275354865328*^9}, {3.6582755590331087`*^9, 3.658275644746291*^9}, {
   3.658275839400229*^9, 3.6582758455265408`*^9}, {3.6582758973266172`*^9, 
   3.658276032713943*^9}, {3.658276065782716*^9, 3.6582762151364822`*^9}, {
   3.658276271302123*^9, 3.6582763371711683`*^9}, 3.658276384203477*^9, {
   3.658276429293391*^9, 3.658276729581854*^9}, {3.658276847155965*^9, 
   3.6582768822910967`*^9}, 3.658277078361019*^9, {3.658277454514134*^9, 
   3.65827755246841*^9}, {3.658277707616706*^9, 3.658277724793824*^9}, {
   3.658277775557291*^9, 3.658277790046358*^9}, {3.6582778408966618`*^9, 
   3.658277880321537*^9}, {3.658277965874803*^9, 3.658278001723259*^9}, {
   3.658278068864526*^9, 3.658278122465324*^9}, {3.6582782743035307`*^9, 
   3.658278463989525*^9}, {3.658278495324057*^9, 3.6582785116036882`*^9}, {
   3.6582787258401527`*^9, 3.6582787620388193`*^9}, {3.658278813660791*^9, 
   3.658278890779448*^9}, {3.658278981426128*^9, 3.6582789851507807`*^9}, {
   3.658279023852993*^9, 3.658279071286935*^9}, {3.6582792891814613`*^9, 
   3.6582793220434237`*^9}, {3.658279596716886*^9, 3.658279661442956*^9}, {
   3.658279700093648*^9, 3.658279706815292*^9}, {3.658279792551382*^9, 
   3.658279815830398*^9}, {3.658279878622261*^9, 3.658279897713276*^9}, {
   3.658279959320986*^9, 3.658279968167665*^9}, {3.658280159539792*^9, 
   3.658280259153908*^9}, {3.658280389314715*^9, 3.658280492142959*^9}, {
   3.65828054504196*^9, 3.6582806104625673`*^9}, {3.658280703485147*^9, 
   3.6582807265634003`*^9}, {3.658280783403376*^9, 3.658280995068233*^9}, {
   3.658332125643222*^9, 3.658332285669385*^9}, {3.658332356434971*^9, 
   3.658332432532056*^9}, {3.6583324694681797`*^9, 3.658332536889868*^9}, {
   3.6583325787135487`*^9, 3.658332603918232*^9}, {3.658332777986459*^9, 
   3.658332831919935*^9}, {3.6583329211917048`*^9, 3.6583329244763107`*^9}, {
   3.65833298690902*^9, 3.6583329940420103`*^9}, {3.658333033513297*^9, 
   3.658333041965459*^9}, {3.658333140934991*^9, 3.6583331410849524`*^9}, {
   3.658333260874716*^9, 3.658333325111835*^9}, {3.6583333640450163`*^9, 
   3.658333602194475*^9}, {3.658333866428316*^9, 3.658333876484424*^9}, {
   3.6583340410637217`*^9, 3.658334041446103*^9}, {3.658334239767832*^9, 
   3.658334256853527*^9}, {3.658334325290709*^9, 3.658334328931733*^9}, {
   3.658334454601124*^9, 3.658334541125682*^9}, {3.658334583676895*^9, 
   3.658334664745475*^9}, {3.658334705147303*^9, 3.6583347127203903`*^9}, {
   3.658334814800128*^9, 3.658334905957917*^9}, {3.658334952676396*^9, 
   3.658334989092309*^9}, {3.658335053255745*^9, 3.658335071690804*^9}, {
   3.658335129550527*^9, 3.658335241594574*^9}, {3.6583353167377977`*^9, 
   3.658335317096506*^9}, {3.658335384569755*^9, 3.658335396679709*^9}, {
   3.658335459752262*^9, 3.658335474398382*^9}, {3.658335569564763*^9, 
   3.6583356135466957`*^9}, {3.658335963702228*^9, 3.6583360118223963`*^9}, {
   3.6583361961257257`*^9, 3.658336324493081*^9}, {3.658336387471901*^9, 
   3.658336413286467*^9}, {3.6583364883081408`*^9, 3.658336518027725*^9}, {
   3.6583497860827847`*^9, 3.658349831490996*^9}, {3.658349861737459*^9, 
   3.658349862153501*^9}, {3.658349942786976*^9, 3.658349965329233*^9}, {
   3.6583500320501423`*^9, 3.658350038684167*^9}, {3.6583500726428823`*^9, 
   3.658350074339263*^9}, {3.658350117777423*^9, 3.658350161383792*^9}, {
   3.6583501955208597`*^9, 3.658350234542882*^9}, {3.6583502755982323`*^9, 
   3.658350338283965*^9}, {3.658350380319613*^9, 3.6583503814310093`*^9}, {
   3.658350450869604*^9, 3.658350549946392*^9}, {3.658350685268361*^9, 
   3.6583506855161467`*^9}, {3.658350727058009*^9, 3.6583507290251617`*^9}, {
   3.658350771093258*^9, 3.658350847603608*^9}, {3.658350951089933*^9, 
   3.658350961855956*^9}, {3.658351021399521*^9, 3.658351021591137*^9}, {
   3.6583511160719757`*^9, 3.658351121390588*^9}, {3.658351310629883*^9, 
   3.658351330581682*^9}, {3.658351453089098*^9, 3.6583514579767447`*^9}, {
   3.6583514969183617`*^9, 3.6583514999993277`*^9}, {3.658351570635014*^9, 
   3.658351577593944*^9}, {3.6583516106406183`*^9, 3.658351657352182*^9}, {
   3.658351766088022*^9, 3.658351770343424*^9}, {3.658351890506502*^9, 
   3.658351904164137*^9}, {3.6583519453391848`*^9, 3.65835200222512*^9}, {
   3.658352444511814*^9, 3.6583524450885687`*^9}, {3.65835945210156*^9, 
   3.658359582160754*^9}, {3.6583597573611526`*^9, 3.658359895421398*^9}, {
   3.6583600200459547`*^9, 3.658360209087796*^9}, {3.6583604062023983`*^9, 
   3.658360556362865*^9}, {3.658369386717368*^9, 3.658369415920825*^9}, {
   3.658369495583129*^9, 3.658369511397794*^9}, {3.658369604058823*^9, 
   3.6583698687217712`*^9}, {3.658369905522255*^9, 3.658370289459115*^9}, {
   3.658435473074052*^9, 3.65843549562414*^9}, {3.658435606368175*^9, 
   3.658435611544252*^9}, {3.6584356461976643`*^9, 3.6584356582216187`*^9}, {
   3.65843569293461*^9, 3.658435693127248*^9}, {3.6584357386455507`*^9, 
   3.6584357504379663`*^9}, {3.658437328158703*^9, 3.658437328842226*^9}, {
   3.658451386320923*^9, 3.658451396416233*^9}, {3.6584514558014927`*^9, 
   3.658451498437763*^9}, {3.65845176533173*^9, 3.658451769500102*^9}, {
   3.658451827834752*^9, 3.658451828192766*^9}, {3.6584518628797626`*^9, 
   3.658451915580929*^9}, {3.658451961311802*^9, 3.658451961463069*^9}, {
   3.658452686235773*^9, 3.658452689778323*^9}, {3.6584528065184526`*^9, 
   3.658452806708708*^9}, {3.6586220651258087`*^9, 3.658622180449822*^9}, {
   3.658622217313324*^9, 3.658622381467565*^9}, {3.658622437008402*^9, 
   3.658622500999549*^9}, {3.658623683248323*^9, 3.6586241287979918`*^9}, {
   3.658624240472498*^9, 3.658624332091518*^9}, {3.6586243934910803`*^9, 
   3.6586246606532173`*^9}, {3.6773212430112534`*^9, 
   3.6773213088789883`*^9}, {3.677321361759098*^9, 3.677321367090461*^9}, {
   3.677321470715757*^9, 3.6773215552292967`*^9}, {3.677321669275291*^9, 
   3.677321799799973*^9}, {3.6773218479713087`*^9, 3.6773219232750673`*^9}, 
   3.6774148217031*^9, 3.677414865205659*^9, 3.6780963661744823`*^9, {
   3.6911724756653557`*^9, 3.6911726325784492`*^9}, {3.6924738579022303`*^9, 
   3.692473911180278*^9}, {3.6931539485206466`*^9, 
   3.6931539497374487`*^9}},ExpressionUUID->"6009f6be-153c-4a23-9e78-\
8febfb6f128a"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"InverseDynamicsTrajectory", "[", 
      RowBox[{
      "thetamat_", ",", "dthetamat_", ",", "ddthetamat_", ",", "g_", ",", 
       "Ftipmat_", ",", "Mlist_", ",", "Glist_", ",", "Slist_"}], "]"}], ":", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"Takes", " ", "thetamat"}], ":", " ", 
     RowBox[{
     "An", " ", "N", " ", "x", " ", "n", " ", "matrix", " ", "of", " ", 
      "robot", " ", "joint", " ", "variables"}]}], ",", "\[IndentingNewLine]",
     "         ", 
    RowBox[{"dthetamat", ":", " ", 
     RowBox[{
     "An", " ", "N", " ", "x", " ", "n", " ", "matrix", " ", "of", " ", 
      "robot", " ", "joint", " ", "velocities"}]}], ",", 
    "\[IndentingNewLine]", "         ", 
    RowBox[{"ddthetamat", ":", " ", 
     RowBox[{
     "An", " ", "N", " ", "x", " ", "n", " ", "matrix", " ", "of", " ", 
      "robot", " ", "joint", " ", "accelerations"}]}], ",", 
    "\[IndentingNewLine]", "         ", 
    RowBox[{"g", ":", " ", 
     RowBox[{"Gravity", " ", "vector", " ", "g"}]}], ",", 
    "\[IndentingNewLine]", "         ", 
    RowBox[{"Ftipmat", ":", " ", 
     RowBox[{
      RowBox[{
      "An", " ", "N", " ", "x", " ", "6", " ", "matrix", " ", "of", " ", 
       "spatial", " ", "forces", " ", "applied", " ", "by", " ", "the", " ", 
       "end"}], "-", 
      RowBox[{"effector", " ", 
       RowBox[{"(", 
        RowBox[{
        "If", " ", "there", " ", "are", " ", "no", " ", "tip", " ", "forces", 
         " ", "the", " ", "user", " ", "should", " ", "input", " ", "a", " ", 
         "zero", " ", "and", " ", "a", " ", "zero", " ", "matrix", " ", 
         "will", " ", "be", " ", "used"}], ")"}]}]}]}], ",", 
    "\[IndentingNewLine]", "         ", 
    RowBox[{"Mlist", ":", " ", 
     RowBox[{
      RowBox[{
      "List", " ", "of", " ", "link", " ", "frames", " ", "i", " ", 
       "relative", " ", "to", " ", "i"}], "-", 
      RowBox[{"1", " ", "at", " ", "the", " ", "home", " ", "position"}]}]}], 
    ",", "\[IndentingNewLine]", "         ", 
    RowBox[{"Glist", ":", " ", 
     RowBox[{
     "Spatial", " ", "inertia", " ", "matrices", " ", "Gi", " ", "of", " ", 
      "the", " ", "links"}]}], ",", "\[IndentingNewLine]", "         ", 
    RowBox[{"Slist", ":", " ", 
     RowBox[{
     "Screw", " ", "axes", " ", "Si", " ", "of", " ", "the", " ", "joints", 
      " ", "in", " ", "a", " ", "space", " ", "frame"}]}], ",", " ", 
    RowBox[{
    "in", " ", "the", " ", "format", " ", "of", " ", "a", " ", "matrix", " ", 
     "with", " ", "axes", " ", "as", " ", "the", " ", 
     RowBox[{"columns", ".", "\[IndentingNewLine]", " ", "Returns"}], " ", 
     RowBox[{"taumat", ":", " ", 
      RowBox[{
      "The", " ", "N", " ", "x", " ", "n", " ", "matrix", " ", "of", " ", 
       "joint", " ", 
       RowBox[{"forces", "/", "torques"}], " ", "for", " ", "the", " ", 
       "specified", " ", "trajectory"}]}]}], ",", 
    RowBox[{
     RowBox[{
     "where", " ", "each", " ", "of", " ", "the", " ", "N", " ", "rows", " ", 
      "is", " ", "the", " ", "vector", " ", "of", " ", "joint", " ", 
      RowBox[{"forces", "/", "torques"}], " ", "at", " ", "each", " ", "time",
       " ", 
      RowBox[{"step", ".", "\[IndentingNewLine]", " ", "This"}], " ", 
      "function", " ", "uses", " ", "InverseDynamics", " ", "to", " ", 
      "calculate", " ", "the", " ", "joint", " ", 
      RowBox[{"forces", "/", "torques"}], " ", "required", " ", "to", " ", 
      "move", " ", "the", " ", "serial", " ", "chain", " ", "along", " ", 
      "the", " ", "given", " ", 
      RowBox[{"trajectory", "."}]}], "\[IndentingNewLine]", ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Example", " ", 
       RowBox[{"Input", ":", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "Create", " ", "a", " ", "trajectory", " ", "to", " ", "follow", " ",
           "using", " ", "functions", " ", "from", " ", "Chapter", " ", "9"}],
          "*)"}], "\n", "thetastart"}]}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0"}], "}"}], "}"}], "\[Transpose]"}]}], 
     ";", "\n", 
     RowBox[{"thetaend", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Pi", "/", "2"}], ",", 
          RowBox[{"Pi", "/", "2"}], ",", 
          RowBox[{"Pi", "/", "2"}]}], "}"}], "}"}], "\[Transpose]"}]}], ";", 
     "\n", 
     RowBox[{"Tf", "=", "3"}], ";", "\n", 
     RowBox[{"No", "=", "1000"}], ";", "\n", 
     RowBox[{"method", "=", "5"}], ";", "\n", 
     RowBox[{"traj", "=", 
      RowBox[{"JointTrajectory", "[", 
       RowBox[{
       "thetastart", ",", "thetaend", ",", "Tf", ",", "No", ",", "method"}], 
       "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"thetamat", "=", "traj"}], ";", "\n", 
     RowBox[{"dthetamat", "=", "traj"}], ";", "\n", 
     RowBox[{"ddthetamat", "=", "traj"}], ";", "\n", 
     RowBox[{"dt", "=", 
      RowBox[{"Tf", "/", 
       RowBox[{"(", 
        RowBox[{"No", "-", "1.0"}], ")"}]}]}], ";", "\n", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"dthetamat", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", ";;"}], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"thetamat", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", ";;"}], "]"}], "]"}], "-", 
            RowBox[{"thetamat", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"i", "-", "1"}], ",", ";;"}], "]"}], "]"}]}], ")"}], 
          "/", "dt"}]}], ";", "\n", 
        RowBox[{
         RowBox[{"ddthetamat", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", ";;"}], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"dthetamat", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", ";;"}], "]"}], "]"}], "-", 
            RowBox[{"dthetamat", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"i", "-", "1"}], ",", ";;"}], "]"}], "]"}]}], ")"}], 
          "/", "dt"}]}], ";"}], "\[IndentingNewLine]", ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2", ",", 
         RowBox[{
          RowBox[{"Dimensions", "[", "traj", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Initialise", " ", "robot", " ", "descripstion", " ", 
       RowBox[{"(", 
        RowBox[{"Example", " ", "with", " ", "3", " ", "links"}], ")"}]}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"g", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", 
          RowBox[{"-", "9.8"}]}], "}"}], "}"}], "\[Transpose]"}]}], ";", "\n", 
     RowBox[{"Ftipmat", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"1", ",", 
        RowBox[{"{", 
         RowBox[{"No", ",", "6"}], "}"}]}], "]"}]}], ";", "\n", 
     RowBox[{"M01", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.089159"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     RowBox[{"M12", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.28"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0.13585"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     RowBox[{"M23", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", 
          RowBox[{"-", "0.1197"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.395"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     RowBox[{"M34", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.14225"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     RowBox[{"G1", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
        "0.010267", ",", "0.010267", ",", "0.00666", ",", "3.7", ",", "3.7", 
         ",", "3.7"}], "}"}], "]"}]}], ";", 
     RowBox[{"G2", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
        "0.22689", ",", "0.22689", ",", "0.0151074", ",", "8.393", ",", 
         "8.393", ",", "8.393"}], "}"}], "]"}]}], ";", 
     RowBox[{"G3", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
        "0.0494433", ",", "0.0494433", ",", "0.004095", ",", "2.275", ",", 
         "2.275", ",", "2.275"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Glist", "=", 
      RowBox[{"{", 
       RowBox[{"G1", ",", "G2", ",", "G3"}], "}"}]}], ";", 
     RowBox[{"Mlist", "=", 
      RowBox[{"{", 
       RowBox[{"M01", ",", "M12", ",", "M23", ",", "M34"}], "}"}]}], ";", 
     RowBox[{"Slist", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", 
           RowBox[{"-", "0.089"}], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", 
           RowBox[{"-", "0.089"}], ",", "0", ",", "0.425"}], "}"}]}], "}"}], 
       "\[Transpose]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"taumat", "=", 
      RowBox[{"InverseDynamicsTrajectory", "[", 
       RowBox[{
       "thetamat", ",", "dthetamat", ",", "ddthetamat", ",", "g", ",", 
        "Ftipmat", ",", "Mlist", ",", "Glist", ",", "Slist"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Output", " ", "to", " ", "plot", " ", "the", " ", "joint", " ", 
       RowBox[{"forces", "/", "torques"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"Tau1", " ", "=", " ", 
      RowBox[{"Flatten", "[", 
       RowBox[{"taumat", "[", 
        RowBox[{"[", 
         RowBox[{";;", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Tau2", " ", "=", " ", 
      RowBox[{"Flatten", "[", 
       RowBox[{"taumat", "[", 
        RowBox[{"[", 
         RowBox[{";;", ",", "2"}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Tau3", " ", "=", 
      RowBox[{"Flatten", "[", " ", 
       RowBox[{"taumat", "[", 
        RowBox[{"[", 
         RowBox[{";;", ",", "3"}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ListLinePlot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Tau1", ",", "Tau2", ",", "Tau3"}], "}"}], ",", 
       RowBox[{"PlotLegends", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<Tau1\>\"", ",", "\"\<Tau2\>\"", ",", "\"\<Tau3\>\""}], 
         "}"}]}], ",", 
       RowBox[{"AxesLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<Time\>\"", ",", "\"\<Torque\>\""}], "}"}]}], ",", 
       RowBox[{
       "PlotLabel", "\[Rule]", "\"\<Plot of Torque Trajectories\>\""}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "Full"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"InverseDynamicsTrajectory", "[", 
     RowBox[{
     "thetamat_", ",", "dthetamat_", ",", "ddthetamat_", ",", "g_", ",", 
      "Ftipmat_", ",", "Mlist_", ",", "Glist_", ",", "Slist_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"thetamatt", "=", 
         RowBox[{"thetamat", "\[Transpose]"}]}], ",", 
        RowBox[{"dthetamatt", "=", 
         RowBox[{"dthetamat", "\[Transpose]"}]}], ",", 
        RowBox[{"ddthetamatt", "=", 
         RowBox[{"ddthetamat", "\[Transpose]"}]}], ",", 
        RowBox[{"Ftipmatt", "=", 
         RowBox[{"Ftipmat", "\[Transpose]"}]}], ",", "taumat"}], "}"}], ",", 
      RowBox[{
       RowBox[{"taumat", "=", "thetamatt"}], ";", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"taumat", "[", 
           RowBox[{"[", 
            RowBox[{";;", ",", "i"}], "]"}], "]"}], "=", 
          RowBox[{"InverseDynamics", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{"thetamatt", "[", 
               RowBox[{"[", 
                RowBox[{";;", ",", "i"}], "]"}], "]"}], "}"}], 
             "\[Transpose]"}], ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"dthetamatt", "[", 
               RowBox[{"[", 
                RowBox[{";;", ",", "i"}], "]"}], "]"}], "}"}], 
             "\[Transpose]"}], ",", 
            RowBox[{
             RowBox[{"{", 
              RowBox[{"ddthetamatt", "[", 
               RowBox[{"[", 
                RowBox[{";;", ",", "i"}], "]"}], "]"}], "}"}], 
             "\[Transpose]"}], ",", "g", ",", 
            RowBox[{"Ftipmatt", "[", 
             RowBox[{"[", 
              RowBox[{";;", ",", "i"}], "]"}], "]"}], ",", "Mlist", ",", 
            "Glist", ",", "Slist"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{
            RowBox[{"Dimensions", "[", "thetamatt", "]"}], "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], "}"}]}], "]"}], ";", 
       RowBox[{"taumat", "=", 
        RowBox[{"taumat", "\[Transpose]"}]}], ";", 
       RowBox[{"Return", "[", "taumat", "]"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.658273872689763*^9, 3.658273988902459*^9}, {
   3.658274157743518*^9, 3.6582741742369556`*^9}, {3.65827421723704*^9, 
   3.6582742187327127`*^9}, {3.6582742677636137`*^9, 3.658274330534523*^9}, {
   3.658274365312026*^9, 3.6582744138260403`*^9}, {3.658274810942898*^9, 
   3.658274859112701*^9}, {3.658275033847995*^9, 3.658275109340135*^9}, {
   3.658275161547172*^9, 3.6582752536631193`*^9}, {3.65827533442001*^9, 
   3.658275354865328*^9}, {3.6582755590331087`*^9, 3.658275644746291*^9}, {
   3.658275839400229*^9, 3.6582758455265408`*^9}, {3.6582758973266172`*^9, 
   3.658276032713943*^9}, {3.658276065782716*^9, 3.6582762151364822`*^9}, {
   3.658276271302123*^9, 3.6582763371711683`*^9}, 3.658276384203477*^9, {
   3.658276429293391*^9, 3.658276729581854*^9}, {3.658276847155965*^9, 
   3.6582768822910967`*^9}, 3.658277078361019*^9, {3.658277454514134*^9, 
   3.65827755246841*^9}, {3.658277707616706*^9, 3.658277724793824*^9}, {
   3.658277775557291*^9, 3.658277790046358*^9}, {3.6582778408966618`*^9, 
   3.658277880321537*^9}, {3.658277965874803*^9, 3.658278001723259*^9}, {
   3.658278068864526*^9, 3.658278122465324*^9}, {3.6582782743035307`*^9, 
   3.658278463989525*^9}, {3.658278495324057*^9, 3.6582785116036882`*^9}, {
   3.6582787258401527`*^9, 3.6582787620388193`*^9}, {3.658278813660791*^9, 
   3.658278890779448*^9}, {3.658278981426128*^9, 3.6582789851507807`*^9}, {
   3.658279023852993*^9, 3.658279071286935*^9}, {3.6582792891814613`*^9, 
   3.6582793220434237`*^9}, {3.658279596716886*^9, 3.658279661442956*^9}, {
   3.658279700093648*^9, 3.658279706815292*^9}, {3.658279792551382*^9, 
   3.658279815830398*^9}, {3.658279878622261*^9, 3.658279897713276*^9}, {
   3.658279959320986*^9, 3.658279968167665*^9}, {3.658280159539792*^9, 
   3.658280259153908*^9}, {3.658280389314715*^9, 3.658280492142959*^9}, {
   3.65828054504196*^9, 3.6582806104625673`*^9}, {3.658280703485147*^9, 
   3.6582807265634003`*^9}, {3.658280783403376*^9, 3.658280995068233*^9}, {
   3.658332125643222*^9, 3.658332285669385*^9}, {3.658332356434971*^9, 
   3.658332432532056*^9}, {3.6583324694681797`*^9, 3.658332536889868*^9}, {
   3.6583325787135487`*^9, 3.658332603918232*^9}, {3.658332777986459*^9, 
   3.658332831919935*^9}, {3.6583329211917048`*^9, 3.6583329244763107`*^9}, {
   3.65833298690902*^9, 3.6583329940420103`*^9}, {3.658333033513297*^9, 
   3.658333041965459*^9}, {3.658333140934991*^9, 3.6583331410849524`*^9}, {
   3.658333260874716*^9, 3.658333325111835*^9}, {3.6583333640450163`*^9, 
   3.658333602194475*^9}, {3.658333866428316*^9, 3.658333876484424*^9}, {
   3.6583340410637217`*^9, 3.658334041446103*^9}, {3.658334239767832*^9, 
   3.658334256853527*^9}, {3.658334325290709*^9, 3.658334328931733*^9}, {
   3.658334454601124*^9, 3.658334541125682*^9}, {3.658334583676895*^9, 
   3.658334664745475*^9}, {3.658334705147303*^9, 3.6583347127203903`*^9}, {
   3.658334814800128*^9, 3.658334905957917*^9}, {3.658334952676396*^9, 
   3.658334989092309*^9}, {3.658335053255745*^9, 3.658335071690804*^9}, {
   3.658335129550527*^9, 3.658335241594574*^9}, {3.6583353167377977`*^9, 
   3.658335317096506*^9}, {3.658335384569755*^9, 3.658335396679709*^9}, {
   3.658335459752262*^9, 3.658335474398382*^9}, {3.658335569564763*^9, 
   3.6583356135466957`*^9}, {3.658335963702228*^9, 3.6583360118223963`*^9}, {
   3.6583361961257257`*^9, 3.658336324493081*^9}, {3.658336387471901*^9, 
   3.658336413286467*^9}, {3.6583364883081408`*^9, 3.658336518027725*^9}, {
   3.6583497860827847`*^9, 3.658349831490996*^9}, {3.658349861737459*^9, 
   3.658349862153501*^9}, {3.658349942786976*^9, 3.658349965329233*^9}, {
   3.6583500320501423`*^9, 3.658350038684167*^9}, {3.6583500726428823`*^9, 
   3.658350074339263*^9}, {3.658350117777423*^9, 3.658350161383792*^9}, {
   3.6583501955208597`*^9, 3.658350234542882*^9}, {3.6583502755982323`*^9, 
   3.658350338283965*^9}, {3.658350380319613*^9, 3.6583503814310093`*^9}, {
   3.658350450869604*^9, 3.658350549946392*^9}, {3.658350685268361*^9, 
   3.6583506855161467`*^9}, {3.658350727058009*^9, 3.6583507290251617`*^9}, {
   3.658350771093258*^9, 3.658350847603608*^9}, {3.658350951089933*^9, 
   3.658350961855956*^9}, {3.658351021399521*^9, 3.658351021591137*^9}, {
   3.6583511160719757`*^9, 3.658351121390588*^9}, {3.658351310629883*^9, 
   3.658351330581682*^9}, {3.658351453089098*^9, 3.6583514579767447`*^9}, {
   3.6583514969183617`*^9, 3.6583514999993277`*^9}, {3.658351570635014*^9, 
   3.658351577593944*^9}, {3.6583516106406183`*^9, 3.658351657352182*^9}, {
   3.658351766088022*^9, 3.658351770343424*^9}, {3.658351890506502*^9, 
   3.658351904164137*^9}, {3.6583519453391848`*^9, 3.65835200222512*^9}, {
   3.658352444511814*^9, 3.6583524450885687`*^9}, {3.65835945210156*^9, 
   3.658359582160754*^9}, {3.6583597573611526`*^9, 3.658359895421398*^9}, {
   3.6583600200459547`*^9, 3.658360209087796*^9}, {3.6583604062023983`*^9, 
   3.658360556362865*^9}, {3.658369386717368*^9, 3.658369415920825*^9}, {
   3.658369495583129*^9, 3.658369511397794*^9}, {3.658369604058823*^9, 
   3.6583698687217712`*^9}, {3.658369905522255*^9, 3.658370289459115*^9}, {
   3.658435473074052*^9, 3.65843549562414*^9}, {3.658435606368175*^9, 
   3.658435611544252*^9}, {3.6584356461976643`*^9, 3.6584356582216187`*^9}, {
   3.65843569293461*^9, 3.658435693127248*^9}, {3.6584357386455507`*^9, 
   3.6584357504379663`*^9}, {3.658437328158703*^9, 3.658437328842226*^9}, {
   3.658451386320923*^9, 3.658451396416233*^9}, {3.6584514558014927`*^9, 
   3.658451498437763*^9}, {3.65845176533173*^9, 3.658451769500102*^9}, {
   3.658451827834752*^9, 3.658451828192766*^9}, {3.6584518628797626`*^9, 
   3.658451915580929*^9}, {3.658451961311802*^9, 3.658451961463069*^9}, {
   3.658452686235773*^9, 3.658452689778323*^9}, {3.6584528065184526`*^9, 
   3.658452806708708*^9}, {3.6586220651258087`*^9, 3.658622180449822*^9}, {
   3.658622217313324*^9, 3.658622381467565*^9}, {3.658622437008402*^9, 
   3.658622500999549*^9}, {3.658623683248323*^9, 3.6586241287979918`*^9}, {
   3.658624240472498*^9, 3.658624332091518*^9}, {3.6586243934910803`*^9, 
   3.6586246606532173`*^9}, {3.67732315475941*^9, 3.677323235084415*^9}, {
   3.677323276630302*^9, 3.677323434547833*^9}, {3.677323484461143*^9, 
   3.677323499819213*^9}, {3.677323535146171*^9, 3.6773235769457493`*^9}, {
   3.677323628046247*^9, 3.6773236934411507`*^9}, {3.677327123605197*^9, 
   3.6773271239634647`*^9}, {3.677328059209757*^9, 3.6773280603224277`*^9}, {
   3.677331788835787*^9, 3.677331816859844*^9}, {3.677332081788471*^9, 
   3.677332105218265*^9}, {3.677333800582396*^9, 3.67733380225889*^9}, {
   3.6773420774064093`*^9, 3.6773420779146147`*^9}, {3.677405584192568*^9, 
   3.677405597246728*^9}, {3.677415011086073*^9, 3.6774150158485613`*^9}, {
   3.677417169219336*^9, 3.677417179691127*^9}, {3.6774904905071697`*^9, 
   3.677490490950142*^9}, {3.67809637333982*^9, 3.6780963899455423`*^9}, {
   3.678452980732629*^9, 3.678453008727953*^9}, {3.678455504215991*^9, 
   3.678455559017528*^9}, 3.691174932871546*^9, {3.6911749659834394`*^9, 
   3.691174987929695*^9}, 3.6911893616321673`*^9, {3.691210735273591*^9, 
   3.6912111825731764`*^9}, {3.6912119145888624`*^9, 3.691211968034556*^9}, {
   3.691212042555887*^9, 3.6912121208992243`*^9}, {3.6912122484294486`*^9, 
   3.691212251580654*^9}, {3.6912123103147573`*^9, 3.691212326616786*^9}, {
   3.6912150185347147`*^9, 3.691215039485551*^9}, {3.6912151456125374`*^9, 
   3.6912151494501443`*^9}, {3.691215182335002*^9, 3.691215263330344*^9}, {
   3.6912153027360134`*^9, 3.6912153096780252`*^9}, {3.691215672503463*^9, 
   3.6912158207505236`*^9}, {3.6924749083103104`*^9, 
   3.6924751278868694`*^9}, {3.692476439892474*^9, 3.6924764476619186`*^9}, {
   3.6924764909783955`*^9, 3.69247650731933*^9}, {3.6924765581032352`*^9, 
   3.692476559643323*^9}, {3.6924766455042343`*^9, 3.6924767074167757`*^9}, {
   3.6924767414427214`*^9, 3.6924768448506365`*^9}, {3.6931539562270603`*^9, 
   3.6931539593626657`*^9}, {3.7306524004528823`*^9, 
   3.730652403755494*^9}},ExpressionUUID->"8c71c553-e0e9-4531-9417-\
f427517894a6"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"ForwardDynamicsTrajectory", "[", 
      RowBox[{
      "thetalist_", ",", "dthetalist_", ",", "taumat_", ",", "g_", ",", 
       "Ftipmat_", ",", "Mlist_", ",", "Glist_", ",", "Slist_", ",", "dt_", 
       ",", "intRes_"}], "]"}], ":", "\[IndentingNewLine]", "   ", 
     RowBox[{"Takes", " ", "thetalist"}], ":", " ", 
     RowBox[{"n", "-", 
      RowBox[{
      "vector", " ", "of", " ", "initial", " ", "joint", " ", 
       "variables"}]}]}], ",", "\[IndentingNewLine]", "          ", 
    RowBox[{"dthetalist", ":", " ", 
     RowBox[{"n", "-", 
      RowBox[{
      "vector", " ", "of", " ", "initial", " ", "joint", " ", "rates"}]}]}], 
    ",", "\[IndentingNewLine]", "          ", 
    RowBox[{"taumat", ":", " ", 
     RowBox[{
     "An", " ", "N", " ", "x", " ", "n", " ", "matrix", " ", "of", " ", 
      "joint", " ", 
      RowBox[{"forces", "/", "torques"}]}]}], ",", 
    RowBox[{
    "where", " ", "each", " ", "row", " ", "is", " ", "the", " ", "joint", 
     " ", "effort", " ", "at", " ", "any", " ", "time", " ", "step"}], ",", 
    "\[IndentingNewLine]", "          ", 
    RowBox[{"g", ":", 
     RowBox[{"Gravity", " ", "vector", " ", "g"}]}], ",", 
    "\[IndentingNewLine]", "          ", 
    RowBox[{"Ftipmat", ":", " ", 
     RowBox[{
      RowBox[{
      "An", " ", "N", " ", "x", " ", "6", " ", "matrix", " ", "of", " ", 
       "spatial", " ", "forces", " ", "applied", " ", "by", " ", "the", " ", 
       "end"}], "-", 
      RowBox[{"effector", " ", 
       RowBox[{"(", 
        RowBox[{
        "If", " ", "there", " ", "are", " ", "no", " ", "tip", " ", "forces", 
         " ", "the", " ", "user", " ", "should", " ", "input", " ", "a", " ", 
         "zero", " ", "and", " ", "a", " ", "zero", " ", "matrix", " ", 
         "will", " ", "be", " ", "used"}], ")"}]}]}]}], ",", 
    "\[IndentingNewLine]", "          ", 
    RowBox[{"Mlist", ":", " ", 
     RowBox[{"List", " ", "of", " ", "link", " ", "frames", " ", 
      RowBox[{"{", "i", "}"}], " ", "relative", " ", "to", " ", 
      RowBox[{"{", 
       RowBox[{"i", "-", "1"}], "}"}], " ", "at", " ", "the", " ", "home", 
      " ", "position"}]}], ",", "\[IndentingNewLine]", "          ", 
    RowBox[{"Glist", ":", " ", 
     RowBox[{
     "Spatial", " ", "inertia", " ", "matrices", " ", "Gi", " ", "of", " ", 
      "the", " ", "links"}]}], ",", "\[IndentingNewLine]", "          ", 
    RowBox[{"Slist", ":", " ", 
     RowBox[{
     "Screw", " ", "axes", " ", "Si", " ", "of", " ", "the", " ", "joints", 
      " ", "in", " ", "a", " ", "space", " ", "frame"}]}], ",", " ", 
    RowBox[{
    "in", " ", "the", " ", "format", " ", "of", " ", "a", " ", "matrix", " ", 
     "with", " ", "axes", " ", "as", " ", "the", " ", "columns"}], ",", 
    "\[IndentingNewLine]", "          ", 
    RowBox[{"dt", ":", " ", 
     RowBox[{
     "The", " ", "timestep", " ", "between", " ", "consecutive", " ", "joint",
       " ", 
      RowBox[{"forces", "/", "torques"}]}]}], ",", " ", "\[IndentingNewLine]",
     "          ", 
    RowBox[{"intRes", ":", 
     RowBox[{
     "Integration", " ", "resolution", " ", "is", " ", "the", " ", "number", 
      " ", "of", " ", "times", " ", "integration", " ", 
      RowBox[{"(", "Euler", ")"}], " ", "takes", " ", "places", " ", 
      "between", " ", "each", " ", "time", " ", 
      RowBox[{"step", ".", " ", "Must"}], " ", "be", " ", "an", " ", 
      "integer", " ", "value", " ", "greater", " ", "than", " ", "or", " ", 
      "equal", " ", "to", " ", "1.", "\[IndentingNewLine]", "  ", "Returns", 
      " ", 
      RowBox[{"thetamat", ":", " ", 
       RowBox[{
       "The", " ", "N", " ", "x", " ", "n", " ", "matrix", " ", "of", " ", 
        "robot", " ", "joint", " ", "angles", " ", "resulting", " ", "from", 
        " ", "the", " ", "specified", " ", "joint", " ", 
        RowBox[{"forces", "/", "torques"}]}]}]}]}], ",", 
    RowBox[{
     RowBox[{"dthetamat", ":", 
      RowBox[{
       RowBox[{
       "The", " ", "N", " ", "x", " ", "n", " ", "matrix", " ", "of", " ", 
        "robot", " ", "joint", " ", 
        RowBox[{"velocities", ".", "\[IndentingNewLine]", "This"}], " ", 
        "function", " ", "simulates", " ", "the", " ", "motion", " ", "of", 
        " ", "a", " ", "serial", " ", "chain", " ", "given", " ", "an", " ", 
        "open"}], "-", 
       RowBox[{"loop", " ", "history", " ", "of", " ", "joint", " ", 
        RowBox[{"forces", "/", 
         RowBox[{"torques", ".", " ", "It"}]}], " ", "calls", " ", "a", " ", 
        "numerical", " ", "integration", " ", "procedure", " ", "that", " ", 
        "uses", " ", 
        RowBox[{"ForwardDynamics", "."}]}]}]}], "\[IndentingNewLine]", ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"Example", " ", 
       RowBox[{"Inputs", ":", "\n", "thetalist"}]}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0.1", ",", "0.1", ",", "0.1"}], "}"}], "}"}], 
       "\[Transpose]"}]}], ";", "\n", 
     RowBox[{"dthetalist", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0.1", ",", "0.2", ",", "0.3"}], "}"}], "}"}], 
       "\[Transpose]"}]}], ";", "\n", 
     RowBox[{"taumat", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"3.63", ",", 
          RowBox[{"-", "6.58"}], ",", 
          RowBox[{"-", "5.57"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"3.74", ",", 
          RowBox[{"-", "5.55"}], ",", 
          RowBox[{"-", "5.5"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"4.31", ",", 
          RowBox[{"-", "0.68"}], ",", 
          RowBox[{"-", "5.19"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"5.18", ",", "5.63", ",", 
          RowBox[{"-", "4.31"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"5.85", ",", "8.17", ",", 
          RowBox[{"-", "2.59"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"5.78", ",", "2.79", ",", 
          RowBox[{"-", "1.7"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"4.99", ",", 
          RowBox[{"-", "5.3"}], ",", 
          RowBox[{"-", "1.19"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"4.08", ",", 
          RowBox[{"-", "9.41"}], ",", "0.07"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"3.56", ",", 
          RowBox[{"-", "10.1"}], ",", "0.97"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"3.49", ",", 
          RowBox[{"-", "9.41"}], ",", "1.23"}], "}"}]}], "}"}]}], ";", "\n", 
     RowBox[{"(*", 
      RowBox[{"Initialise", " ", "robot", " ", "descripstion", " ", 
       RowBox[{"(", 
        RowBox[{"Example", " ", "with", " ", "3", " ", "links"}], ")"}]}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{"g", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", 
          RowBox[{"-", "9.8"}]}], "}"}], "}"}], "\[Transpose]"}]}], ";", "\n", 
     RowBox[{"Ftipmat", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"1", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Dimensions", "[", "taumat", "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "6"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"M01", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.089159"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     RowBox[{"M12", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.28"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0.13585"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     RowBox[{"M23", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", 
          RowBox[{"-", "0.1197"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.395"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     RowBox[{"M34", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.14225"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     RowBox[{"G1", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
        "0.010267", ",", "0.010267", ",", "0.00666", ",", "3.7", ",", "3.7", 
         ",", "3.7"}], "}"}], "]"}]}], ";", 
     RowBox[{"G2", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
        "0.22689", ",", "0.22689", ",", "0.0151074", ",", "8.393", ",", 
         "8.393", ",", "8.393"}], "}"}], "]"}]}], ";", 
     RowBox[{"G3", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
        "0.0494433", ",", "0.0494433", ",", "0.004095", ",", "2.275", ",", 
         "2.275", ",", "2.275"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"Glist", "=", 
      RowBox[{"{", 
       RowBox[{"G1", ",", "G2", ",", "G3"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Mlist", "=", 
      RowBox[{"{", 
       RowBox[{"M01", ",", "M12", ",", "M23", ",", "M34"}], "}"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Slist", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", 
           RowBox[{"-", "0.089"}], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", 
           RowBox[{"-", "0.089"}], ",", "0", ",", "0.425"}], "}"}]}], "}"}], 
       "\[Transpose]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"dt", "=", "0.1"}], ";", "\n", 
     RowBox[{"intRes", "=", "8"}], ";", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"thetamat", ",", "dthetamat"}], "}"}], "=", 
      RowBox[{"ForwardDynamicsTrajectory", "[", 
       RowBox[{
       "thetalist", ",", "dthetalist", ",", "taumat", ",", "g", ",", 
        "Ftipmat", ",", "Mlist", ",", "Glist", ",", "Slist", ",", "dt", ",", 
        "intRes"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{"Output", " ", "to", " ", "plot", " ", "the", " ", "joint", " ", 
       RowBox[{"forces", "/", "torques"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"theta1", " ", "=", " ", 
      RowBox[{"Flatten", "[", 
       RowBox[{"thetamat", "[", 
        RowBox[{"[", 
         RowBox[{";;", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"theta2", " ", "=", " ", 
      RowBox[{"Flatten", "[", 
       RowBox[{"thetamat", "[", 
        RowBox[{"[", 
         RowBox[{";;", ",", "2"}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"theta3", " ", "=", " ", 
      RowBox[{"Flatten", "[", 
       RowBox[{"thetamat", "[", 
        RowBox[{"[", 
         RowBox[{";;", ",", "3"}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dtheta1", " ", "=", 
      RowBox[{"Flatten", "[", " ", 
       RowBox[{"dthetamat", "[", 
        RowBox[{"[", 
         RowBox[{";;", ",", "1"}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dtheta2", " ", "=", " ", 
      RowBox[{"Flatten", "[", 
       RowBox[{"dthetamat", "[", 
        RowBox[{"[", 
         RowBox[{";;", ",", "2"}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"dtheta3", " ", "=", 
      RowBox[{"Flatten", "[", " ", 
       RowBox[{"dthetamat", "[", 
        RowBox[{"[", 
         RowBox[{";;", ",", "3"}], "]"}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"ListLinePlot", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "theta1", ",", "theta2", ",", "theta3", ",", "dtheta1", ",", 
         "dtheta2", ",", "dtheta3"}], "}"}], ",", 
       RowBox[{"PlotLegends", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
         "\"\<theta1\>\"", ",", "\"\<theta2\>\"", ",", "\"\<theta3\>\"", ",", 
          "\"\<dtheta1\>\"", ",", "\"\<dtheta2\>\"", ",", "\"\<dtheta3\>\""}],
          "}"}]}], ",", 
       RowBox[{"AxesLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<Time\>\"", ",", "\"\<Joint Angles/Velocities\>\""}], 
         "}"}]}], ",", 
       RowBox[{
       "PlotLabel", "\[Rule]", 
        "\"\<Plot of Joint Angles and Joint Velocities\>\""}], ",", 
       RowBox[{"PlotRange", "\[Rule]", "Full"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ForwardDynamicsTrajectory", "[", 
     RowBox[{
     "thetalist_", ",", "dthetalist_", ",", "taumat_", ",", "g_", ",", 
      "Ftipmat_", ",", "Mlist_", ",", "Glist_", ",", "Slist_", ",", "dt_", 
      ",", "intRes_"}], "]"}], ":=", "\[IndentingNewLine]", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"taumatt", "=", 
         RowBox[{"taumat", "\[Transpose]"}]}], ",", 
        RowBox[{"Ftipmatt", "=", 
         RowBox[{"Ftipmat", "\[Transpose]"}]}], ",", "thetamat", ",", 
        "dthetamat", ",", "ddthetanext", ",", 
        RowBox[{"thetanext", "=", "thetalist"}], ",", 
        RowBox[{"dthetanext", "=", "dthetalist"}]}], "}"}], ",", 
      RowBox[{
       RowBox[{"thetamat", "=", "taumatt"}], ";", 
       RowBox[{"dthetamat", "=", "taumatt"}], ";", 
       RowBox[{
        RowBox[{"thetamat", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", "1"}], "]"}], "]"}], "=", "thetanext"}], ";", 
       RowBox[{
        RowBox[{"dthetamat", "[", 
         RowBox[{"[", 
          RowBox[{";;", ",", "1"}], "]"}], "]"}], "=", "dthetanext"}], ";", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Do", "[", 
           RowBox[{
            RowBox[{
             RowBox[{"ddthetanext", "=", 
              RowBox[{"ForwardDynamics", "[", 
               RowBox[{"thetanext", ",", "dthetanext", ",", 
                RowBox[{"taumatt", "[", 
                 RowBox[{"[", 
                  RowBox[{";;", ",", "i"}], "]"}], "]"}], ",", "g", ",", 
                RowBox[{"Ftipmatt", "[", 
                 RowBox[{"[", 
                  RowBox[{";;", ",", "i"}], "]"}], "]"}], ",", "Mlist", ",", 
                "Glist", ",", "Slist"}], "]"}]}], ";", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"thetanext", ",", "dthetanext"}], "}"}], "=", 
              RowBox[{"EulerStep", "[", 
               RowBox[{
               "thetanext", ",", "dthetanext", ",", "ddthetanext", ",", 
                RowBox[{"dt", "/", "intRes"}]}], "]"}]}]}], ",", "intRes"}], 
           "]"}], ";", 
          RowBox[{
           RowBox[{"thetamat", "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", 
              RowBox[{"i", "+", "1"}]}], "]"}], "]"}], "=", "thetanext"}], 
          ";", 
          RowBox[{
           RowBox[{"dthetamat", "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", 
              RowBox[{"i", "+", "1"}]}], "]"}], "]"}], "=", "dthetanext"}]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{
            RowBox[{
             RowBox[{"Dimensions", "[", "taumatt", "]"}], "[", 
             RowBox[{"[", "2", "]"}], "]"}], "-", "1"}]}], "}"}]}], "]"}], 
       ";", 
       RowBox[{"thetamat", "=", 
        RowBox[{"thetamat", "\[Transpose]"}]}], ";", 
       RowBox[{"dthetamat", "=", 
        RowBox[{"dthetamat", "\[Transpose]"}]}], ";", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"thetamat", ",", "dthetamat"}], "}"}], "]"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.658273872689763*^9, 3.658273988902459*^9}, {
   3.658274157743518*^9, 3.6582741742369556`*^9}, {3.65827421723704*^9, 
   3.6582742187327127`*^9}, {3.6582742677636137`*^9, 3.658274330534523*^9}, {
   3.658274365312026*^9, 3.6582744138260403`*^9}, {3.658274810942898*^9, 
   3.658274859112701*^9}, {3.658275033847995*^9, 3.658275109340135*^9}, {
   3.658275161547172*^9, 3.6582752536631193`*^9}, {3.65827533442001*^9, 
   3.658275354865328*^9}, {3.6582755590331087`*^9, 3.658275644746291*^9}, {
   3.658275839400229*^9, 3.6582758455265408`*^9}, {3.6582758973266172`*^9, 
   3.658276032713943*^9}, {3.658276065782716*^9, 3.6582762151364822`*^9}, {
   3.658276271302123*^9, 3.6582763371711683`*^9}, 3.658276384203477*^9, {
   3.658276429293391*^9, 3.658276729581854*^9}, {3.658276847155965*^9, 
   3.6582768822910967`*^9}, 3.658277078361019*^9, {3.658277454514134*^9, 
   3.65827755246841*^9}, {3.658277707616706*^9, 3.658277724793824*^9}, {
   3.658277775557291*^9, 3.658277790046358*^9}, {3.6582778408966618`*^9, 
   3.658277880321537*^9}, {3.658277965874803*^9, 3.658278001723259*^9}, {
   3.658278068864526*^9, 3.658278122465324*^9}, {3.6582782743035307`*^9, 
   3.658278463989525*^9}, {3.658278495324057*^9, 3.6582785116036882`*^9}, {
   3.6582787258401527`*^9, 3.6582787620388193`*^9}, {3.658278813660791*^9, 
   3.658278890779448*^9}, {3.658278981426128*^9, 3.6582789851507807`*^9}, {
   3.658279023852993*^9, 3.658279071286935*^9}, {3.6582792891814613`*^9, 
   3.6582793220434237`*^9}, {3.658279596716886*^9, 3.658279661442956*^9}, {
   3.658279700093648*^9, 3.658279706815292*^9}, {3.658279792551382*^9, 
   3.658279815830398*^9}, {3.658279878622261*^9, 3.658279897713276*^9}, {
   3.658279959320986*^9, 3.658279968167665*^9}, {3.658280159539792*^9, 
   3.658280259153908*^9}, {3.658280389314715*^9, 3.658280492142959*^9}, {
   3.65828054504196*^9, 3.6582806104625673`*^9}, {3.658280703485147*^9, 
   3.6582807265634003`*^9}, {3.658280783403376*^9, 3.658280995068233*^9}, {
   3.658332125643222*^9, 3.658332285669385*^9}, {3.658332356434971*^9, 
   3.658332432532056*^9}, {3.6583324694681797`*^9, 3.658332536889868*^9}, {
   3.6583325787135487`*^9, 3.658332603918232*^9}, {3.658332777986459*^9, 
   3.658332831919935*^9}, {3.6583329211917048`*^9, 3.6583329244763107`*^9}, {
   3.65833298690902*^9, 3.6583329940420103`*^9}, {3.658333033513297*^9, 
   3.658333041965459*^9}, {3.658333140934991*^9, 3.6583331410849524`*^9}, {
   3.658333260874716*^9, 3.658333325111835*^9}, {3.6583333640450163`*^9, 
   3.658333602194475*^9}, {3.658333866428316*^9, 3.658333876484424*^9}, {
   3.6583340410637217`*^9, 3.658334041446103*^9}, {3.658334239767832*^9, 
   3.658334256853527*^9}, {3.658334325290709*^9, 3.658334328931733*^9}, {
   3.658334454601124*^9, 3.658334541125682*^9}, {3.658334583676895*^9, 
   3.658334664745475*^9}, {3.658334705147303*^9, 3.6583347127203903`*^9}, {
   3.658334814800128*^9, 3.658334905957917*^9}, {3.658334952676396*^9, 
   3.658334989092309*^9}, {3.658335053255745*^9, 3.658335071690804*^9}, {
   3.658335129550527*^9, 3.658335241594574*^9}, {3.6583353167377977`*^9, 
   3.658335317096506*^9}, {3.658335384569755*^9, 3.658335396679709*^9}, {
   3.658335459752262*^9, 3.658335474398382*^9}, {3.658335569564763*^9, 
   3.6583356135466957`*^9}, {3.658335963702228*^9, 3.6583360118223963`*^9}, {
   3.6583361961257257`*^9, 3.658336324493081*^9}, {3.658336387471901*^9, 
   3.658336413286467*^9}, {3.6583364883081408`*^9, 3.658336518027725*^9}, {
   3.6583497860827847`*^9, 3.658349831490996*^9}, {3.658349861737459*^9, 
   3.658349862153501*^9}, {3.658349942786976*^9, 3.658349965329233*^9}, {
   3.6583500320501423`*^9, 3.658350038684167*^9}, {3.6583500726428823`*^9, 
   3.658350074339263*^9}, {3.658350117777423*^9, 3.658350161383792*^9}, {
   3.6583501955208597`*^9, 3.658350234542882*^9}, {3.6583502755982323`*^9, 
   3.658350338283965*^9}, {3.658350380319613*^9, 3.6583503814310093`*^9}, {
   3.658350450869604*^9, 3.658350549946392*^9}, {3.658350685268361*^9, 
   3.6583506855161467`*^9}, {3.658350727058009*^9, 3.6583507290251617`*^9}, {
   3.658350771093258*^9, 3.658350847603608*^9}, {3.658350951089933*^9, 
   3.658350961855956*^9}, {3.658351021399521*^9, 3.658351021591137*^9}, {
   3.6583511160719757`*^9, 3.658351121390588*^9}, {3.658351310629883*^9, 
   3.658351330581682*^9}, {3.658351453089098*^9, 3.6583514579767447`*^9}, {
   3.6583514969183617`*^9, 3.6583514999993277`*^9}, {3.658351570635014*^9, 
   3.658351577593944*^9}, {3.6583516106406183`*^9, 3.658351657352182*^9}, {
   3.658351766088022*^9, 3.658351770343424*^9}, {3.658351890506502*^9, 
   3.658351904164137*^9}, {3.6583519453391848`*^9, 3.65835200222512*^9}, {
   3.658352444511814*^9, 3.6583524450885687`*^9}, {3.65835945210156*^9, 
   3.658359582160754*^9}, {3.6583597573611526`*^9, 3.658359895421398*^9}, {
   3.6583600200459547`*^9, 3.658360209087796*^9}, {3.6583604062023983`*^9, 
   3.658360556362865*^9}, {3.658369386717368*^9, 3.658369415920825*^9}, {
   3.658369495583129*^9, 3.658369511397794*^9}, {3.658369604058823*^9, 
   3.6583698687217712`*^9}, {3.658369905522255*^9, 3.658370289459115*^9}, {
   3.658435473074052*^9, 3.65843549562414*^9}, {3.658435606368175*^9, 
   3.658435611544252*^9}, {3.6584356461976643`*^9, 3.6584356582216187`*^9}, {
   3.65843569293461*^9, 3.658435693127248*^9}, {3.6584357386455507`*^9, 
   3.6584357504379663`*^9}, {3.658437328158703*^9, 3.658437328842226*^9}, {
   3.658451386320923*^9, 3.658451396416233*^9}, {3.6584514558014927`*^9, 
   3.658451498437763*^9}, {3.65845176533173*^9, 3.658451769500102*^9}, {
   3.658451827834752*^9, 3.658451828192766*^9}, {3.6584518628797626`*^9, 
   3.658451915580929*^9}, {3.658451961311802*^9, 3.658451961463069*^9}, {
   3.658452686235773*^9, 3.658452689778323*^9}, {3.6584528065184526`*^9, 
   3.658452806708708*^9}, {3.6586220651258087`*^9, 3.658622180449822*^9}, {
   3.658622217313324*^9, 3.658622381467565*^9}, {3.658622437008402*^9, 
   3.658622500999549*^9}, {3.658623683248323*^9, 3.6586241287979918`*^9}, {
   3.658624240472498*^9, 3.658624332091518*^9}, {3.6586243934910803`*^9, 
   3.6586246606532173`*^9}, {3.677407880850321*^9, 3.6774079492889233`*^9}, 
   3.677414022557517*^9, {3.6774140684385967`*^9, 3.677414075630186*^9}, {
   3.677414335095175*^9, 3.6774144298603773`*^9}, {3.677414470492803*^9, 
   3.6774146091155233`*^9}, {3.67741468942129*^9, 3.6774147932681417`*^9}, {
   3.67741491149364*^9, 3.677414922353374*^9}, {3.67741498492174*^9, 
   3.6774151635455713`*^9}, {3.677415203976342*^9, 3.677415224900571*^9}, {
   3.6774152627756023`*^9, 3.6774153898486433`*^9}, {3.677415447679756*^9, 
   3.677415479578895*^9}, {3.677415510129551*^9, 3.6774155189848757`*^9}, {
   3.677415563853796*^9, 3.677415658868799*^9}, {3.6774156922934237`*^9, 
   3.677415750725058*^9}, 3.677415816213516*^9, 3.677415995234165*^9, {
   3.677416164828886*^9, 3.677416172065155*^9}, 3.6774162123220577`*^9, 
   3.6774162696380577`*^9, {3.677416302219317*^9, 3.6774163049989634`*^9}, {
   3.677416378172185*^9, 3.677416424224967*^9}, {3.677416454762212*^9, 
   3.677416495972261*^9}, {3.6774165285301943`*^9, 3.677416609497998*^9}, {
   3.6774167079897223`*^9, 3.677416809355668*^9}, {3.677417011496028*^9, 
   3.6774171391385193`*^9}, 3.677417196932665*^9, {3.6774905052362013`*^9, 
   3.67749050537529*^9}, {3.678096405086987*^9, 3.6780964104728518`*^9}, {
   3.678452887470743*^9, 3.678452964874299*^9}, {3.6784530534763193`*^9, 
   3.678453091013393*^9}, {3.678453126802677*^9, 3.6784531289330797`*^9}, {
   3.678453439478467*^9, 3.678453592963132*^9}, {3.67845373611872*^9, 
   3.678453765205407*^9}, {3.6784538527604933`*^9, 3.678453869490027*^9}, {
   3.6784538995984297`*^9, 3.678453940309951*^9}, {3.6784540141405973`*^9, 
   3.678454036151272*^9}, {3.681455189340788*^9, 3.6814552018036423`*^9}, {
   3.6814552579394627`*^9, 3.681455263407737*^9}, {3.681455819481369*^9, 
   3.681455824984709*^9}, {3.6891225723446455`*^9, 3.689122614646705*^9}, {
   3.691203050525611*^9, 3.6912030748460536`*^9}, {3.691203265665589*^9, 
   3.6912033941630144`*^9}, {3.6912034373126907`*^9, 3.691203441072297*^9}, {
   3.691203499135599*^9, 3.691203713417575*^9}, {3.6912038389353957`*^9, 
   3.6912038410725994`*^9}, {3.691204128861905*^9, 3.691204181340397*^9}, {
   3.6912042895265875`*^9, 3.6912043103058233`*^9}, {3.6912043426134806`*^9, 
   3.691204396449175*^9}, {3.691204556536656*^9, 3.691204561575465*^9}, {
   3.691204653662427*^9, 3.691204739852578*^9}, {3.691205211789407*^9, 
   3.6912052409302583`*^9}, {3.6912052895399437`*^9, 3.69120530434437*^9}, {
   3.6924780729568796`*^9, 3.6924782185882096`*^9}, {3.692478258881514*^9, 
   3.6924783828486047`*^9}, {3.6924784140933914`*^9, 3.692478416578534*^9}, {
   3.6924786162319536`*^9, 3.692478667775902*^9}, {3.6931539666946783`*^9, 
   3.6931539707350855`*^9}, {3.7306524103938313`*^9, 
   3.7306524111785803`*^9}},ExpressionUUID->"c001454f-a821-4609-9c44-\
fc644598fd8e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["CHAPTER  9: TRAJECTORY GENERATION",
 FontSize->24,
 FontWeight->"Bold",
 FontColor->RGBColor[0, 0, 1]]], "Title",
 CellChangeTimes->{{3.6755319110417843`*^9, 3.675531927048277*^9}, {
  3.675531958735077*^9, 3.67553201284205*^9}, {3.675607857109823*^9, 
  3.6756079117244864`*^9}, {3.6756821024917507`*^9, 3.6756821283850946`*^9}, {
  3.6757648758196497`*^9, 3.675764892595064*^9}, {3.6767235712710247`*^9, 
  3.676723593007389*^9}},ExpressionUUID->"75d6083f-b722-498a-b9fa-\
576327a19efc"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"CubicTimeScaling", "[", 
      RowBox[{"Tf_", ",", "t_"}], "]"}], ":", "\[IndentingNewLine]", "   ", 
     RowBox[{"Takes", " ", "Tf"}], ":", " ", 
     RowBox[{
     "Total", " ", "time", " ", "of", " ", "the", " ", "motion", " ", "in", 
      " ", "seconds", " ", "from", " ", "rest", " ", "to", " ", "rest"}]}], 
    ",", "\[IndentingNewLine]", "          ", 
    RowBox[{
     RowBox[{"t", ":", " ", 
      RowBox[{
       RowBox[{
       "The", " ", "current", " ", "time", " ", "t", " ", "satisfying", " ", 
        "0"}], "<", "t", "<", 
       RowBox[{
        RowBox[{"Tf", ".", "\[IndentingNewLine]", "Returns"}], " ", "s"}]}], 
      ":", " ", 
      RowBox[{
       RowBox[{"The", " ", "path", " ", "parameter", " ", "s", 
        RowBox[{"(", "t", ")"}], " ", "corresponding", " ", "to", " ", "a", 
        " ", "third"}], "-", 
       RowBox[{
       "order", " ", "polynomial", " ", "motion", " ", "that", " ", "begins", 
        " ", "and", " ", "ends", " ", "at", " ", "zero", " ", 
        RowBox[{"velocity", "."}]}]}]}], "\[IndentingNewLine]", ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Example", ":", "\[IndentingNewLine]", "Input", ":", 
       "\[IndentingNewLine]", "Tf"}], "=", "2"}], ";", "\n", "  ", 
     RowBox[{"t", "=", "0.6"}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"s", " ", "=", " ", 
      RowBox[{
       RowBox[{"CubicTimeScaling", "[", 
        RowBox[{"Tf", ",", "t"}], "]"}], "\[IndentingNewLine]", 
       RowBox[{
       "Output", ":", "\[IndentingNewLine]", "0.21600000000000003"}]}]}]}]}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CubicTimeScaling", "[", 
     RowBox[{"Tf_", ",", "t_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"3", "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"t", "/", "Tf"}], ")"}], "^", "2"}]}], "-", 
     RowBox[{"2", "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"t", "/", "Tf"}], ")"}], "^", "3"}]}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.654107438701495*^9, 3.6541075770931664`*^9}, {
   3.6541076103152647`*^9, 3.654107726674172*^9}, {3.654107800327899*^9, 
   3.654107805926005*^9}, {3.654107842157054*^9, 3.654107956534466*^9}, {
   3.6541080276373253`*^9, 3.654108039845397*^9}, {3.654108208328875*^9, 
   3.654108267778264*^9}, {3.654108316603101*^9, 3.65410832858707*^9}, {
   3.654122072990996*^9, 3.654122200142358*^9}, {3.654122232524707*^9, 
   3.6541222637488813`*^9}, {3.654122372486209*^9, 3.65412253592478*^9}, {
   3.654122571686759*^9, 3.654122685636675*^9}, {3.654122740902017*^9, 
   3.6541228215630703`*^9}, {3.654122865671712*^9, 3.654122935620612*^9}, {
   3.654123032181581*^9, 3.6541230914473333`*^9}, {3.654123152783122*^9, 
   3.6541232043612537`*^9}, {3.654123304611115*^9, 3.654123341073502*^9}, {
   3.654123502235703*^9, 3.654123578362132*^9}, {3.654123664279245*^9, 
   3.654123683195951*^9}, {3.6541237878998413`*^9, 3.6541238249788847`*^9}, {
   3.654123940392714*^9, 3.654123947510108*^9}, {3.654124026309593*^9, 
   3.654124026885428*^9}, 3.6541241152729683`*^9, 3.654124170343902*^9, {
   3.6541246995439568`*^9, 3.654124712871656*^9}, {3.6541251843297157`*^9, 
   3.654125231518578*^9}, {3.6541254856851683`*^9, 3.65412548908077*^9}, {
   3.654125547742125*^9, 3.654125551165526*^9}, {3.654125930807577*^9, 
   3.654126007244483*^9}, {3.654126127665163*^9, 3.654126191634789*^9}, {
   3.654126236482831*^9, 3.654126250153975*^9}, {3.6541262848658533`*^9, 
   3.654126288991514*^9}, {3.654126323055903*^9, 3.654126399729628*^9}, {
   3.654126435349374*^9, 3.654126447266036*^9}, {3.654126530077552*^9, 
   3.6541265937421*^9}, {3.654126679867402*^9, 3.6541267650289497`*^9}, {
   3.6541267969631968`*^9, 3.654126798410089*^9}, {3.654126829860013*^9, 
   3.654126881359337*^9}, {3.6541269393824577`*^9, 3.654126959132009*^9}, {
   3.654127079773924*^9, 3.654127194954756*^9}, {3.654127229244482*^9, 
   3.654127253953713*^9}, {3.6541278694900227`*^9, 3.654127878663176*^9}, {
   3.654127969775614*^9, 3.6541279938293123`*^9}, {3.654128051763153*^9, 
   3.654128134016169*^9}, {3.654128326830834*^9, 3.654128326972948*^9}, {
   3.654182305132535*^9, 3.654182317491791*^9}, {3.65418238746202*^9, 
   3.654182511491269*^9}, {3.654182551115921*^9, 3.654182559209998*^9}, {
   3.6541826265390177`*^9, 3.654182732425318*^9}, {3.654182795218339*^9, 
   3.654182802306821*^9}, {3.654182858360195*^9, 3.654182976637673*^9}, {
   3.65418309291822*^9, 3.6541831115452337`*^9}, {3.654183280620055*^9, 
   3.654183381285778*^9}, {3.6541834216733217`*^9, 3.65418343026462*^9}, {
   3.65418347398075*^9, 3.654183479016459*^9}, {3.654183517743698*^9, 
   3.654183590244978*^9}, {3.654183629340012*^9, 3.654183659551435*^9}, {
   3.654183828746057*^9, 3.654183869187777*^9}, {3.654183918271063*^9, 
   3.6541839184304667`*^9}, {3.654206461375032*^9, 3.6542064948942213`*^9}, {
   3.6542065261576433`*^9, 3.654206710642645*^9}, {3.65420685898112*^9, 
   3.654206859498214*^9}, {3.654206912388175*^9, 3.6542069199221067`*^9}, {
   3.654206956850091*^9, 3.654206957769821*^9}, {3.6542070885864773`*^9, 
   3.6542070905801163`*^9}, {3.6542071861274023`*^9, 3.654207197287834*^9}, {
   3.654207355631957*^9, 3.65420737546005*^9}, {3.654207422116619*^9, 
   3.6542074295958633`*^9}, {3.654207513008601*^9, 3.654207622631179*^9}, {
   3.6542077902321663`*^9, 3.6542079082040863`*^9}, {3.654208112675095*^9, 
   3.6542082406765347`*^9}, {3.654208390436673*^9, 3.654208437282127*^9}, {
   3.654208729398788*^9, 3.6542088242969923`*^9}, {3.654208875181876*^9, 
   3.6542089105814543`*^9}, {3.654209036563011*^9, 3.654209042056604*^9}, {
   3.654209131808134*^9, 3.654209211748107*^9}, {3.654277910558556*^9, 
   3.654277962902483*^9}, {3.6542785554956903`*^9, 3.654278555764879*^9}, {
   3.6542801407928543`*^9, 3.654280145647377*^9}, {3.654280336511973*^9, 
   3.654280388661951*^9}, {3.654735519742467*^9, 3.654735526212496*^9}, {
   3.654736711632904*^9, 3.654736744359725*^9}, {3.654736840726715*^9, 
   3.6547369027091503`*^9}, {3.6547369619155817`*^9, 3.65473711893006*^9}, 
   3.654737215212165*^9, {3.6547372623430433`*^9, 3.654737301717353*^9}, {
   3.654737434898181*^9, 3.654737445769989*^9}, {3.654737593349925*^9, 
   3.654737893647337*^9}, {3.654737938282483*^9, 3.654737939560112*^9}, {
   3.654737995469615*^9, 3.65473804382544*^9}, {3.65473814244207*^9, 
   3.65473826286047*^9}, {3.654738473301898*^9, 3.654738519313912*^9}, {
   3.654738551955141*^9, 3.654738559351729*^9}, {3.654738599129403*^9, 
   3.654738599566987*^9}, {3.654738653005966*^9, 3.654738704434928*^9}, {
   3.654738885183668*^9, 3.654738922018218*^9}, {3.654739011880048*^9, 
   3.65473910917871*^9}, {3.654739159170903*^9, 3.654739162120161*^9}, {
   3.6547393230277576`*^9, 3.6547393764227123`*^9}, {3.654739415181912*^9, 
   3.65473942023728*^9}, {3.654739453135948*^9, 3.654739679965816*^9}, {
   3.654739718627033*^9, 3.6547397334487553`*^9}, {3.654739765385715*^9, 
   3.654739851694334*^9}, {3.654739889466123*^9, 3.654740005071364*^9}, {
   3.6547400491757*^9, 3.654740154008595*^9}, 3.654740216700787*^9, {
   3.654740314399178*^9, 3.6547403286014967`*^9}, 3.6547403850818996`*^9, {
   3.654740521314966*^9, 3.654740541208376*^9}, {3.65474063388687*^9, 
   3.654740654515286*^9}, {3.654740701345427*^9, 3.654740810460566*^9}, {
   3.654740848239312*^9, 3.654741082783293*^9}, {3.654741274225429*^9, 
   3.65474127713437*^9}, 3.654741426789631*^9, {3.6547414571147537`*^9, 
   3.654741569824174*^9}, {3.654741604551594*^9, 3.65474161887015*^9}, {
   3.6547416933496304`*^9, 3.654741709459137*^9}, {3.654741935230948*^9, 
   3.654741945307493*^9}, {3.6547830386167917`*^9, 3.654783105454197*^9}, {
   3.6547832406606083`*^9, 3.6547832525310373`*^9}, {3.654783794511154*^9, 
   3.654783837663447*^9}, {3.65478390359721*^9, 3.654783909803577*^9}, {
   3.654783989474423*^9, 3.654784403124803*^9}, {3.654784520313846*^9, 
   3.654784622329711*^9}, {3.6547847231449842`*^9, 3.654784727983326*^9}, {
   3.654785122876478*^9, 3.654785187751635*^9}, {3.654785255283667*^9, 
   3.654785472044736*^9}, {3.654785554330287*^9, 3.6547855634367*^9}, {
   3.6547858133842907`*^9, 3.654785842420493*^9}, {3.654785988696732*^9, 
   3.654785999313698*^9}, {3.654786083383224*^9, 3.654786083827299*^9}, {
   3.654799998454865*^9, 3.654800009014682*^9}, 3.654800058896707*^9, {
   3.6548001027328*^9, 3.654800173381201*^9}, {3.654800206111162*^9, 
   3.654800346038969*^9}, {3.654800415767541*^9, 3.654800685527397*^9}, {
   3.654800717895743*^9, 3.6548007259529123`*^9}, {3.6548007560240192`*^9, 
   3.654800892868227*^9}, {3.654800961067473*^9, 3.6548010443125353`*^9}, {
   3.654801144205307*^9, 3.6548013970409203`*^9}, {3.654801447723054*^9, 
   3.6548014700938597`*^9}, {3.654801562889327*^9, 3.6548017505389137`*^9}, {
   3.6548017965315866`*^9, 3.654801838591158*^9}, {3.654801925163512*^9, 
   3.654801957336872*^9}, {3.654802037838778*^9, 3.654802097667626*^9}, {
   3.6548021338675137`*^9, 3.654802151746142*^9}, {3.6548021938035927`*^9, 
   3.65480226557542*^9}, {3.6548023434469347`*^9, 3.6548024564595747`*^9}, {
   3.654802493167995*^9, 3.654802498462143*^9}, {3.654802632969117*^9, 
   3.654802636326886*^9}, {3.6548026864101667`*^9, 3.6548027624957323`*^9}, {
   3.654802812209731*^9, 3.6548030159498*^9}, {3.6548066359524317`*^9, 
   3.654806720935005*^9}, {3.654806751992766*^9, 3.6548067587144833`*^9}, {
   3.654806821497799*^9, 3.654806889382121*^9}, {3.654807006283039*^9, 
   3.654807210369132*^9}, {3.654807340425975*^9, 3.6548074184588003`*^9}, {
   3.6548074913193197`*^9, 3.654807699931301*^9}, 3.6548078200861998`*^9, {
   3.654807890939335*^9, 3.65480791502777*^9}, {3.654807960842239*^9, 
   3.6548080712336483`*^9}, {3.654808128338978*^9, 3.6548081799548407`*^9}, {
   3.6548101758929577`*^9, 3.654810330104765*^9}, {3.654810401423953*^9, 
   3.654810408457419*^9}, {3.6548104718702717`*^9, 3.6548106690676603`*^9}, {
   3.6548107121438303`*^9, 3.6548108463298893`*^9}, {3.654810878513033*^9, 
   3.6548109250220337`*^9}, {3.654810973064028*^9, 3.6548109963255377`*^9}, {
   3.654811065383171*^9, 3.65481111435124*^9}, {3.6548111568410273`*^9, 
   3.654811165569319*^9}, {3.654811202562601*^9, 3.654811649746052*^9}, {
   3.657067656153129*^9, 3.657067660941557*^9}, {3.6570766750689*^9, 
   3.657076677028944*^9}, {3.658274451899232*^9, 3.6582744912918463`*^9}, {
   3.6583703518545094`*^9, 3.65837035300604*^9}, {3.675682824450754*^9, 
   3.6756828836706333`*^9}, {3.6756829858535852`*^9, 3.675683093476144*^9}, {
   3.675683163431617*^9, 3.675683301926485*^9}, {3.6756834458193197`*^9, 
   3.675683520674423*^9}, {3.675683569012762*^9, 3.675683584065415*^9}, 
   3.675683635500771*^9, {3.675684508273862*^9, 3.675684520687911*^9}, {
   3.675764977565001*^9, 3.675764979617189*^9}, {3.6757662451157312`*^9, 
   3.675766254498831*^9}, {3.675766317871736*^9, 3.675766345394107*^9}, {
   3.6757664078898573`*^9, 3.675766419041957*^9}, {3.6757665260531073`*^9, 
   3.6757665599652433`*^9}, {3.675766688881428*^9, 3.675766693414764*^9}, {
   3.675766760364307*^9, 3.675766898736827*^9}, {3.675766931380547*^9, 
   3.675766932915333*^9}, 3.675767022524777*^9, 3.675767053903921*^9, {
   3.675767094663486*^9, 3.675767157353602*^9}, {3.6757672038039017`*^9, 
   3.67576720815028*^9}, {3.675767263478516*^9, 3.675767302851701*^9}, {
   3.6757673469407463`*^9, 3.6757675158730087`*^9}, {3.675767609117689*^9, 
   3.6757676149377613`*^9}, 3.676110621848937*^9, {3.676110673192341*^9, 
   3.676110708132433*^9}, {3.676110758266004*^9, 3.676110779724792*^9}, {
   3.676110837502541*^9, 3.676110924302658*^9}, {3.676111015370205*^9, 
   3.676111023652515*^9}, {3.676111616884136*^9, 3.676111619101164*^9}, {
   3.67611165132108*^9, 3.67611182175666*^9}, 3.6761124388093357`*^9, {
   3.6761125310577183`*^9, 3.676112535417371*^9}, {3.67611278534865*^9, 
   3.676112852293083*^9}, {3.6761129469420633`*^9, 3.6761129566090517`*^9}, {
   3.6761133261675377`*^9, 3.6761133851728067`*^9}, {3.6761134570078707`*^9, 
   3.6761134886549597`*^9}, {3.676113519585043*^9, 3.676113581404831*^9}, {
   3.676113994051722*^9, 3.6761140495138607`*^9}, {3.67611471759483*^9, 
   3.676114727326268*^9}, {3.676114788083909*^9, 3.676114788267289*^9}, {
   3.67611493328951*^9, 3.6761149644016867`*^9}, {3.6761149993051443`*^9, 
   3.676115038096011*^9}, {3.676115419194528*^9, 3.676115484935451*^9}, {
   3.6761155900865583`*^9, 3.676115605985518*^9}, {3.676115760093829*^9, 
   3.676115778909306*^9}, {3.676115982499289*^9, 3.676116037133542*^9}, {
   3.6761161990700502`*^9, 3.676116233908482*^9}, {3.676116286507206*^9, 
   3.676116286712512*^9}, {3.67611639463448*^9, 3.676116464258135*^9}, {
   3.6761165873897543`*^9, 3.676116602580727*^9}, {3.6761174556753473`*^9, 
   3.67611745672952*^9}, {3.676117506535368*^9, 3.6761175229462357`*^9}, {
   3.676117600215383*^9, 3.6761176442364273`*^9}, {3.676117677849012*^9, 
   3.6761177082717953`*^9}, {3.67611812248459*^9, 3.6761181278825502`*^9}, {
   3.676118580166224*^9, 3.67611860485815*^9}, {3.676118651876894*^9, 
   3.6761187537386017`*^9}, {3.676118838160269*^9, 3.676118838374693*^9}, {
   3.67611887610327*^9, 3.676118940213615*^9}, {3.6761191096213007`*^9, 
   3.676119140757559*^9}, {3.6761192665343122`*^9, 3.676119273783136*^9}, {
   3.67611936142714*^9, 3.676119363325075*^9}, {3.676119488561606*^9, 
   3.676119492487294*^9}, {3.6761200703687267`*^9, 3.6761200707356052`*^9}, {
   3.6761202104386873`*^9, 3.676120268289008*^9}, {3.676120410677075*^9, 
   3.676120443293746*^9}, {3.676120474583932*^9, 3.676120475526285*^9}, {
   3.6761206125852633`*^9, 3.6761206205196333`*^9}, {3.6761234586125507`*^9, 
   3.676123489461384*^9}, {3.6761235483793917`*^9, 3.676123569634534*^9}, {
   3.676124493441423*^9, 3.676124518157651*^9}, {3.676124553443336*^9, 
   3.676124582966502*^9}, {3.6761246820730133`*^9, 3.676124716437358*^9}, {
   3.67612487549886*^9, 3.676124882235661*^9}, {3.676124956893395*^9, 
   3.676124958216114*^9}, {3.6761249904362507`*^9, 3.676124994364197*^9}, {
   3.676125048497746*^9, 3.676125189073619*^9}, {3.676125219923954*^9, 
   3.6761253767254953`*^9}, {3.6761261361020412`*^9, 3.676126180304117*^9}, {
   3.6761262318219957`*^9, 3.676126312208794*^9}, {3.6761263690337877`*^9, 
   3.6761264446350737`*^9}, {3.676126475578731*^9, 3.676126485467072*^9}, {
   3.676126538828438*^9, 3.676126562090301*^9}, {3.676126633785634*^9, 
   3.6761266365895157`*^9}, 3.6761268247458773`*^9, 3.676126912241247*^9, {
   3.676126960168599*^9, 3.676126960170166*^9}, {3.676127961375718*^9, 
   3.676127975299335*^9}, {3.676128268770321*^9, 3.676128269338847*^9}, 
   3.676128811729394*^9, 3.676723618051702*^9, {3.6767236778209963`*^9, 
   3.676723719771995*^9}, {3.676723979458334*^9, 3.676724090604282*^9}, {
   3.676724127937508*^9, 3.6767241297457438`*^9}, {3.676724160436442*^9, 
   3.676724221011488*^9}, {3.676724251830257*^9, 3.67672438224609*^9}, {
   3.676724439849156*^9, 3.676724475037467*^9}, 3.6767483498529*^9, 
   3.6780964291715813`*^9, {3.6911754904044347`*^9, 3.691175566060762*^9}, {
   3.6924786857669306`*^9, 3.6924787359268*^9}, {3.6931540241963797`*^9, 
   3.6931540282211866`*^9}},ExpressionUUID->"c0075b7e-c880-4998-8fed-\
6d7994aad149"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"QuinticTimeScaling", "[", 
      RowBox[{"Tf_", ",", "t_"}], "]"}], ":", "\[IndentingNewLine]", "   ", 
     RowBox[{"Takes", " ", "Tf"}], ":", " ", 
     RowBox[{
     "Total", " ", "time", " ", "of", " ", "the", " ", "motion", " ", "in", 
      " ", "seconds", " ", "from", " ", "rest", " ", "to", " ", "rest"}]}], 
    ",", "\[IndentingNewLine]", "          ", 
    RowBox[{
     RowBox[{"t", ":", " ", 
      RowBox[{
       RowBox[{
       "The", " ", "current", " ", "time", " ", "t", " ", "satisfying", " ", 
        "0"}], "<", "t", "<", 
       RowBox[{
        RowBox[{"Tf", ".", "\[IndentingNewLine]", "Returns"}], " ", "s"}]}], 
      ":", " ", 
      RowBox[{
       RowBox[{"The", " ", "path", " ", "parameter", " ", "s", 
        RowBox[{"(", "t", ")"}], " ", "corresponding", " ", "to", " ", "a", 
        " ", "fifth"}], "-", 
       RowBox[{
       "order", " ", "polynomial", " ", "motion", " ", "that", " ", "begins", 
        " ", "and", " ", "ends", " ", "at", " ", "zero", " ", "velocity", " ",
         "and", " ", "zero", " ", 
        RowBox[{"acceleration", "."}]}]}]}], "\[IndentingNewLine]", ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Example", ":", "\[IndentingNewLine]", "Input", ":", 
       "\[IndentingNewLine]", "Tf"}], "=", "2"}], ";", "\n", "  ", 
     RowBox[{"t", "=", "0.6"}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"s", " ", "=", " ", 
      RowBox[{
       RowBox[{"QuinticTimeScaling", "[", 
        RowBox[{"Tf", ",", "t"}], "]"}], "\[IndentingNewLine]", 
       RowBox[{"Output", ":", "\[IndentingNewLine]", "0.16308"}]}]}]}]}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"QuinticTimeScaling", "[", 
     RowBox[{"Tf_", ",", "t_"}], "]"}], ":=", 
    RowBox[{
     RowBox[{"10", "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"t", "/", "Tf"}], ")"}], "^", "3"}]}], "-", 
     RowBox[{"15", "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"t", "/", "Tf"}], ")"}], "^", "4"}]}], "+", 
     RowBox[{"6", "*", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"t", "/", "Tf"}], ")"}], "^", "5"}]}]}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.6767251794253798`*^9, 3.676725236664359*^9}, {
   3.676725277944274*^9, 3.67672530444382*^9}, {3.676725421409651*^9, 
   3.6767254615354853`*^9}, {3.676725541834879*^9, 3.67672557969561*^9}, {
   3.676725634863492*^9, 3.67672567485637*^9}, {3.676725730380808*^9, 
   3.676725775670374*^9}, 3.6780964362059727`*^9, {3.6911766132276564`*^9, 
   3.6911766747101727`*^9}, {3.6924787156806417`*^9, 3.692478737600895*^9}, {
   3.6931540326047945`*^9, 
   3.693154036801202*^9}},ExpressionUUID->"b650297d-45e5-44b0-83f7-\
ea7a549e74e8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"JointTrajectory", "[", 
      RowBox[{
      "thetastart_", ",", "thetaend_", ",", "Tf_", ",", "N_", ",", 
       "method_"}], "]"}], ":", "\[IndentingNewLine]", "     ", 
     RowBox[{"Takes", " ", "thetastart"}], ":", " ", 
     RowBox[{"The", " ", "initial", " ", "joint", " ", "variables"}]}], ",", 
    "\[IndentingNewLine]", "            ", 
    RowBox[{"thetaend", ":", " ", 
     RowBox[{"The", " ", "final", " ", "joint", " ", "variables"}]}], ",", 
    RowBox[{"Tf", ":", 
     RowBox[{
     "Total", " ", "time", " ", "of", " ", "the", " ", "motion", " ", "in", 
      " ", "seconds", " ", "from", " ", "rest", " ", "to", " ", "rest"}]}], 
    ",", "                                                                    \
     ", "\[IndentingNewLine]", "            ", 
    RowBox[{"N", ":", " ", 
     RowBox[{
      RowBox[{"The", " ", "number", " ", "of", " ", "points", " ", "N"}], ">", 
      RowBox[{"1", " ", 
       RowBox[{"(", 
        RowBox[{"Start", " ", "and", " ", "stop"}], ")"}], " ", "in", " ", 
       "the", " ", "discrete", " ", "representation", " ", "of", " ", "the", 
       " ", "trajectory"}]}]}], ",", "\[IndentingNewLine]", "            ", 
    RowBox[{"method", ":", " ", 
     RowBox[{
      RowBox[{"The", " ", "time"}], "-", 
      RowBox[{"scaling", " ", "method"}]}]}], ",", 
    RowBox[{"where", " ", "3", " ", "indicates", " ", "cubic", " ", 
     RowBox[{"(", 
      RowBox[{"third", "-", 
       RowBox[{"order", " ", "polynomial"}]}], ")"}], " ", "time", " ", 
     "scaling", " ", "and", " ", "5", " ", "indicates", " ", "quintic", " ", 
     RowBox[{"(", 
      RowBox[{"fifth", "-", 
       RowBox[{"order", " ", "polynomial"}]}], ")"}], " ", "time", " ", 
     RowBox[{"scaling", ".", "\[IndentingNewLine]", "    ", "Returns"}], " ", 
     RowBox[{"traj", ":", " ", 
      RowBox[{
      "A", " ", "trajectory", " ", "as", " ", "an", " ", "N", " ", "x", " ", 
       "n", " ", "matrix"}]}]}], ",", " ", 
    RowBox[{
     RowBox[{
      RowBox[{
      "where", " ", "each", " ", "row", " ", "is", " ", "an", " ", "n"}], "-", 
      RowBox[{
      "vector", " ", "of", " ", "joint", " ", "variables", " ", "at", " ", 
       "an", " ", "instant", " ", "in", " ", 
       RowBox[{"time", ".", "The"}], " ", "first", " ", "row", " ", "is", " ",
        "thetastart", " ", "and", " ", "the", " ", "Nth", " ", "row", " ", 
       "is", " ", 
       RowBox[{"thetaend", ".", "The"}], " ", "elapsed", " ", "time", " ", 
       "between", " ", "each", " ", "row", " ", "is", " ", 
       RowBox[{"Tf", "/", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"N", "-", "1"}], ")"}], ".", "\[IndentingNewLine]", 
         "The"}]}], " ", "returned", " ", "trajectory", " ", "is", " ", "a", 
       " ", "straight"}], "-", 
      RowBox[{"line", " ", "motion", " ", "in", " ", "joint", " ", 
       RowBox[{"space", "."}]}]}], "\[IndentingNewLine]", ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Example", ":", "\[IndentingNewLine]", "Input", ":", 
       "\[IndentingNewLine]", "thetastart"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
         "1", ",", "0", ",", "0", ",", "1", ",", "1", ",", "0.2", ",", "0", 
          ",", "1"}], "}"}], "}"}], "\[Transpose]"}]}], ";", "\n", 
     RowBox[{"thetaend", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
         "1.2", ",", "0.5", ",", "0.6", ",", "1.1", ",", "2", ",", "2", ",", 
          "0.9", ",", "1"}], "}"}], "}"}], "\[Transpose]"}]}], ";", "\n", 
     RowBox[{"Tf", "=", "4"}], ";", "\n", 
     RowBox[{"Np", "=", "6"}], ";", "\n", 
     RowBox[{"method", "=", "3"}], ";", "\[IndentingNewLine]", 
     RowBox[{"traj", " ", "=", " ", 
      RowBox[{
       RowBox[{
        RowBox[{"JointTrajectory", "[", 
         RowBox[{
         "thetastart", ",", "thetaend", ",", "Tf", ",", "Np", ",", "method"}],
          "]"}], "//", "MatrixForm"}], "//", 
       RowBox[{"N", "\[IndentingNewLine]", 
        RowBox[{"Output", ":", "\[IndentingNewLine]", 
         TagBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"1.", "0.", "0.", "1.", "1.", "0.2", "0.", "1."},
             {"1.0208", "0.052", "0.0624", "1.0104", "1.104", "0.3872", 
              "0.0936", "1."},
             {"1.0704", "0.176", "0.21119999999999997", "1.0352000000000001", 
              "1.352", "0.8335999999999999", "0.31679999999999997", "1."},
             {"1.1296", "0.324", "0.3888", "1.0648", "1.648", "1.3664", 
              "0.5832", "1."},
             {"1.1792", "0.448", "0.5376", "1.0896000000000001", "1.896", 
              "1.8128", "0.8064", "1."},
             {"1.2", "0.5", "0.6", "1.1", "2.", "2.", "0.9", "1."}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], ")"}],
          Function[BoxForm`e$, 
           MatrixForm[BoxForm`e$]]]}]}]}]}]}]}], "\[IndentingNewLine]", 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"JointTrajectory", "[", 
     RowBox[{
     "thetastart_", ",", "thetaend_", ",", "Tf_", ",", "Num_", ",", 
      "method_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Numb", "=", 
         RowBox[{"Round", "[", "Num", "]"}]}], ",", "timegap", ",", "traj", 
        ",", "s"}], "}"}], ",", 
      RowBox[{
       RowBox[{"timegap", "=", 
        RowBox[{"Tf", "/", 
         RowBox[{"(", 
          RowBox[{"Numb", "-", "1"}], ")"}]}]}], ";", 
       RowBox[{"traj", "=", " ", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Length", "[", "thetastart", "]"}], ",", "Numb"}], 
           "}"}]}], "]"}]}], ";", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"method", " ", "\[Equal]", " ", "3"}], ",", 
            RowBox[{"s", "=", 
             RowBox[{"CubicTimeScaling", "[", 
              RowBox[{"Tf", ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"i", "-", "1"}], ")"}], "*", "timegap"}]}], "]"}]}], 
            ",", 
            RowBox[{"s", "=", " ", 
             RowBox[{"QuinticTimeScaling", "[", 
              RowBox[{"Tf", ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"i", "-", "1"}], ")"}], "*", "timegap"}]}], 
              "]"}]}]}], "]"}], ";", 
          RowBox[{
           RowBox[{"traj", "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", "i"}], "]"}], "]"}], "=", 
           RowBox[{"Flatten", "[", 
            RowBox[{"thetastart", " ", "+", 
             RowBox[{"s", "*", 
              RowBox[{"(", 
               RowBox[{"thetaend", "-", "thetastart"}], ")"}]}]}], "]"}]}]}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "Numb"}], "}"}]}], "]"}], ";", 
       RowBox[{"traj", "=", 
        RowBox[{"traj", "\[Transpose]"}]}], ";", 
       RowBox[{"Return", "[", "traj", "]"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.654107438701495*^9, 3.6541075770931664`*^9}, {
   3.6541076103152647`*^9, 3.654107726674172*^9}, {3.654107800327899*^9, 
   3.654107805926005*^9}, {3.654107842157054*^9, 3.654107956534466*^9}, {
   3.6541080276373253`*^9, 3.654108039845397*^9}, {3.654108208328875*^9, 
   3.654108267778264*^9}, {3.654108316603101*^9, 3.65410832858707*^9}, {
   3.654122072990996*^9, 3.654122200142358*^9}, {3.654122232524707*^9, 
   3.6541222637488813`*^9}, {3.654122372486209*^9, 3.65412253592478*^9}, {
   3.654122571686759*^9, 3.654122685636675*^9}, {3.654122740902017*^9, 
   3.6541228215630703`*^9}, {3.654122865671712*^9, 3.654122935620612*^9}, {
   3.654123032181581*^9, 3.6541230914473333`*^9}, {3.654123152783122*^9, 
   3.6541232043612537`*^9}, {3.654123304611115*^9, 3.654123341073502*^9}, {
   3.654123502235703*^9, 3.654123578362132*^9}, {3.654123664279245*^9, 
   3.654123683195951*^9}, {3.6541237878998413`*^9, 3.6541238249788847`*^9}, {
   3.654123940392714*^9, 3.654123947510108*^9}, {3.654124026309593*^9, 
   3.654124026885428*^9}, 3.6541241152729683`*^9, 3.654124170343902*^9, {
   3.6541246995439568`*^9, 3.654124712871656*^9}, {3.6541251843297157`*^9, 
   3.654125231518578*^9}, {3.6541254856851683`*^9, 3.65412548908077*^9}, {
   3.654125547742125*^9, 3.654125551165526*^9}, {3.654125930807577*^9, 
   3.654126007244483*^9}, {3.654126127665163*^9, 3.654126191634789*^9}, {
   3.654126236482831*^9, 3.654126250153975*^9}, {3.6541262848658533`*^9, 
   3.654126288991514*^9}, {3.654126323055903*^9, 3.654126399729628*^9}, {
   3.654126435349374*^9, 3.654126447266036*^9}, {3.654126530077552*^9, 
   3.6541265937421*^9}, {3.654126679867402*^9, 3.6541267650289497`*^9}, {
   3.6541267969631968`*^9, 3.654126798410089*^9}, {3.654126829860013*^9, 
   3.654126881359337*^9}, {3.6541269393824577`*^9, 3.654126959132009*^9}, {
   3.654127079773924*^9, 3.654127194954756*^9}, {3.654127229244482*^9, 
   3.654127253953713*^9}, {3.6541278694900227`*^9, 3.654127878663176*^9}, {
   3.654127969775614*^9, 3.6541279938293123`*^9}, {3.654128051763153*^9, 
   3.654128134016169*^9}, {3.654128326830834*^9, 3.654128326972948*^9}, {
   3.654182305132535*^9, 3.654182317491791*^9}, {3.65418238746202*^9, 
   3.654182511491269*^9}, {3.654182551115921*^9, 3.654182559209998*^9}, {
   3.6541826265390177`*^9, 3.654182732425318*^9}, {3.654182795218339*^9, 
   3.654182802306821*^9}, {3.654182858360195*^9, 3.654182976637673*^9}, {
   3.65418309291822*^9, 3.6541831115452337`*^9}, {3.654183280620055*^9, 
   3.654183381285778*^9}, {3.6541834216733217`*^9, 3.65418343026462*^9}, {
   3.65418347398075*^9, 3.654183479016459*^9}, {3.654183517743698*^9, 
   3.654183590244978*^9}, {3.654183629340012*^9, 3.654183659551435*^9}, {
   3.654183828746057*^9, 3.654183869187777*^9}, {3.654183918271063*^9, 
   3.6541839184304667`*^9}, {3.654206461375032*^9, 3.6542064948942213`*^9}, {
   3.6542065261576433`*^9, 3.654206710642645*^9}, {3.65420685898112*^9, 
   3.654206859498214*^9}, {3.654206912388175*^9, 3.6542069199221067`*^9}, {
   3.654206956850091*^9, 3.654206957769821*^9}, {3.6542070885864773`*^9, 
   3.6542070905801163`*^9}, {3.6542071861274023`*^9, 3.654207197287834*^9}, {
   3.654207355631957*^9, 3.65420737546005*^9}, {3.654207422116619*^9, 
   3.6542074295958633`*^9}, {3.654207513008601*^9, 3.654207622631179*^9}, {
   3.6542077902321663`*^9, 3.6542079082040863`*^9}, {3.654208112675095*^9, 
   3.6542082406765347`*^9}, {3.654208390436673*^9, 3.654208437282127*^9}, {
   3.654208729398788*^9, 3.6542088242969923`*^9}, {3.654208875181876*^9, 
   3.6542089105814543`*^9}, {3.654209036563011*^9, 3.654209042056604*^9}, {
   3.654209131808134*^9, 3.654209211748107*^9}, {3.654277910558556*^9, 
   3.654277962902483*^9}, {3.6542785554956903`*^9, 3.654278555764879*^9}, {
   3.6542801407928543`*^9, 3.654280145647377*^9}, {3.654280336511973*^9, 
   3.654280388661951*^9}, {3.654735519742467*^9, 3.654735526212496*^9}, {
   3.654736711632904*^9, 3.654736744359725*^9}, {3.654736840726715*^9, 
   3.6547369027091503`*^9}, {3.6547369619155817`*^9, 3.65473711893006*^9}, 
   3.654737215212165*^9, {3.6547372623430433`*^9, 3.654737301717353*^9}, {
   3.654737434898181*^9, 3.654737445769989*^9}, {3.654737593349925*^9, 
   3.654737893647337*^9}, {3.654737938282483*^9, 3.654737939560112*^9}, {
   3.654737995469615*^9, 3.65473804382544*^9}, {3.65473814244207*^9, 
   3.65473826286047*^9}, {3.654738473301898*^9, 3.654738519313912*^9}, {
   3.654738551955141*^9, 3.654738559351729*^9}, {3.654738599129403*^9, 
   3.654738599566987*^9}, {3.654738653005966*^9, 3.654738704434928*^9}, {
   3.654738885183668*^9, 3.654738922018218*^9}, {3.654739011880048*^9, 
   3.65473910917871*^9}, {3.654739159170903*^9, 3.654739162120161*^9}, {
   3.6547393230277576`*^9, 3.6547393764227123`*^9}, {3.654739415181912*^9, 
   3.65473942023728*^9}, {3.654739453135948*^9, 3.654739679965816*^9}, {
   3.654739718627033*^9, 3.6547397334487553`*^9}, {3.654739765385715*^9, 
   3.654739851694334*^9}, {3.654739889466123*^9, 3.654740005071364*^9}, {
   3.6547400491757*^9, 3.654740154008595*^9}, 3.654740216700787*^9, {
   3.654740314399178*^9, 3.6547403286014967`*^9}, 3.6547403850818996`*^9, {
   3.654740521314966*^9, 3.654740541208376*^9}, {3.65474063388687*^9, 
   3.654740654515286*^9}, {3.654740701345427*^9, 3.654740810460566*^9}, {
   3.654740848239312*^9, 3.654741082783293*^9}, {3.654741274225429*^9, 
   3.65474127713437*^9}, 3.654741426789631*^9, {3.6547414571147537`*^9, 
   3.654741569824174*^9}, {3.654741604551594*^9, 3.65474161887015*^9}, {
   3.6547416933496304`*^9, 3.654741709459137*^9}, {3.654741935230948*^9, 
   3.654741945307493*^9}, {3.6547830386167917`*^9, 3.654783105454197*^9}, {
   3.6547832406606083`*^9, 3.6547832525310373`*^9}, {3.654783794511154*^9, 
   3.654783837663447*^9}, {3.65478390359721*^9, 3.654783909803577*^9}, {
   3.654783989474423*^9, 3.654784403124803*^9}, {3.654784520313846*^9, 
   3.654784622329711*^9}, {3.6547847231449842`*^9, 3.654784727983326*^9}, {
   3.654785122876478*^9, 3.654785187751635*^9}, {3.654785255283667*^9, 
   3.654785472044736*^9}, {3.654785554330287*^9, 3.6547855634367*^9}, {
   3.6547858133842907`*^9, 3.654785842420493*^9}, {3.654785988696732*^9, 
   3.654785999313698*^9}, {3.654786083383224*^9, 3.654786083827299*^9}, {
   3.654799998454865*^9, 3.654800009014682*^9}, 3.654800058896707*^9, {
   3.6548001027328*^9, 3.654800173381201*^9}, {3.654800206111162*^9, 
   3.654800346038969*^9}, {3.654800415767541*^9, 3.654800685527397*^9}, {
   3.654800717895743*^9, 3.6548007259529123`*^9}, {3.6548007560240192`*^9, 
   3.654800892868227*^9}, {3.654800961067473*^9, 3.6548010443125353`*^9}, {
   3.654801144205307*^9, 3.6548013970409203`*^9}, {3.654801447723054*^9, 
   3.6548014700938597`*^9}, {3.654801562889327*^9, 3.6548017505389137`*^9}, {
   3.6548017965315866`*^9, 3.654801838591158*^9}, {3.654801925163512*^9, 
   3.654801957336872*^9}, {3.654802037838778*^9, 3.654802097667626*^9}, {
   3.6548021338675137`*^9, 3.654802151746142*^9}, {3.6548021938035927`*^9, 
   3.65480226557542*^9}, {3.6548023434469347`*^9, 3.6548024564595747`*^9}, {
   3.654802493167995*^9, 3.654802498462143*^9}, {3.654802632969117*^9, 
   3.654802636326886*^9}, {3.6548026864101667`*^9, 3.6548027624957323`*^9}, {
   3.654802812209731*^9, 3.6548030159498*^9}, {3.6548066359524317`*^9, 
   3.654806720935005*^9}, {3.654806751992766*^9, 3.6548067587144833`*^9}, {
   3.654806821497799*^9, 3.654806889382121*^9}, {3.654807006283039*^9, 
   3.654807210369132*^9}, {3.654807340425975*^9, 3.6548074184588003`*^9}, {
   3.6548074913193197`*^9, 3.654807699931301*^9}, 3.6548078200861998`*^9, {
   3.654807890939335*^9, 3.65480791502777*^9}, {3.654807960842239*^9, 
   3.6548080712336483`*^9}, {3.654808128338978*^9, 3.6548081799548407`*^9}, {
   3.6548101758929577`*^9, 3.654810330104765*^9}, {3.654810401423953*^9, 
   3.654810408457419*^9}, {3.6548104718702717`*^9, 3.6548106690676603`*^9}, {
   3.6548107121438303`*^9, 3.6548108463298893`*^9}, {3.654810878513033*^9, 
   3.6548109250220337`*^9}, {3.654810973064028*^9, 3.6548109963255377`*^9}, {
   3.654811065383171*^9, 3.65481111435124*^9}, {3.6548111568410273`*^9, 
   3.654811165569319*^9}, {3.654811202562601*^9, 3.654811649746052*^9}, {
   3.657067656153129*^9, 3.657067660941557*^9}, {3.6570766750689*^9, 
   3.657076677028944*^9}, {3.658274451899232*^9, 3.6582744912918463`*^9}, {
   3.6583703518545094`*^9, 3.65837035300604*^9}, {3.67672532250014*^9, 
   3.676725326694919*^9}, {3.676726238098218*^9, 3.6767262868714447`*^9}, {
   3.67672632351712*^9, 3.676726328872868*^9}, {3.6767269746668167`*^9, 
   3.676726982754202*^9}, {3.676727016189947*^9, 3.6767270198275414`*^9}, {
   3.676727056006617*^9, 3.676727061995698*^9}, {3.676727162429737*^9, 
   3.676727252326495*^9}, {3.676727300513076*^9, 3.6767274904689007`*^9}, {
   3.6767382395189667`*^9, 3.676738245456195*^9}, 3.676743247626157*^9, {
   3.676748358463169*^9, 3.6767483602563457`*^9}, 3.678096441208591*^9, {
   3.6911891462586484`*^9, 3.6911891500962553`*^9}, {3.6911892163339715`*^9, 
   3.691189307765732*^9}, {3.6911893792941775`*^9, 3.691189661283306*^9}, 
   3.6911897134022875`*^9, {3.6911897779439793`*^9, 3.6911899073293796`*^9}, {
   3.69119374391782*^9, 3.691193824151409*^9}, {3.691194316052544*^9, 
   3.691194321015828*^9}, {3.6912399841067915`*^9, 3.691239985105193*^9}, {
   3.6912402595382757`*^9, 3.6912403230645876`*^9}, {3.6912403553742447`*^9, 
   3.691240444876602*^9}, {3.691240612846568*^9, 3.691240682956092*^9}, 
   3.6912407187289543`*^9, {3.6924745037041683`*^9, 3.692474615545565*^9}, {
   3.692474647572397*^9, 3.6924748587114735`*^9}, {3.6931540449912157`*^9, 
   3.6931540481112213`*^9}, {3.693162697432002*^9, 
   3.693162699008605*^9}},ExpressionUUID->"01b172e6-150d-47a2-93d8-\
0c226f061852"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"ScrewTrajectory", "[", 
      RowBox[{
      "Xstart_", ",", "Xend_", ",", "Tf_", ",", "N_", ",", "method_"}], "]"}],
      ":", "\[IndentingNewLine]", "   ", 
     RowBox[{"Takes", " ", "Xstart"}], ":", " ", 
     RowBox[{
      RowBox[{"The", " ", "initial", " ", "end"}], "-", 
      RowBox[{"effector", " ", "configuration"}]}]}], ",", 
    RowBox[{"Xend", ":", 
     RowBox[{
      RowBox[{"The", " ", "final", " ", "end"}], "-", 
      RowBox[{"effector", " ", "configuration"}]}]}], ",", 
    RowBox[{"Tf", ":", 
     RowBox[{
     "Total", " ", "time", " ", "of", " ", "the", " ", "motion", " ", "in", 
      " ", "seconds", " ", "from", " ", "rest", " ", "to", " ", "rest"}]}], 
    ",", "   ", "\[IndentingNewLine]", "          ", 
    RowBox[{"N", ":", " ", 
     RowBox[{
      RowBox[{"The", " ", "number", " ", "of", " ", "points", " ", "N"}], ">", 
      RowBox[{"1", " ", 
       RowBox[{"(", 
        RowBox[{"Start", " ", "and", " ", "stop"}], ")"}], " ", "in", " ", 
       "the", " ", "discrete", " ", "representation", " ", "of", " ", "the", 
       " ", "trajectory"}]}]}], ",", "\[IndentingNewLine]", "          ", 
    RowBox[{"method", ":", " ", 
     RowBox[{
      RowBox[{"The", " ", "time"}], "-", 
      RowBox[{"scaling", " ", "method"}]}]}], ",", " ", 
    RowBox[{
     RowBox[{"where", " ", "3", " ", "indicates", " ", "cubic", " ", 
      RowBox[{"(", 
       RowBox[{"third", "-", 
        RowBox[{"order", " ", "polynomial"}]}], ")"}], " ", "time", " ", 
      "scaling", " ", "and", " ", "5", " ", "indicates", " ", "quintic", " ", 
      RowBox[{"(", 
       RowBox[{"fifth", "-", 
        RowBox[{"order", " ", "polynomial"}]}], ")"}], " ", "time", " ", 
      RowBox[{"scaling", ".", "\[IndentingNewLine]", "  ", "Returns"}], " ", 
      RowBox[{"traj", ":", " ", 
       RowBox[{
       "The", " ", "discretized", " ", "trajectory", " ", "as", " ", "a", " ",
         "list", " ", "of", " ", "N", " ", "matrices", " ", "in", " ", "SE", 
        RowBox[{"(", "3", ")"}], " ", "separated", " ", "in", " ", "time", 
        " ", "by", " ", 
        RowBox[{"Tf", "/", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"N", "-", "1"}], ")"}], ".", "The"}]}], " ", "first", " ", 
        "in", " ", "the", " ", "list", " ", "is", " ", "Xstart", " ", "and", 
        " ", "the", " ", "Nth", " ", "is", " ", 
        RowBox[{"Xend", ".", "\[IndentingNewLine]", "This"}], " ", "function",
         " ", "calculates", " ", "a", " ", "trajectory", " ", "corresponding",
         " ", "to", " ", "the", " ", "screw", " ", "motion", " ", "about", 
        " ", "a", " ", "space", " ", "screw", " ", 
        RowBox[{"axis", "."}]}]}]}], "\[IndentingNewLine]", ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Example", ":", "\[IndentingNewLine]", "Input", ":", 
       "\[IndentingNewLine]", "Xstart"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\n", "  ", 
     RowBox[{"Xend", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "4.1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\n", "  ", 
     RowBox[{"Tf", "=", "5"}], ";", "\n", "  ", 
     RowBox[{"Np", "=", "4"}], ";", "\n", "  ", 
     RowBox[{"method", "=", "3"}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"traj", " ", "=", " ", 
      RowBox[{"ScrewTrajectory", "[", 
       RowBox[{"Xstart", ",", "Xend", ",", "Tf", ",", "Np", ",", "method"}], 
       "]"}]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"traj", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "//", 
         RowBox[{"MatrixForm", "\[IndentingNewLine]", 
          RowBox[{"traj", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}]}], "//", 
        RowBox[{"MatrixForm", "\[IndentingNewLine]", 
         RowBox[{"traj", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}]}], "//", 
       RowBox[{"MatrixForm", "\[IndentingNewLine]", 
        RowBox[{"traj", "[", 
         RowBox[{"[", "4", "]"}], "]"}]}]}], "//", 
      RowBox[{"MatrixForm", "\[IndentingNewLine]", 
       RowBox[{"Output", ":", "\[IndentingNewLine]", " ", 
        RowBox[{
         TagBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"1.", "0.", "0.", "1."},
             {"0.", "1.", "0.", "0."},
             {"0.", "0.", "1.", "1."},
             {"0.", "0.", "0.", "1."}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
          Function[BoxForm`e$, 
           MatrixForm[BoxForm`e$]]], "\[IndentingNewLine]", 
         TagBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"0.904", 
              RowBox[{"-", "0.25"}], "0.346", "0.441"},
             {"0.346", "0.904", 
              RowBox[{"-", "0.25"}], "0.529"},
             {
              RowBox[{"-", "0.25"}], "0.346", "0.904", "1.601"},
             {"0.", "0.", "0.", "1."}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], ")"}],
          Function[BoxForm`e$, 
           MatrixForm[BoxForm`e$]]], "\[IndentingNewLine]", 
         TagBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"0.346", 
              RowBox[{"-", "0.25"}], "0.904", 
              RowBox[{"-", "0.117"}]},
             {"0.904", "0.346", 
              RowBox[{"-", "0.25"}], "0.473"},
             {
              RowBox[{"-", "0.25"}], "0.904", "0.346", "3.274"},
             {"0.", "0.", "0.", "1."}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
          Function[BoxForm`e$, 
           MatrixForm[BoxForm`e$]]], "\[IndentingNewLine]", 
         TagBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"0.", "0.", "1.", "0.1"},
             {"1.", "0.", "0.", "0."},
             {"0.", "1.", "0.", "4.1"},
             {"0.", "0.", "0.", "1."}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
          Function[BoxForm`e$, 
           MatrixForm[BoxForm`e$]]]}]}]}]}]}]}], "\[IndentingNewLine]", 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ScrewTrajectory", "[", 
     RowBox[{"Xstart_", ",", "Xend_", ",", "Tf_", ",", "N_", ",", "method_"}],
      "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"timegap", "=", 
         RowBox[{"Tf", "/", 
          RowBox[{"(", 
           RowBox[{"N", "-", "1"}], ")"}]}]}], ",", 
        RowBox[{"traj", "=", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"Null", ",", "N"}], "]"}]}], ",", "s"}], "}"}], ",", 
      RowBox[{
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"method", " ", "\[Equal]", " ", "3"}], ",", 
            RowBox[{"s", "=", 
             RowBox[{"CubicTimeScaling", "[", 
              RowBox[{"Tf", ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"i", "-", "1"}], ")"}], "*", "timegap"}]}], "]"}]}], 
            ",", 
            RowBox[{"s", "=", " ", 
             RowBox[{"QuinticTimeScaling", "[", 
              RowBox[{"Tf", ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"i", "-", "1"}], ")"}], "*", "timegap"}]}], 
              "]"}]}]}], "]"}], ";", 
          RowBox[{
           RowBox[{"traj", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "=", 
           RowBox[{"Xstart", ".", 
            RowBox[{"MatrixExp6", "[", 
             RowBox[{
              RowBox[{"MatrixLog6", "[", 
               RowBox[{
                RowBox[{"TransInv", "[", "Xstart", "]"}], ".", "Xend"}], 
               "]"}], "*", "s"}], "]"}]}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "N"}], "}"}]}], "]"}], ";", 
       RowBox[{"Return", "[", "traj", "]"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.654107438701495*^9, 3.6541075770931664`*^9}, {
   3.6541076103152647`*^9, 3.654107726674172*^9}, {3.654107800327899*^9, 
   3.654107805926005*^9}, {3.654107842157054*^9, 3.654107956534466*^9}, {
   3.6541080276373253`*^9, 3.654108039845397*^9}, {3.654108208328875*^9, 
   3.654108267778264*^9}, {3.654108316603101*^9, 3.65410832858707*^9}, {
   3.654122072990996*^9, 3.654122200142358*^9}, {3.654122232524707*^9, 
   3.6541222637488813`*^9}, {3.654122372486209*^9, 3.65412253592478*^9}, {
   3.654122571686759*^9, 3.654122685636675*^9}, {3.654122740902017*^9, 
   3.6541228215630703`*^9}, {3.654122865671712*^9, 3.654122935620612*^9}, {
   3.654123032181581*^9, 3.6541230914473333`*^9}, {3.654123152783122*^9, 
   3.6541232043612537`*^9}, {3.654123304611115*^9, 3.654123341073502*^9}, {
   3.654123502235703*^9, 3.654123578362132*^9}, {3.654123664279245*^9, 
   3.654123683195951*^9}, {3.6541237878998413`*^9, 3.6541238249788847`*^9}, {
   3.654123940392714*^9, 3.654123947510108*^9}, {3.654124026309593*^9, 
   3.654124026885428*^9}, 3.6541241152729683`*^9, 3.654124170343902*^9, {
   3.6541246995439568`*^9, 3.654124712871656*^9}, {3.6541251843297157`*^9, 
   3.654125231518578*^9}, {3.6541254856851683`*^9, 3.65412548908077*^9}, {
   3.654125547742125*^9, 3.654125551165526*^9}, {3.654125930807577*^9, 
   3.654126007244483*^9}, {3.654126127665163*^9, 3.654126191634789*^9}, {
   3.654126236482831*^9, 3.654126250153975*^9}, {3.6541262848658533`*^9, 
   3.654126288991514*^9}, {3.654126323055903*^9, 3.654126399729628*^9}, {
   3.654126435349374*^9, 3.654126447266036*^9}, {3.654126530077552*^9, 
   3.6541265937421*^9}, {3.654126679867402*^9, 3.6541267650289497`*^9}, {
   3.6541267969631968`*^9, 3.654126798410089*^9}, {3.654126829860013*^9, 
   3.654126881359337*^9}, {3.6541269393824577`*^9, 3.654126959132009*^9}, {
   3.654127079773924*^9, 3.654127194954756*^9}, {3.654127229244482*^9, 
   3.654127253953713*^9}, {3.6541278694900227`*^9, 3.654127878663176*^9}, {
   3.654127969775614*^9, 3.6541279938293123`*^9}, {3.654128051763153*^9, 
   3.654128134016169*^9}, {3.654128326830834*^9, 3.654128326972948*^9}, {
   3.654182305132535*^9, 3.654182317491791*^9}, {3.65418238746202*^9, 
   3.654182511491269*^9}, {3.654182551115921*^9, 3.654182559209998*^9}, {
   3.6541826265390177`*^9, 3.654182732425318*^9}, {3.654182795218339*^9, 
   3.654182802306821*^9}, {3.654182858360195*^9, 3.654182976637673*^9}, {
   3.65418309291822*^9, 3.6541831115452337`*^9}, {3.654183280620055*^9, 
   3.654183381285778*^9}, {3.6541834216733217`*^9, 3.65418343026462*^9}, {
   3.65418347398075*^9, 3.654183479016459*^9}, {3.654183517743698*^9, 
   3.654183590244978*^9}, {3.654183629340012*^9, 3.654183659551435*^9}, {
   3.654183828746057*^9, 3.654183869187777*^9}, {3.654183918271063*^9, 
   3.6541839184304667`*^9}, {3.654206461375032*^9, 3.6542064948942213`*^9}, {
   3.6542065261576433`*^9, 3.654206710642645*^9}, {3.65420685898112*^9, 
   3.654206859498214*^9}, {3.654206912388175*^9, 3.6542069199221067`*^9}, {
   3.654206956850091*^9, 3.654206957769821*^9}, {3.6542070885864773`*^9, 
   3.6542070905801163`*^9}, {3.6542071861274023`*^9, 3.654207197287834*^9}, {
   3.654207355631957*^9, 3.65420737546005*^9}, {3.654207422116619*^9, 
   3.6542074295958633`*^9}, {3.654207513008601*^9, 3.654207622631179*^9}, {
   3.6542077902321663`*^9, 3.6542079082040863`*^9}, {3.654208112675095*^9, 
   3.6542082406765347`*^9}, {3.654208390436673*^9, 3.654208437282127*^9}, {
   3.654208729398788*^9, 3.6542088242969923`*^9}, {3.654208875181876*^9, 
   3.6542089105814543`*^9}, {3.654209036563011*^9, 3.654209042056604*^9}, {
   3.654209131808134*^9, 3.654209211748107*^9}, {3.654277910558556*^9, 
   3.654277962902483*^9}, {3.6542785554956903`*^9, 3.654278555764879*^9}, {
   3.6542801407928543`*^9, 3.654280145647377*^9}, {3.654280336511973*^9, 
   3.654280388661951*^9}, {3.654735519742467*^9, 3.654735526212496*^9}, {
   3.654736711632904*^9, 3.654736744359725*^9}, {3.654736840726715*^9, 
   3.6547369027091503`*^9}, {3.6547369619155817`*^9, 3.65473711893006*^9}, 
   3.654737215212165*^9, {3.6547372623430433`*^9, 3.654737301717353*^9}, {
   3.654737434898181*^9, 3.654737445769989*^9}, {3.654737593349925*^9, 
   3.654737893647337*^9}, {3.654737938282483*^9, 3.654737939560112*^9}, {
   3.654737995469615*^9, 3.65473804382544*^9}, {3.65473814244207*^9, 
   3.65473826286047*^9}, {3.654738473301898*^9, 3.654738519313912*^9}, {
   3.654738551955141*^9, 3.654738559351729*^9}, {3.654738599129403*^9, 
   3.654738599566987*^9}, {3.654738653005966*^9, 3.654738704434928*^9}, {
   3.654738885183668*^9, 3.654738922018218*^9}, {3.654739011880048*^9, 
   3.65473910917871*^9}, {3.654739159170903*^9, 3.654739162120161*^9}, {
   3.6547393230277576`*^9, 3.6547393764227123`*^9}, {3.654739415181912*^9, 
   3.65473942023728*^9}, {3.654739453135948*^9, 3.654739679965816*^9}, {
   3.654739718627033*^9, 3.6547397334487553`*^9}, {3.654739765385715*^9, 
   3.654739851694334*^9}, {3.654739889466123*^9, 3.654740005071364*^9}, {
   3.6547400491757*^9, 3.654740154008595*^9}, 3.654740216700787*^9, {
   3.654740314399178*^9, 3.6547403286014967`*^9}, 3.6547403850818996`*^9, {
   3.654740521314966*^9, 3.654740541208376*^9}, {3.65474063388687*^9, 
   3.654740654515286*^9}, {3.654740701345427*^9, 3.654740810460566*^9}, {
   3.654740848239312*^9, 3.654741082783293*^9}, {3.654741274225429*^9, 
   3.65474127713437*^9}, 3.654741426789631*^9, {3.6547414571147537`*^9, 
   3.654741569824174*^9}, {3.654741604551594*^9, 3.65474161887015*^9}, {
   3.6547416933496304`*^9, 3.654741709459137*^9}, {3.654741935230948*^9, 
   3.654741945307493*^9}, {3.6547830386167917`*^9, 3.654783105454197*^9}, {
   3.6547832406606083`*^9, 3.6547832525310373`*^9}, {3.654783794511154*^9, 
   3.654783837663447*^9}, {3.65478390359721*^9, 3.654783909803577*^9}, {
   3.654783989474423*^9, 3.654784403124803*^9}, {3.654784520313846*^9, 
   3.654784622329711*^9}, {3.6547847231449842`*^9, 3.654784727983326*^9}, {
   3.654785122876478*^9, 3.654785187751635*^9}, {3.654785255283667*^9, 
   3.654785472044736*^9}, {3.654785554330287*^9, 3.6547855634367*^9}, {
   3.6547858133842907`*^9, 3.654785842420493*^9}, {3.654785988696732*^9, 
   3.654785999313698*^9}, {3.654786083383224*^9, 3.654786083827299*^9}, {
   3.654799998454865*^9, 3.654800009014682*^9}, 3.654800058896707*^9, {
   3.6548001027328*^9, 3.654800173381201*^9}, {3.654800206111162*^9, 
   3.654800346038969*^9}, {3.654800415767541*^9, 3.654800685527397*^9}, {
   3.654800717895743*^9, 3.6548007259529123`*^9}, {3.6548007560240192`*^9, 
   3.654800892868227*^9}, {3.654800961067473*^9, 3.6548010443125353`*^9}, {
   3.654801144205307*^9, 3.6548013970409203`*^9}, {3.654801447723054*^9, 
   3.6548014700938597`*^9}, {3.654801562889327*^9, 3.6548017505389137`*^9}, {
   3.6548017965315866`*^9, 3.654801838591158*^9}, {3.654801925163512*^9, 
   3.654801957336872*^9}, {3.654802037838778*^9, 3.654802097667626*^9}, {
   3.6548021338675137`*^9, 3.654802151746142*^9}, {3.6548021938035927`*^9, 
   3.65480226557542*^9}, {3.6548023434469347`*^9, 3.6548024564595747`*^9}, {
   3.654802493167995*^9, 3.654802498462143*^9}, {3.654802632969117*^9, 
   3.654802636326886*^9}, {3.6548026864101667`*^9, 3.6548027624957323`*^9}, {
   3.654802812209731*^9, 3.6548030159498*^9}, {3.6548066359524317`*^9, 
   3.654806720935005*^9}, {3.654806751992766*^9, 3.6548067587144833`*^9}, {
   3.654806821497799*^9, 3.654806889382121*^9}, {3.654807006283039*^9, 
   3.654807210369132*^9}, {3.654807340425975*^9, 3.6548074184588003`*^9}, {
   3.6548074913193197`*^9, 3.654807699931301*^9}, 3.6548078200861998`*^9, {
   3.654807890939335*^9, 3.65480791502777*^9}, {3.654807960842239*^9, 
   3.6548080712336483`*^9}, {3.654808128338978*^9, 3.6548081799548407`*^9}, {
   3.6548101758929577`*^9, 3.654810330104765*^9}, {3.654810401423953*^9, 
   3.654810408457419*^9}, {3.6548104718702717`*^9, 3.6548106690676603`*^9}, {
   3.6548107121438303`*^9, 3.6548108463298893`*^9}, {3.654810878513033*^9, 
   3.6548109250220337`*^9}, {3.654810973064028*^9, 3.6548109963255377`*^9}, {
   3.654811065383171*^9, 3.65481111435124*^9}, {3.6548111568410273`*^9, 
   3.654811165569319*^9}, {3.654811202562601*^9, 3.654811649746052*^9}, {
   3.657067656153129*^9, 3.657067660941557*^9}, {3.6570766750689*^9, 
   3.657076677028944*^9}, {3.658274451899232*^9, 3.6582744912918463`*^9}, {
   3.6583703518545094`*^9, 3.65837035300604*^9}, {3.6767384630832443`*^9, 
   3.6767384852301083`*^9}, {3.676738544986739*^9, 3.676738607109634*^9}, {
   3.676739097041395*^9, 3.676739116485881*^9}, {3.6767393261296473`*^9, 
   3.676739361702149*^9}, {3.6767396930954237`*^9, 3.676739694812849*^9}, 
   3.676739769624935*^9, {3.676739804626966*^9, 3.676739852892261*^9}, {
   3.676741390075983*^9, 3.676741723511598*^9}, 3.6774898932912083`*^9, 
   3.678096448832265*^9, 3.691191530784236*^9, {3.691191616929163*^9, 
   3.6911916893663063`*^9}, {3.691191734550891*^9, 3.691191924737769*^9}, {
   3.691193832070862*^9, 3.691193855746216*^9}, {3.691194328297244*^9, 
   3.6911943322294693`*^9}, {3.692478748282506*^9, 3.692478847255167*^9}, 
   3.692486566709695*^9, {3.6931540553652344`*^9, 
   3.6931540619016457`*^9}},ExpressionUUID->"8eab3c39-2044-482c-9bc9-\
f59721338bd9"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"CartesianTrajectory", "[", 
      RowBox[{
      "Xstart_", ",", "Xend_", ",", "Tf_", ",", "N_", ",", "method_"}], "]"}],
      ":", "\[IndentingNewLine]", "   ", 
     RowBox[{"Takes", " ", "Xstart"}], ":", " ", 
     RowBox[{
      RowBox[{"The", " ", "initial", " ", "end"}], "-", 
      RowBox[{"effector", " ", "configuration"}]}]}], ",", 
    RowBox[{"Xend", ":", 
     RowBox[{
      RowBox[{"The", " ", "final", " ", "end"}], "-", 
      RowBox[{"effector", " ", "configuration"}]}]}], ",", 
    RowBox[{"Tf", ":", 
     RowBox[{
     "Total", " ", "time", " ", "of", " ", "the", " ", "motion", " ", "in", 
      " ", "seconds", " ", "from", " ", "rest", " ", "to", " ", "rest"}]}], 
    ",", " ", "\[IndentingNewLine]", "          ", 
    RowBox[{"N", ":", 
     RowBox[{
      RowBox[{"The", " ", "number", " ", "of", " ", "points", " ", "N"}], ">", 
      RowBox[{"1", " ", 
       RowBox[{"(", 
        RowBox[{"Start", " ", "and", " ", "stop"}], ")"}], " ", "in", " ", 
       "the", " ", "discrete", " ", "representation", " ", "of", " ", "the", 
       " ", "trajectory"}]}]}], ",", "\[IndentingNewLine]", "          ", 
    RowBox[{"method", ":", 
     RowBox[{
      RowBox[{"The", " ", "time"}], "-", 
      RowBox[{"scaling", " ", "method"}]}]}], ",", 
    RowBox[{"where", " ", "3", " ", "indicates", " ", "cubic", " ", 
     RowBox[{"(", 
      RowBox[{"third", "-", 
       RowBox[{"order", " ", "polynomial"}]}], ")"}], " ", "time", " ", 
     "scaling", " ", "and", " ", "5", " ", "indicates", " ", "quintic", " ", 
     RowBox[{"(", 
      RowBox[{"fifth", "-", 
       RowBox[{"order", " ", "polynomial"}]}], ")"}], " ", "time", " ", 
     RowBox[{"scaling", ".", "\[IndentingNewLine]", "  ", "Returns"}], " ", 
     RowBox[{"traj", ":", " ", 
      RowBox[{
      "The", " ", "discretized", " ", "trajectory", " ", "as", " ", "a", " ", 
       "list", " ", "of", " ", "N", " ", "matrices", " ", "in", " ", "SE", 
       RowBox[{"(", "3", ")"}], " ", "separated", " ", "in", " ", "time", " ",
        "by", " ", 
       RowBox[{"Tf", "/", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"N", "-", "1"}], ")"}], ".", "The"}]}], " ", "first", " ", 
       "in", " ", "the", " ", "list", " ", "is", " ", "Xstart", " ", "and", 
       " ", "the", " ", "Nth", " ", "is", " ", 
       RowBox[{"Xend", ".", " ", "\[IndentingNewLine]", "This"}], " ", 
       "function", " ", "is", " ", "similar", " ", "to", " ", 
       "ScrewTrajectory"}]}]}], ",", 
    RowBox[{
     RowBox[{
     "except", " ", "the", " ", "origin", " ", "of", " ", "the", " ", "end"}],
      "-", 
     RowBox[{
     "effector", " ", "frame", " ", "follows", " ", "a", " ", "straight", " ",
       "line"}]}], ",", 
    RowBox[{
     RowBox[{"decoupled", " ", "from", " ", "the", " ", "rotational", " ", 
      RowBox[{"motion", "."}]}], "\[IndentingNewLine]", ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Example", ":", "\[IndentingNewLine]", "Input", ":", 
       "\[IndentingNewLine]", "Xstart"}], "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\n", "  ", 
     RowBox[{"Xend", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "4.1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\n", "  ", 
     RowBox[{"Tf", "=", "5"}], ";", "\n", "  ", 
     RowBox[{"Np", "=", "4"}], ";", "\n", "  ", 
     RowBox[{"method", "=", "5"}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"traj", " ", "=", " ", 
      RowBox[{"CartesianTrajectory", "[", 
       RowBox[{"Xstart", ",", "Xend", ",", "Tf", ",", "Np", ",", "method"}], 
       "]"}]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"traj", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "//", "MatrixForm"}], "//", 
            RowBox[{"N", "\[IndentingNewLine]", 
             RowBox[{"traj", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}]}], "//", "MatrixForm"}], "//", 
          RowBox[{"N", "\[IndentingNewLine]", 
           RowBox[{"traj", "[", 
            RowBox[{"[", "3", "]"}], "]"}]}]}], "//", "MatrixForm"}], "//", 
        RowBox[{"N", "\[IndentingNewLine]", 
         RowBox[{"traj", "[", 
          RowBox[{"[", "4", "]"}], "]"}]}]}], "//", "MatrixForm"}], "//", 
      RowBox[{"N", "\[IndentingNewLine]", 
       RowBox[{"Output", ":", "\[IndentingNewLine]", 
        RowBox[{
         TagBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"1.", "0.", "0.", "1."},
             {"0.", "1.", "0.", "0."},
             {"0.", "0.", "1.", "1."},
             {"0.", "0.", "0.", "1."}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
          Function[BoxForm`e$, 
           MatrixForm[BoxForm`e$]]], "\n", 
         TagBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"0.937", 
              RowBox[{"-", "0.214"}], "0.277", "0.811"},
             {"0.277", "0.937", 
              RowBox[{"-", "0.214"}], "0."},
             {
              RowBox[{"-", "0.214"}], "0.277", "0.937", "1.651"},
             {"0.`", "0.", "0.", "1."}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
          Function[BoxForm`e$, 
           MatrixForm[BoxForm`e$]]], "\n", 
         TagBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"0.277", 
              RowBox[{"-", "0.214"}], "0.937", "0.289"},
             {"0.937", "0.277", 
              RowBox[{"-", "0.214"}], "0."},
             {
              RowBox[{"-", "0.214"}], "0.937", "0.277", "3.449"},
             {"0.", "0.", "0.", "1."}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
          Function[BoxForm`e$, 
           MatrixForm[BoxForm`e$]]], "\n", 
         TagBox[
          RowBox[{"(", "\[NoBreak]", GridBox[{
             {"0.", "0.", "1.", "0.1"},
             {"1.", "0.", "0.", "0."},
             {"0.", "1.", "0.", "4.1"},
             {"0.", "0.", "0.", "1."}
            },
            
            GridBoxAlignment->{
             "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, 
              "Rows" -> {{Baseline}}, "RowsIndexed" -> {}},
            GridBoxSpacings->{"Columns" -> {
                Offset[0.27999999999999997`], {
                 Offset[0.7]}, 
                Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
                Offset[0.2], {
                 Offset[0.4]}, 
                Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
          Function[BoxForm`e$, 
           MatrixForm[BoxForm`e$]]]}]}]}]}]}]}], "\[IndentingNewLine]", 
   "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"CartesianTrajectory", "[", 
     RowBox[{"Xstart_", ",", "Xend_", ",", "Tf_", ",", "N_", ",", "method_"}],
      "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"timegap", "=", 
         RowBox[{"Tf", "/", 
          RowBox[{"(", 
           RowBox[{"N", "-", "1"}], ")"}]}]}], ",", 
        RowBox[{"traj", "=", 
         RowBox[{"ConstantArray", "[", 
          RowBox[{"Null", ",", "N"}], "]"}]}], ",", "s", ",", "Rstart", ",", 
        "pstart", ",", "Rend", ",", "pend"}], "}"}], ",", 
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Rstart", ",", "pstart"}], "}"}], "=", 
        RowBox[{"TransToRp", "[", "Xstart", "]"}]}], ";", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Rend", ",", "pend"}], "}"}], "=", 
        RowBox[{"TransToRp", "[", "Xend", "]"}]}], ";", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"method", " ", "\[Equal]", " ", "3"}], ",", 
            RowBox[{"s", "=", 
             RowBox[{"CubicTimeScaling", "[", 
              RowBox[{"Tf", ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"i", "-", "1"}], ")"}], "*", "timegap"}]}], "]"}]}], 
            ",", 
            RowBox[{"s", "=", " ", 
             RowBox[{"QuinticTimeScaling", "[", 
              RowBox[{"Tf", ",", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"i", "-", "1"}], ")"}], "*", "timegap"}]}], 
              "]"}]}]}], "]"}], ";", 
          RowBox[{
           RowBox[{"traj", "[", 
            RowBox[{"[", "i", "]"}], "]"}], "=", 
           RowBox[{"ArrayFlatten", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{
                RowBox[{"Rstart", ".", 
                 RowBox[{"MatrixExp3", "[", 
                  RowBox[{
                   RowBox[{"MatrixLog3", "[", 
                    RowBox[{
                    RowBox[{"Rstart", "\[Transpose]"}], ".", "Rend"}], "]"}], 
                   "*", "s"}], "]"}]}], ",", 
                RowBox[{"pstart", "+", 
                 RowBox[{"s", "*", 
                  RowBox[{"(", 
                   RowBox[{"pend", "-", "pstart"}], ")"}]}]}]}], "}"}], ",", 
              RowBox[{"{", 
               RowBox[{"0", ",", "1"}], "}"}]}], "}"}], "]"}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "N"}], "}"}]}], "]"}], ";", 
       RowBox[{"Return", "[", "traj", "]"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.654107438701495*^9, 3.6541075770931664`*^9}, {
   3.6541076103152647`*^9, 3.654107726674172*^9}, {3.654107800327899*^9, 
   3.654107805926005*^9}, {3.654107842157054*^9, 3.654107956534466*^9}, {
   3.6541080276373253`*^9, 3.654108039845397*^9}, {3.654108208328875*^9, 
   3.654108267778264*^9}, {3.654108316603101*^9, 3.65410832858707*^9}, {
   3.654122072990996*^9, 3.654122200142358*^9}, {3.654122232524707*^9, 
   3.6541222637488813`*^9}, {3.654122372486209*^9, 3.65412253592478*^9}, {
   3.654122571686759*^9, 3.654122685636675*^9}, {3.654122740902017*^9, 
   3.6541228215630703`*^9}, {3.654122865671712*^9, 3.654122935620612*^9}, {
   3.654123032181581*^9, 3.6541230914473333`*^9}, {3.654123152783122*^9, 
   3.6541232043612537`*^9}, {3.654123304611115*^9, 3.654123341073502*^9}, {
   3.654123502235703*^9, 3.654123578362132*^9}, {3.654123664279245*^9, 
   3.654123683195951*^9}, {3.6541237878998413`*^9, 3.6541238249788847`*^9}, {
   3.654123940392714*^9, 3.654123947510108*^9}, {3.654124026309593*^9, 
   3.654124026885428*^9}, 3.6541241152729683`*^9, 3.654124170343902*^9, {
   3.6541246995439568`*^9, 3.654124712871656*^9}, {3.6541251843297157`*^9, 
   3.654125231518578*^9}, {3.6541254856851683`*^9, 3.65412548908077*^9}, {
   3.654125547742125*^9, 3.654125551165526*^9}, {3.654125930807577*^9, 
   3.654126007244483*^9}, {3.654126127665163*^9, 3.654126191634789*^9}, {
   3.654126236482831*^9, 3.654126250153975*^9}, {3.6541262848658533`*^9, 
   3.654126288991514*^9}, {3.654126323055903*^9, 3.654126399729628*^9}, {
   3.654126435349374*^9, 3.654126447266036*^9}, {3.654126530077552*^9, 
   3.6541265937421*^9}, {3.654126679867402*^9, 3.6541267650289497`*^9}, {
   3.6541267969631968`*^9, 3.654126798410089*^9}, {3.654126829860013*^9, 
   3.654126881359337*^9}, {3.6541269393824577`*^9, 3.654126959132009*^9}, {
   3.654127079773924*^9, 3.654127194954756*^9}, {3.654127229244482*^9, 
   3.654127253953713*^9}, {3.6541278694900227`*^9, 3.654127878663176*^9}, {
   3.654127969775614*^9, 3.6541279938293123`*^9}, {3.654128051763153*^9, 
   3.654128134016169*^9}, {3.654128326830834*^9, 3.654128326972948*^9}, {
   3.654182305132535*^9, 3.654182317491791*^9}, {3.65418238746202*^9, 
   3.654182511491269*^9}, {3.654182551115921*^9, 3.654182559209998*^9}, {
   3.6541826265390177`*^9, 3.654182732425318*^9}, {3.654182795218339*^9, 
   3.654182802306821*^9}, {3.654182858360195*^9, 3.654182976637673*^9}, {
   3.65418309291822*^9, 3.6541831115452337`*^9}, {3.654183280620055*^9, 
   3.654183381285778*^9}, {3.6541834216733217`*^9, 3.65418343026462*^9}, {
   3.65418347398075*^9, 3.654183479016459*^9}, {3.654183517743698*^9, 
   3.654183590244978*^9}, {3.654183629340012*^9, 3.654183659551435*^9}, {
   3.654183828746057*^9, 3.654183869187777*^9}, {3.654183918271063*^9, 
   3.6541839184304667`*^9}, {3.654206461375032*^9, 3.6542064948942213`*^9}, {
   3.6542065261576433`*^9, 3.654206710642645*^9}, {3.65420685898112*^9, 
   3.654206859498214*^9}, {3.654206912388175*^9, 3.6542069199221067`*^9}, {
   3.654206956850091*^9, 3.654206957769821*^9}, {3.6542070885864773`*^9, 
   3.6542070905801163`*^9}, {3.6542071861274023`*^9, 3.654207197287834*^9}, {
   3.654207355631957*^9, 3.65420737546005*^9}, {3.654207422116619*^9, 
   3.6542074295958633`*^9}, {3.654207513008601*^9, 3.654207622631179*^9}, {
   3.6542077902321663`*^9, 3.6542079082040863`*^9}, {3.654208112675095*^9, 
   3.6542082406765347`*^9}, {3.654208390436673*^9, 3.654208437282127*^9}, {
   3.654208729398788*^9, 3.6542088242969923`*^9}, {3.654208875181876*^9, 
   3.6542089105814543`*^9}, {3.654209036563011*^9, 3.654209042056604*^9}, {
   3.654209131808134*^9, 3.654209211748107*^9}, {3.654277910558556*^9, 
   3.654277962902483*^9}, {3.6542785554956903`*^9, 3.654278555764879*^9}, {
   3.6542801407928543`*^9, 3.654280145647377*^9}, {3.654280336511973*^9, 
   3.654280388661951*^9}, {3.654735519742467*^9, 3.654735526212496*^9}, {
   3.654736711632904*^9, 3.654736744359725*^9}, {3.654736840726715*^9, 
   3.6547369027091503`*^9}, {3.6547369619155817`*^9, 3.65473711893006*^9}, 
   3.654737215212165*^9, {3.6547372623430433`*^9, 3.654737301717353*^9}, {
   3.654737434898181*^9, 3.654737445769989*^9}, {3.654737593349925*^9, 
   3.654737893647337*^9}, {3.654737938282483*^9, 3.654737939560112*^9}, {
   3.654737995469615*^9, 3.65473804382544*^9}, {3.65473814244207*^9, 
   3.65473826286047*^9}, {3.654738473301898*^9, 3.654738519313912*^9}, {
   3.654738551955141*^9, 3.654738559351729*^9}, {3.654738599129403*^9, 
   3.654738599566987*^9}, {3.654738653005966*^9, 3.654738704434928*^9}, {
   3.654738885183668*^9, 3.654738922018218*^9}, {3.654739011880048*^9, 
   3.65473910917871*^9}, {3.654739159170903*^9, 3.654739162120161*^9}, {
   3.6547393230277576`*^9, 3.6547393764227123`*^9}, {3.654739415181912*^9, 
   3.65473942023728*^9}, {3.654739453135948*^9, 3.654739679965816*^9}, {
   3.654739718627033*^9, 3.6547397334487553`*^9}, {3.654739765385715*^9, 
   3.654739851694334*^9}, {3.654739889466123*^9, 3.654740005071364*^9}, {
   3.6547400491757*^9, 3.654740154008595*^9}, 3.654740216700787*^9, {
   3.654740314399178*^9, 3.6547403286014967`*^9}, 3.6547403850818996`*^9, {
   3.654740521314966*^9, 3.654740541208376*^9}, {3.65474063388687*^9, 
   3.654740654515286*^9}, {3.654740701345427*^9, 3.654740810460566*^9}, {
   3.654740848239312*^9, 3.654741082783293*^9}, {3.654741274225429*^9, 
   3.65474127713437*^9}, 3.654741426789631*^9, {3.6547414571147537`*^9, 
   3.654741569824174*^9}, {3.654741604551594*^9, 3.65474161887015*^9}, {
   3.6547416933496304`*^9, 3.654741709459137*^9}, {3.654741935230948*^9, 
   3.654741945307493*^9}, {3.6547830386167917`*^9, 3.654783105454197*^9}, {
   3.6547832406606083`*^9, 3.6547832525310373`*^9}, {3.654783794511154*^9, 
   3.654783837663447*^9}, {3.65478390359721*^9, 3.654783909803577*^9}, {
   3.654783989474423*^9, 3.654784403124803*^9}, {3.654784520313846*^9, 
   3.654784622329711*^9}, {3.6547847231449842`*^9, 3.654784727983326*^9}, {
   3.654785122876478*^9, 3.654785187751635*^9}, {3.654785255283667*^9, 
   3.654785472044736*^9}, {3.654785554330287*^9, 3.6547855634367*^9}, {
   3.6547858133842907`*^9, 3.654785842420493*^9}, {3.654785988696732*^9, 
   3.654785999313698*^9}, {3.654786083383224*^9, 3.654786083827299*^9}, {
   3.654799998454865*^9, 3.654800009014682*^9}, 3.654800058896707*^9, {
   3.6548001027328*^9, 3.654800173381201*^9}, {3.654800206111162*^9, 
   3.654800346038969*^9}, {3.654800415767541*^9, 3.654800685527397*^9}, {
   3.654800717895743*^9, 3.6548007259529123`*^9}, {3.6548007560240192`*^9, 
   3.654800892868227*^9}, {3.654800961067473*^9, 3.6548010443125353`*^9}, {
   3.654801144205307*^9, 3.6548013970409203`*^9}, {3.654801447723054*^9, 
   3.6548014700938597`*^9}, {3.654801562889327*^9, 3.6548017505389137`*^9}, {
   3.6548017965315866`*^9, 3.654801838591158*^9}, {3.654801925163512*^9, 
   3.654801957336872*^9}, {3.654802037838778*^9, 3.654802097667626*^9}, {
   3.6548021338675137`*^9, 3.654802151746142*^9}, {3.6548021938035927`*^9, 
   3.65480226557542*^9}, {3.6548023434469347`*^9, 3.6548024564595747`*^9}, {
   3.654802493167995*^9, 3.654802498462143*^9}, {3.654802632969117*^9, 
   3.654802636326886*^9}, {3.6548026864101667`*^9, 3.6548027624957323`*^9}, {
   3.654802812209731*^9, 3.6548030159498*^9}, {3.6548066359524317`*^9, 
   3.654806720935005*^9}, {3.654806751992766*^9, 3.6548067587144833`*^9}, {
   3.654806821497799*^9, 3.654806889382121*^9}, {3.654807006283039*^9, 
   3.654807210369132*^9}, {3.654807340425975*^9, 3.6548074184588003`*^9}, {
   3.6548074913193197`*^9, 3.654807699931301*^9}, 3.6548078200861998`*^9, {
   3.654807890939335*^9, 3.65480791502777*^9}, {3.654807960842239*^9, 
   3.6548080712336483`*^9}, {3.654808128338978*^9, 3.6548081799548407`*^9}, {
   3.6548101758929577`*^9, 3.654810330104765*^9}, {3.654810401423953*^9, 
   3.654810408457419*^9}, {3.6548104718702717`*^9, 3.6548106690676603`*^9}, {
   3.6548107121438303`*^9, 3.6548108463298893`*^9}, {3.654810878513033*^9, 
   3.6548109250220337`*^9}, {3.654810973064028*^9, 3.6548109963255377`*^9}, {
   3.654811065383171*^9, 3.65481111435124*^9}, {3.6548111568410273`*^9, 
   3.654811165569319*^9}, {3.654811202562601*^9, 3.654811649746052*^9}, {
   3.657067656153129*^9, 3.657067660941557*^9}, {3.6570766750689*^9, 
   3.657076677028944*^9}, {3.658274451899232*^9, 3.6582744912918463`*^9}, {
   3.6583703518545094`*^9, 3.65837035300604*^9}, {3.67673963558117*^9, 
   3.6767396395269127`*^9}, {3.676743278578334*^9, 3.676743282140527*^9}, {
   3.676743329578144*^9, 3.676743332931324*^9}, {3.676743375759927*^9, 
   3.676743393331377*^9}, {3.676743579279604*^9, 3.676743610992496*^9}, {
   3.676743696815421*^9, 3.676743702063456*^9}, {3.676743797327611*^9, 
   3.676743802367258*^9}, {3.676743844436429*^9, 3.676743923034832*^9}, {
   3.676744067943886*^9, 3.676744101485681*^9}, {3.676745202969133*^9, 
   3.676745215144767*^9}, {3.676745254062787*^9, 3.676745307013712*^9}, {
   3.6767453632225313`*^9, 3.676745371103043*^9}, 3.676745427635807*^9, 
   3.676745643761804*^9, {3.6767456813682833`*^9, 3.676745685052404*^9}, {
   3.676745890112192*^9, 3.676745904905205*^9}, {3.676745949389865*^9, 
   3.676746003820777*^9}, {3.676746191330016*^9, 3.676746202180275*^9}, {
   3.6767463628997517`*^9, 3.6767463680370293`*^9}, {3.6767464041150723`*^9, 
   3.6767464065122213`*^9}, {3.676746447029583*^9, 3.676746538635809*^9}, {
   3.67674660560835*^9, 3.676746624390595*^9}, {3.676746756856359*^9, 
   3.676746788930705*^9}, {3.67674687514357*^9, 3.6767469138687143`*^9}, {
   3.676746954576331*^9, 3.67674698750915*^9}, 3.676747020885099*^9, {
   3.6767472587172203`*^9, 3.676747387781352*^9}, {3.676748382220996*^9, 
   3.676748383415188*^9}, 3.678096454219871*^9, {3.6911935162898006`*^9, 
   3.6911935321347065`*^9}, {3.69119360668097*^9, 3.6911937260087957`*^9}, {
   3.6911938706650696`*^9, 3.691194004824743*^9}, {3.6911940559916697`*^9, 
   3.691194175012477*^9}, {3.6911943422920446`*^9, 3.6911943657793884`*^9}, {
   3.692486572990054*^9, 3.692486637770759*^9}, {3.693154068375657*^9, 
   3.6931540714176626`*^9}, {3.693162708174821*^9, 3.693162708518022*^9}, 
   3.6931627959226713`*^9},ExpressionUUID->"e7f7c189-2377-47aa-8f37-\
8943a95caef1"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[StyleBox["CHAPTER  11: ROBOT CONTROL",
 FontSize->24,
 FontWeight->"Bold",
 FontColor->RGBColor[0, 0, 1]]], "Title",
 CellChangeTimes->{{3.6755319110417843`*^9, 3.675531927048277*^9}, {
  3.675531958735077*^9, 3.67553201284205*^9}, {3.675607857109823*^9, 
  3.6756079117244864`*^9}, {3.6756821024917507`*^9, 3.6756821283850946`*^9}, {
  3.6757648758196497`*^9, 3.675764892595064*^9}, {3.677861669528915*^9, 
  3.677861687077693*^9}},ExpressionUUID->"10d566a6-4644-4e65-8900-\
e5ebea810780"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"ComputedTorque", "[", 
      RowBox[{
      "thetalist_", ",", "dthetalist_", ",", "eint_", ",", "g_", ",", 
       "Mlist_", ",", "Glist_", ",", "Slist_", ",", "thetalistd_", ",", 
       "dthetalistd_", ",", "ddthetalistd_", ",", "Kp_", ",", "Ki_", ",", 
       "Kd_"}], "]"}], ":", "\[IndentingNewLine]", "  ", 
     RowBox[{"Takes", " ", "thetalist"}], ":", " ", 
     RowBox[{"n", "-", 
      RowBox[{"vector", " ", "of", " ", "joint", " ", "variables"}]}]}], ",", 
    "\[IndentingNewLine]", "         ", 
    RowBox[{"dthetalist", ":", " ", 
     RowBox[{"n", "-", 
      RowBox[{"vector", " ", "of", " ", "joint", " ", "rates"}]}]}], ",", 
    "\[IndentingNewLine]", "         ", 
    RowBox[{"eint", ":", " ", 
     RowBox[{"n", "-", 
      RowBox[{"vector", " ", "of", " ", "the", " ", "time"}], "-", 
      RowBox[{"integral", " ", "of", " ", "joint", " ", "errors"}]}]}], ",", 
    "\[IndentingNewLine]", "         ", 
    RowBox[{"g", ":", " ", 
     RowBox[{"Gravity", " ", "vector", " ", "g"}]}], ",", 
    "\[IndentingNewLine]", "         ", 
    RowBox[{"Mlist", ":", " ", 
     RowBox[{"List", " ", "of", " ", "link", " ", "frames", " ", 
      RowBox[{"{", "i", "}"}], " ", "relative", " ", "to", " ", 
      RowBox[{"{", 
       RowBox[{"i", "-", "1"}], "}"}], " ", "at", " ", "the", " ", "home", 
      " ", "position"}]}], ",", "\[IndentingNewLine]", "         ", 
    RowBox[{"Glist", ":", " ", 
     RowBox[{
     "Spatial", " ", "inertia", " ", "matrices", " ", "Gi", " ", "of", " ", 
      "the", " ", "links"}]}], ",", "\[IndentingNewLine]", "         ", 
    RowBox[{"Slist", ":", " ", 
     RowBox[{
     "Screw", " ", "axes", " ", "Si", " ", "of", " ", "the", " ", "joints", 
      " ", "in", " ", "a", " ", "space", " ", "frame"}]}], ",", " ", 
    RowBox[{
    "in", " ", "the", " ", "format", " ", "of", " ", "a", " ", "matrix", " ", 
     "with", " ", "axes", " ", "as", " ", "the", " ", "columns"}], ",", 
    "\[IndentingNewLine]", "         ", 
    RowBox[{"thetalistd", ":", " ", 
     RowBox[{"n", "-", 
      RowBox[{
      "vector", " ", "of", " ", "reference", " ", "joint", " ", 
       "variables"}]}]}], ",", "\[IndentingNewLine]", "         ", 
    RowBox[{"dthetalistd", ":", " ", 
     RowBox[{"n", "-", 
      RowBox[{
      "vector", " ", "of", " ", "reference", " ", "joint", " ", 
       "velocities"}]}]}], ",", "\[IndentingNewLine]", "         ", 
    RowBox[{"ddthetalistd", ":", " ", 
     RowBox[{"n", "-", 
      RowBox[{
      "vector", " ", "of", " ", "reference", " ", "joint", " ", 
       "accelerations"}]}]}], ",", "\[IndentingNewLine]", "         ", 
    RowBox[{"Kp", ":", " ", 
     RowBox[{"The", " ", "feedback", " ", "proportional", " ", "gain", " ", 
      RowBox[{"(", 
       RowBox[{"identical", " ", "for", " ", "each", " ", "joint"}], 
       ")"}]}]}], ",", "\[IndentingNewLine]", "         ", 
    RowBox[{"Ki", ":", " ", 
     RowBox[{"The", " ", "feedback", " ", "integral", " ", "gain", " ", 
      RowBox[{"(", 
       RowBox[{"identical", " ", "for", " ", "each", " ", "joint"}], 
       ")"}]}]}], ",", "\[IndentingNewLine]", "         ", 
    RowBox[{
     RowBox[{"Kd", ":", " ", 
      RowBox[{"The", " ", "feedback", " ", "derivative", " ", "gain", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"identical", " ", "for", " ", "each", " ", "joint"}], ")"}], 
        ".", "\[IndentingNewLine]", "Returns"}], " ", "taulist"}], ":", " ", 
      RowBox[{"The", " ", "vector", " ", "of", " ", "joint", " ", 
       RowBox[{"forces", "/", "torques"}], " ", "computed", " ", "by", " ", 
       "the", " ", "feedback", " ", "linearizing", " ", "controller", " ", 
       "at", " ", "the", " ", "current", " ", 
       RowBox[{"instant", "."}]}]}], "\[IndentingNewLine]", ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Exapmle", ":", "\[IndentingNewLine]", "Input", ":", 
       "\[IndentingNewLine]", "thetalist"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0.1", ",", "0.1", ",", "0.1"}], "}"}], "}"}], 
       "\[Transpose]"}]}], ";", "\n", "  ", 
     RowBox[{"dthetalist", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0.1", ",", "0.2", ",", "0.3"}], "}"}], "}"}], 
       "\[Transpose]"}]}], ";", "\n", "  ", 
     RowBox[{"eint", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0.2", ",", "0.2", ",", "0.2"}], "}"}], "}"}], 
       "\[Transpose]"}]}], ";", "\n", "  ", 
     RowBox[{"g", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", 
          RowBox[{"-", "9.8"}]}], "}"}], "}"}], "\[Transpose]"}]}], ";", "\n",
      "  ", 
     RowBox[{"M01", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.089159"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"M12", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.28"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0.13585"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"M23", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", 
          RowBox[{"-", "0.1197"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.395"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"M34", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.14225"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"G1", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
        "0.010267", ",", "0.010267", ",", "0.00666", ",", "3.7", ",", "3.7", 
         ",", "3.7"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"G2", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
        "0.22689", ",", "0.22689", ",", "0.0151074", ",", "8.393", ",", 
         "8.393", ",", "8.393"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "  ", 
     RowBox[{"G3", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
        "0.0494433", ",", "0.0494433", ",", "0.004095", ",", "2.275", ",", 
         "2.275", ",", "2.275"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "  ", 
     RowBox[{"Glist", "=", 
      RowBox[{"{", 
       RowBox[{"G1", ",", "G2", ",", "G3"}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"Mlist", "=", 
      RowBox[{"{", 
       RowBox[{"M01", ",", "M12", ",", "M23", ",", "M34"}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"Slist", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", 
           RowBox[{"-", "0.089"}], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", 
           RowBox[{"-", "0.089"}], ",", "0", ",", "0.425"}], "}"}]}], "}"}], 
       "\[Transpose]"}]}], ";", "\n", "  ", 
     RowBox[{"thetalistd", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"1", ",", "1", ",", "1"}], "}"}], "}"}], "\[Transpose]"}]}], 
     ";", "\n", "  ", 
     RowBox[{"dthetalistd", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"2", ",", "1.2", ",", "2"}], "}"}], "}"}], 
       "\[Transpose]"}]}], ";", "\n", "  ", 
     RowBox[{"ddthetalistd", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0.1", ",", "0.1", ",", "0.1"}], "}"}], "}"}], 
       "\[Transpose]"}]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"Kp", "=", "1.3"}], ";", "\n", "  ", 
     RowBox[{"Ki", "=", "1.2"}], ";", "\n", "  ", 
     RowBox[{"Kd", "=", "1.1"}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"taulist", " ", "=", " ", 
      RowBox[{
       RowBox[{"ComputedTorque", "[", 
        RowBox[{
        "thetalist", ",", "dthetalist", ",", "eint", ",", "g", ",", "Mlist", 
         ",", "Glist", ",", "Slist", ",", "thetalistd", ",", "dthetalistd", 
         ",", "ddthetalistd", ",", "Kp", ",", "Ki", ",", "Kd"}], "]"}], 
       "\[IndentingNewLine]", 
       RowBox[{"Ouput", ":", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", "133.0052524649953", "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"-", "29.942233243760633"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"-", "3.0327685616172406"}], "}"}]}], "}"}]}]}]}]}]}], 
   "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"ComputedTorque", "[", 
     RowBox[{
     "thetalist_", ",", "dthetalist_", ",", "eint_", ",", "g_", ",", "Mlist_",
       ",", "Glist_", ",", "Slist_", ",", "thetalistd_", ",", "dthetalistd_", 
      ",", "ddthetalistd_", ",", "Kp_", ",", "Ki_", ",", "Kd_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"e", "=", 
        RowBox[{"thetalistd", "-", "thetalist"}]}], "}"}], ",", 
      RowBox[{"Return", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"MassMatrix", "[", 
          RowBox[{"thetalist", ",", "Mlist", ",", "Glist", ",", "Slist"}], 
          "]"}], ".", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Kp", "*", "e"}], "+", 
           RowBox[{"Ki", "*", 
            RowBox[{"(", 
             RowBox[{"eint", "+", "e"}], ")"}]}], "+", 
           RowBox[{"Kd", "*", 
            RowBox[{"(", 
             RowBox[{"dthetalistd", "-", "dthetalist"}], ")"}]}]}], ")"}]}], 
        "+", 
        RowBox[{"InverseDynamics", "[", 
         RowBox[{
         "thetalist", ",", "dthetalist", ",", "ddthetalistd", ",", "g", ",", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"{", 
             RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
             "}"}], "}"}], "\[Transpose]"}], ",", "Mlist", ",", "Glist", ",", 
          "Slist"}], "]"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.654107438701495*^9, 3.6541075770931664`*^9}, {
   3.6541076103152647`*^9, 3.654107726674172*^9}, {3.654107800327899*^9, 
   3.654107805926005*^9}, {3.654107842157054*^9, 3.654107956534466*^9}, {
   3.6541080276373253`*^9, 3.654108039845397*^9}, {3.654108208328875*^9, 
   3.654108267778264*^9}, {3.654108316603101*^9, 3.65410832858707*^9}, {
   3.654122072990996*^9, 3.654122200142358*^9}, {3.654122232524707*^9, 
   3.6541222637488813`*^9}, {3.654122372486209*^9, 3.65412253592478*^9}, {
   3.654122571686759*^9, 3.654122685636675*^9}, {3.654122740902017*^9, 
   3.6541228215630703`*^9}, {3.654122865671712*^9, 3.654122935620612*^9}, {
   3.654123032181581*^9, 3.6541230914473333`*^9}, {3.654123152783122*^9, 
   3.6541232043612537`*^9}, {3.654123304611115*^9, 3.654123341073502*^9}, {
   3.654123502235703*^9, 3.654123578362132*^9}, {3.654123664279245*^9, 
   3.654123683195951*^9}, {3.6541237878998413`*^9, 3.6541238249788847`*^9}, {
   3.654123940392714*^9, 3.654123947510108*^9}, {3.654124026309593*^9, 
   3.654124026885428*^9}, 3.6541241152729683`*^9, 3.654124170343902*^9, {
   3.6541246995439568`*^9, 3.654124712871656*^9}, {3.6541251843297157`*^9, 
   3.654125231518578*^9}, {3.6541254856851683`*^9, 3.65412548908077*^9}, {
   3.654125547742125*^9, 3.654125551165526*^9}, {3.654125930807577*^9, 
   3.654126007244483*^9}, {3.654126127665163*^9, 3.654126191634789*^9}, {
   3.654126236482831*^9, 3.654126250153975*^9}, {3.6541262848658533`*^9, 
   3.654126288991514*^9}, {3.654126323055903*^9, 3.654126399729628*^9}, {
   3.654126435349374*^9, 3.654126447266036*^9}, {3.654126530077552*^9, 
   3.6541265937421*^9}, {3.654126679867402*^9, 3.6541267650289497`*^9}, {
   3.6541267969631968`*^9, 3.654126798410089*^9}, {3.654126829860013*^9, 
   3.654126881359337*^9}, {3.6541269393824577`*^9, 3.654126959132009*^9}, {
   3.654127079773924*^9, 3.654127194954756*^9}, {3.654127229244482*^9, 
   3.654127253953713*^9}, {3.6541278694900227`*^9, 3.654127878663176*^9}, {
   3.654127969775614*^9, 3.6541279938293123`*^9}, {3.654128051763153*^9, 
   3.654128134016169*^9}, {3.654128326830834*^9, 3.654128326972948*^9}, {
   3.654182305132535*^9, 3.654182317491791*^9}, {3.65418238746202*^9, 
   3.654182511491269*^9}, {3.654182551115921*^9, 3.654182559209998*^9}, {
   3.6541826265390177`*^9, 3.654182732425318*^9}, {3.654182795218339*^9, 
   3.654182802306821*^9}, {3.654182858360195*^9, 3.654182976637673*^9}, {
   3.65418309291822*^9, 3.6541831115452337`*^9}, {3.654183280620055*^9, 
   3.654183381285778*^9}, {3.6541834216733217`*^9, 3.65418343026462*^9}, {
   3.65418347398075*^9, 3.654183479016459*^9}, {3.654183517743698*^9, 
   3.654183590244978*^9}, {3.654183629340012*^9, 3.654183659551435*^9}, {
   3.654183828746057*^9, 3.654183869187777*^9}, {3.654183918271063*^9, 
   3.6541839184304667`*^9}, {3.654206461375032*^9, 3.6542064948942213`*^9}, {
   3.6542065261576433`*^9, 3.654206710642645*^9}, {3.65420685898112*^9, 
   3.654206859498214*^9}, {3.654206912388175*^9, 3.6542069199221067`*^9}, {
   3.654206956850091*^9, 3.654206957769821*^9}, {3.6542070885864773`*^9, 
   3.6542070905801163`*^9}, {3.6542071861274023`*^9, 3.654207197287834*^9}, {
   3.654207355631957*^9, 3.65420737546005*^9}, {3.654207422116619*^9, 
   3.6542074295958633`*^9}, {3.654207513008601*^9, 3.654207622631179*^9}, {
   3.6542077902321663`*^9, 3.6542079082040863`*^9}, {3.654208112675095*^9, 
   3.6542082406765347`*^9}, {3.654208390436673*^9, 3.654208437282127*^9}, {
   3.654208729398788*^9, 3.6542088242969923`*^9}, {3.654208875181876*^9, 
   3.6542089105814543`*^9}, {3.654209036563011*^9, 3.654209042056604*^9}, {
   3.654209131808134*^9, 3.654209211748107*^9}, {3.654277910558556*^9, 
   3.654277962902483*^9}, {3.6542785554956903`*^9, 3.654278555764879*^9}, {
   3.6542801407928543`*^9, 3.654280145647377*^9}, {3.654280336511973*^9, 
   3.654280388661951*^9}, {3.654735519742467*^9, 3.654735526212496*^9}, {
   3.654736711632904*^9, 3.654736744359725*^9}, {3.654736840726715*^9, 
   3.6547369027091503`*^9}, {3.6547369619155817`*^9, 3.65473711893006*^9}, 
   3.654737215212165*^9, {3.6547372623430433`*^9, 3.654737301717353*^9}, {
   3.654737434898181*^9, 3.654737445769989*^9}, {3.654737593349925*^9, 
   3.654737893647337*^9}, {3.654737938282483*^9, 3.654737939560112*^9}, {
   3.654737995469615*^9, 3.65473804382544*^9}, {3.65473814244207*^9, 
   3.65473826286047*^9}, {3.654738473301898*^9, 3.654738519313912*^9}, {
   3.654738551955141*^9, 3.654738559351729*^9}, {3.654738599129403*^9, 
   3.654738599566987*^9}, {3.654738653005966*^9, 3.654738704434928*^9}, {
   3.654738885183668*^9, 3.654738922018218*^9}, {3.654739011880048*^9, 
   3.65473910917871*^9}, {3.654739159170903*^9, 3.654739162120161*^9}, {
   3.6547393230277576`*^9, 3.6547393764227123`*^9}, {3.654739415181912*^9, 
   3.65473942023728*^9}, {3.654739453135948*^9, 3.654739679965816*^9}, {
   3.654739718627033*^9, 3.6547397334487553`*^9}, {3.654739765385715*^9, 
   3.654739851694334*^9}, {3.654739889466123*^9, 3.654740005071364*^9}, {
   3.6547400491757*^9, 3.654740154008595*^9}, 3.654740216700787*^9, {
   3.654740314399178*^9, 3.6547403286014967`*^9}, 3.6547403850818996`*^9, {
   3.654740521314966*^9, 3.654740541208376*^9}, {3.65474063388687*^9, 
   3.654740654515286*^9}, {3.654740701345427*^9, 3.654740810460566*^9}, {
   3.654740848239312*^9, 3.654741082783293*^9}, {3.654741274225429*^9, 
   3.65474127713437*^9}, 3.654741426789631*^9, {3.6547414571147537`*^9, 
   3.654741569824174*^9}, {3.654741604551594*^9, 3.65474161887015*^9}, {
   3.6547416933496304`*^9, 3.654741709459137*^9}, {3.654741935230948*^9, 
   3.654741945307493*^9}, {3.6547830386167917`*^9, 3.654783105454197*^9}, {
   3.6547832406606083`*^9, 3.6547832525310373`*^9}, {3.654783794511154*^9, 
   3.654783837663447*^9}, {3.65478390359721*^9, 3.654783909803577*^9}, {
   3.654783989474423*^9, 3.654784403124803*^9}, {3.654784520313846*^9, 
   3.654784622329711*^9}, {3.6547847231449842`*^9, 3.654784727983326*^9}, {
   3.654785122876478*^9, 3.654785187751635*^9}, {3.654785255283667*^9, 
   3.654785472044736*^9}, {3.654785554330287*^9, 3.6547855634367*^9}, {
   3.6547858133842907`*^9, 3.654785842420493*^9}, {3.654785988696732*^9, 
   3.654785999313698*^9}, {3.654786083383224*^9, 3.654786083827299*^9}, {
   3.654799998454865*^9, 3.654800009014682*^9}, 3.654800058896707*^9, {
   3.6548001027328*^9, 3.654800173381201*^9}, {3.654800206111162*^9, 
   3.654800346038969*^9}, {3.654800415767541*^9, 3.654800685527397*^9}, {
   3.654800717895743*^9, 3.6548007259529123`*^9}, {3.6548007560240192`*^9, 
   3.654800892868227*^9}, {3.654800961067473*^9, 3.6548010443125353`*^9}, {
   3.654801144205307*^9, 3.6548013970409203`*^9}, {3.654801447723054*^9, 
   3.6548014700938597`*^9}, {3.654801562889327*^9, 3.6548017505389137`*^9}, {
   3.6548017965315866`*^9, 3.654801838591158*^9}, {3.654801925163512*^9, 
   3.654801957336872*^9}, {3.654802037838778*^9, 3.654802097667626*^9}, {
   3.6548021338675137`*^9, 3.654802151746142*^9}, {3.6548021938035927`*^9, 
   3.65480226557542*^9}, {3.6548023434469347`*^9, 3.6548024564595747`*^9}, {
   3.654802493167995*^9, 3.654802498462143*^9}, {3.654802632969117*^9, 
   3.654802636326886*^9}, {3.6548026864101667`*^9, 3.6548027624957323`*^9}, {
   3.654802812209731*^9, 3.6548030159498*^9}, {3.6548066359524317`*^9, 
   3.654806720935005*^9}, {3.654806751992766*^9, 3.6548067587144833`*^9}, {
   3.654806821497799*^9, 3.654806889382121*^9}, {3.654807006283039*^9, 
   3.654807210369132*^9}, {3.654807340425975*^9, 3.6548074184588003`*^9}, {
   3.6548074913193197`*^9, 3.654807699931301*^9}, 3.6548078200861998`*^9, {
   3.654807890939335*^9, 3.65480791502777*^9}, {3.654807960842239*^9, 
   3.6548080712336483`*^9}, {3.654808128338978*^9, 3.6548081799548407`*^9}, {
   3.6548101758929577`*^9, 3.654810330104765*^9}, {3.654810401423953*^9, 
   3.654810408457419*^9}, {3.6548104718702717`*^9, 3.6548106690676603`*^9}, {
   3.6548107121438303`*^9, 3.6548108463298893`*^9}, {3.654810878513033*^9, 
   3.6548109250220337`*^9}, {3.654810973064028*^9, 3.6548109963255377`*^9}, {
   3.654811065383171*^9, 3.65481111435124*^9}, {3.6548111568410273`*^9, 
   3.654811165569319*^9}, {3.654811202562601*^9, 3.654811649746052*^9}, {
   3.657067656153129*^9, 3.657067660941557*^9}, {3.6570766750689*^9, 
   3.657076677028944*^9}, {3.658274451899232*^9, 3.6582744912918463`*^9}, {
   3.6583703518545094`*^9, 3.65837035300604*^9}, {3.675682824450754*^9, 
   3.6756828836706333`*^9}, {3.6756829858535852`*^9, 3.675683093476144*^9}, {
   3.675683163431617*^9, 3.675683301926485*^9}, {3.6756834458193197`*^9, 
   3.675683520674423*^9}, {3.675683569012762*^9, 3.675683584065415*^9}, 
   3.675683635500771*^9, {3.675684508273862*^9, 3.675684520687911*^9}, {
   3.675764977565001*^9, 3.675764979617189*^9}, {3.6757662451157312`*^9, 
   3.675766254498831*^9}, {3.675766317871736*^9, 3.675766345394107*^9}, {
   3.6757664078898573`*^9, 3.675766419041957*^9}, {3.6757665260531073`*^9, 
   3.6757665599652433`*^9}, {3.675766688881428*^9, 3.675766693414764*^9}, {
   3.675766760364307*^9, 3.675766898736827*^9}, {3.675766931380547*^9, 
   3.675766932915333*^9}, 3.675767022524777*^9, 3.675767053903921*^9, {
   3.675767094663486*^9, 3.675767157353602*^9}, {3.6757672038039017`*^9, 
   3.67576720815028*^9}, {3.675767263478516*^9, 3.675767302851701*^9}, {
   3.6757673469407463`*^9, 3.6757675158730087`*^9}, {3.675767609117689*^9, 
   3.6757676149377613`*^9}, 3.676110621848937*^9, {3.676110673192341*^9, 
   3.676110708132433*^9}, {3.676110758266004*^9, 3.676110779724792*^9}, {
   3.676110837502541*^9, 3.676110924302658*^9}, {3.676111015370205*^9, 
   3.676111023652515*^9}, {3.676111616884136*^9, 3.676111619101164*^9}, {
   3.67611165132108*^9, 3.67611182175666*^9}, 3.6761124388093357`*^9, {
   3.6761125310577183`*^9, 3.676112535417371*^9}, {3.67611278534865*^9, 
   3.676112852293083*^9}, {3.6761129469420633`*^9, 3.6761129566090517`*^9}, {
   3.6761133261675377`*^9, 3.6761133851728067`*^9}, {3.6761134570078707`*^9, 
   3.6761134886549597`*^9}, {3.676113519585043*^9, 3.676113581404831*^9}, {
   3.676113994051722*^9, 3.6761140495138607`*^9}, {3.67611471759483*^9, 
   3.676114727326268*^9}, {3.676114788083909*^9, 3.676114788267289*^9}, {
   3.67611493328951*^9, 3.6761149644016867`*^9}, {3.6761149993051443`*^9, 
   3.676115038096011*^9}, {3.676115419194528*^9, 3.676115484935451*^9}, {
   3.6761155900865583`*^9, 3.676115605985518*^9}, {3.676115760093829*^9, 
   3.676115778909306*^9}, {3.676115982499289*^9, 3.676116037133542*^9}, {
   3.6761161990700502`*^9, 3.676116233908482*^9}, {3.676116286507206*^9, 
   3.676116286712512*^9}, {3.67611639463448*^9, 3.676116464258135*^9}, {
   3.6761165873897543`*^9, 3.676116602580727*^9}, {3.6761174556753473`*^9, 
   3.67611745672952*^9}, {3.676117506535368*^9, 3.6761175229462357`*^9}, {
   3.676117600215383*^9, 3.6761176442364273`*^9}, {3.676117677849012*^9, 
   3.6761177082717953`*^9}, {3.67611812248459*^9, 3.6761181278825502`*^9}, {
   3.676118580166224*^9, 3.67611860485815*^9}, {3.676118651876894*^9, 
   3.6761187537386017`*^9}, {3.676118838160269*^9, 3.676118838374693*^9}, {
   3.67611887610327*^9, 3.676118940213615*^9}, {3.6761191096213007`*^9, 
   3.676119140757559*^9}, {3.6761192665343122`*^9, 3.676119273783136*^9}, {
   3.67611936142714*^9, 3.676119363325075*^9}, {3.676119488561606*^9, 
   3.676119492487294*^9}, {3.6761200703687267`*^9, 3.6761200707356052`*^9}, {
   3.6761202104386873`*^9, 3.676120268289008*^9}, {3.676120410677075*^9, 
   3.676120443293746*^9}, {3.676120474583932*^9, 3.676120475526285*^9}, {
   3.6761206125852633`*^9, 3.6761206205196333`*^9}, {3.6761234586125507`*^9, 
   3.676123489461384*^9}, {3.6761235483793917`*^9, 3.676123569634534*^9}, {
   3.676124493441423*^9, 3.676124518157651*^9}, {3.676124553443336*^9, 
   3.676124582966502*^9}, {3.6761246820730133`*^9, 3.676124716437358*^9}, {
   3.67612487549886*^9, 3.676124882235661*^9}, {3.676124956893395*^9, 
   3.676124958216114*^9}, {3.6761249904362507`*^9, 3.676124994364197*^9}, {
   3.676125048497746*^9, 3.676125189073619*^9}, {3.676125219923954*^9, 
   3.6761253767254953`*^9}, {3.6761261361020412`*^9, 3.676126180304117*^9}, {
   3.6761262318219957`*^9, 3.676126312208794*^9}, {3.6761263690337877`*^9, 
   3.6761264446350737`*^9}, {3.676126475578731*^9, 3.676126485467072*^9}, {
   3.676126538828438*^9, 3.676126562090301*^9}, {3.676126633785634*^9, 
   3.6761266365895157`*^9}, 3.6761268247458773`*^9, 3.676126912241247*^9, {
   3.676126960168599*^9, 3.676126960170166*^9}, {3.676127961375718*^9, 
   3.676127975299335*^9}, {3.676128268770321*^9, 3.676128269338847*^9}, 
   3.676128811729394*^9, {3.677836754519267*^9, 3.6778367717532873`*^9}, {
   3.6778617429809027`*^9, 3.677861778150968*^9}, {3.677861811363162*^9, 
   3.677861883641371*^9}, {3.677861923205984*^9, 3.677861958483556*^9}, {
   3.677862045631447*^9, 3.6778620815532303`*^9}, {3.677862112947032*^9, 
   3.6778621629685993`*^9}, {3.677922443289874*^9, 3.677922623758004*^9}, 
   3.677923019588035*^9, {3.677923068363806*^9, 3.677923083545373*^9}, {
   3.6779231196089497`*^9, 3.677923586617464*^9}, {3.677923629777021*^9, 
   3.6779236499633503`*^9}, {3.677924129538789*^9, 3.677924181633729*^9}, {
   3.677924307517605*^9, 3.677924330024685*^9}, {3.677924381606667*^9, 
   3.677924497028296*^9}, {3.677924555410111*^9, 3.677924576632324*^9}, 
   3.678027718232277*^9, {3.678096470512413*^9, 3.678096475556388*^9}, 
   3.6784491986905737`*^9, 3.6814510240805492`*^9, {3.682637744857705*^9, 
   3.682637756820936*^9}, 3.6912198213910027`*^9, {3.691219860796672*^9, 
   3.6912199797156806`*^9}, {3.691220025969762*^9, 3.691220107479905*^9}, {
   3.6912201427983675`*^9, 3.6912202540733624`*^9}, {3.692486659326992*^9, 
   3.6924868074064617`*^9}, {3.693154101837716*^9, 3.6931541075005255`*^9}, {
   3.7306524225181856`*^9, 
   3.730652423090435*^9}},ExpressionUUID->"beb700cb-b16d-4bc9-a775-\
f33065f66984"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"SimulateControl", "[", 
      RowBox[{
      "thetalist_", ",", "dthetalist_", ",", "g_", ",", "Ftipmat_", ",", 
       "Mlist_", ",", "Glist_", ",", "Slist_", ",", "thetamatd_", ",", 
       "dthetamatd_", ",", "ddthetamatd_", ",", "gtilde_", ",", "Mtildelist_",
        ",", "Gtildelist_", ",", "Kp_", ",", "Ki_", ",", "Kd_", ",", "dt_", 
       ",", "intRes_"}], "]"}], ":", "\[IndentingNewLine]", "  ", 
     RowBox[{"Takes", " ", "thetalist"}], ":", " ", 
     RowBox[{"n", "-", 
      RowBox[{
      "vector", " ", "of", " ", "initial", " ", "joint", " ", 
       "variables"}]}]}], ",", "\[IndentingNewLine]", "         ", 
    RowBox[{"dthetalist", ":", " ", 
     RowBox[{"n", "-", 
      RowBox[{
      "vector", " ", "of", " ", "initial", " ", "joint", " ", 
       "velocities"}]}]}], ",", "\[IndentingNewLine]", "         ", 
    RowBox[{"g", ":", " ", 
     RowBox[{"Actual", " ", "gravity", " ", "vector", " ", "g"}]}], ",", 
    "\[IndentingNewLine]", "         ", 
    RowBox[{"Ftipmat", ":", " ", 
     RowBox[{
      RowBox[{
      "An", " ", "N", " ", "x", " ", "6", " ", "matrix", " ", "of", " ", 
       "spatial", " ", "forces", " ", "applied", " ", "by", " ", "the", " ", 
       "end"}], "-", 
      RowBox[{"effector", " ", 
       RowBox[{"(", 
        RowBox[{
        "If", " ", "there", " ", "are", " ", "no", " ", "tip", " ", "forces", 
         " ", "the", " ", "user", " ", "should", " ", "input", " ", "a", " ", 
         "zero", " ", "and", " ", "a", " ", "zero", " ", "matrix", " ", 
         "will", " ", "be", " ", "used"}], ")"}]}]}]}], ",", 
    "\[IndentingNewLine]", "         ", 
    RowBox[{"Mlist", ":", " ", 
     RowBox[{
      RowBox[{
      "Actual", " ", "list", " ", "of", " ", "link", " ", "frames", " ", "i", 
       " ", "relative", " ", "to", " ", "i"}], "-", 
      RowBox[{"1", " ", "at", " ", "the", " ", "home", " ", "position"}]}]}], 
    ",", "\[IndentingNewLine]", "         ", 
    RowBox[{"Glist", ":", " ", 
     RowBox[{
     "Actual", " ", "spatial", " ", "inertia", " ", "matrices", " ", "Gi", 
      " ", "of", " ", "the", " ", "links"}]}], ",", "\[IndentingNewLine]", 
    "         ", 
    RowBox[{"Slist", ":", " ", 
     RowBox[{
     "Screw", " ", "axes", " ", "Si", " ", "of", " ", "the", " ", "joints", 
      " ", "in", " ", "a", " ", "space", " ", "frame"}]}], ",", " ", 
    RowBox[{
    "in", " ", "the", " ", "format", " ", "of", " ", "a", " ", "matrix", " ", 
     "with", " ", "axes", " ", "as", " ", "the", " ", "columns"}], ",", 
    "\[IndentingNewLine]", "         ", 
    RowBox[{"thetamatd", ":", " ", 
     RowBox[{
     "An", " ", "Nxn", " ", "matrix", " ", "of", " ", "desired", " ", "joint",
       " ", "variables", " ", "from", " ", "the", " ", "reference", " ", 
      "trajectory"}]}], ",", "\[IndentingNewLine]", "         ", 
    RowBox[{"dthetamatd", ":", " ", 
     RowBox[{
     "An", " ", "Nxn", " ", "matrix", " ", "of", " ", "desired", " ", "joint",
       " ", "velocities"}]}], ",", "\[IndentingNewLine]", "         ", 
    RowBox[{"ddthetamatd", ":", " ", 
     RowBox[{
     "An", " ", "Nxn", " ", "matrix", " ", "of", " ", "desired", " ", "joint",
       " ", "accelerations"}]}], ",", "\[IndentingNewLine]", "         ", 
    RowBox[{"gtilde", ":", " ", 
     RowBox[{
     "The", " ", "gravity", " ", "vector", " ", "based", " ", "on", " ", 
      "the", " ", "model", " ", "of", " ", "the", " ", "actual", " ", "robot",
       " ", 
      RowBox[{"(", 
       RowBox[{"actual", " ", "values", " ", "given", " ", "above"}], 
       ")"}]}]}], ",", "\[IndentingNewLine]", "         ", 
    RowBox[{"Mtildelist", ":", " ", 
     RowBox[{
     "The", " ", "link", " ", "frame", " ", "locations", " ", "based", " ", 
      "on", " ", "the", " ", "model", " ", "of", " ", "the", " ", "actual", 
      " ", "robot", " ", 
      RowBox[{"(", 
       RowBox[{"actual", " ", "values", " ", "given", " ", "above"}], 
       ")"}]}]}], ",", "\[IndentingNewLine]", "         ", 
    RowBox[{"Gtildelist", ":", " ", 
     RowBox[{
     "The", " ", "link", " ", "spatial", " ", "inertias", " ", "based", " ", 
      "on", " ", "the", " ", "model", " ", "of", " ", "the", " ", "actual", 
      " ", "robot", " ", 
      RowBox[{"(", 
       RowBox[{"actual", " ", "values", " ", "given", " ", "above"}], 
       ")"}]}]}], ",", "\[IndentingNewLine]", "         ", 
    RowBox[{"Kp", ":", " ", 
     RowBox[{"The", " ", "feedback", " ", "proportional", " ", "gain", " ", 
      RowBox[{"(", 
       RowBox[{"identical", " ", "for", " ", "each", " ", "joint"}], 
       ")"}]}]}], ",", "\[IndentingNewLine]", "         ", 
    RowBox[{"Ki", ":", " ", 
     RowBox[{"The", " ", "feedback", " ", "integral", " ", "gain", " ", 
      RowBox[{"(", 
       RowBox[{"identical", " ", "for", " ", "each", " ", "joint"}], 
       ")"}]}]}], ",", "\[IndentingNewLine]", "         ", 
    RowBox[{"Kd", ":", " ", 
     RowBox[{"The", " ", "feedback", " ", "derivative", " ", "gain", " ", 
      RowBox[{"(", 
       RowBox[{"identical", " ", "for", " ", "each", " ", "joint"}], 
       ")"}]}]}], ",", 
    RowBox[{"dt", ":", 
     RowBox[{
     "The", " ", "timestep", " ", "between", " ", "points", " ", "on", " ", 
      "the", " ", "reference", " ", "trajectory"}]}], ",", 
    "\[IndentingNewLine]", "         ", 
    RowBox[{"intRes", ":", " ", 
     RowBox[{
     "Integration", " ", "resolution", " ", "is", " ", "the", " ", "number", 
      " ", "of", " ", "times", " ", "integration", " ", 
      RowBox[{"(", "Euler", ")"}], " ", "takes", " ", "places", " ", 
      "between", " ", "each", " ", "time", " ", 
      RowBox[{"step", ".", "Must"}], " ", "be", " ", "an", " ", "integer", 
      " ", "value", " ", "greater", " ", "than", " ", "or", " ", "equal", " ",
       "to", " ", "1.", "\[IndentingNewLine]", " ", "Returns", " ", 
      "taumat"}], ":", " ", 
     RowBox[{
     "An", " ", "Nxn", " ", "matrix", " ", "of", " ", "the", " ", 
      "controllers", " ", "commanded", " ", "joint", " ", 
      RowBox[{"forces", "/", "torques"}]}]}], ",", 
    RowBox[{"where", " ", "each", " ", "row", " ", "of", " ", "n", " ", 
     RowBox[{"forces", "/", "torques"}], " ", "corresponds", " ", "to", " ", 
     "a", " ", "single", " ", "time", " ", "instant"}], ",", "           ", 
    "\[IndentingNewLine]", "           ", 
    RowBox[{
     RowBox[{"thetamat", ":", " ", 
      RowBox[{
      "An", " ", "Nxn", " ", "matrix", " ", "of", " ", "actual", " ", "joint",
        " ", 
       RowBox[{"angles", ".", "\[IndentingNewLine]", "The"}], " ", "end", " ",
        "of", " ", "this", " ", "function", " ", "plots", " ", "all", " ", 
       "the", " ", "actual", " ", "and", " ", "desired", " ", "joint", " ", 
       RowBox[{"angles", "."}]}]}], "\[IndentingNewLine]", ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
      "Exapmle", ":", "\[IndentingNewLine]", "Input", ":", 
       "\[IndentingNewLine]", "thetalist"}], "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0.1", ",", "0.1", ",", "0.1"}], "}"}], "}"}], 
       "\[Transpose]"}]}], ";", "\n", "  ", 
     RowBox[{"dthetalist", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0.1", ",", "0.2", ",", "0.3"}], "}"}], "}"}], 
       "\[Transpose]"}]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"(*", 
      RowBox[{"Initialize", " ", "robot", " ", "description", " ", 
       RowBox[{"(", 
        RowBox[{"Example", " ", "with", " ", "3", " ", "links"}], ")"}]}], 
      "*)"}], "\n", "  ", 
     RowBox[{"g", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", 
          RowBox[{"-", "9.8"}]}], "}"}], "}"}], "\[Transpose]"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"M01", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.089159"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "  ", "\[IndentingNewLine]", "  ", 
     RowBox[{"M12", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.28"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0.13585"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"M23", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", 
          RowBox[{"-", "0.1197"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.395"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"M34", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.14225"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"G1", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
        "0.010267", ",", "0.010267", ",", "0.00666", ",", "3.7", ",", "3.7", 
         ",", "3.7"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"G2", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
        "0.22689", ",", "0.22689", ",", "0.0151074", ",", "8.393", ",", 
         "8.393", ",", "8.393"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "  ", 
     RowBox[{"G3", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{
        "0.0494433", ",", "0.0494433", ",", "0.004095", ",", "2.275", ",", 
         "2.275", ",", "2.275"}], "}"}], "]"}]}], ";", "\[IndentingNewLine]", 
     "  ", 
     RowBox[{"Glist", "=", 
      RowBox[{"{", 
       RowBox[{"G1", ",", "G2", ",", "G3"}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"Mlist", "=", 
      RowBox[{"{", 
       RowBox[{"M01", ",", "M12", ",", "M23", ",", "M34"}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"Slist", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", "0", ",", "1", ",", "0", ",", "1", ",", "0"}], 
          "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", 
           RowBox[{"-", "0.089"}], ",", "0", ",", "0"}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"0", ",", "1", ",", "0", ",", 
           RowBox[{"-", "0.089"}], ",", "0", ",", "0.425"}], "}"}]}], "}"}], 
       "\[Transpose]"}]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"dt", " ", "=", "0.01"}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"(*", 
      RowBox[{
      "Create", " ", "a", " ", "trajectory", " ", "to", " ", "follow"}], 
      "*)"}], "\[IndentingNewLine]", "  ", 
     RowBox[{"thetaend", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Pi", "/", "2"}], ",", "Pi", ",", 
          RowBox[{"1.5", "*", "Pi"}]}], "}"}], "}"}], "\[Transpose]"}]}], ";",
      "\n", "  ", 
     RowBox[{"Tf", "=", "1"}], ";", "\n", "  ", 
     RowBox[{"No", "=", 
      RowBox[{"Tf", "/", "dt"}]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"method", "=", "5"}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"traj", "=", 
      RowBox[{"JointTrajectory", "[", 
       RowBox[{
       "thetalist", ",", "thetaend", ",", "Tf", ",", "No", ",", "method"}], 
       "]"}]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"thetamatd", "=", "traj"}], ";", "\n", "  ", 
     RowBox[{"dthetamatd", "=", "traj"}], ";", "\n", "  ", 
     RowBox[{"ddthetamatd", "=", "traj"}], ";", "\n", "  ", 
     RowBox[{"dt", "=", 
      RowBox[{"Tf", "/", 
       RowBox[{"(", 
        RowBox[{"No", "-", "1.0"}], ")"}]}]}], ";", "\n", "  ", 
     RowBox[{"Do", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"dthetamatd", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", ";;"}], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"thetamatd", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", ";;"}], "]"}], "]"}], "-", 
            RowBox[{"thetamatd", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"i", "-", "1"}], ",", ";;"}], "]"}], "]"}]}], ")"}], 
          "/", "dt"}]}], ";", 
        RowBox[{
         RowBox[{"ddthetamatd", "[", 
          RowBox[{"[", 
           RowBox[{"i", ",", ";;"}], "]"}], "]"}], "=", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"dthetamatd", "[", 
             RowBox[{"[", 
              RowBox[{"i", ",", ";;"}], "]"}], "]"}], "-", 
            RowBox[{"dthetamatd", "[", 
             RowBox[{"[", 
              RowBox[{
               RowBox[{"i", "-", "1"}], ",", ";;"}], "]"}], "]"}]}], ")"}], 
          "/", "dt"}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "2", ",", 
         RowBox[{
          RowBox[{"Dimensions", "[", "traj", "]"}], "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "}"}]}], "]"}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"(*", 
      RowBox[{"Possibly", " ", "wrong", " ", "robot", " ", "description", " ", 
       RowBox[{"(", 
        RowBox[{"Example", " ", "with", " ", "3", " ", "links"}], ")"}]}], 
      "*)"}], "\n", "  ", 
     RowBox[{"gtilde", "=", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"{", 
         RowBox[{"0.8", ",", "0.2", ",", 
          RowBox[{"-", "8.8"}]}], "}"}], "}"}], "\[Transpose]"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"Mhat01", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.1"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "  ", "\[IndentingNewLine]", "  ", 
     RowBox[{"Mhat12", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.3"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0.2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"-", "1"}], ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"Mhat23", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", 
          RowBox[{"-", "0.2"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.4"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"Mhat34", "=", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "1", ",", "0.2"}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}]}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"Ghat1", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{"0.1", ",", "0.1", ",", "0.1", ",", "4", ",", "4", ",", "4"}],
         "}"}], "]"}]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"Ghat2", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{"0.3", ",", "0.3", ",", "0.1", ",", "9", ",", "9", ",", "9"}],
         "}"}], "]"}]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"Ghat3", "=", 
      RowBox[{"DiagonalMatrix", "[", 
       RowBox[{"{", 
        RowBox[{"0.1", ",", "0.1", ",", "0.1", ",", "3", ",", "3", ",", "3"}],
         "}"}], "]"}]}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"Gtildelist", "=", 
      RowBox[{"{", 
       RowBox[{"Ghat1", ",", "Ghat2", ",", "Ghat3"}], "}"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"Mtildelist", "=", 
      RowBox[{"{", 
       RowBox[{"Mhat01", ",", "Mhat12", ",", "Mhat23", ",", "Mhat34"}], 
       "}"}]}], ";", "\n", "  ", 
     RowBox[{"Ftipmat", "=", 
      RowBox[{"ConstantArray", "[", 
       RowBox[{"1", ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"Dimensions", "[", "traj", "]"}], "[", 
           RowBox[{"[", "1", "]"}], "]"}], ",", "6"}], "}"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", "  ", 
     RowBox[{"Kp", "=", "20"}], ";", "\n", "  ", 
     RowBox[{"Ki", "=", "10"}], ";", "\n", "  ", 
     RowBox[{"Kd", "=", "18"}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{"intRes", "=", "8"}], ";", "\[IndentingNewLine]", "  ", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"taumat", ",", "thetamat"}], "}"}], " ", "=", " ", 
      RowBox[{"SimulateControl", "[", 
       RowBox[{
       "thetalist", ",", "dthetalist", ",", "g", ",", "Ftipmat", ",", "Mlist",
         ",", "Glist", ",", "Slist", ",", "thetamatd", ",", "dthetamatd", ",",
         "ddthetamatd", ",", "gtilde", ",", "Mtildelist", ",", "Gtildelist", 
        ",", "Kp", ",", "Ki", ",", "Kd", ",", "dt", ",", "intRes"}], "]"}]}], 
     ";"}]}], "\[IndentingNewLine]", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"SimulateControl", "[", 
     RowBox[{
     "thetalist_", ",", "dthetalist_", ",", "g_", ",", "Ftipmat_", ",", 
      "Mlist_", ",", "Glist_", ",", "Slist_", ",", "thetamatd_", ",", 
      "dthetamatd_", ",", "ddthetamatd_", ",", "gtilde_", ",", "Mtildelist_", 
      ",", "Gtildelist_", ",", "Kp_", ",", "Ki_", ",", "Kd_", ",", "dt_", ",",
       "intRes_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Ftipmatt", "=", 
         RowBox[{"Ftipmat", "\[Transpose]"}]}], ",", 
        RowBox[{"thetamatdt", "=", 
         RowBox[{"thetamatd", "\[Transpose]"}]}], ",", 
        RowBox[{"dthetamatdt", "=", 
         RowBox[{"dthetamatd", "\[Transpose]"}]}], ",", 
        RowBox[{"ddthetamatdt", "=", 
         RowBox[{"ddthetamatd", "\[Transpose]"}]}], ",", "taumat", ",", 
        "thetamat", ",", "n", ",", "thetacurrent", ",", " ", "dthetacurrent", 
        ",", " ", "eint", ",", " ", "taulist", ",", "ddthetalist", ",", 
        "links", ",", " ", "plotAngles", ",", " ", "labels", ",", "style", 
        ",", "col"}], "}"}], ",", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{
         RowBox[{"Dimensions", "[", "thetamatdt", "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", 
       RowBox[{"thetamat", "=", "thetamatdt"}], ";", 
       RowBox[{"taumat", "=", "thetamatdt"}], ";", "\[IndentingNewLine]", 
       RowBox[{"thetacurrent", "=", "thetalist"}], ";", "\n", 
       RowBox[{"dthetacurrent", "=", "dthetalist"}], ";", "\n", 
       RowBox[{"eint", "=", 
        RowBox[{"ConstantArray", "[", 
         RowBox[{"0", ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{
             RowBox[{"Dimensions", "[", "thetamatdt", "]"}], "[", 
             RowBox[{"[", "1", "]"}], "]"}], ",", "1"}], "}"}]}], "]"}]}], 
       ";", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"taulist", "=", 
           RowBox[{"ComputedTorque", "[", 
            RowBox[{
            "thetacurrent", ",", "dthetacurrent", ",", "eint", ",", "gtilde", 
             ",", "Mtildelist", ",", "Gtildelist", ",", "Slist", ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"thetamatdt", "[", 
                RowBox[{"[", 
                 RowBox[{";;", ",", "i"}], "]"}], "]"}], "}"}], 
              "\[Transpose]"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"dthetamatdt", "[", 
                RowBox[{"[", 
                 RowBox[{";;", ",", "i"}], "]"}], "]"}], "}"}], 
              "\[Transpose]"}], ",", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"ddthetamatdt", "[", 
                RowBox[{"[", 
                 RowBox[{";;", ",", "i"}], "]"}], "]"}], "}"}], 
              "\[Transpose]"}], ",", "Kp", ",", "Ki", ",", "Kd"}], "]"}]}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"Do", "[", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{
             RowBox[{"ddthetalist", "=", 
              RowBox[{"ForwardDynamics", "[", 
               RowBox[{
               "thetacurrent", ",", "dthetacurrent", ",", "taulist", ",", "g",
                 ",", 
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{"Ftipmatt", "[", 
                   RowBox[{"[", 
                    RowBox[{";;", ",", "i"}], "]"}], "]"}], "}"}], 
                 "\[Transpose]"}], ",", "Mlist", ",", "Glist", ",", "Slist"}],
                "]"}]}], ";", "\n", 
             RowBox[{
              RowBox[{"{", 
               RowBox[{"thetacurrent", ",", "dthetacurrent"}], "}"}], "=", 
              RowBox[{"EulerStep", "[", 
               RowBox[{
               "thetacurrent", ",", "dthetacurrent", ",", "ddthetalist", ",", 
                RowBox[{"(", 
                 RowBox[{"dt", "/", "intRes"}], ")"}]}], "]"}]}]}], 
            "\[IndentingNewLine]", ",", 
            RowBox[{"{", 
             RowBox[{"j", ",", "intRes"}], "}"}]}], "]"}], ";", 
          RowBox[{
           RowBox[{"taumat", "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", "i"}], "]"}], "]"}], "=", "taulist"}], ";", 
          RowBox[{
           RowBox[{"thetamat", "[", 
            RowBox[{"[", 
             RowBox[{";;", ",", "i"}], "]"}], "]"}], "=", "thetacurrent"}], 
          ";", "\[IndentingNewLine]", 
          RowBox[{"eint", "=", 
           RowBox[{"eint", "+", 
            RowBox[{"(", 
             RowBox[{"dt", "*", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"thetamatdt", "[", 
                 RowBox[{"[", 
                  RowBox[{";;", ",", "i"}], "]"}], "]"}], "-", 
                "thetacurrent"}], ")"}]}], ")"}]}]}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "n"}], "}"}]}], "]"}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"Output", " ", "plotting"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"links", "=", 
        RowBox[{
         RowBox[{"Dimensions", "[", "thetamat", "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", 
       RowBox[{"plotAngles", " ", "=", 
        RowBox[{"{", "}"}]}], ";", 
       RowBox[{"labels", " ", "=", " ", 
        RowBox[{"{", "}"}]}], ";", 
       RowBox[{"style", "=", 
        RowBox[{"{", "}"}]}], ";", 
       RowBox[{"Do", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"AppendTo", "[", 
           RowBox[{"plotAngles", ",", " ", 
            RowBox[{"Flatten", "[", 
             RowBox[{"thetamat", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", ";;"}], "]"}], "]"}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"plotAngles", ",", " ", 
            RowBox[{"Flatten", "[", 
             RowBox[{"thetamatdt", "[", 
              RowBox[{"[", 
               RowBox[{"i", ",", ";;"}], "]"}], "]"}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"labels", ",", " ", 
            RowBox[{"StringJoin", "[", 
             RowBox[{"\"\<ActualTheta\>\"", ",", 
              RowBox[{"ToString", "[", "i", "]"}]}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"labels", ",", " ", 
            RowBox[{"StringJoin", "[", 
             RowBox[{"\"\<DesiredTheta\>\"", ",", 
              RowBox[{"ToString", "[", "i", "]"}]}], "]"}]}], "]"}], ";", 
          "\[IndentingNewLine]", 
          RowBox[{"col", " ", "=", " ", 
           RowBox[{"RandomColor", "[", "]"}]}], ";", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"style", ",", " ", "col"}], "]"}], ";", 
          RowBox[{"AppendTo", "[", 
           RowBox[{"style", ",", " ", 
            RowBox[{"{", 
             RowBox[{"col", ",", "Dashed"}], "}"}]}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "1", ",", "links"}], "}"}]}], "]"}], ";", 
       "\[IndentingNewLine]", 
       RowBox[{"Print", "[", 
        RowBox[{"ListLinePlot", "[", 
         RowBox[{"plotAngles", ",", 
          RowBox[{"PlotLegends", "\[Rule]", "labels"}], ",", 
          RowBox[{"PlotStyle", "\[Rule]", "style"}], ",", 
          RowBox[{"AxesLabel", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"\"\<Time\>\"", ",", "\"\<Joint Angles\>\""}], "}"}]}], 
          ",", 
          RowBox[{
          "PlotLabel", "\[Rule]", 
           "\"\<Plot of Actual and Desired Joint Angles\>\""}], ",", 
          RowBox[{"PlotRange", "\[Rule]", "Full"}]}], "]"}], "]"}], ";", 
       RowBox[{"taumat", "=", 
        RowBox[{"taumat", "\[Transpose]"}]}], ";", 
       RowBox[{"thetamat", "=", 
        RowBox[{"thetamat", "\[Transpose]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"Return", "[", 
        RowBox[{"{", 
         RowBox[{"taumat", ",", "thetamat"}], "}"}], "]"}]}]}], "]"}]}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{
  3.677924853965807*^9, 3.6779251590971527`*^9, {3.677925359632638*^9, 
   3.677925494612109*^9}, {3.677925600073634*^9, 3.677925626646657*^9}, {
   3.6779257311273537`*^9, 3.677925754253189*^9}, {3.677925821586344*^9, 
   3.6779258481817217`*^9}, {3.6779273195920897`*^9, 3.677927355304405*^9}, {
   3.6779277973487988`*^9, 3.6779278021979847`*^9}, {3.67792783288631*^9, 
   3.677928121348311*^9}, {3.6779281661484547`*^9, 3.6779281914512463`*^9}, {
   3.677928236881343*^9, 3.677928274073283*^9}, {3.677932699269586*^9, 
   3.677932700327119*^9}, {3.677934027976076*^9, 3.67793404625205*^9}, {
   3.677934083734558*^9, 3.677934088566362*^9}, {3.677934163992302*^9, 
   3.677934185281588*^9}, {3.677934364550599*^9, 3.677934419897183*^9}, {
   3.6779344508362417`*^9, 3.677934451566586*^9}, {3.677934492157349*^9, 
   3.677934494681019*^9}, {3.677934527031344*^9, 3.677934527237537*^9}, {
   3.677934575273864*^9, 3.677934644837254*^9}, {3.677934691786611*^9, 
   3.677934817811751*^9}, {3.6779349436710033`*^9, 3.677934985204653*^9}, {
   3.677937983500269*^9, 3.677937984977446*^9}, {3.6779381257429047`*^9, 
   3.677938133660923*^9}, {3.677938202196999*^9, 3.677938227703239*^9}, 
   3.677938377314639*^9, {3.677938438157711*^9, 3.677938576047544*^9}, {
   3.678096486746469*^9, 3.678096488807798*^9}, {3.678458049947278*^9, 
   3.678458060952914*^9}, 3.6784581253393917`*^9, 3.678458183955419*^9, {
   3.6784582141901493`*^9, 3.678458265956141*^9}, {3.6784583117105293`*^9, 
   3.678458357793298*^9}, {3.6814552043709087`*^9, 3.6814552145069237`*^9}, {
   3.681455255663412*^9, 3.6814552687776537`*^9}, {3.682527789069289*^9, 
   3.68252787877598*^9}, {3.6826377575249643`*^9, 3.682637758148562*^9}, {
   3.682637818965764*^9, 3.682637876057115*^9}, {3.68263799461088*^9, 
   3.6826380144271793`*^9}, {3.682638200804899*^9, 3.682638250258004*^9}, {
   3.682638491207387*^9, 3.682638509228066*^9}, {3.682638631917736*^9, 
   3.682638693519517*^9}, {3.682638745721383*^9, 3.682638747825354*^9}, {
   3.682638856341588*^9, 3.6826388905407257`*^9}, {3.682640381499113*^9, 
   3.6826403886003857`*^9}, {3.683217656988469*^9, 3.6832176852212048`*^9}, {
   3.683217744924802*^9, 3.683217766049675*^9}, {3.683217920478265*^9, 
   3.683217969778751*^9}, {3.683218016468755*^9, 3.683218027518409*^9}, {
   3.683218299683257*^9, 3.683218343811051*^9}, {3.6832294792369823`*^9, 
   3.6832295082177353`*^9}, {3.683229548795042*^9, 3.683229601725254*^9}, {
   3.6832296530608*^9, 3.683229663552986*^9}, {3.683230807268846*^9, 
   3.683230812968185*^9}, {3.683231175975581*^9, 3.683231188638826*^9}, {
   3.6832842444241858`*^9, 3.6832842861726007`*^9}, {3.68328437230928*^9, 
   3.683284428369204*^9}, {3.683284725151619*^9, 3.683284747446712*^9}, {
   3.683284795412685*^9, 3.683284800591009*^9}, {3.683284836456174*^9, 
   3.6832849599694633`*^9}, {3.6832850755968657`*^9, 3.683285079362492*^9}, {
   3.683285131777463*^9, 3.6832851358839684`*^9}, {3.683285170074172*^9, 
   3.683285181469409*^9}, {3.6832852291753883`*^9, 3.683285255535644*^9}, {
   3.68328532480322*^9, 3.683285387297305*^9}, {3.683293799303421*^9, 
   3.683293808848403*^9}, {3.683293900157916*^9, 3.6832939365266323`*^9}, {
   3.683294004515588*^9, 3.683294015304785*^9}, {3.6832940532275763`*^9, 
   3.6832940548821487`*^9}, {3.683294119846901*^9, 3.683294124792877*^9}, {
   3.683294201505858*^9, 3.683294206793943*^9}, {3.683294527397341*^9, 
   3.683294536674127*^9}, {3.68329459453303*^9, 3.6832946335870047`*^9}, {
   3.683294675202341*^9, 3.68329467563385*^9}, {3.683294828461928*^9, 
   3.683294843524208*^9}, {3.683295063325433*^9, 3.683295096414126*^9}, {
   3.6832951835909977`*^9, 3.68329518390718*^9}, {3.683295296841012*^9, 
   3.6832953163258457`*^9}, {3.683295372115971*^9, 3.683295388765071*^9}, {
   3.683295527674631*^9, 3.683295532339222*^9}, {3.683295569113285*^9, 
   3.683295606563596*^9}, 3.683295882014827*^9, {3.683296409908462*^9, 
   3.68329642375393*^9}, {3.683296552745085*^9, 3.683296592250246*^9}, {
   3.683296653009379*^9, 3.683296669019459*^9}, {3.683296989986912*^9, 
   3.683297034939659*^9}, {3.683298384693363*^9, 3.68329838977964*^9}, {
   3.683298428043923*^9, 3.6832984401731453`*^9}, {3.683298491152433*^9, 
   3.683298544421233*^9}, {3.683298597144882*^9, 3.683298646838909*^9}, {
   3.683298685695128*^9, 3.683298691211185*^9}, 3.6832988974154367`*^9, 
   3.6833032529549294`*^9, 3.683303395645307*^9, {3.6833040545975246`*^9, 
   3.683304084731357*^9}, {3.683307930454728*^9, 3.6833079832892313`*^9}, {
   3.683308115214395*^9, 3.683308196130604*^9}, {3.6890470361422048`*^9, 
   3.6890470388812103`*^9}, {3.6891123699780474`*^9, 3.689112372338051*^9}, {
   3.691238468892124*^9, 3.6912384810445457`*^9}, {3.691238519391413*^9, 
   3.691238560359085*^9}, {3.6912385973985505`*^9, 3.691238753935226*^9}, {
   3.6912388138745317`*^9, 3.691238883784254*^9}, {3.6912390413973317`*^9, 
   3.6912390540821543`*^9}, {3.6912391147224607`*^9, 3.691239358017889*^9}, {
   3.691239391667148*^9, 3.691239399311161*^9}, {3.6912394351152244`*^9, 
   3.691239440233033*^9}, {3.6912395186427712`*^9, 3.6912395261307845`*^9}, {
   3.6912396178483458`*^9, 3.691239629298766*^9}, {3.6912397575233917`*^9, 
   3.6912397579289923`*^9}, {3.6912398155272937`*^9, 
   3.6912398167128954`*^9}, {3.691239848133752*^9, 3.6912399032906494`*^9}, {
   3.691240733580181*^9, 3.6912407517240124`*^9}, {3.691240781871266*^9, 
   3.691240790166881*^9}, {3.691240822398538*^9, 3.691240839324568*^9}, {
   3.691240904942283*^9, 3.69124098820463*^9}, {3.691241221936241*^9, 
   3.6912412912667627`*^9}, {3.691241341265851*^9, 3.691241353121872*^9}, {
   3.691241384745127*^9, 3.6912414460094347`*^9}, {3.6912415506282187`*^9, 
   3.6912415601442356`*^9}, {3.691241609224922*^9, 3.691241611346526*^9}, 
   3.6912416772334423`*^9, {3.691241709542099*^9, 3.691241722053321*^9}, {
   3.6912417533645763`*^9, 3.6912417645653954`*^9}, 3.692486815324915*^9, {
   3.692487068665405*^9, 3.6924873955661025`*^9}, {3.6924875142908936`*^9, 
   3.69248752279338*^9}, {3.692487617276784*^9, 3.6924876211690063`*^9}, {
   3.692487750765419*^9, 3.6924880706777167`*^9}, {3.6931541227261524`*^9, 
   3.6931541304325657`*^9}, {3.693164676347744*^9, 3.6931647434622774`*^9}, {
   3.730652432462822*^9, 
   3.730652432947859*^9}},ExpressionUUID->"78a6cb02-1e69-4815-87fd-\
0b13c84611e1"]
}, Closed]]
},
WindowSize->{1904, 997},
WindowMargins->{{-94, Automatic}, {Automatic, 89}},
Magnification:>1.1 Inherited,
FrontEndVersion->"11.2 for Microsoft Windows (64-bit) (September 10, 2017)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 863, 20, 149, "Title",ExpressionUUID->"3096a67c-add9-43da-83af-32b7a7a080ef"],
Cell[1446, 44, 1977, 38, 940, "Title",ExpressionUUID->"b6567309-8434-4708-a2bb-37b3f2220626"],
Cell[3426, 84, 953, 14, 63, "Input",ExpressionUUID->"051fe601-9dc3-4e99-996b-456fe895c2ee"]
}, Closed]],
Cell[CellGroupData[{
Cell[4416, 103, 428, 8, 48, "Title",ExpressionUUID->"67b2b117-d9a7-4270-b942-f78127e03058"],
Cell[4847, 113, 3254, 59, 308, "Input",ExpressionUUID->"384776d6-859b-4642-a67d-e130b5288bb1"]
}, Closed]],
Cell[CellGroupData[{
Cell[8138, 177, 408, 8, 48, "Title",ExpressionUUID->"634fe91f-27b4-4e3f-a2ab-11a4d248e7fd"],
Cell[8549, 187, 2290, 53, 275, "Input",ExpressionUUID->"f6c93c67-d27e-41b6-bdde-6f032fb810cd"],
Cell[10842, 242, 3262, 86, 275, "Input",ExpressionUUID->"a30bf937-6481-47ee-bb9e-be8b63cba8e1"],
Cell[14107, 330, 2717, 70, 275, "Input",ExpressionUUID->"c7a81d49-344f-4e62-a20b-5d1c78342f7c"],
Cell[16827, 402, 2903, 64, 297, "Input",ExpressionUUID->"a1df8796-c264-4486-93a4-7068200bf83e"],
Cell[19733, 468, 5841, 124, 382, "Input",ExpressionUUID->"9e5fc67d-eedb-4d6c-92ce-f7e1bae8e4b6"],
Cell[25577, 594, 10433, 233, 429, "Input",ExpressionUUID->"305f1770-a098-48b5-a75d-b4d53949ef1a"],
Cell[36013, 829, 11703, 195, 340, "Input",ExpressionUUID->"4ddea111-4d1b-4fab-bb2e-2bf18b5511c8"],
Cell[47719, 1026, 11790, 198, 319, "Input",ExpressionUUID->"231c024d-75c6-45bd-a348-b4411df7ad47"],
Cell[59512, 1226, 12296, 212, 384, "Input",ExpressionUUID->"6b00b4cf-8c90-4a79-8772-4318b9207225"],
Cell[71811, 1440, 11679, 199, 340, "Input",ExpressionUUID->"2d25915a-29df-4bc1-87fb-88bf40588e9c"],
Cell[83493, 1641, 11520, 193, 275, "Input",ExpressionUUID->"8a71ceb0-ae72-491a-a009-dd65a1a09814"],
Cell[95016, 1836, 11997, 204, 388, "Input",ExpressionUUID->"883d455b-d605-47ff-8abc-4fc42cf1f167"],
Cell[107016, 2042, 11644, 192, 319, "Input",ExpressionUUID->"a4b8d789-2193-4eb4-89e8-f131c17e84af"],
Cell[118663, 2236, 12248, 208, 319, "Input",ExpressionUUID->"ec6248e6-c8a6-47c2-b31f-5eddd1d42a35"],
Cell[130914, 2446, 16513, 297, 406, "Input",ExpressionUUID->"cb2b4b25-a328-4451-b1a7-53449ff8db62"],
Cell[147430, 2745, 23859, 478, 1128, "Input",ExpressionUUID->"30cfbd3e-57bb-4e33-99e1-c83444da6e3e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[171326, 3228, 358, 7, 77, "Title",ExpressionUUID->"2c8ea6eb-fa7d-47e8-92f0-27b5858ae3f0"],
Cell[171687, 3237, 7193, 167, 567, "Input",ExpressionUUID->"42e3cd6c-7142-4593-924a-642228db11d2"],
Cell[178883, 3406, 6633, 157, 567, "Input",ExpressionUUID->"3e604bd8-121f-4823-845b-8af9015f2e0b"]
}, Closed]],
Cell[CellGroupData[{
Cell[185553, 3568, 424, 8, 48, "Title",ExpressionUUID->"000ed3dd-e640-4394-bfdd-112e054fe39e"],
Cell[185980, 3578, 16119, 289, 547, "Input",ExpressionUUID->"240e2dfc-5e90-4b05-a228-e4214db5aa73"],
Cell[202102, 3869, 14782, 263, 572, "Input",ExpressionUUID->"537c0d96-762a-44d8-9b3b-ae7cd65b0ad8"]
}, Closed]],
Cell[CellGroupData[{
Cell[216921, 4137, 462, 9, 48, "Title",ExpressionUUID->"9b65060d-851c-4e01-9b60-18f3c42fd7f6"],
Cell[217386, 4148, 23816, 427, 834, "Input",ExpressionUUID->"faf42c91-d222-47ba-a1cf-c70438e66ed9"],
Cell[241205, 4577, 24229, 435, 883, "Input",ExpressionUUID->"cd8261cd-edb7-439b-80ea-07f7f0f661f2"]
}, Closed]],
Cell[CellGroupData[{
Cell[265471, 5017, 510, 9, 48, "Title",ExpressionUUID->"81e5be89-ffaf-473a-8cbb-55c594f704e9"],
Cell[265984, 5028, 10924, 193, 476, "Input",ExpressionUUID->"eebfa9bb-9b2c-44e6-9326-456220a27d55"],
Cell[276911, 5223, 31869, 641, 1155, "Input",ExpressionUUID->"d13bd5d8-2632-4dc0-b0b1-630524e24a38"],
Cell[308783, 5866, 17547, 351, 807, "Input",ExpressionUUID->"92528685-883e-4c0c-bac2-bf106210e42b"],
Cell[326333, 6219, 15720, 310, 783, "Input",ExpressionUUID->"f3f61900-aa02-4fd1-9e7e-e8d496ab43f7"],
Cell[342056, 6531, 15016, 298, 738, "Input",ExpressionUUID->"a7efa093-4b6e-496e-9dcb-6d6052ee3445"],
Cell[357075, 6831, 8797, 216, 738, "Input",ExpressionUUID->"050d5074-a82f-46cd-af46-1b1b25e99315"],
Cell[365875, 7049, 16719, 337, 955, "Input",ExpressionUUID->"d6589c3c-8957-41cb-b657-352eb72af4ed"],
Cell[382597, 7388, 10341, 186, 520, "Input",ExpressionUUID->"6009f6be-153c-4a23-9e78-8febfb6f128a"],
Cell[392941, 7576, 22510, 468, 1294, "Input",ExpressionUUID->"8c71c553-e0e9-4531-9417-f427517894a6"],
Cell[415454, 8046, 25638, 531, 1439, "Input",ExpressionUUID->"c001454f-a821-4609-9c44-fc644598fd8e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[441129, 8582, 513, 9, 84, "Title",ExpressionUUID->"75d6083f-b722-498a-b9fa-576327a19efc"],
Cell[441645, 8593, 15363, 235, 751, "Input",ExpressionUUID->"c0075b7e-c880-4998-8fed-6d7994aad149"],
Cell[457011, 8830, 2877, 69, 751, "Input",ExpressionUUID->"b650297d-45e5-44b0-83f7-ea7a549e74e8"],
Cell[459891, 8901, 17437, 315, 1716, "Input",ExpressionUUID->"01b172e6-150d-47a2-93d8-0c226f061852"],
Cell[477331, 9218, 19665, 378, 2270, "Input",ExpressionUUID->"8eab3c39-2044-482c-9bc9-f59721338bd9"],
Cell[496999, 9598, 21722, 421, 2362, "Input",ExpressionUUID->"e7f7c189-2377-47aa-8f37-8943a95caef1"]
}, Closed]],
Cell[CellGroupData[{
Cell[518758, 10024, 504, 9, 52, "Title",ExpressionUUID->"10d566a6-4644-4e65-8900-e5ebea810780"],
Cell[519265, 10035, 25323, 468, 1447, "Input",ExpressionUUID->"beb700cb-b16d-4bc9-a775-f33065f66984"],
Cell[544591, 10505, 32931, 717, 3138, "Input",ExpressionUUID->"78a6cb02-1e69-4815-87fd-0b13c84611e1"]
}, Closed]]
}
]
*)

